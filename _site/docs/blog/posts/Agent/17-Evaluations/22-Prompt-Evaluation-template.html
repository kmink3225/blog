<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="ko" xml:lang="ko"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.543">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Kwangmin Kim">
<meta name="description" content="LLM 판사에게 전달하는 평가 프롬프트를 어떻게 설계할 것인가? 3가지 실전 템플릿을 분석한다: (1) LMSYS 원본 템플릿 - 5가지 설계 원칙: 명확한 역할 부여(“impartial judge”), 다차원 평가 기준 6가지(helpfulness, relevance, accuracy, depth, creativity, detail), 사고 과정 유도(Chain-of-Thought), 엄격한 출력 형식([[score]]), 객관성 강조 (2) Azure AI 템플릿 - XML 구조화, 프롬프트 자체도 평가, hallucination 명시적 경고, JSON 출력, 실행 가능한 개선 권장사항 제공 (3) HuggingFace 간소화 템플릿 - 단순함의 장점(빠른 실행, 저렴한 비용), 0-10 float 점수, 빠른 프로토타이핑에 적합평가 템플릿 설계 6가지 핵심 원칙: (1) 명확한 역할과 목표, (2) 구체적이고 측정 가능한 기준, (3) 사고 과정 유도, (4) 엄격한 출력 형식, (5) 편향 완화 기법, (6) 맥락 정보 제공.실무 적용 코드를 제공한다: 기본 평가 파이프라인, 배치 평가, 위치 편향 완화를 위한 순서 무작위화, 다중 판사 앙상블 평가. Python 코드로 즉시 적용 가능하다.해결되지 않은 4가지 과제: (1) 전문 도메인에서의 인간-AI 정렬, (2) Few-shot 예시의 효과, (3) 적절한 점수 척도 선택(0-100 vs 0-1 vs 1-10), (4) 템플릿의 범용성과 도메인 특화의 균형.">

<title>Kwangmin Kim - LLM-as-a-Judge 평가 프롬프트 템플릿 설계</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../../../site_libs/quarto-search/quarto-search.js"></script>
<script src="../../../../../site_libs/quarto-search/autocomplete-preset-algolia.umd.js"></script>
<meta name="quarto:offset" content="../../../../../">
<script src="../../../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../../../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../../../../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "algolia": {
    "application-id": "DUOR1DRC9D",
    "search-only-api-key": "f264da5dea684ffb9e9b4a574af3ed61",
    "index-name": "prod_QUARTO",
    "analytics-events": true,
    "show-logo": true,
    "libDir": "site_libs"
  },
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": true,
  "language": {
    "search-no-results-text": "일치 없음",
    "search-matching-documents-text": "일치된 문서",
    "search-copy-link-title": "검색 링크 복사",
    "search-hide-matches-text": "추가 검색 결과 숨기기",
    "search-more-match-text": "추가 검색결과",
    "search-more-matches-text": "추가 검색결과",
    "search-clear-button-title": "제거",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "취소",
    "search-submit-button-title": "검색",
    "search-label": "검색"
  }
}</script>
<script src="https://cdn.jsdelivr.net/npm/algoliasearch@4.5.1/dist/algoliasearch-lite.umd.js"></script>


<script type="text/javascript">
var ALGOLIA_INSIGHTS_SRC = "https://cdn.jsdelivr.net/npm/search-insights/dist/search-insights.iife.min.js";
!function(e,a,t,n,s,i,c){e.AlgoliaAnalyticsObject=s,e[s]=e[s]||function(){
(e[s].queue=e[s].queue||[]).push(arguments)},i=a.createElement(t),c=a.getElementsByTagName(t)[0],
i.async=1,i.src=n,c.parentNode.insertBefore(i,c)
}(window,document,"script",ALGOLIA_INSIGHTS_SRC,"aa");
</script>

<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@algolia/autocomplete-plugin-algolia-insights">

</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-6W0EKFMWBN"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-6W0EKFMWBN', { 'anonymize_ip': true});
</script>
<style>

      .quarto-title-block .quarto-title-banner h1,
      .quarto-title-block .quarto-title-banner h2,
      .quarto-title-block .quarto-title-banner h3,
      .quarto-title-block .quarto-title-banner h4,
      .quarto-title-block .quarto-title-banner h5,
      .quarto-title-block .quarto-title-banner h6
      {
        color: black;
      }

      .quarto-title-block .quarto-title-banner {
        color: black;
background: #EDF3F9;
      }
</style>
<style>
.custom-footer { 
  text-align: center; 
  font-size: 0.8em; 
  color: #666; 
  margin-top: 2rem; 
}
</style>


<link rel="stylesheet" href="../../../../../styles.css">
<meta property="og:title" content="Kwangmin Kim - LLM-as-a-Judge 평가 프롬프트 템플릿 설계">
<meta property="og:description" content="LLM 판사에게 전달하는 평가 프롬프트를 어떻게 설계할 것인가?">
<meta property="og:site_name" content="Kwangmin Kim">
<meta name="twitter:title" content="Kwangmin Kim - LLM-as-a-Judge 평가 프롬프트 템플릿 설계">
<meta name="twitter:description" content="LLM 판사에게 전달하는 평가 프롬프트를 어떻게 설계할 것인가?">
<meta name="twitter:card" content="summary">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../../../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../../../.././images/logo.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../../../../../index.html">
    <span class="navbar-title">Kwangmin Kim</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="검색"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="탐색 전환" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../../../docs/blog/index.html"> 
<span class="menu-text">Blog</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../../../about.html"> 
<span class="menu-text">Me</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/kmink3225"> <i class="bi bi-github" role="img" aria-label="Github">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/kwangmin-kim-a5241b200/"> <i class="bi bi-linkedin" role="img" aria-label="Linkedin">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="다크 모드 전환"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">LLM-as-a-Judge 평가 프롬프트 템플릿 설계</h1>
            <p class="subtitle lead">LMSYS, Azure, HuggingFace 템플릿 분석과 실무 적용</p>
                  <div>
        <div class="description">
          <p>LLM 판사에게 전달하는 평가 프롬프트를 어떻게 설계할 것인가? 3가지 실전 템플릿을 분석한다: (1) LMSYS 원본 템플릿 - 5가지 설계 원칙: 명확한 역할 부여(“impartial judge”), 다차원 평가 기준 6가지(helpfulness, relevance, accuracy, depth, creativity, detail), 사고 과정 유도(Chain-of-Thought), 엄격한 출력 형식([[score]]), 객관성 강조 (2) Azure AI 템플릿 - XML 구조화, 프롬프트 자체도 평가, hallucination 명시적 경고, JSON 출력, 실행 가능한 개선 권장사항 제공 (3) HuggingFace 간소화 템플릿 - 단순함의 장점(빠른 실행, 저렴한 비용), 0-10 float 점수, 빠른 프로토타이핑에 적합</p>
          <p>평가 템플릿 설계 6가지 핵심 원칙: (1) 명확한 역할과 목표, (2) 구체적이고 측정 가능한 기준, (3) 사고 과정 유도, (4) 엄격한 출력 형식, (5) 편향 완화 기법, (6) 맥락 정보 제공.</p>
          <p>실무 적용 코드를 제공한다: 기본 평가 파이프라인, 배치 평가, 위치 편향 완화를 위한 순서 무작위화, 다중 판사 앙상블 평가. Python 코드로 즉시 적용 가능하다.</p>
          <p>해결되지 않은 4가지 과제: (1) 전문 도메인에서의 인간-AI 정렬, (2) Few-shot 예시의 효과, (3) 적절한 점수 척도 선택(0-100 vs 0-1 vs 1-10), (4) 템플릿의 범용성과 도메인 특화의 균형.</p>
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">AI</div>
                <div class="quarto-category">Agent</div>
                <div class="quarto-category">Prompt Engineering</div>
                <div class="quarto-category">Evaluation</div>
                <div class="quarto-category">LLM</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">저자</div>
      <div class="quarto-title-meta-contents">
               <p>Kwangmin Kim </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">공개</div>
      <div class="quarto-title-meta-contents">
        <p class="date">2025년 02월 06일</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">목차</h2>
   
  <ul>
  <li><a href="#이론에서-실무로-평가-프롬프트-설계의-실제" id="toc-이론에서-실무로-평가-프롬프트-설계의-실제" class="nav-link active" data-scroll-target="#이론에서-실무로-평가-프롬프트-설계의-실제"><span class="header-section-number">1</span> 이론에서 실무로: 평가 프롬프트 설계의 실제</a></li>
  <li><a href="#lmsys-논문의-원본-평가-프롬프트" id="toc-lmsys-논문의-원본-평가-프롬프트" class="nav-link" data-scroll-target="#lmsys-논문의-원본-평가-프롬프트"><span class="header-section-number">2</span> LMSYS 논문의 원본 평가 프롬프트</a>
  <ul class="collapse">
  <li><a href="#원본-프롬프트-전문" id="toc-원본-프롬프트-전문" class="nav-link" data-scroll-target="#원본-프롬프트-전문"><span class="header-section-number">2.1</span> 원본 프롬프트 전문</a></li>
  <li><a href="#설계-원칙-1-명확한-역할-부여" id="toc-설계-원칙-1-명확한-역할-부여" class="nav-link" data-scroll-target="#설계-원칙-1-명확한-역할-부여"><span class="header-section-number">2.2</span> 설계 원칙 1: 명확한 역할 부여</a></li>
  <li><a href="#설계-원칙-2-다차원-평가-기준" id="toc-설계-원칙-2-다차원-평가-기준" class="nav-link" data-scroll-target="#설계-원칙-2-다차원-평가-기준"><span class="header-section-number">2.3</span> 설계 원칙 2: 다차원 평가 기준</a></li>
  <li><a href="#설계-원칙-3-사고-과정-유도" id="toc-설계-원칙-3-사고-과정-유도" class="nav-link" data-scroll-target="#설계-원칙-3-사고-과정-유도"><span class="header-section-number">2.4</span> 설계 원칙 3: 사고 과정 유도</a></li>
  <li><a href="#설계-원칙-4-엄격한-출력-형식" id="toc-설계-원칙-4-엄격한-출력-형식" class="nav-link" data-scroll-target="#설계-원칙-4-엄격한-출력-형식"><span class="header-section-number">2.5</span> 설계 원칙 4: 엄격한 출력 형식</a></li>
  <li><a href="#설계-원칙-5-객관성-강조" id="toc-설계-원칙-5-객관성-강조" class="nav-link" data-scroll-target="#설계-원칙-5-객관성-강조"><span class="header-section-number">2.6</span> 설계 원칙 5: 객관성 강조</a></li>
  </ul></li>
  <li><a href="#azure-ai의-정교한-평가-템플릿" id="toc-azure-ai의-정교한-평가-템플릿" class="nav-link" data-scroll-target="#azure-ai의-정교한-평가-템플릿"><span class="header-section-number">3</span> Azure AI의 정교한 평가 템플릿</a>
  <ul class="collapse">
  <li><a href="#구조화된-xml-기반-템플릿" id="toc-구조화된-xml-기반-템플릿" class="nav-link" data-scroll-target="#구조화된-xml-기반-템플릿"><span class="header-section-number">3.1</span> 구조화된 XML 기반 템플릿</a></li>
  <li><a href="#개선점-1-xml-태그로-구조화" id="toc-개선점-1-xml-태그로-구조화" class="nav-link" data-scroll-target="#개선점-1-xml-태그로-구조화"><span class="header-section-number">3.2</span> 개선점 1: XML 태그로 구조화</a></li>
  <li><a href="#개선점-2-프롬프트-자체도-평가" id="toc-개선점-2-프롬프트-자체도-평가" class="nav-link" data-scroll-target="#개선점-2-프롬프트-자체도-평가"><span class="header-section-number">3.3</span> 개선점 2: 프롬프트 자체도 평가</a></li>
  <li><a href="#개선점-3-hallucination에-대한-명시적-경고" id="toc-개선점-3-hallucination에-대한-명시적-경고" class="nav-link" data-scroll-target="#개선점-3-hallucination에-대한-명시적-경고"><span class="header-section-number">3.4</span> 개선점 3: Hallucination에 대한 명시적 경고</a></li>
  <li><a href="#개선점-4-json-구조화된-출력-요구" id="toc-개선점-4-json-구조화된-출력-요구" class="nav-link" data-scroll-target="#개선점-4-json-구조화된-출력-요구"><span class="header-section-number">3.5</span> 개선점 4: JSON 구조화된 출력 요구</a></li>
  <li><a href="#개선점-5-실행-가능한-권장사항-요구" id="toc-개선점-5-실행-가능한-권장사항-요구" class="nav-link" data-scroll-target="#개선점-5-실행-가능한-권장사항-요구"><span class="header-section-number">3.6</span> 개선점 5: 실행 가능한 권장사항 요구</a></li>
  </ul></li>
  <li><a href="#huggingface의-실용적-간소화-버전" id="toc-huggingface의-실용적-간소화-버전" class="nav-link" data-scroll-target="#huggingface의-실용적-간소화-버전"><span class="header-section-number">4</span> HuggingFace의 실용적 간소화 버전</a>
  <ul class="collapse">
  <li><a href="#단순함의-장점" id="toc-단순함의-장점" class="nav-link" data-scroll-target="#단순함의-장점"><span class="header-section-number">4.1</span> 단순함의 장점</a></li>
  <li><a href="#언제-단순한-버전을-쓸까" id="toc-언제-단순한-버전을-쓸까" class="nav-link" data-scroll-target="#언제-단순한-버전을-쓸까"><span class="header-section-number">4.2</span> 언제 단순한 버전을 쓸까?</a></li>
  <li><a href="#점수-체계의-의미" id="toc-점수-체계의-의미" class="nav-link" data-scroll-target="#점수-체계의-의미"><span class="header-section-number">4.3</span> 0-10 점수 체계의 의미</a></li>
  </ul></li>
  <li><a href="#평가-템플릿-설계의-핵심-원칙" id="toc-평가-템플릿-설계의-핵심-원칙" class="nav-link" data-scroll-target="#평가-템플릿-설계의-핵심-원칙"><span class="header-section-number">5</span> 평가 템플릿 설계의 핵심 원칙</a>
  <ul class="collapse">
  <li><a href="#원칙-1-명확한-역할과-목표" id="toc-원칙-1-명확한-역할과-목표" class="nav-link" data-scroll-target="#원칙-1-명확한-역할과-목표"><span class="header-section-number">5.1</span> 원칙 1: 명확한 역할과 목표</a></li>
  <li><a href="#원칙-2-구체적이고-측정-가능한-기준" id="toc-원칙-2-구체적이고-측정-가능한-기준" class="nav-link" data-scroll-target="#원칙-2-구체적이고-측정-가능한-기준"><span class="header-section-number">5.2</span> 원칙 2: 구체적이고 측정 가능한 기준</a></li>
  <li><a href="#원칙-3-사고-과정-유도" id="toc-원칙-3-사고-과정-유도" class="nav-link" data-scroll-target="#원칙-3-사고-과정-유도"><span class="header-section-number">5.3</span> 원칙 3: 사고 과정 유도</a></li>
  <li><a href="#원칙-4-엄격한-출력-형식" id="toc-원칙-4-엄격한-출력-형식" class="nav-link" data-scroll-target="#원칙-4-엄격한-출력-형식"><span class="header-section-number">5.4</span> 원칙 4: 엄격한 출력 형식</a></li>
  <li><a href="#원칙-5-편향-완화-기법-포함" id="toc-원칙-5-편향-완화-기법-포함" class="nav-link" data-scroll-target="#원칙-5-편향-완화-기법-포함"><span class="header-section-number">5.5</span> 원칙 5: 편향 완화 기법 포함</a></li>
  <li><a href="#원칙-6-맥락-정보-제공" id="toc-원칙-6-맥락-정보-제공" class="nav-link" data-scroll-target="#원칙-6-맥락-정보-제공"><span class="header-section-number">5.6</span> 원칙 6: 맥락 정보 제공</a></li>
  </ul></li>
  <li><a href="#실무-적용-평가-파이프라인-구축" id="toc-실무-적용-평가-파이프라인-구축" class="nav-link" data-scroll-target="#실무-적용-평가-파이프라인-구축"><span class="header-section-number">6</span> 실무 적용: 평가 파이프라인 구축</a>
  <ul class="collapse">
  <li><a href="#기본-파이프라인" id="toc-기본-파이프라인" class="nav-link" data-scroll-target="#기본-파이프라인"><span class="header-section-number">6.1</span> 기본 파이프라인</a></li>
  <li><a href="#배치-평가" id="toc-배치-평가" class="nav-link" data-scroll-target="#배치-평가"><span class="header-section-number">6.2</span> 배치 평가</a></li>
  <li><a href="#위치-편향-완화-순서-무작위화" id="toc-위치-편향-완화-순서-무작위화" class="nav-link" data-scroll-target="#위치-편향-완화-순서-무작위화"><span class="header-section-number">6.3</span> 위치 편향 완화: 순서 무작위화</a></li>
  <li><a href="#다중-판사-활용-앙상블-평가" id="toc-다중-판사-활용-앙상블-평가" class="nav-link" data-scroll-target="#다중-판사-활용-앙상블-평가"><span class="header-section-number">6.4</span> 다중 판사 활용: 앙상블 평가</a></li>
  </ul></li>
  <li><a href="#해결되지-않은-과제들" id="toc-해결되지-않은-과제들" class="nav-link" data-scroll-target="#해결되지-않은-과제들"><span class="header-section-number">7</span> 해결되지 않은 과제들</a>
  <ul class="collapse">
  <li><a href="#과제-1-alignment-with-human-grading" id="toc-과제-1-alignment-with-human-grading" class="nav-link" data-scroll-target="#과제-1-alignment-with-human-grading"><span class="header-section-number">7.1</span> 과제 1: Alignment with Human Grading</a></li>
  <li><a href="#과제-2-accuracy-through-examples" id="toc-과제-2-accuracy-through-examples" class="nav-link" data-scroll-target="#과제-2-accuracy-through-examples"><span class="header-section-number">7.2</span> 과제 2: Accuracy Through Examples</a></li>
  <li><a href="#과제-3-appropriate-grade-scales" id="toc-과제-3-appropriate-grade-scales" class="nav-link" data-scroll-target="#과제-3-appropriate-grade-scales"><span class="header-section-number">7.3</span> 과제 3: Appropriate Grade Scales</a></li>
  <li><a href="#과제-4-applicability-across-use-cases" id="toc-과제-4-applicability-across-use-cases" class="nav-link" data-scroll-target="#과제-4-applicability-across-use-cases"><span class="header-section-number">7.4</span> 과제 4: Applicability Across Use Cases</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<section id="이론에서-실무로-평가-프롬프트-설계의-실제" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="이론에서-실무로-평가-프롬프트-설계의-실제"><span class="header-section-number">1</span> 이론에서 실무로: 평가 프롬프트 설계의 실제</h2>
<p>Part B에서 우리는 LLM-as-a-Judge가 왜 작동하는지, 얼마나 신뢰할 만한지를 살펴봤다. 이제 핵심 질문이 남았다: <strong>실제로 어떻게 사용하는가?</strong></p>
<p>판사 역할을 하는 LLM에게 단순히 “이 답변이 좋은지 평가해줘”라고 하면 될까? 아니다. 평가 프롬프트 자체를 정교하게 설계해야 한다. 좋은 평가 프롬프트는 일관되고, 명확하고, 포괄적인 평가를 이끌어낸다. 나쁜 평가 프롬프트는 편향되고, 모호하고, 재현 불가능한 결과를 낳는다.</p>
<p>이번 파트에서는 실제 사용되는 평가 프롬프트 템플릿들을 살펴보고, 그 설계 원칙과 실무 적용 방법을 구체적으로 다룬다.</p>
</section>
<section id="lmsys-논문의-원본-평가-프롬프트" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="lmsys-논문의-원본-평가-프롬프트"><span class="header-section-number">2</span> LMSYS 논문의 원본 평가 프롬프트</h2>
<p>MT-Bench 연구에서 사용된 원본 프롬프트를 먼저 살펴보자. 이것이 많은 후속 연구와 실무 적용의 기초가 되었다.</p>
<section id="원본-프롬프트-전문" class="level3" data-number="2.1">
<h3 data-number="2.1" class="anchored" data-anchor-id="원본-프롬프트-전문"><span class="header-section-number">2.1</span> 원본 프롬프트 전문</h3>
<pre><code>Please act as an impartial judge and evaluate the quality of the response 
provided by an AI assistant to the user question displayed below. 

Your evaluation should consider factors such as the helpfulness, relevance, 
accuracy, depth, creativity, and level of detail of the response. 

Begin your evaluation by providing a short explanation. Be as objective as 
possible. After providing your explanation, you must rate the response on a 
scale of 1 to 10 by strictly following this format.</code></pre>
<p>이 프롬프트는 겉보기에 단순해 보이지만, 각 요소가 신중하게 설계되었다.</p>
</section>
<section id="설계-원칙-1-명확한-역할-부여" class="level3" data-number="2.2">
<h3 data-number="2.2" class="anchored" data-anchor-id="설계-원칙-1-명확한-역할-부여"><span class="header-section-number">2.2</span> 설계 원칙 1: 명확한 역할 부여</h3>
<p><strong>“Please act as an impartial judge”</strong></p>
<p>왜 “impartial(공정한)” 이라는 단어를 사용했을까? 연구팀은 여러 실험을 통해 이 단어가 중요하다는 것을 발견했다. 역할 지시 없이 평가를 요청하면, 모델이 지나치게 관대하거나 또는 지나치게 엄격한 평가를 내릴 수 있다. “공정한 판사” 역할을 명시하면, 모델이 더 균형 잡힌 평가를 한다.</p>
<p>이는 프롬프트 엔지니어링의 일반 원칙과도 일치한다: <strong>역할을 부여하면 모델이 그 역할에 맞는 톤, 스타일, 판단 기준을 적용한다.</strong> “당신은 수학 선생님입니다”라고 하면 교육적으로, “당신은 코드 리뷰어입니다”라고 하면 비판적으로 접근한다.</p>
<p>실무 팁: 평가 목적에 맞게 역할을 조정할 수 있다. 예를 들어:<br>
- “당신은 초보자를 위한 교육 콘텐츠를 평가하는 교육학 전문가입니다” → 명확성과 이해 가능성에 높은 가중치<br>
- “당신은 기술 문서의 정확성을 평가하는 시니어 엔지니어입니다” → 정확성과 완성도에 높은 가중치</p>
</section>
<section id="설계-원칙-2-다차원-평가-기준" class="level3" data-number="2.3">
<h3 data-number="2.3" class="anchored" data-anchor-id="설계-원칙-2-다차원-평가-기준"><span class="header-section-number">2.3</span> 설계 원칙 2: 다차원 평가 기준</h3>
<p><strong>“helpfulness, relevance, accuracy, depth, creativity, and level of detail”</strong></p>
<p>6가지 차원을 명시했다. 이것이 중요한 이유:</p>
<ol type="1">
<li><p><strong>포괄성</strong>: 단일 차원(예: 정확성만)으로는 품질을 완전히 포착할 수 없다. 정확하지만 도움이 되지 않는 답변, 자세하지만 관련성이 없는 답변이 존재한다.</p></li>
<li><p><strong>명시성</strong>: 평가 기준을 명시하지 않으면 모델이 자체적인 기준을 적용한다. 그 기준이 당신의 의도와 다를 수 있다. 명시하면 일관성이 높아진다.</p></li>
<li><p><strong>해석 가능성</strong>: 나중에 “왜 이 답변이 높은 점수를 받았는가?”를 추적할 수 있다. “정확도는 높지만 창의성이 낮았다”처럼 구체적으로 이해할 수 있다.</p></li>
</ol>
<p>그런데 왜 하필 이 6가지 차원일까? 연구팀은 다양한 차원 조합을 실험했고, 이 6가지가 가장 일반적이고 포괄적이라는 것을 발견했다. 하지만 이것이 유일한 정답은 아니다. 사용 사례에 따라 다른 차원을 추가하거나 제거할 수 있다.</p>
<p><strong>사용 사례별 차원 조정 예시</strong>:</p>
<p><strong>고객 지원 챗봇 평가</strong>:<br>
- Empathy (공감): 사용자의 감정을 이해하고 적절히 반응하는가?<br>
- Actionability (실행 가능성): 구체적인 해결 방법을 제시하는가?<br>
- Politeness (정중함): 예의 바른 표현을 사용하는가?<br>
- Efficiency (효율성): 불필요한 정보 없이 핵심만 전달하는가?</p>
<p><strong>창작 글쓰기 평가</strong>:<br>
- Originality (독창성): 진부한 표현을 피하고 참신한가?<br>
- Emotional Impact (감정적 영향력): 독자의 감정을 움직이는가?<br>
- Narrative Flow (서사 흐름): 이야기가 자연스럽게 전개되는가?</p>
<p><strong>기술 문서 평가</strong>:<br>
- Completeness (완전성): 필요한 모든 정보를 포함하는가?<br>
- Reproducibility (재현 가능성): 독자가 지시를 따라 할 수 있는가?<br>
- Technical Accuracy (기술적 정확성): 전문 용어와 개념이 정확한가?</p>
</section>
<section id="설계-원칙-3-사고-과정-유도" class="level3" data-number="2.4">
<h3 data-number="2.4" class="anchored" data-anchor-id="설계-원칙-3-사고-과정-유도"><span class="header-section-number">2.4</span> 설계 원칙 3: 사고 과정 유도</h3>
<p><strong>“Begin your evaluation by providing a short explanation”</strong></p>
<p>왜 점수만 달라고 하지 않고, 먼저 설명을 요구할까? 이것은 <strong>Chain-of-Thought (CoT)</strong> 프롬프팅 기법의 적용이다.</p>
<p>연구에 따르면, LLM이 결론을 내리기 전에 추론 과정을 먼저 표현하도록 하면 더 정확하고 일관된 결과를 낸다. 평가에서도 마찬가지다. 모델이 “이 답변은 8점이다”라고 바로 말하는 것보다, “이 답변은 정확한 정보를 제공하지만, 초보자가 이해하기에는 너무 전문적이다. 따라서…”처럼 이유를 먼저 설명하면, 더 신중한 평가가 나온다.</p>
<p>추가 이점:<br>
- <strong>감사 가능성(Auditability)</strong>: 평가 이유를 추적할 수 있다<br>
- <strong>편향 감지</strong>: 설명을 보면 모델이 어떤 요소에 편향되었는지 알 수 있다<br>
- <strong>개선 가능성</strong>: 평가 논리를 이해하면 프롬프트를 개선할 방향을 알 수 있다</p>
</section>
<section id="설계-원칙-4-엄격한-출력-형식" class="level3" data-number="2.5">
<h3 data-number="2.5" class="anchored" data-anchor-id="설계-원칙-4-엄격한-출력-형식"><span class="header-section-number">2.5</span> 설계 원칙 4: 엄격한 출력 형식</h3>
<p><strong>“you must rate the response on a scale of 1 to 10 by strictly following this format”</strong></p>
<p>“strictly following this format”이라는 표현에 주목하자. 왜 이렇게 강조할까?</p>
<p>LLM은 때때로 지시를 “유연하게” 해석한다. “1-10으로 평가하라”고 하면:<br>
- “8-9점 정도입니다” (범위로 답함)<br>
- “8.5점” (소수점 사용)<br>
- “8점입니다만, 맥락에 따라 7점일 수도…” (모호한 답변)</p>
<p>이런 출력은 자동화된 파싱을 어렵게 만든다. 수백 개의 평가를 처리할 때, 각각을 수동으로 해석할 수 없다. 따라서 <strong>“엄격하게”</strong> 형식을 지킬 것을 요구한다.</p>
<p>실무에서는 더 나아가 출력 형식을 예시로 보여주는 것이 좋다:</p>
<pre><code>You must provide your rating in exactly this format:
Rating: [[8]]

Do not include any text after the rating. Do not explain the rating again after providing the number.</code></pre>
<p>대괄호 <code>[[]]</code>를 사용하는 것은 정규식(regex)으로 파싱하기 쉽게 만드는 패턴이다. 코드에서 <code>\[\[(\d+)\]\]</code> 같은 패턴으로 점수를 추출할 수 있다.</p>
</section>
<section id="설계-원칙-5-객관성-강조" class="level3" data-number="2.6">
<h3 data-number="2.6" class="anchored" data-anchor-id="설계-원칙-5-객관성-강조"><span class="header-section-number">2.6</span> 설계 원칙 5: 객관성 강조</h3>
<p><strong>“Be as objective as possible”</strong></p>
<p>이것은 모델에게 개인적 선호나 스타일 편향을 최소화하라고 지시한다. 완벽한 객관성은 불가능하지만, 명시적으로 요구하면 모델이 더 중립적인 평가를 시도한다.</p>
<p>실험적으로, 이 문구가 없을 때와 있을 때를 비교하면:<br>
- <strong>없을 때</strong>: “저는 개인적으로 더 간결한 답변을 선호합니다”<br>
- <strong>있을 때</strong>: “답변의 길이는 적절하며, 필요한 정보를 모두 포함합니다”</p>
</section>
</section>
<section id="azure-ai의-정교한-평가-템플릿" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="azure-ai의-정교한-평가-템플릿"><span class="header-section-number">3</span> Azure AI의 정교한 평가 템플릿</h2>
<p>LMSYS의 기본 템플릿을 넘어, 실무에서 사용되는 더 정교한 템플릿을 살펴보자. PDF 슬라이드 13-14에 나온 Azure AI 스타일의 템플릿이다.</p>
<section id="구조화된-xml-기반-템플릿" class="level3" data-number="3.1">
<h3 data-number="3.1" class="anchored" data-anchor-id="구조화된-xml-기반-템플릿"><span class="header-section-number">3.1</span> 구조화된 XML 기반 템플릿</h3>
<div class="sourceCode" id="cb3"><pre class="sourceCode numberSource xml number-lines code-with-copy"><code class="sourceCode xml"><span id="cb3-1"><a href="#cb3-1"></a>You're an evaluator for the prompts and answers provided by a generative AI model. </span>
<span id="cb3-2"><a href="#cb3-2"></a></span>
<span id="cb3-3"><a href="#cb3-3"></a>Consider the input prompt in the &lt;<span class="kw">input</span>&gt; tags, </span>
<span id="cb3-4"><a href="#cb3-4"></a>the output answer in the &lt;<span class="kw">output</span>&gt; tags, </span>
<span id="cb3-5"><a href="#cb3-5"></a>the prompt evaluation criteria in the &lt;<span class="kw">prompt_criteria</span>&gt; tags, </span>
<span id="cb3-6"><a href="#cb3-6"></a>and the answer evaluation criteria in the &lt;<span class="kw">answer_criteria</span>&gt; tags.</span>
<span id="cb3-7"><a href="#cb3-7"></a></span>
<span id="cb3-8"><a href="#cb3-8"></a>&lt;<span class="kw">input</span>&gt;</span>
<span id="cb3-9"><a href="#cb3-9"></a>{{input}}</span>
<span id="cb3-10"><a href="#cb3-10"></a>&lt;/<span class="kw">input</span>&gt;</span>
<span id="cb3-11"><a href="#cb3-11"></a></span>
<span id="cb3-12"><a href="#cb3-12"></a>&lt;<span class="kw">output</span>&gt;</span>
<span id="cb3-13"><a href="#cb3-13"></a>{{output}}</span>
<span id="cb3-14"><a href="#cb3-14"></a>&lt;/<span class="kw">output</span>&gt;</span>
<span id="cb3-15"><a href="#cb3-15"></a></span>
<span id="cb3-16"><a href="#cb3-16"></a>&lt;<span class="kw">prompt_criteria</span>&gt;</span>
<span id="cb3-17"><a href="#cb3-17"></a>- The prompt should be clear, direct, and detailed.</span>
<span id="cb3-18"><a href="#cb3-18"></a>- The question, task, or goal should be well explained and be grammatically correct.</span>
<span id="cb3-19"><a href="#cb3-19"></a>- The prompt is better if containing examples.</span>
<span id="cb3-20"><a href="#cb3-20"></a>- The prompt is better if specifies a role or sets a context.</span>
<span id="cb3-21"><a href="#cb3-21"></a>- The prompt is better if provides details about the format and tone of the expected answer.</span>
<span id="cb3-22"><a href="#cb3-22"></a>&lt;/<span class="kw">prompt_criteria</span>&gt;</span>
<span id="cb3-23"><a href="#cb3-23"></a></span>
<span id="cb3-24"><a href="#cb3-24"></a>&lt;<span class="kw">answer_criteria</span>&gt;</span>
<span id="cb3-25"><a href="#cb3-25"></a>- The answers should be correct, well structured, and technically complete.</span>
<span id="cb3-26"><a href="#cb3-26"></a>- The answers should not have any hallucinations, made up content, or toxic content.</span>
<span id="cb3-27"><a href="#cb3-27"></a>- The answer should be grammatically correct.</span>
<span id="cb3-28"><a href="#cb3-28"></a>- The answer should be fully aligned with the question or instruction in the prompt.</span>
<span id="cb3-29"><a href="#cb3-29"></a>&lt;/<span class="kw">answer_criteria</span>&gt;</span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>이 템플릿은 여러 개선점을 포함한다.</p>
</section>
<section id="개선점-1-xml-태그로-구조화" class="level3" data-number="3.2">
<h3 data-number="3.2" class="anchored" data-anchor-id="개선점-1-xml-태그로-구조화"><span class="header-section-number">3.2</span> 개선점 1: XML 태그로 구조화</h3>
<p>왜 XML 태그를 사용할까? 여러 이점이 있다:</p>
<ol type="1">
<li><p><strong>명확한 경계</strong>: 어디까지가 입력이고, 어디까지가 출력인지 모호함이 없다. 특히 평가할 텍스트 자체에 따옴표나 특수 문자가 있을 때 유용하다.</p></li>
<li><p><strong>파싱 용이성</strong>: 프로그래밍적으로 각 섹션을 추출하기 쉽다. BeautifulSoup이나 xml.etree 같은 라이브러리로 간단히 파싱할 수 있다.</p></li>
<li><p><strong>확장 가능성</strong>: 새로운 정보를 추가하고 싶으면 새 태그를 추가하면 된다. 예를 들어 <code>&lt;context&gt;</code> 태그로 대화 이력을 추가하거나, <code>&lt;user_profile&gt;</code> 태그로 사용자 특성을 추가할 수 있다.</p></li>
<li><p><strong>LLM 친화성</strong>: 최신 LLM들은 XML 구조를 잘 이해한다. 학습 데이터에 많은 XML 문서가 포함되어 있기 때문이다.</p></li>
</ol>
</section>
<section id="개선점-2-프롬프트-자체도-평가" class="level3" data-number="3.3">
<h3 data-number="3.3" class="anchored" data-anchor-id="개선점-2-프롬프트-자체도-평가"><span class="header-section-number">3.3</span> 개선점 2: 프롬프트 자체도 평가</h3>
<p>흥미롭게도 이 템플릿은 <strong>답변뿐만 아니라 프롬프트도 평가</strong>한다. 이것은 매우 실용적인 접근이다.</p>
<p>나쁜 답변의 원인은 두 가지다:<br>
1. 모델의 능력 부족<br>
2. 프롬프트가 불명확하거나 불완전함</p>
<p>만약 프롬프트가 애매하다면, 모델이 좋은 답변을 내놓기 어렵다. 예를 들어:</p>
<p><strong>나쁜 프롬프트</strong>: “파이썬 코드 짜줘”<br>
→ 무엇을 하는 코드? 어떤 입출력? 어느 수준의 사용자?</p>
<p><strong>좋은 프롬프트</strong>: “파이썬 초보자를 위해, CSV 파일을 읽어서 평균값을 계산하는 코드를 작성해줘. 주석을 포함하고, pandas 라이브러리를 사용해.”<br>
→ 명확한 목표, 대상 사용자, 기술 스택, 출력 형식</p>
<p>프롬프트를 평가하면:<br>
- 프롬프트 작성자에게 피드백을 줄 수 있다<br>
- 프롬프트 자체를 개선하는 방향을 찾을 수 있다<br>
- 답변의 품질 문제가 프롬프트 때문인지 모델 때문인지 구분할 수 있다</p>
</section>
<section id="개선점-3-hallucination에-대한-명시적-경고" class="level3" data-number="3.4">
<h3 data-number="3.4" class="anchored" data-anchor-id="개선점-3-hallucination에-대한-명시적-경고"><span class="header-section-number">3.4</span> 개선점 3: Hallucination에 대한 명시적 경고</h3>
<p><strong>“The answers should not have any hallucinations, made up content”</strong></p>
<p>이것은 매우 중요한 기준이다. Hallucination(환각)은 생성형 AI의 가장 큰 위험 중 하나다. 모델이 그럴듯하게 들리지만 완전히 틀린 정보를 자신있게 말하는 현상.</p>
<p>예를 들어:<br>
- 존재하지 않는 책이나 논문을 인용<br>
- 잘못된 날짜나 통계를 제시<br>
- 실제로는 없는 API 함수를 제안</p>
<p>평가 기준에 이를 명시하면, 판사 모델이 사실 확인에 더 주의를 기울인다. 물론 판사 모델도 완벽하지 않지만, 명시적으로 경고하면 더 신중해진다.</p>
<p>실무 팁: Hallucination 평가를 강화하려면 외부 지식 소스를 활용할 수 있다. 예를 들어:<br>
- 검색 엔진으로 주요 사실을 확인<br>
- 지식 베이스(knowledge base)와 대조<br>
- 여러 모델의 답변을 교차 검증</p>
</section>
<section id="개선점-4-json-구조화된-출력-요구" class="level3" data-number="3.5">
<h3 data-number="3.5" class="anchored" data-anchor-id="개선점-4-json-구조화된-출력-요구"><span class="header-section-number">3.5</span> 개선점 4: JSON 구조화된 출력 요구</h3>
<div class="sourceCode" id="cb4"><pre class="sourceCode numberSource xml number-lines code-with-copy"><code class="sourceCode xml"><span id="cb4-1"><a href="#cb4-1"></a>Respond only with a JSON having:</span>
<span id="cb4-2"><a href="#cb4-2"></a>- An 'answer-score' key with the score number you evaluated the answer with.</span>
<span id="cb4-3"><a href="#cb4-3"></a>- A 'prompt-score' key with the score number you evaluated the prompt with.</span>
<span id="cb4-4"><a href="#cb4-4"></a>- A 'justification' key with a justification for the two evaluations you provided </span>
<span id="cb4-5"><a href="#cb4-5"></a>  to the answer and the prompt; make sure to explicitly include any errors or </span>
<span id="cb4-6"><a href="#cb4-6"></a>  hallucinations in this part.</span>
<span id="cb4-7"><a href="#cb4-7"></a>- An 'input' key with the content of the &lt;<span class="kw">input</span>&gt; tags.</span>
<span id="cb4-8"><a href="#cb4-8"></a>- An 'output' key with the content of the &lt;<span class="kw">output</span>&gt; tags.</span>
<span id="cb4-9"><a href="#cb4-9"></a>- A 'prompt-recommendations' key with recommendations for improving the prompt </span>
<span id="cb4-10"><a href="#cb4-10"></a>  based on the evaluations performed.</span>
<span id="cb4-11"><a href="#cb4-11"></a></span>
<span id="cb4-12"><a href="#cb4-12"></a>Skip any preamble or any other text apart from the JSON in your answer.</span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>이것은 매우 실용적인 설계다. JSON 출력을 요구하는 이유:</p>
<ol type="1">
<li><p><strong>자동화</strong>: 프로그래밍적으로 파싱하기 매우 쉽다. Python의 <code>json.loads()</code>로 한 줄이면 된다.</p></li>
<li><p><strong>구조 보장</strong>: 필요한 모든 필드가 있는지 자동으로 확인할 수 있다. 필드가 빠지면 즉시 감지된다.</p></li>
<li><p><strong>데이터베이스 저장</strong>: JSON은 대부분의 데이터베이스(MongoDB, PostgreSQL의 JSONB 등)에 직접 저장할 수 있다.</p></li>
<li><p><strong>대시보드 연동</strong>: JSON 데이터를 시각화 도구로 바로 보낼 수 있다. Grafana, Tableau 등이 JSON을 네이티브로 지원한다.</p></li>
</ol>
<p><strong>“Skip any preamble”의 중요성</strong>:</p>
<p>LLM은 종종 친절하게(?) 부연 설명을 추가한다:</p>
<pre><code>물론이죠! 평가 결과를 JSON 형식으로 제공하겠습니다:

{
  "answer-score": 8,
  ...
}

이상으로 평가를 마치겠습니다.</code></pre>
<p>이런 추가 텍스트는 JSON 파싱을 방해한다. “오직 JSON만”을 출력하라고 명시하면 이 문제를 줄일 수 있다. 물론 100% 보장되지는 않으므로, 코드에서 JSON 추출 로직을 견고하게 작성해야 한다:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1"></a><span class="im">import</span> re</span>
<span id="cb6-2"><a href="#cb6-2"></a><span class="im">import</span> json</span>
<span id="cb6-3"><a href="#cb6-3"></a></span>
<span id="cb6-4"><a href="#cb6-4"></a><span class="kw">def</span> extract_json(text):</span>
<span id="cb6-5"><a href="#cb6-5"></a>    <span class="co"># 중괄호로 시작하는 첫 번째 JSON 객체 찾기</span></span>
<span id="cb6-6"><a href="#cb6-6"></a>    match <span class="op">=</span> re.search(<span class="vs">r'\{.*\}'</span>, text, re.DOTALL)</span>
<span id="cb6-7"><a href="#cb6-7"></a>    <span class="cf">if</span> match:</span>
<span id="cb6-8"><a href="#cb6-8"></a>        <span class="cf">try</span>:</span>
<span id="cb6-9"><a href="#cb6-9"></a>            <span class="cf">return</span> json.loads(match.group(<span class="dv">0</span>))</span>
<span id="cb6-10"><a href="#cb6-10"></a>        <span class="cf">except</span> json.JSONDecodeError:</span>
<span id="cb6-11"><a href="#cb6-11"></a>            <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb6-12"><a href="#cb6-12"></a>    <span class="cf">return</span> <span class="va">None</span></span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="개선점-5-실행-가능한-권장사항-요구" class="level3" data-number="3.6">
<h3 data-number="3.6" class="anchored" data-anchor-id="개선점-5-실행-가능한-권장사항-요구"><span class="header-section-number">3.6</span> 개선점 5: 실행 가능한 권장사항 요구</h3>
<p><strong>“A ‘prompt-recommendations’ key with recommendations for improving the prompt”</strong></p>
<p>이것이 이 템플릿의 가장 강력한 부분이다. 단순히 점수를 매기는 것을 넘어, <strong>어떻게 개선할 것인지</strong>를 제안한다.</p>
<p>예를 들어:</p>
<p><strong>평가 결과</strong>:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode numberSource json number-lines code-with-copy"><code class="sourceCode json"><span id="cb7-1"><a href="#cb7-1"></a><span class="fu">{</span></span>
<span id="cb7-2"><a href="#cb7-2"></a>  <span class="dt">"prompt-score"</span><span class="fu">:</span> <span class="dv">65</span><span class="fu">,</span></span>
<span id="cb7-3"><a href="#cb7-3"></a>  <span class="dt">"answer-score"</span><span class="fu">:</span> <span class="dv">70</span><span class="fu">,</span></span>
<span id="cb7-4"><a href="#cb7-4"></a>  <span class="dt">"justification"</span><span class="fu">:</span> <span class="st">"프롬프트가 너무 모호하여 모델이 명확한 답변을 제공하기 어려웠음. </span></span>
<span id="cb7-5"><a href="#cb7-5"></a><span class="st">                   답변은 일부 유용한 정보를 포함하지만 불완전함."</span><span class="fu">,</span></span>
<span id="cb7-6"><a href="#cb7-6"></a>  <span class="dt">"prompt-recommendations"</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb7-7"><a href="#cb7-7"></a>    <span class="st">"대상 사용자의 기술 수준을 명시하세요 (예: 초보자, 중급자)"</span><span class="ot">,</span></span>
<span id="cb7-8"><a href="#cb7-8"></a>    <span class="st">"구체적인 사용 사례나 맥락을 제공하세요"</span><span class="ot">,</span></span>
<span id="cb7-9"><a href="#cb7-9"></a>    <span class="st">"원하는 출력 형식을 명확히 하세요 (예: 코드, 설명, 단계별 가이드)"</span></span>
<span id="cb7-10"><a href="#cb7-10"></a>  <span class="ot">]</span></span>
<span id="cb7-11"><a href="#cb7-11"></a><span class="fu">}</span></span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>이런 권장사항은 프롬프트 엔지니어에게 즉시 실행 가능한 개선 방향을 제공한다. “점수가 낮다”는 것만 아는 것과, “이렇게 고치면 된다”를 아는 것은 큰 차이다.</p>
</section>
</section>
<section id="huggingface의-실용적-간소화-버전" class="level2" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="huggingface의-실용적-간소화-버전"><span class="header-section-number">4</span> HuggingFace의 실용적 간소화 버전</h2>
<p>때로는 복잡한 것보다 단순한 것이 더 효과적이다. HuggingFace 커뮤니티에서 인기 있는 간소화된 템플릿을 보자 (슬라이드 15).</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1"></a>JUDGE_PROMPT <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb8-2"><a href="#cb8-2"></a><span class="st">You will be given a user_question and system_answer couple. </span></span>
<span id="cb8-3"><a href="#cb8-3"></a><span class="st">Your task is to provide a 'total rating' scoring how well the system_answer </span></span>
<span id="cb8-4"><a href="#cb8-4"></a><span class="st">answers the user concerns expressed in the user_question.</span></span>
<span id="cb8-5"><a href="#cb8-5"></a></span>
<span id="cb8-6"><a href="#cb8-6"></a><span class="st">Give your answer as a float on a scale of 0 to 10, where 0 means that the </span></span>
<span id="cb8-7"><a href="#cb8-7"></a><span class="st">system_answer is not helpful at all, and 10 means that the answer completely </span></span>
<span id="cb8-8"><a href="#cb8-8"></a><span class="st">and helpfully addresses the question.</span></span>
<span id="cb8-9"><a href="#cb8-9"></a></span>
<span id="cb8-10"><a href="#cb8-10"></a><span class="st">Provide your feedback as follows:</span></span>
<span id="cb8-11"><a href="#cb8-11"></a></span>
<span id="cb8-12"><a href="#cb8-12"></a><span class="st">Feedback::: </span></span>
<span id="cb8-13"><a href="#cb8-13"></a><span class="st">Total rating: (your rating, as a float between 0 and 10)</span></span>
<span id="cb8-14"><a href="#cb8-14"></a></span>
<span id="cb8-15"><a href="#cb8-15"></a><span class="st">Now here are the question and answer.</span></span>
<span id="cb8-16"><a href="#cb8-16"></a></span>
<span id="cb8-17"><a href="#cb8-17"></a><span class="st">Question: </span><span class="sc">{question}</span></span>
<span id="cb8-18"><a href="#cb8-18"></a><span class="st">Answer: </span><span class="sc">{answer}</span></span>
<span id="cb8-19"><a href="#cb8-19"></a></span>
<span id="cb8-20"><a href="#cb8-20"></a><span class="st">Feedback:::</span></span>
<span id="cb8-21"><a href="#cb8-21"></a><span class="st">Total rating:</span></span>
<span id="cb8-22"><a href="#cb8-22"></a><span class="st">"""</span></span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
<section id="단순함의-장점" class="level3" data-number="4.1">
<h3 data-number="4.1" class="anchored" data-anchor-id="단순함의-장점"><span class="header-section-number">4.1</span> 단순함의 장점</h3>
<p>이 템플릿은 Azure 버전보다 훨씬 짧고 간단하다. 장점:</p>
<ol type="1">
<li><strong>빠른 실행</strong>: 토큰 수가 적어서 API 호출이 더 빠르고 저렴하다<br>
</li>
<li><strong>이해 용이성</strong>: 팀원 누구나 쉽게 이해하고 수정할 수 있다<br>
</li>
<li><strong>적용 장벽 낮음</strong>: 복잡한 설정 없이 바로 사용할 수 있다</li>
</ol>
</section>
<section id="언제-단순한-버전을-쓸까" class="level3" data-number="4.2">
<h3 data-number="4.2" class="anchored" data-anchor-id="언제-단순한-버전을-쓸까"><span class="header-section-number">4.2</span> 언제 단순한 버전을 쓸까?</h3>
<p><strong>단순 버전이 적합한 경우</strong>:<br>
- 빠른 프로토타이핑 단계<br>
- 큰 규모의 평가 (수만 건 이상, 비용이 중요)<br>
- 일반적인 품질 체크 (세부 진단보다는 전반적 수준 파악)<br>
- 실시간 평가가 필요한 경우</p>
<p><strong>복잡한 버전이 필요한 경우</strong>:<br>
- 상세한 진단이 필요할 때<br>
- 프롬프트 개선 방향을 찾을 때<br>
- 다차원 평가가 필요할 때<br>
- 감사(audit) 목적으로 평가 근거를 남겨야 할 때</p>
</section>
<section id="점수-체계의-의미" class="level3" data-number="4.3">
<h3 data-number="4.3" class="anchored" data-anchor-id="점수-체계의-의미"><span class="header-section-number">4.3</span> 0-10 점수 체계의 의미</h3>
<p>왜 1-10이 아니라 0-10일까? 그리고 왜 float(소수점)을 허용할까?</p>
<p><strong>0을 포함하는 이유</strong>:<br>
완전히 쓸모없는 답변을 표현하기 위해. 예를 들어, 질문과 완전히 무관한 답변, 또는 유해한 내용. 1점은 “매우 나쁘지만 뭔가 시도는 했다”를 의미하고, 0점은 “아예 실패”를 의미한다.</p>
<p><strong>소수점을 허용하는 이유</strong>:<br>
미묘한 차이를 표현하기 위해. 7점과 8점 사이의 답변이 많다. 7.5점으로 표현할 수 있으면 더 세밀한 비교가 가능하다.</p>
<p>하지만 실무에서는 논쟁의 여지가 있다:<br>
- <strong>찬성</strong>: 더 정밀한 평가 가능<br>
- <strong>반대</strong>: 가짜 정밀도(false precision). 7.3과 7.5의 차이가 실제로 의미 있는가?</p>
<p>경험적으로, 대규모 평가에서는 소수점을 사용하고 나중에 반올림하는 것이 좋다. 개별 평가의 소수점은 의미 없지만, 수백 개의 평균을 내면 의미있는 차이가 나타난다.</p>
</section>
</section>
<section id="평가-템플릿-설계의-핵심-원칙" class="level2" data-number="5">
<h2 data-number="5" class="anchored" data-anchor-id="평가-템플릿-설계의-핵심-원칙"><span class="header-section-number">5</span> 평가 템플릿 설계의 핵심 원칙</h2>
<p>지금까지 세 가지 템플릿을 살펴봤다. 이제 좋은 평가 템플릿을 설계하는 일반 원칙을 정리해보자.</p>
<section id="원칙-1-명확한-역할과-목표" class="level3" data-number="5.1">
<h3 data-number="5.1" class="anchored" data-anchor-id="원칙-1-명확한-역할과-목표"><span class="header-section-number">5.1</span> 원칙 1: 명확한 역할과 목표</h3>
<p>항상 판사의 역할을 명확히 하라. 그리고 평가의 목표가 무엇인지 명시하라.</p>
<p><strong>나쁜 예</strong>:<br>
“이 답변을 평가하세요”</p>
<p><strong>좋은 예</strong>:<br>
“당신은 기술 문서의 품질을 평가하는 시니어 테크니컬 라이터입니다. 이 답변이 초보 개발자에게 얼마나 유용한지 평가하세요.”</p>
</section>
<section id="원칙-2-구체적이고-측정-가능한-기준" class="level3" data-number="5.2">
<h3 data-number="5.2" class="anchored" data-anchor-id="원칙-2-구체적이고-측정-가능한-기준"><span class="header-section-number">5.2</span> 원칙 2: 구체적이고 측정 가능한 기준</h3>
<p>추상적인 기준은 피하라. 측정 가능한 기준을 제시하라.</p>
<p><strong>나쁜 예</strong>:<br>
“답변이 좋은지 평가하세요”</p>
<p><strong>좋은 예</strong>:<br>
“다음 기준으로 평가하세요:<br>
- 정확성: 사실적 오류가 있는가?<br>
- 완성도: 질문의 모든 부분에 답했는가?<br>
- 명확성: 전문 용어를 적절히 설명했는가?”</p>
</section>
<section id="원칙-3-사고-과정-유도" class="level3" data-number="5.3">
<h3 data-number="5.3" class="anchored" data-anchor-id="원칙-3-사고-과정-유도"><span class="header-section-number">5.3</span> 원칙 3: 사고 과정 유도</h3>
<p>항상 추론 과정을 먼저 요구하라. 점수만 달라고 하지 말라.</p>
<pre><code>먼저 각 기준에 대해 평가하고 그 이유를 설명하세요.
그런 다음 전체 점수를 제시하세요.</code></pre>
</section>
<section id="원칙-4-엄격한-출력-형식" class="level3" data-number="5.4">
<h3 data-number="5.4" class="anchored" data-anchor-id="원칙-4-엄격한-출력-형식"><span class="header-section-number">5.4</span> 원칙 4: 엄격한 출력 형식</h3>
<p>자동화를 위해 출력 형식을 엄격하게 지정하라. 예시를 제공하라.</p>
<pre><code>다음 형식을 정확히 따르세요:

Accuracy: 8/10
Clarity: 7/10
Overall: 7.5/10

형식을 변경하지 마세요.</code></pre>
</section>
<section id="원칙-5-편향-완화-기법-포함" class="level3" data-number="5.5">
<h3 data-number="5.5" class="anchored" data-anchor-id="원칙-5-편향-완화-기법-포함"><span class="header-section-number">5.5</span> 원칙 5: 편향 완화 기법 포함</h3>
<p>알려진 편향을 완화하는 지시를 포함하라.</p>
<pre><code>- 답변의 길이가 품질을 보장하지 않습니다. 짧아도 완벽할 수 있습니다.
- 첫 번째 답변과 두 번째 답변을 공정하게 대하세요. 순서가 판단에 영향을 주어서는 안 됩니다.
- 기술 용어가 많다고 해서 더 정확한 것은 아닙니다.</code></pre>
</section>
<section id="원칙-6-맥락-정보-제공" class="level3" data-number="5.6">
<h3 data-number="5.6" class="anchored" data-anchor-id="원칙-6-맥락-정보-제공"><span class="header-section-number">5.6</span> 원칙 6: 맥락 정보 제공</h3>
<p>필요한 맥락을 충분히 제공하라.</p>
<pre><code>&lt;context&gt;
사용자 수준: 프로그래밍 초보자 (6개월 경험)
사용 목적: 개인 프로젝트를 위한 학습
환경: Python 3.9, 기본 라이브러리만 사용 가능
&lt;/context&gt;</code></pre>
</section>
</section>
<section id="실무-적용-평가-파이프라인-구축" class="level2" data-number="6">
<h2 data-number="6" class="anchored" data-anchor-id="실무-적용-평가-파이프라인-구축"><span class="header-section-number">6</span> 실무 적용: 평가 파이프라인 구축</h2>
<p>템플릿을 만들었다면, 이제 실제로 어떻게 사용하는지 보자.</p>
<section id="기본-파이프라인" class="level3" data-number="6.1">
<h3 data-number="6.1" class="anchored" data-anchor-id="기본-파이프라인"><span class="header-section-number">6.1</span> 기본 파이프라인</h3>
<div class="sourceCode" id="cb13"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1"></a><span class="im">import</span> openai</span>
<span id="cb13-2"><a href="#cb13-2"></a><span class="im">import</span> json</span>
<span id="cb13-3"><a href="#cb13-3"></a></span>
<span id="cb13-4"><a href="#cb13-4"></a><span class="kw">def</span> evaluate_response(question, answer, judge_model<span class="op">=</span><span class="st">"gpt-4"</span>):</span>
<span id="cb13-5"><a href="#cb13-5"></a>    <span class="co">"""</span></span>
<span id="cb13-6"><a href="#cb13-6"></a><span class="co">    LLM-as-a-Judge를 사용하여 답변을 평가한다.</span></span>
<span id="cb13-7"><a href="#cb13-7"></a><span class="co">    """</span></span>
<span id="cb13-8"><a href="#cb13-8"></a>    eval_prompt <span class="op">=</span> <span class="ss">f"""</span></span>
<span id="cb13-9"><a href="#cb13-9"></a><span class="ss">    당신은 공정한 AI 응답 평가자입니다.</span></span>
<span id="cb13-10"><a href="#cb13-10"></a><span class="ss">    </span></span>
<span id="cb13-11"><a href="#cb13-11"></a><span class="ss">    질문: </span><span class="sc">{</span>question<span class="sc">}</span></span>
<span id="cb13-12"><a href="#cb13-12"></a><span class="ss">    답변: </span><span class="sc">{</span>answer<span class="sc">}</span></span>
<span id="cb13-13"><a href="#cb13-13"></a><span class="ss">    </span></span>
<span id="cb13-14"><a href="#cb13-14"></a><span class="ss">    다음 기준으로 평가하세요:</span></span>
<span id="cb13-15"><a href="#cb13-15"></a><span class="ss">    1. 정확성 (0-10)</span></span>
<span id="cb13-16"><a href="#cb13-16"></a><span class="ss">    2. 명확성 (0-10)</span></span>
<span id="cb13-17"><a href="#cb13-17"></a><span class="ss">    3. 유용성 (0-10)</span></span>
<span id="cb13-18"><a href="#cb13-18"></a><span class="ss">    </span></span>
<span id="cb13-19"><a href="#cb13-19"></a><span class="ss">    JSON 형식으로 응답하세요:</span></span>
<span id="cb13-20"><a href="#cb13-20"></a><span class="ss">    </span><span class="ch">{{</span></span>
<span id="cb13-21"><a href="#cb13-21"></a><span class="ss">      "accuracy": &lt;점수&gt;,</span></span>
<span id="cb13-22"><a href="#cb13-22"></a><span class="ss">      "clarity": &lt;점수&gt;,</span></span>
<span id="cb13-23"><a href="#cb13-23"></a><span class="ss">      "helpfulness": &lt;점수&gt;,</span></span>
<span id="cb13-24"><a href="#cb13-24"></a><span class="ss">      "justification": "&lt;이유&gt;"</span></span>
<span id="cb13-25"><a href="#cb13-25"></a><span class="ss">    </span><span class="ch">}}</span></span>
<span id="cb13-26"><a href="#cb13-26"></a><span class="ss">    """</span></span>
<span id="cb13-27"><a href="#cb13-27"></a>    </span>
<span id="cb13-28"><a href="#cb13-28"></a>    response <span class="op">=</span> openai.ChatCompletion.create(</span>
<span id="cb13-29"><a href="#cb13-29"></a>        model<span class="op">=</span>judge_model,</span>
<span id="cb13-30"><a href="#cb13-30"></a>        messages<span class="op">=</span>[{<span class="st">"role"</span>: <span class="st">"user"</span>, <span class="st">"content"</span>: eval_prompt}],</span>
<span id="cb13-31"><a href="#cb13-31"></a>        temperature<span class="op">=</span><span class="dv">0</span>  <span class="co"># 일관성을 위해 0으로 설정</span></span>
<span id="cb13-32"><a href="#cb13-32"></a>    )</span>
<span id="cb13-33"><a href="#cb13-33"></a>    </span>
<span id="cb13-34"><a href="#cb13-34"></a>    <span class="co"># JSON 추출</span></span>
<span id="cb13-35"><a href="#cb13-35"></a>    result <span class="op">=</span> extract_json(response.choices[<span class="dv">0</span>].message.content)</span>
<span id="cb13-36"><a href="#cb13-36"></a>    <span class="cf">return</span> result</span>
<span id="cb13-37"><a href="#cb13-37"></a></span>
<span id="cb13-38"><a href="#cb13-38"></a><span class="kw">def</span> extract_json(text):</span>
<span id="cb13-39"><a href="#cb13-39"></a>    <span class="co">"""텍스트에서 JSON 추출"""</span></span>
<span id="cb13-40"><a href="#cb13-40"></a>    <span class="im">import</span> re</span>
<span id="cb13-41"><a href="#cb13-41"></a>    match <span class="op">=</span> re.search(<span class="vs">r'\{.*\}'</span>, text, re.DOTALL)</span>
<span id="cb13-42"><a href="#cb13-42"></a>    <span class="cf">if</span> match:</span>
<span id="cb13-43"><a href="#cb13-43"></a>        <span class="cf">return</span> json.loads(match.group(<span class="dv">0</span>))</span>
<span id="cb13-44"><a href="#cb13-44"></a>    <span class="cf">return</span> <span class="va">None</span></span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="배치-평가" class="level3" data-number="6.2">
<h3 data-number="6.2" class="anchored" data-anchor-id="배치-평가"><span class="header-section-number">6.2</span> 배치 평가</h3>
<p>실무에서는 수십, 수백 개의 응답을 한 번에 평가해야 한다.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb14-2"><a href="#cb14-2"></a><span class="im">from</span> tqdm <span class="im">import</span> tqdm</span>
<span id="cb14-3"><a href="#cb14-3"></a></span>
<span id="cb14-4"><a href="#cb14-4"></a><span class="kw">def</span> batch_evaluate(test_cases, judge_model<span class="op">=</span><span class="st">"gpt-4"</span>):</span>
<span id="cb14-5"><a href="#cb14-5"></a>    <span class="co">"""</span></span>
<span id="cb14-6"><a href="#cb14-6"></a><span class="co">    여러 테스트 케이스를 배치로 평가한다.</span></span>
<span id="cb14-7"><a href="#cb14-7"></a><span class="co">    </span></span>
<span id="cb14-8"><a href="#cb14-8"></a><span class="co">    test_cases: [{"question": ..., "answer": ...}, ...]</span></span>
<span id="cb14-9"><a href="#cb14-9"></a><span class="co">    """</span></span>
<span id="cb14-10"><a href="#cb14-10"></a>    results <span class="op">=</span> []</span>
<span id="cb14-11"><a href="#cb14-11"></a>    </span>
<span id="cb14-12"><a href="#cb14-12"></a>    <span class="cf">for</span> case <span class="kw">in</span> tqdm(test_cases):</span>
<span id="cb14-13"><a href="#cb14-13"></a>        <span class="cf">try</span>:</span>
<span id="cb14-14"><a href="#cb14-14"></a>            eval_result <span class="op">=</span> evaluate_response(</span>
<span id="cb14-15"><a href="#cb14-15"></a>                case[<span class="st">"question"</span>], </span>
<span id="cb14-16"><a href="#cb14-16"></a>                case[<span class="st">"answer"</span>],</span>
<span id="cb14-17"><a href="#cb14-17"></a>                judge_model</span>
<span id="cb14-18"><a href="#cb14-18"></a>            )</span>
<span id="cb14-19"><a href="#cb14-19"></a>            results.append({</span>
<span id="cb14-20"><a href="#cb14-20"></a>                <span class="op">**</span>case,</span>
<span id="cb14-21"><a href="#cb14-21"></a>                <span class="op">**</span>eval_result</span>
<span id="cb14-22"><a href="#cb14-22"></a>            })</span>
<span id="cb14-23"><a href="#cb14-23"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb14-24"><a href="#cb14-24"></a>            <span class="bu">print</span>(<span class="ss">f"Error evaluating case: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb14-25"><a href="#cb14-25"></a>            results.append({</span>
<span id="cb14-26"><a href="#cb14-26"></a>                <span class="op">**</span>case,</span>
<span id="cb14-27"><a href="#cb14-27"></a>                <span class="st">"error"</span>: <span class="bu">str</span>(e)</span>
<span id="cb14-28"><a href="#cb14-28"></a>            })</span>
<span id="cb14-29"><a href="#cb14-29"></a>    </span>
<span id="cb14-30"><a href="#cb14-30"></a>    <span class="cf">return</span> pd.DataFrame(results)</span>
<span id="cb14-31"><a href="#cb14-31"></a></span>
<span id="cb14-32"><a href="#cb14-32"></a><span class="co"># 사용 예시</span></span>
<span id="cb14-33"><a href="#cb14-33"></a>test_cases <span class="op">=</span> [</span>
<span id="cb14-34"><a href="#cb14-34"></a>    {</span>
<span id="cb14-35"><a href="#cb14-35"></a>        <span class="st">"question"</span>: <span class="st">"파이썬에서 리스트를 정렬하는 방법은?"</span>,</span>
<span id="cb14-36"><a href="#cb14-36"></a>        <span class="st">"answer"</span>: <span class="st">"sorted() 함수를 사용하면 됩니다..."</span></span>
<span id="cb14-37"><a href="#cb14-37"></a>    },</span>
<span id="cb14-38"><a href="#cb14-38"></a>    <span class="co"># ... 더 많은 케이스</span></span>
<span id="cb14-39"><a href="#cb14-39"></a>]</span>
<span id="cb14-40"><a href="#cb14-40"></a></span>
<span id="cb14-41"><a href="#cb14-41"></a>results_df <span class="op">=</span> batch_evaluate(test_cases)</span>
<span id="cb14-42"><a href="#cb14-42"></a></span>
<span id="cb14-43"><a href="#cb14-43"></a><span class="co"># 결과 분석</span></span>
<span id="cb14-44"><a href="#cb14-44"></a><span class="bu">print</span>(results_df[[<span class="st">'accuracy'</span>, <span class="st">'clarity'</span>, <span class="st">'helpfulness'</span>]].describe())</span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="위치-편향-완화-순서-무작위화" class="level3" data-number="6.3">
<h3 data-number="6.3" class="anchored" data-anchor-id="위치-편향-완화-순서-무작위화"><span class="header-section-number">6.3</span> 위치 편향 완화: 순서 무작위화</h3>
<p>위에서 언급했듯이, LLM 판사는 위치 편향을 보일 수 있다. 이를 완화하는 방법:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1"></a><span class="im">import</span> random</span>
<span id="cb15-2"><a href="#cb15-2"></a></span>
<span id="cb15-3"><a href="#cb15-3"></a><span class="kw">def</span> evaluate_with_position_debiasing(question, answer_a, answer_b):</span>
<span id="cb15-4"><a href="#cb15-4"></a>    <span class="co">"""</span></span>
<span id="cb15-5"><a href="#cb15-5"></a><span class="co">    두 답변을 비교하되, 순서를 바꿔가며 여러 번 평가한다.</span></span>
<span id="cb15-6"><a href="#cb15-6"></a><span class="co">    """</span></span>
<span id="cb15-7"><a href="#cb15-7"></a>    results <span class="op">=</span> []</span>
<span id="cb15-8"><a href="#cb15-8"></a>    </span>
<span id="cb15-9"><a href="#cb15-9"></a>    <span class="co"># 순서를 바꿔가며 3번 평가</span></span>
<span id="cb15-10"><a href="#cb15-10"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">3</span>):</span>
<span id="cb15-11"><a href="#cb15-11"></a>        <span class="co"># 랜덤하게 순서 결정</span></span>
<span id="cb15-12"><a href="#cb15-12"></a>        <span class="cf">if</span> random.random() <span class="op">&lt;</span> <span class="fl">0.5</span>:</span>
<span id="cb15-13"><a href="#cb15-13"></a>            first, second <span class="op">=</span> answer_a, answer_b</span>
<span id="cb15-14"><a href="#cb15-14"></a>            is_swapped <span class="op">=</span> <span class="va">False</span></span>
<span id="cb15-15"><a href="#cb15-15"></a>        <span class="cf">else</span>:</span>
<span id="cb15-16"><a href="#cb15-16"></a>            first, second <span class="op">=</span> answer_b, answer_a</span>
<span id="cb15-17"><a href="#cb15-17"></a>            is_swapped <span class="op">=</span> <span class="va">True</span></span>
<span id="cb15-18"><a href="#cb15-18"></a>        </span>
<span id="cb15-19"><a href="#cb15-19"></a>        eval_result <span class="op">=</span> compare_answers(question, first, second)</span>
<span id="cb15-20"><a href="#cb15-20"></a>        </span>
<span id="cb15-21"><a href="#cb15-21"></a>        <span class="co"># 순서를 바꿨다면 결과도 뒤집기</span></span>
<span id="cb15-22"><a href="#cb15-22"></a>        <span class="cf">if</span> is_swapped:</span>
<span id="cb15-23"><a href="#cb15-23"></a>            <span class="cf">if</span> eval_result[<span class="st">"winner"</span>] <span class="op">==</span> <span class="st">"A"</span>:</span>
<span id="cb15-24"><a href="#cb15-24"></a>                eval_result[<span class="st">"winner"</span>] <span class="op">=</span> <span class="st">"B"</span></span>
<span id="cb15-25"><a href="#cb15-25"></a>            <span class="cf">elif</span> eval_result[<span class="st">"winner"</span>] <span class="op">==</span> <span class="st">"B"</span>:</span>
<span id="cb15-26"><a href="#cb15-26"></a>                eval_result[<span class="st">"winner"</span>] <span class="op">=</span> <span class="st">"A"</span></span>
<span id="cb15-27"><a href="#cb15-27"></a>        </span>
<span id="cb15-28"><a href="#cb15-28"></a>        results.append(eval_result)</span>
<span id="cb15-29"><a href="#cb15-29"></a>    </span>
<span id="cb15-30"><a href="#cb15-30"></a>    <span class="co"># 다수결로 최종 결정</span></span>
<span id="cb15-31"><a href="#cb15-31"></a>    winners <span class="op">=</span> [r[<span class="st">"winner"</span>] <span class="cf">for</span> r <span class="kw">in</span> results]</span>
<span id="cb15-32"><a href="#cb15-32"></a>    final_winner <span class="op">=</span> <span class="bu">max</span>(<span class="bu">set</span>(winners), key<span class="op">=</span>winners.count)</span>
<span id="cb15-33"><a href="#cb15-33"></a>    </span>
<span id="cb15-34"><a href="#cb15-34"></a>    <span class="cf">return</span> {</span>
<span id="cb15-35"><a href="#cb15-35"></a>        <span class="st">"winner"</span>: final_winner,</span>
<span id="cb15-36"><a href="#cb15-36"></a>        <span class="st">"confidence"</span>: winners.count(final_winner) <span class="op">/</span> <span class="bu">len</span>(winners),</span>
<span id="cb15-37"><a href="#cb15-37"></a>        <span class="st">"individual_results"</span>: results</span>
<span id="cb15-38"><a href="#cb15-38"></a>    }</span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="다중-판사-활용-앙상블-평가" class="level3" data-number="6.4">
<h3 data-number="6.4" class="anchored" data-anchor-id="다중-판사-활용-앙상블-평가"><span class="header-section-number">6.4</span> 다중 판사 활용: 앙상블 평가</h3>
<p>하나의 판사 모델에만 의존하지 말고, 여러 모델의 평가를 종합할 수 있다.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1"></a><span class="kw">def</span> ensemble_evaluate(question, answer, judges<span class="op">=</span>[<span class="st">"gpt-4"</span>, <span class="st">"claude-3-opus"</span>, <span class="st">"gemini-pro"</span>]):</span>
<span id="cb16-2"><a href="#cb16-2"></a>    <span class="co">"""</span></span>
<span id="cb16-3"><a href="#cb16-3"></a><span class="co">    여러 판사 모델의 평가를 종합한다.</span></span>
<span id="cb16-4"><a href="#cb16-4"></a><span class="co">    """</span></span>
<span id="cb16-5"><a href="#cb16-5"></a>    evaluations <span class="op">=</span> []</span>
<span id="cb16-6"><a href="#cb16-6"></a>    </span>
<span id="cb16-7"><a href="#cb16-7"></a>    <span class="cf">for</span> judge <span class="kw">in</span> judges:</span>
<span id="cb16-8"><a href="#cb16-8"></a>        <span class="cf">try</span>:</span>
<span id="cb16-9"><a href="#cb16-9"></a>            result <span class="op">=</span> evaluate_response(question, answer, judge_model<span class="op">=</span>judge)</span>
<span id="cb16-10"><a href="#cb16-10"></a>            result[<span class="st">"judge"</span>] <span class="op">=</span> judge</span>
<span id="cb16-11"><a href="#cb16-11"></a>            evaluations.append(result)</span>
<span id="cb16-12"><a href="#cb16-12"></a>        <span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> e:</span>
<span id="cb16-13"><a href="#cb16-13"></a>            <span class="bu">print</span>(<span class="ss">f"Error with </span><span class="sc">{</span>judge<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb16-14"><a href="#cb16-14"></a>    </span>
<span id="cb16-15"><a href="#cb16-15"></a>    <span class="co"># 평균 점수 계산</span></span>
<span id="cb16-16"><a href="#cb16-16"></a>    avg_scores <span class="op">=</span> {</span>
<span id="cb16-17"><a href="#cb16-17"></a>        <span class="st">"accuracy"</span>: <span class="bu">sum</span>(e[<span class="st">"accuracy"</span>] <span class="cf">for</span> e <span class="kw">in</span> evaluations) <span class="op">/</span> <span class="bu">len</span>(evaluations),</span>
<span id="cb16-18"><a href="#cb16-18"></a>        <span class="st">"clarity"</span>: <span class="bu">sum</span>(e[<span class="st">"clarity"</span>] <span class="cf">for</span> e <span class="kw">in</span> evaluations) <span class="op">/</span> <span class="bu">len</span>(evaluations),</span>
<span id="cb16-19"><a href="#cb16-19"></a>        <span class="st">"helpfulness"</span>: <span class="bu">sum</span>(e[<span class="st">"helpfulness"</span>] <span class="cf">for</span> e <span class="kw">in</span> evaluations) <span class="op">/</span> <span class="bu">len</span>(evaluations),</span>
<span id="cb16-20"><a href="#cb16-20"></a>    }</span>
<span id="cb16-21"><a href="#cb16-21"></a>    </span>
<span id="cb16-22"><a href="#cb16-22"></a>    <span class="co"># 판사들 간 일치도 (표준편차)</span></span>
<span id="cb16-23"><a href="#cb16-23"></a>    <span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb16-24"><a href="#cb16-24"></a>    agreement <span class="op">=</span> {</span>
<span id="cb16-25"><a href="#cb16-25"></a>        <span class="st">"accuracy_std"</span>: np.std([e[<span class="st">"accuracy"</span>] <span class="cf">for</span> e <span class="kw">in</span> evaluations]),</span>
<span id="cb16-26"><a href="#cb16-26"></a>        <span class="st">"clarity_std"</span>: np.std([e[<span class="st">"clarity"</span>] <span class="cf">for</span> e <span class="kw">in</span> evaluations]),</span>
<span id="cb16-27"><a href="#cb16-27"></a>        <span class="st">"helpfulness_std"</span>: np.std([e[<span class="st">"helpfulness"</span>] <span class="cf">for</span> e <span class="kw">in</span> evaluations]),</span>
<span id="cb16-28"><a href="#cb16-28"></a>    }</span>
<span id="cb16-29"><a href="#cb16-29"></a>    </span>
<span id="cb16-30"><a href="#cb16-30"></a>    <span class="cf">return</span> {</span>
<span id="cb16-31"><a href="#cb16-31"></a>        <span class="st">"average_scores"</span>: avg_scores,</span>
<span id="cb16-32"><a href="#cb16-32"></a>        <span class="st">"agreement"</span>: agreement,</span>
<span id="cb16-33"><a href="#cb16-33"></a>        <span class="st">"individual_evaluations"</span>: evaluations</span>
<span id="cb16-34"><a href="#cb16-34"></a>    }</span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>표준편차가 낮다면 (예: &lt; 1.0), 판사들이 대체로 동의한다는 의미다. 높다면 (예: &gt; 2.0), 답변이 평가하기 애매하거나 판사들 간 관점 차이가 크다는 신호다.</p>
</section>
</section>
<section id="해결되지-않은-과제들" class="level2" data-number="7">
<h2 data-number="7" class="anchored" data-anchor-id="해결되지-않은-과제들"><span class="header-section-number">7</span> 해결되지 않은 과제들</h2>
<p>PDF 슬라이드 16에서 연구팀이 명시한 “Unanswered Questions”를 다시 보자. 이것들은 여전히 활발한 연구 주제다.</p>
<section id="과제-1-alignment-with-human-grading" class="level3" data-number="7.1">
<h3 data-number="7.1" class="anchored" data-anchor-id="과제-1-alignment-with-human-grading"><span class="header-section-number">7.1</span> 과제 1: Alignment with Human Grading</h3>
<p><strong>문제</strong>: 특정 도메인(예: 문서 Q&amp;A 챗봇)에서 LLM 판사와 인간 평가자의 일치도가 충분한가?</p>
<p>일반적인 태스크에서는 80% 이상의 일치도가 보고되지만, 매우 전문적인 영역에서는?<br>
- 의료 진단 보조<br>
- 법률 문서 해석<br>
- 고급 수학 증명</p>
<p>이런 영역에서는 LLM 판사가 평가할 능력이 있는지 의문이다. 판사 자신이 해당 영역을 제대로 이해하지 못하면, 평가도 신뢰할 수 없다.</p>
<p><strong>현재 접근법</strong>:<br>
- 도메인 전문가의 평가 샘플을 수집하여 LLM 판사 결과와 비교<br>
- 일치도가 낮으면 (&lt; 70%), 평가 기준을 더 구체화하거나 판사 프롬프트에 도메인 지식 추가<br>
- 극단적인 경우, LLM 판사를 보조 도구로만 사용하고 최종 결정은 인간이</p>
</section>
<section id="과제-2-accuracy-through-examples" class="level3" data-number="7.2">
<h3 data-number="7.2" class="anchored" data-anchor-id="과제-2-accuracy-through-examples"><span class="header-section-number">7.2</span> 과제 2: Accuracy Through Examples</h3>
<p><strong>문제</strong>: 평가 프롬프트에 예시를 포함하면 정확도가 향상되는가?</p>
<p>Few-shot 프롬프팅이 생성 태스크에서 효과적이듯, 평가에서도 효과적일까?</p>
<pre><code>다음은 좋은 평가의 예시입니다:

질문: "파이썬에서 파일을 읽는 방법은?"
답변: "open() 함수를 사용하세요"
평가: 3/10 - 정확하지만 너무 간략함. 예시 코드와 오류 처리가 필요함.

이제 다음을 평가하세요:
...</code></pre>
<p><strong>현재 증거</strong>:<br>
- 혼재된 결과. 일부 연구에서는 개선을, 일부는 효과 없음을 보고<br>
- 예시가 “anchor”로 작용하여 오히려 편향을 일으킬 수 있음<br>
- 예시 선택이 중요: 대표성 있고 다양한 예시를 선별해야 함</p>
</section>
<section id="과제-3-appropriate-grade-scales" class="level3" data-number="7.3">
<h3 data-number="7.3" class="anchored" data-anchor-id="과제-3-appropriate-grade-scales"><span class="header-section-number">7.3</span> 과제 3: Appropriate Grade Scales</h3>
<p><strong>문제</strong>: 0-100 척도 vs 0-1 이진 척도 vs 1-10 척도. 어느 것이 가장 적합한가?</p>
<p><strong>Azure 프레임워크</strong>: 0-100 척도 사용<br>
- 장점: 세밀한 구분 가능<br>
- 단점: 가짜 정밀도. 73점과 76점이 실제로 의미 있게 다른가?</p>
<p><strong>LangChain</strong>: 이진 척도 (0 = 나쁨, 1 = 좋음)<br>
- 장점: 명확한 결정. 애매함 없음<br>
- 단점: 미묘한 차이를 포착 못함</p>
<p><strong>LMSYS</strong>: 1-10 척도<br>
- 장점: 익숙함 (학교 성적과 유사). 적당한 세분성<br>
- 단점: 중간 지점 편향 (대부분 5-7점에 몰림)</p>
<p><strong>실무 권장사항</strong>:<br>
사용 사례에 따라 선택하되, 일관성을 유지하라. 한 프로젝트 내에서 척도를 자주 바꾸면 혼란스럽다.</p>
</section>
<section id="과제-4-applicability-across-use-cases" class="level3" data-number="7.4">
<h3 data-number="7.4" class="anchored" data-anchor-id="과제-4-applicability-across-use-cases"><span class="header-section-number">7.4</span> 과제 4: Applicability Across Use Cases</h3>
<p><strong>문제</strong>: 하나의 평가 프레임워크를 여러 사용 사례에 재사용할 수 있는가?</p>
<p>예를 들어, 고객 지원 챗봇을 평가하는 기준을 코드 생성 평가에 그대로 쓸 수 있는가? 당연히 아니다.</p>
<p>하지만 매번 처음부터 새로 만들 수도 없다. 재사용 가능한 “템플릿”이 필요하다.</p>
<p><strong>현재 접근법</strong>:<br>
- <strong>코어 기준 + 도메인 특화 기준</strong> 구조<br>
- 코어: 정확성, 명확성, 완성도 (거의 모든 태스크에 적용 가능)<br>
- 도메인 특화: Empathy (고객 지원), Code Quality (코딩), Creativity (글쓰기)</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1"></a><span class="co"># 기본 템플릿</span></span>
<span id="cb18-2"><a href="#cb18-2"></a>CORE_CRITERIA <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb18-3"><a href="#cb18-3"></a><span class="st">- Accuracy: 사실적으로 정확한가?</span></span>
<span id="cb18-4"><a href="#cb18-4"></a><span class="st">- Clarity: 이해하기 쉬운가?</span></span>
<span id="cb18-5"><a href="#cb18-5"></a><span class="st">- Completeness: 필요한 정보를 모두 포함하는가?</span></span>
<span id="cb18-6"><a href="#cb18-6"></a><span class="st">"""</span></span>
<span id="cb18-7"><a href="#cb18-7"></a></span>
<span id="cb18-8"><a href="#cb18-8"></a><span class="co"># 도메인별 추가</span></span>
<span id="cb18-9"><a href="#cb18-9"></a>CUSTOMER_SUPPORT_CRITERIA <span class="op">=</span> CORE_CRITERIA <span class="op">+</span> <span class="st">"""</span></span>
<span id="cb18-10"><a href="#cb18-10"></a><span class="st">- Empathy: 사용자의 감정을 이해하고 공감하는가?</span></span>
<span id="cb18-11"><a href="#cb18-11"></a><span class="st">- Actionability: 구체적인 해결 방법을 제시하는가?</span></span>
<span id="cb18-12"><a href="#cb18-12"></a><span class="st">"""</span></span>
<span id="cb18-13"><a href="#cb18-13"></a></span>
<span id="cb18-14"><a href="#cb18-14"></a>CODE_GENERATION_CRITERIA <span class="op">=</span> CORE_CRITERIA <span class="op">+</span> <span class="st">"""</span></span>
<span id="cb18-15"><a href="#cb18-15"></a><span class="st">- Executability: 코드가 실제로 실행되는가?</span></span>
<span id="cb18-16"><a href="#cb18-16"></a><span class="st">- Best Practices: 코딩 컨벤션을 따르는가?</span></span>
<span id="cb18-17"><a href="#cb18-17"></a><span class="st">"""</span></span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
<hr>
<p><em>평가 템플릿은 한 번 만들고 끝이 아니다. 지속적으로 검증하고, 개선하고, 사용 사례에 맞게 조정해야 한다. 다음 파트에서는 질적 평가와 양적 평가를 통합하는 방법론을 살펴본다.</em></p>


</section>
</section>

</main> <!-- /main -->
<script type="text/javascript">

// replace cmd keyboard shortcut w/ control on non-Mac platforms
const kPlatformMac = typeof navigator !== 'undefined' ? /Mac/.test(navigator.platform) : false;
if (!kPlatformMac) {
   var kbds = document.querySelectorAll("kbd")
   kbds.forEach(function(kbd) {
      kbd.innerHTML = kbd.innerHTML.replace(/⌘/g, '⌃');
   });
}

// tweak headings in pymd
document.querySelectorAll(".pymd span.co").forEach(el => {
   if (!el.innerText.startsWith("#|")) {
      el.style.fontWeight = 1000;
   }
});

</script>
<!-- Begin Mailchimp Signup Form -->
<div id="mc_embed_signup" style="padding-bottom: 1em; max-width: 400px;" class="ms-auto me-auto">
  <p style="font-weight: 600; margin-bottom: 0;">Subscribe</p>
  <span style="font-size: 0.9em;">Enjoy this blog? Get notified of new posts by email:</span>
<form action="https://quarto.us14.list-manage.com/subscribe/post?u=c79fb56a311ae347fbe916740&amp;id=ec05dfca03" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate="">
    <div id="mc_embed_signup_scroll">
	
        <div class="input-group mt-1 mb-2">
        <input type="email" class="form-control" placeholder="Email Address" aria-label="Email Address" name="EMAIL" style="font-size: 0.8em; padding: .2em;">
        </div>              

	<div id="mce-responses" class="clear foot">
		<div class="response" id="mce-error-response" style="display:none"></div>
		<div class="response" id="mce-success-response" style="display:none"></div>
	</div>    <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->
    <div style="position: absolute; left: -5000px;" aria-hidden="true"><input type="text" name="b_c79fb56a311ae347fbe916740_ec05dfca03" tabindex="-1" value=""></div>
        <div class="optionalParent">
            <div class="clear foot" style="display: flex; align-items: center; justify-content: center;">
              
              
                <input type="submit" value="Subscribe" name="subscribe" style="min-width: 150px; font-size: 0.8em;" id="mc-embedded-subscribe" class="button btn btn-light btn-sm ms-auto me-auto">
            </div>
        </div>
    </div>
</form>
</div>

<!--End mc_embed_signup-->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "복사완료!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "복사완료!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://giscus.app/client.js" data-repo="kmink3225/blog" data-repo-id="R_kgDOLCZyDg" data-category="Blog" data-category-id="" data-mapping="title" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="light" data-lang="en" crossorigin="anonymous" async="">
</script>
<input type="hidden" id="giscus-base-theme" value="light">
<input type="hidden" id="giscus-alt-theme" value="dark">
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>© Kwangmin Kim</p>
</div>   
    <div class="nav-footer-center">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
    <a class="nav-link" href="../../../../../about.html">
<p>About</p>
</a>
  </li>  
</ul>
    </div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/kmink3225/blog">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>




</body></html>