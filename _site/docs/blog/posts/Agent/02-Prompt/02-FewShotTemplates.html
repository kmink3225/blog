<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="ko" xml:lang="ko"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.543">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Kwangmin Kim">
<meta name="description" content="효과적인 프롬프트 템플릿 설계 및 관리 기법을 다룬다.">

<title>Kwangmin Kim - FewShotPromptTemplate</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../../../site_libs/quarto-search/quarto-search.js"></script>
<script src="../../../../../site_libs/quarto-search/autocomplete-preset-algolia.umd.js"></script>
<meta name="quarto:offset" content="../../../../../">
<script src="../../../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../../../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../../../../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "algolia": {
    "application-id": "DUOR1DRC9D",
    "search-only-api-key": "f264da5dea684ffb9e9b4a574af3ed61",
    "index-name": "prod_QUARTO",
    "analytics-events": true,
    "show-logo": true,
    "libDir": "site_libs"
  },
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": true,
  "language": {
    "search-no-results-text": "일치 없음",
    "search-matching-documents-text": "일치된 문서",
    "search-copy-link-title": "검색 링크 복사",
    "search-hide-matches-text": "추가 검색 결과 숨기기",
    "search-more-match-text": "추가 검색결과",
    "search-more-matches-text": "추가 검색결과",
    "search-clear-button-title": "제거",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "취소",
    "search-submit-button-title": "검색",
    "search-label": "검색"
  }
}</script>
<script src="https://cdn.jsdelivr.net/npm/algoliasearch@4.5.1/dist/algoliasearch-lite.umd.js"></script>


<script type="text/javascript">
var ALGOLIA_INSIGHTS_SRC = "https://cdn.jsdelivr.net/npm/search-insights/dist/search-insights.iife.min.js";
!function(e,a,t,n,s,i,c){e.AlgoliaAnalyticsObject=s,e[s]=e[s]||function(){
(e[s].queue=e[s].queue||[]).push(arguments)},i=a.createElement(t),c=a.getElementsByTagName(t)[0],
i.async=1,i.src=n,c.parentNode.insertBefore(i,c)
}(window,document,"script",ALGOLIA_INSIGHTS_SRC,"aa");
</script>

<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@algolia/autocomplete-plugin-algolia-insights">

</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-6W0EKFMWBN"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-6W0EKFMWBN', { 'anonymize_ip': true});
</script>
<style>

      .quarto-title-block .quarto-title-banner h1,
      .quarto-title-block .quarto-title-banner h2,
      .quarto-title-block .quarto-title-banner h3,
      .quarto-title-block .quarto-title-banner h4,
      .quarto-title-block .quarto-title-banner h5,
      .quarto-title-block .quarto-title-banner h6
      {
        color: black;
      }

      .quarto-title-block .quarto-title-banner {
        color: black;
background: #EDF3F9;
      }
</style>
<style>
.custom-footer { 
  text-align: center; 
  font-size: 0.8em; 
  color: #666; 
  margin-top: 2rem; 
}
</style>


<link rel="stylesheet" href="../../../../../styles.css">
<meta property="og:title" content="Kwangmin Kim - FewShotPromptTemplate">
<meta property="og:description" content="효과적인 프롬프트 템플릿 설계 및 관리 기법을 다룬다.">
<meta property="og:site_name" content="Kwangmin Kim">
<meta name="twitter:title" content="Kwangmin Kim - FewShotPromptTemplate">
<meta name="twitter:description" content="효과적인 프롬프트 템플릿 설계 및 관리 기법을 다룬다.">
<meta name="twitter:card" content="summary">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../../../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../../../.././images/logo.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../../../../../index.html">
    <span class="navbar-title">Kwangmin Kim</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="검색"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="탐색 전환" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../../../docs/blog/index.html"> 
<span class="menu-text">Blog</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../../../about.html"> 
<span class="menu-text">Me</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/kmink3225"> <i class="bi bi-github" role="img" aria-label="Github">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/kwangmin-kim-a5241b200/"> <i class="bi bi-linkedin" role="img" aria-label="Linkedin">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="다크 모드 전환"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-page-left">
      <h1 class="title">FewShotPromptTemplate</h1>
            <p class="subtitle lead">프롬프트 엔지니어링</p>
                  <div>
        <div class="description">
          <p>효과적인 프롬프트 템플릿 설계 및 관리 기법을 다룬다.</p>
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">AI</div>
                <div class="quarto-category">RAG</div>
                <div class="quarto-category">LangChain</div>
                <div class="quarto-category">Prompt Engineering</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta column-page-left">

      <div>
      <div class="quarto-title-meta-heading">저자</div>
      <div class="quarto-title-meta-contents">
               <p>Kwangmin Kim </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">공개</div>
      <div class="quarto-title-meta-contents">
        <p class="date">2025년 01월 13일</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">목차</h2>
   
  <ul>
  <li><a href="#example-selector" id="toc-example-selector" class="nav-link active" data-scroll-target="#example-selector"><span class="header-section-number">1</span> Example Selector</a></li>
  <li><a href="#fewshotchatmessageprompttemplate" id="toc-fewshotchatmessageprompttemplate" class="nav-link" data-scroll-target="#fewshotchatmessageprompttemplate"><span class="header-section-number">2</span> FewShotChatMessagePromptTemplate</a>
  <ul class="collapse">
  <li><a href="#example-selector-의-유사도-검색-문제-해결" id="toc-example-selector-의-유사도-검색-문제-해결" class="nav-link" data-scroll-target="#example-selector-의-유사도-검색-문제-해결"><span class="header-section-number">2.1</span> Example Selector 의 유사도 검색 문제 해결</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block column-page-left" id="quarto-document-content">





<div id="d59da054" class="cell" data-execution_count="1">
<details class="code-fold">
<summary>코드</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1"></a><span class="im">from</span> dotenv <span class="im">import</span> load_dotenv</span>
<span id="cb1-2"><a href="#cb1-2"></a></span>
<span id="cb1-3"><a href="#cb1-3"></a>load_dotenv()</span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="9fbd46a9" class="cell" data-execution_count="2">
<details class="code-fold">
<summary>코드</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1"></a><span class="co"># LangSmith 추적을 설정합니다. https://smith.langchain.com</span></span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="co"># !pip install -qU langchain-teddynote</span></span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="im">from</span> langchain_teddynote <span class="im">import</span> logging</span>
<span id="cb2-4"><a href="#cb2-4"></a></span>
<span id="cb2-5"><a href="#cb2-5"></a><span class="co"># 프로젝트 이름을 입력합니다.</span></span>
<span id="cb2-6"><a href="#cb2-6"></a>logging.langsmith(<span class="st">"CH02-Prompt"</span>)</span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="1c55c365" class="cell" data-execution_count="3">
<details class="code-fold">
<summary>코드</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1"></a><span class="im">from</span> langchain_openai <span class="im">import</span> ChatOpenAI</span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="im">from</span> langchain_teddynote.messages <span class="im">import</span> stream_response</span>
<span id="cb3-3"><a href="#cb3-3"></a></span>
<span id="cb3-4"><a href="#cb3-4"></a><span class="co"># 객체 생성</span></span>
<span id="cb3-5"><a href="#cb3-5"></a>llm <span class="op">=</span> ChatOpenAI(</span>
<span id="cb3-6"><a href="#cb3-6"></a>    temperature<span class="op">=</span><span class="dv">0</span>,  <span class="co"># 창의성</span></span>
<span id="cb3-7"><a href="#cb3-7"></a>    model_name<span class="op">=</span><span class="st">"gpt-4.1"</span>,  <span class="co"># 모델명</span></span>
<span id="cb3-8"><a href="#cb3-8"></a>)</span>
<span id="cb3-9"><a href="#cb3-9"></a></span>
<span id="cb3-10"><a href="#cb3-10"></a><span class="co"># 질의내용</span></span>
<span id="cb3-11"><a href="#cb3-11"></a>question <span class="op">=</span> <span class="st">"대한민국의 수도는 뭐야?"</span></span>
<span id="cb3-12"><a href="#cb3-12"></a></span>
<span id="cb3-13"><a href="#cb3-13"></a><span class="co"># 질의</span></span>
<span id="cb3-14"><a href="#cb3-14"></a>answer <span class="op">=</span> llm.stream(question)</span>
<span id="cb3-15"><a href="#cb3-15"></a>stream_response(answer)</span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="d745c117" class="cell" data-execution_count="4">
<details class="code-fold">
<summary>코드</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1"></a><span class="im">from</span> langchain_core.prompts.few_shot <span class="im">import</span> FewShotPromptTemplate</span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="im">from</span> langchain_core.prompts <span class="im">import</span> PromptTemplate</span>
<span id="cb4-3"><a href="#cb4-3"></a><span class="im">from</span> langchain_core.output_parsers <span class="im">import</span> StrOutputParser</span>
<span id="cb4-4"><a href="#cb4-4"></a></span>
<span id="cb4-5"><a href="#cb4-5"></a></span>
<span id="cb4-6"><a href="#cb4-6"></a>examples <span class="op">=</span> [</span>
<span id="cb4-7"><a href="#cb4-7"></a>    {</span>
<span id="cb4-8"><a href="#cb4-8"></a>        <span class="st">"question"</span>: <span class="st">"스티브 잡스와 아인슈타인 중 누가 더 오래 살았나요?"</span>,</span>
<span id="cb4-9"><a href="#cb4-9"></a>        <span class="st">"answer"</span>: <span class="st">"""이 질문에 추가 질문이 필요한가요: 예.</span></span>
<span id="cb4-10"><a href="#cb4-10"></a><span class="st">추가 질문: 스티브 잡스는 몇 살에 사망했나요?</span></span>
<span id="cb4-11"><a href="#cb4-11"></a><span class="st">중간 답변: 스티브 잡스는 56세에 사망했습니다.</span></span>
<span id="cb4-12"><a href="#cb4-12"></a><span class="st">추가 질문: 아인슈타인은 몇 살에 사망했나요?</span></span>
<span id="cb4-13"><a href="#cb4-13"></a><span class="st">중간 답변: 아인슈타인은 76세에 사망했습니다.</span></span>
<span id="cb4-14"><a href="#cb4-14"></a><span class="st">최종 답변은: 아인슈타인</span></span>
<span id="cb4-15"><a href="#cb4-15"></a><span class="st">"""</span>,</span>
<span id="cb4-16"><a href="#cb4-16"></a>    },</span>
<span id="cb4-17"><a href="#cb4-17"></a>    {</span>
<span id="cb4-18"><a href="#cb4-18"></a>        <span class="st">"question"</span>: <span class="st">"네이버의 창립자는 언제 태어났나요?"</span>,</span>
<span id="cb4-19"><a href="#cb4-19"></a>        <span class="st">"answer"</span>: <span class="st">"""이 질문에 추가 질문이 필요한가요: 예.</span></span>
<span id="cb4-20"><a href="#cb4-20"></a><span class="st">추가 질문: 네이버의 창립자는 누구인가요?</span></span>
<span id="cb4-21"><a href="#cb4-21"></a><span class="st">중간 답변: 네이버는 이해진에 의해 창립되었습니다.</span></span>
<span id="cb4-22"><a href="#cb4-22"></a><span class="st">추가 질문: 이해진은 언제 태어났나요?</span></span>
<span id="cb4-23"><a href="#cb4-23"></a><span class="st">중간 답변: 이해진은 1967년 6월 22일에 태어났습니다.</span></span>
<span id="cb4-24"><a href="#cb4-24"></a><span class="st">최종 답변은: 1967년 6월 22일</span></span>
<span id="cb4-25"><a href="#cb4-25"></a><span class="st">"""</span>,</span>
<span id="cb4-26"><a href="#cb4-26"></a>    },</span>
<span id="cb4-27"><a href="#cb4-27"></a>    {</span>
<span id="cb4-28"><a href="#cb4-28"></a>        <span class="st">"question"</span>: <span class="st">"율곡 이이의 어머니가 태어난 해의 통치하던 왕은 누구인가요?"</span>,</span>
<span id="cb4-29"><a href="#cb4-29"></a>        <span class="st">"answer"</span>: <span class="st">"""이 질문에 추가 질문이 필요한가요: 예.</span></span>
<span id="cb4-30"><a href="#cb4-30"></a><span class="st">추가 질문: 율곡 이이의 어머니는 누구인가요?</span></span>
<span id="cb4-31"><a href="#cb4-31"></a><span class="st">중간 답변: 율곡 이이의 어머니는 신사임당입니다.</span></span>
<span id="cb4-32"><a href="#cb4-32"></a><span class="st">추가 질문: 신사임당은 언제 태어났나요?</span></span>
<span id="cb4-33"><a href="#cb4-33"></a><span class="st">중간 답변: 신사임당은 1504년에 태어났습니다.</span></span>
<span id="cb4-34"><a href="#cb4-34"></a><span class="st">추가 질문: 1504년에 조선을 통치한 왕은 누구인가요?</span></span>
<span id="cb4-35"><a href="#cb4-35"></a><span class="st">중간 답변: 1504년에 조선을 통치한 왕은 연산군입니다.</span></span>
<span id="cb4-36"><a href="#cb4-36"></a><span class="st">최종 답변은: 연산군</span></span>
<span id="cb4-37"><a href="#cb4-37"></a><span class="st">"""</span>,</span>
<span id="cb4-38"><a href="#cb4-38"></a>    },</span>
<span id="cb4-39"><a href="#cb4-39"></a>    {</span>
<span id="cb4-40"><a href="#cb4-40"></a>        <span class="st">"question"</span>: <span class="st">"올드보이와 기생충의 감독이 같은 나라 출신인가요?"</span>,</span>
<span id="cb4-41"><a href="#cb4-41"></a>        <span class="st">"answer"</span>: <span class="st">"""이 질문에 추가 질문이 필요한가요: 예.</span></span>
<span id="cb4-42"><a href="#cb4-42"></a><span class="st">추가 질문: 올드보이의 감독은 누구인가요?</span></span>
<span id="cb4-43"><a href="#cb4-43"></a><span class="st">중간 답변: 올드보이의 감독은 박찬욱입니다.</span></span>
<span id="cb4-44"><a href="#cb4-44"></a><span class="st">추가 질문: 박찬욱은 어느 나라 출신인가요?</span></span>
<span id="cb4-45"><a href="#cb4-45"></a><span class="st">중간 답변: 박찬욱은 대한민국 출신입니다.</span></span>
<span id="cb4-46"><a href="#cb4-46"></a><span class="st">추가 질문: 기생충의 감독은 누구인가요?</span></span>
<span id="cb4-47"><a href="#cb4-47"></a><span class="st">중간 답변: 기생충의 감독은 봉준호입니다.</span></span>
<span id="cb4-48"><a href="#cb4-48"></a><span class="st">추가 질문: 봉준호는 어느 나라 출신인가요?</span></span>
<span id="cb4-49"><a href="#cb4-49"></a><span class="st">중간 답변: 봉준호는 대한민국 출신입니다.</span></span>
<span id="cb4-50"><a href="#cb4-50"></a><span class="st">최종 답변은: 예</span></span>
<span id="cb4-51"><a href="#cb4-51"></a><span class="st">"""</span>,</span>
<span id="cb4-52"><a href="#cb4-52"></a>    },</span>
<span id="cb4-53"><a href="#cb4-53"></a>]</span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="9148614b" class="cell" data-execution_count="5">
<details class="code-fold">
<summary>코드</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1"></a>example_prompt <span class="op">=</span> PromptTemplate.from_template(</span>
<span id="cb5-2"><a href="#cb5-2"></a>    <span class="st">"Question:</span><span class="ch">\n</span><span class="sc">{question}</span><span class="ch">\n</span><span class="st">Answer:</span><span class="ch">\n</span><span class="sc">{answer}</span><span class="st">"</span></span>
<span id="cb5-3"><a href="#cb5-3"></a>)</span>
<span id="cb5-4"><a href="#cb5-4"></a></span>
<span id="cb5-5"><a href="#cb5-5"></a><span class="bu">print</span>(example_prompt.<span class="bu">format</span>(<span class="op">**</span>examples[<span class="dv">0</span>]))</span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="d37156cf" class="cell" data-execution_count="6">
<details class="code-fold">
<summary>코드</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1"></a>prompt <span class="op">=</span> FewShotPromptTemplate(</span>
<span id="cb6-2"><a href="#cb6-2"></a>    examples<span class="op">=</span>examples,</span>
<span id="cb6-3"><a href="#cb6-3"></a>    example_prompt<span class="op">=</span>example_prompt,</span>
<span id="cb6-4"><a href="#cb6-4"></a>    suffix<span class="op">=</span><span class="st">"Question:</span><span class="ch">\n</span><span class="sc">{question}</span><span class="ch">\n</span><span class="st">Answer:"</span>,</span>
<span id="cb6-5"><a href="#cb6-5"></a>    input_variables<span class="op">=</span>[<span class="st">"question"</span>],</span>
<span id="cb6-6"><a href="#cb6-6"></a>)</span>
<span id="cb6-7"><a href="#cb6-7"></a></span>
<span id="cb6-8"><a href="#cb6-8"></a>question <span class="op">=</span> <span class="st">"Google이 창립된 연도에 Bill Gates의 나이는 몇 살인가요?"</span></span>
<span id="cb6-9"><a href="#cb6-9"></a>final_prompt <span class="op">=</span> prompt.<span class="bu">format</span>(question<span class="op">=</span>question)</span>
<span id="cb6-10"><a href="#cb6-10"></a><span class="bu">print</span>(final_prompt)</span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="42f9be46" class="cell" data-execution_count="7">
<details class="code-fold">
<summary>코드</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1"></a><span class="co"># 결과 출력</span></span>
<span id="cb7-2"><a href="#cb7-2"></a>answer <span class="op">=</span> llm.stream(final_prompt)</span>
<span id="cb7-3"><a href="#cb7-3"></a>stream_response(answer)</span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="1355b728" class="cell" data-execution_count="8">
<details class="code-fold">
<summary>코드</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1"></a>prompt <span class="op">=</span> FewShotPromptTemplate(</span>
<span id="cb8-2"><a href="#cb8-2"></a>    examples<span class="op">=</span>examples,</span>
<span id="cb8-3"><a href="#cb8-3"></a>    example_prompt<span class="op">=</span>example_prompt,</span>
<span id="cb8-4"><a href="#cb8-4"></a>    suffix<span class="op">=</span><span class="st">"Question:</span><span class="ch">\n</span><span class="sc">{question}</span><span class="ch">\n</span><span class="st">Answer:"</span>,</span>
<span id="cb8-5"><a href="#cb8-5"></a>    input_variables<span class="op">=</span>[<span class="st">"question"</span>],</span>
<span id="cb8-6"><a href="#cb8-6"></a>)</span>
<span id="cb8-7"><a href="#cb8-7"></a></span>
<span id="cb8-8"><a href="#cb8-8"></a><span class="co"># chain 생성</span></span>
<span id="cb8-9"><a href="#cb8-9"></a>chain <span class="op">=</span> prompt <span class="op">|</span> llm <span class="op">|</span> StrOutputParser()</span>
<span id="cb8-10"><a href="#cb8-10"></a></span>
<span id="cb8-11"><a href="#cb8-11"></a><span class="co"># 결과 출력</span></span>
<span id="cb8-12"><a href="#cb8-12"></a>answer <span class="op">=</span> chain.stream(</span>
<span id="cb8-13"><a href="#cb8-13"></a>    {<span class="st">"question"</span>: <span class="st">"Google이 창립된 연도에 Bill Gates의 나이는 몇 살인가요?"</span>}</span>
<span id="cb8-14"><a href="#cb8-14"></a>)</span>
<span id="cb8-15"><a href="#cb8-15"></a>stream_response(answer)</span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="example-selector" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="example-selector"><span class="header-section-number">1</span> Example Selector</h2>
<p>예제가 많은 경우 프롬프트에 포함할 예제를 선택해야 할 수도 있습니다. Example Selector 는 이 작업을 담당하는 클래스입니다.</p>
<ul>
<li><a href="https://api.python.langchain.com/en/latest/core/example_selectors.html">API 문서</a></li>
</ul>
<div id="69a544bc" class="cell" data-execution_count="9">
<details class="code-fold">
<summary>코드</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1"></a><span class="im">from</span> langchain_core.example_selectors <span class="im">import</span> (</span>
<span id="cb9-2"><a href="#cb9-2"></a>    MaxMarginalRelevanceExampleSelector,</span>
<span id="cb9-3"><a href="#cb9-3"></a>    SemanticSimilarityExampleSelector,</span>
<span id="cb9-4"><a href="#cb9-4"></a>)</span>
<span id="cb9-5"><a href="#cb9-5"></a><span class="im">from</span> langchain_openai <span class="im">import</span> OpenAIEmbeddings</span>
<span id="cb9-6"><a href="#cb9-6"></a><span class="im">from</span> langchain_chroma <span class="im">import</span> Chroma</span>
<span id="cb9-7"><a href="#cb9-7"></a></span>
<span id="cb9-8"><a href="#cb9-8"></a><span class="co"># Vector DB 생성 (저장소 이름, 임베딩 클래스)</span></span>
<span id="cb9-9"><a href="#cb9-9"></a>chroma <span class="op">=</span> Chroma(<span class="st">"example_selector"</span>, OpenAIEmbeddings())</span>
<span id="cb9-10"><a href="#cb9-10"></a></span>
<span id="cb9-11"><a href="#cb9-11"></a>example_selector <span class="op">=</span> SemanticSimilarityExampleSelector.from_examples(</span>
<span id="cb9-12"><a href="#cb9-12"></a>    <span class="co"># 여기에는 선택 가능한 예시 목록이 있습니다.</span></span>
<span id="cb9-13"><a href="#cb9-13"></a>    examples,</span>
<span id="cb9-14"><a href="#cb9-14"></a>    <span class="co"># 여기에는 의미적 유사성을 측정하는 데 사용되는 임베딩을 생성하는 임베딩 클래스가 있습니다.</span></span>
<span id="cb9-15"><a href="#cb9-15"></a>    OpenAIEmbeddings(),</span>
<span id="cb9-16"><a href="#cb9-16"></a>    <span class="co"># 여기에는 임베딩을 저장하고 유사성 검색을 수행하는 데 사용되는 VectorStore 클래스가 있습니다.</span></span>
<span id="cb9-17"><a href="#cb9-17"></a>    Chroma,</span>
<span id="cb9-18"><a href="#cb9-18"></a>    <span class="co"># 이것은 생성할 예시의 수입니다.</span></span>
<span id="cb9-19"><a href="#cb9-19"></a>    k<span class="op">=</span><span class="dv">1</span>,</span>
<span id="cb9-20"><a href="#cb9-20"></a>)</span>
<span id="cb9-21"><a href="#cb9-21"></a></span>
<span id="cb9-22"><a href="#cb9-22"></a>question <span class="op">=</span> <span class="st">"Google이 창립된 연도에 Bill Gates의 나이는 몇 살인가요?"</span></span>
<span id="cb9-23"><a href="#cb9-23"></a></span>
<span id="cb9-24"><a href="#cb9-24"></a><span class="co"># 입력과 가장 유사한 예시를 선택합니다.</span></span>
<span id="cb9-25"><a href="#cb9-25"></a>selected_examples <span class="op">=</span> example_selector.select_examples({<span class="st">"question"</span>: question})</span>
<span id="cb9-26"><a href="#cb9-26"></a></span>
<span id="cb9-27"><a href="#cb9-27"></a><span class="bu">print</span>(<span class="ss">f"입력에 가장 유사한 예시:</span><span class="ch">\n</span><span class="sc">{</span>question<span class="sc">}</span><span class="ch">\n</span><span class="ss">"</span>)</span>
<span id="cb9-28"><a href="#cb9-28"></a><span class="cf">for</span> example <span class="kw">in</span> selected_examples:</span>
<span id="cb9-29"><a href="#cb9-29"></a>    <span class="bu">print</span>(<span class="ss">f'question:</span><span class="ch">\n</span><span class="sc">{</span>example[<span class="st">"question"</span>]<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb9-30"><a href="#cb9-30"></a>    <span class="bu">print</span>(<span class="ss">f'answer:</span><span class="ch">\n</span><span class="sc">{</span>example[<span class="st">"answer"</span>]<span class="sc">}</span><span class="ss">'</span>)</span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="4750433f" class="cell" data-execution_count="10">
<details class="code-fold">
<summary>코드</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1"></a>prompt <span class="op">=</span> FewShotPromptTemplate(</span>
<span id="cb10-2"><a href="#cb10-2"></a>    example_selector<span class="op">=</span>example_selector,</span>
<span id="cb10-3"><a href="#cb10-3"></a>    example_prompt<span class="op">=</span>example_prompt,</span>
<span id="cb10-4"><a href="#cb10-4"></a>    suffix<span class="op">=</span><span class="st">"Question:</span><span class="ch">\n</span><span class="sc">{question}</span><span class="ch">\n</span><span class="st">Answer:"</span>,</span>
<span id="cb10-5"><a href="#cb10-5"></a>    input_variables<span class="op">=</span>[<span class="st">"question"</span>],</span>
<span id="cb10-6"><a href="#cb10-6"></a>)</span>
<span id="cb10-7"><a href="#cb10-7"></a></span>
<span id="cb10-8"><a href="#cb10-8"></a>question <span class="op">=</span> <span class="st">"Google이 창립된 연도에 Bill Gates의 나이는 몇 살인가요?"</span></span>
<span id="cb10-9"><a href="#cb10-9"></a>example_selector_prompt <span class="op">=</span> prompt.<span class="bu">format</span>(question<span class="op">=</span>question)</span>
<span id="cb10-10"><a href="#cb10-10"></a><span class="bu">print</span>(example_selector_prompt)</span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>이번에는 ExampleSelector 를 사용하여 FewShotPromptTemplate 을 생성합니다.</p>
<div id="60fcf621" class="cell" data-execution_count="11">
<details class="code-fold">
<summary>코드</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1"></a>prompt <span class="op">=</span> FewShotPromptTemplate(</span>
<span id="cb11-2"><a href="#cb11-2"></a>    example_selector<span class="op">=</span>example_selector,</span>
<span id="cb11-3"><a href="#cb11-3"></a>    example_prompt<span class="op">=</span>example_prompt,</span>
<span id="cb11-4"><a href="#cb11-4"></a>    suffix<span class="op">=</span><span class="st">"Question:</span><span class="ch">\n</span><span class="sc">{question}</span><span class="ch">\n</span><span class="st">Answer:"</span>,</span>
<span id="cb11-5"><a href="#cb11-5"></a>    input_variables<span class="op">=</span>[<span class="st">"question"</span>],</span>
<span id="cb11-6"><a href="#cb11-6"></a>)</span>
<span id="cb11-7"><a href="#cb11-7"></a></span>
<span id="cb11-8"><a href="#cb11-8"></a><span class="co"># 체인 생성</span></span>
<span id="cb11-9"><a href="#cb11-9"></a>chain <span class="op">=</span> prompt <span class="op">|</span> llm</span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="85f2e1f1" class="cell" data-execution_count="12">
<details class="code-fold">
<summary>코드</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1"></a><span class="co"># 결과 출력</span></span>
<span id="cb12-2"><a href="#cb12-2"></a>answer <span class="op">=</span> chain.stream(</span>
<span id="cb12-3"><a href="#cb12-3"></a>    {<span class="st">"question"</span>: <span class="st">"Google이 창립된 연도에 Bill Gates의 나이는 몇 살인가요?"</span>}</span>
<span id="cb12-4"><a href="#cb12-4"></a>)</span>
<span id="cb12-5"><a href="#cb12-5"></a>stream_response(answer)</span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="fewshotchatmessageprompttemplate" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="fewshotchatmessageprompttemplate"><span class="header-section-number">2</span> FewShotChatMessagePromptTemplate</h2>
<div id="728327bd" class="cell" data-execution_count="13">
<details class="code-fold">
<summary>코드</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1"></a>examples <span class="op">=</span> [</span>
<span id="cb13-2"><a href="#cb13-2"></a>    {</span>
<span id="cb13-3"><a href="#cb13-3"></a>        <span class="st">"instruction"</span>: <span class="st">"당신은 회의록 작성 전문가 입니다. 주어진 정보를 바탕으로 회의록을 작성해 주세요"</span>,</span>
<span id="cb13-4"><a href="#cb13-4"></a>        <span class="st">"input"</span>: <span class="st">"2023년 12월 25일, XYZ 회사의 마케팅 전략 회의가 오후 3시에 시작되었다. 회의에는 마케팅 팀장인 김수진, 디지털 마케팅 담당자인 박지민, 소셜 미디어 관리자인 이준호가 참석했다. 회의의 주요 목적은 2024년 상반기 마케팅 전략을 수립하고, 새로운 소셜 미디어 캠페인에 대한 아이디어를 논의하는 것이었다. 팀장인 김수진은 최근 시장 동향에 대한 간략한 개요를 제공했으며, 이어서 각 팀원이 자신의 분야에서의 전략적 아이디어를 발표했다."</span>,</span>
<span id="cb13-5"><a href="#cb13-5"></a>        <span class="st">"answer"</span>: <span class="st">"""</span></span>
<span id="cb13-6"><a href="#cb13-6"></a><span class="st">회의록: XYZ 회사 마케팅 전략 회의</span></span>
<span id="cb13-7"><a href="#cb13-7"></a><span class="st">일시: 2023년 12월 25일</span></span>
<span id="cb13-8"><a href="#cb13-8"></a><span class="st">장소: XYZ 회사 회의실</span></span>
<span id="cb13-9"><a href="#cb13-9"></a><span class="st">참석자: 김수진 (마케팅 팀장), 박지민 (디지털 마케팅 담당자), 이준호 (소셜 미디어 관리자)</span></span>
<span id="cb13-10"><a href="#cb13-10"></a></span>
<span id="cb13-11"><a href="#cb13-11"></a><span class="st">1. 개회</span></span>
<span id="cb13-12"><a href="#cb13-12"></a><span class="st">   - 회의는 김수진 팀장의 개회사로 시작됨.</span></span>
<span id="cb13-13"><a href="#cb13-13"></a><span class="st">   - 회의의 목적은 2024년 상반기 마케팅 전략 수립 및 새로운 소셜 미디어 캠페인 아이디어 논의.</span></span>
<span id="cb13-14"><a href="#cb13-14"></a></span>
<span id="cb13-15"><a href="#cb13-15"></a><span class="st">2. 시장 동향 개요 (김수진)</span></span>
<span id="cb13-16"><a href="#cb13-16"></a><span class="st">   - 김수진 팀장은 최근 시장 동향에 대한 분석을 제시.</span></span>
<span id="cb13-17"><a href="#cb13-17"></a><span class="st">   - 소비자 행동 변화와 경쟁사 전략에 대한 통찰 공유.</span></span>
<span id="cb13-18"><a href="#cb13-18"></a></span>
<span id="cb13-19"><a href="#cb13-19"></a><span class="st">3. 디지털 마케팅 전략 (박지민)</span></span>
<span id="cb13-20"><a href="#cb13-20"></a><span class="st">   - 박지민은 디지털 마케팅 전략에 대해 발표.</span></span>
<span id="cb13-21"><a href="#cb13-21"></a><span class="st">   - 온라인 광고와 SEO 최적화 방안에 중점을 둠.</span></span>
<span id="cb13-22"><a href="#cb13-22"></a></span>
<span id="cb13-23"><a href="#cb13-23"></a><span class="st">4. 소셜 미디어 캠페인 (이준호)</span></span>
<span id="cb13-24"><a href="#cb13-24"></a><span class="st">   - 이준호는 새로운 소셜 미디어 캠페인에 대한 아이디어를 제안.</span></span>
<span id="cb13-25"><a href="#cb13-25"></a><span class="st">   - 인플루언서 마케팅과 콘텐츠 전략에 대한 계획을 설명함.</span></span>
<span id="cb13-26"><a href="#cb13-26"></a></span>
<span id="cb13-27"><a href="#cb13-27"></a><span class="st">5. 종합 논의</span></span>
<span id="cb13-28"><a href="#cb13-28"></a><span class="st">   - 팀원들 간의 아이디어 공유 및 토론.</span></span>
<span id="cb13-29"><a href="#cb13-29"></a><span class="st">   - 각 전략에 대한 예산 및 자원 배분에 대해 논의.</span></span>
<span id="cb13-30"><a href="#cb13-30"></a></span>
<span id="cb13-31"><a href="#cb13-31"></a><span class="st">6. 마무리</span></span>
<span id="cb13-32"><a href="#cb13-32"></a><span class="st">   - 다음 회의 날짜 및 시간 확정.</span></span>
<span id="cb13-33"><a href="#cb13-33"></a><span class="st">   - 회의록 정리 및 배포는 박지민 담당.</span></span>
<span id="cb13-34"><a href="#cb13-34"></a><span class="st">"""</span>,</span>
<span id="cb13-35"><a href="#cb13-35"></a>    },</span>
<span id="cb13-36"><a href="#cb13-36"></a>    {</span>
<span id="cb13-37"><a href="#cb13-37"></a>        <span class="st">"instruction"</span>: <span class="st">"당신은 요약 전문가 입니다. 다음 주어진 정보를 바탕으로 내용을 요약해 주세요"</span>,</span>
<span id="cb13-38"><a href="#cb13-38"></a>        <span class="st">"input"</span>: <span class="st">"이 문서는 '지속 가능한 도시 개발을 위한 전략'에 대한 20페이지 분량의 보고서입니다. 보고서는 지속 가능한 도시 개발의 중요성, 현재 도시화의 문제점, 그리고 도시 개발을 지속 가능하게 만들기 위한 다양한 전략을 포괄적으로 다루고 있습니다. 이 보고서는 또한 성공적인 지속 가능한 도시 개발 사례를 여러 국가에서 소개하고, 이러한 사례들을 통해 얻은 교훈을 요약하고 있습니다."</span>,</span>
<span id="cb13-39"><a href="#cb13-39"></a>        <span class="st">"answer"</span>: <span class="st">"""</span></span>
<span id="cb13-40"><a href="#cb13-40"></a><span class="st">문서 요약: 지속 가능한 도시 개발을 위한 전략 보고서</span></span>
<span id="cb13-41"><a href="#cb13-41"></a></span>
<span id="cb13-42"><a href="#cb13-42"></a><span class="st">- 중요성: 지속 가능한 도시 개발이 필수적인 이유와 그에 따른 사회적, 경제적, 환경적 이익을 강조.</span></span>
<span id="cb13-43"><a href="#cb13-43"></a><span class="st">- 현 문제점: 현재의 도시화 과정에서 발생하는 주요 문제점들, 예를 들어 환경 오염, 자원 고갈, 불평등 증가 등을 분석.</span></span>
<span id="cb13-44"><a href="#cb13-44"></a><span class="st">- 전략: 지속 가능한 도시 개발을 달성하기 위한 다양한 전략 제시. 이에는 친환경 건축, 대중교통 개선, 에너지 효율성 증대, 지역사회 참여 강화 등이 포함됨.</span></span>
<span id="cb13-45"><a href="#cb13-45"></a><span class="st">- 사례 연구: 전 세계 여러 도시의 성공적인 지속 가능한 개발 사례를 소개. 예를 들어, 덴마크의 코펜하겐, 일본의 요코하마 등의 사례를 통해 실현 가능한 전략들을 설명.</span></span>
<span id="cb13-46"><a href="#cb13-46"></a><span class="st">- 교훈: 이러한 사례들에서 얻은 주요 교훈을 요약. 강조된 교훈에는 다각적 접근의 중요성, 지역사회와의 협력, 장기적 계획의 필요성 등이 포함됨.</span></span>
<span id="cb13-47"><a href="#cb13-47"></a></span>
<span id="cb13-48"><a href="#cb13-48"></a><span class="st">이 보고서는 지속 가능한 도시 개발이 어떻게 현실적이고 효과적인 형태로 이루어질 수 있는지에 대한 심도 있는 분석을 제공합니다.</span></span>
<span id="cb13-49"><a href="#cb13-49"></a><span class="st">"""</span>,</span>
<span id="cb13-50"><a href="#cb13-50"></a>    },</span>
<span id="cb13-51"><a href="#cb13-51"></a>    {</span>
<span id="cb13-52"><a href="#cb13-52"></a>        <span class="st">"instruction"</span>: <span class="st">"당신은 문장 교정 전문가 입니다. 다음 주어진 문장을 교정해 주세요"</span>,</span>
<span id="cb13-53"><a href="#cb13-53"></a>        <span class="st">"input"</span>: <span class="st">"우리 회사는 새로운 마케팅 전략을 도입하려고 한다. 이를 통해 고객과의 소통이 더 효과적이 될 것이다."</span>,</span>
<span id="cb13-54"><a href="#cb13-54"></a>        <span class="st">"answer"</span>: <span class="st">"본 회사는 새로운 마케팅 전략을 도입함으로써, 고객과의 소통을 보다 효과적으로 개선할 수 있을 것으로 기대된다."</span>,</span>
<span id="cb13-55"><a href="#cb13-55"></a>    },</span>
<span id="cb13-56"><a href="#cb13-56"></a>]</span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="ce5a315c" class="cell" data-execution_count="14">
<details class="code-fold">
<summary>코드</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1"></a><span class="im">from</span> langchain_core.prompts <span class="im">import</span> ChatPromptTemplate, FewShotChatMessagePromptTemplate</span>
<span id="cb14-2"><a href="#cb14-2"></a><span class="im">from</span> langchain_core.example_selectors <span class="im">import</span> (</span>
<span id="cb14-3"><a href="#cb14-3"></a>    SemanticSimilarityExampleSelector,</span>
<span id="cb14-4"><a href="#cb14-4"></a>)</span>
<span id="cb14-5"><a href="#cb14-5"></a><span class="im">from</span> langchain_openai <span class="im">import</span> OpenAIEmbeddings</span>
<span id="cb14-6"><a href="#cb14-6"></a><span class="im">from</span> langchain_chroma <span class="im">import</span> Chroma</span>
<span id="cb14-7"><a href="#cb14-7"></a></span>
<span id="cb14-8"><a href="#cb14-8"></a>chroma <span class="op">=</span> Chroma(<span class="st">"fewshot_chat"</span>, OpenAIEmbeddings())</span>
<span id="cb14-9"><a href="#cb14-9"></a></span>
<span id="cb14-10"><a href="#cb14-10"></a>example_prompt <span class="op">=</span> ChatPromptTemplate.from_messages(</span>
<span id="cb14-11"><a href="#cb14-11"></a>    [</span>
<span id="cb14-12"><a href="#cb14-12"></a>        (<span class="st">"human"</span>, <span class="st">"</span><span class="sc">{instruction}</span><span class="st">:</span><span class="ch">\n</span><span class="sc">{input}</span><span class="st">"</span>),</span>
<span id="cb14-13"><a href="#cb14-13"></a>        (<span class="st">"ai"</span>, <span class="st">"</span><span class="sc">{answer}</span><span class="st">"</span>),</span>
<span id="cb14-14"><a href="#cb14-14"></a>    ]</span>
<span id="cb14-15"><a href="#cb14-15"></a>)</span>
<span id="cb14-16"><a href="#cb14-16"></a></span>
<span id="cb14-17"><a href="#cb14-17"></a>example_selector <span class="op">=</span> SemanticSimilarityExampleSelector.from_examples(</span>
<span id="cb14-18"><a href="#cb14-18"></a>    <span class="co"># 여기에는 선택 가능한 예시 목록이 있습니다.</span></span>
<span id="cb14-19"><a href="#cb14-19"></a>    examples,</span>
<span id="cb14-20"><a href="#cb14-20"></a>    <span class="co"># 여기에는 의미적 유사성을 측정하는 데 사용되는 임베딩을 생성하는 임베딩 클래스가 있습니다.</span></span>
<span id="cb14-21"><a href="#cb14-21"></a>    OpenAIEmbeddings(),</span>
<span id="cb14-22"><a href="#cb14-22"></a>    <span class="co"># 여기에는 임베딩을 저장하고 유사성 검색을 수행하는 데 사용되는 VectorStore 클래스가 있습니다.</span></span>
<span id="cb14-23"><a href="#cb14-23"></a>    chroma,</span>
<span id="cb14-24"><a href="#cb14-24"></a>    <span class="co"># 이것은 생성할 예시의 수입니다.</span></span>
<span id="cb14-25"><a href="#cb14-25"></a>    k<span class="op">=</span><span class="dv">1</span>,</span>
<span id="cb14-26"><a href="#cb14-26"></a>)</span>
<span id="cb14-27"><a href="#cb14-27"></a></span>
<span id="cb14-28"><a href="#cb14-28"></a>few_shot_prompt <span class="op">=</span> FewShotChatMessagePromptTemplate(</span>
<span id="cb14-29"><a href="#cb14-29"></a>    example_selector<span class="op">=</span>example_selector,</span>
<span id="cb14-30"><a href="#cb14-30"></a>    example_prompt<span class="op">=</span>example_prompt,</span>
<span id="cb14-31"><a href="#cb14-31"></a>)</span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>fewshot 예제와 example selector를 사용하여 유사한 예제 1개를 선택합니다.</p>
<div id="131f5b12" class="cell" data-execution_count="15">
<details class="code-fold">
<summary>코드</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1"></a>question <span class="op">=</span> {</span>
<span id="cb15-2"><a href="#cb15-2"></a>    <span class="st">"instruction"</span>: <span class="st">"회의록을 작성해 주세요"</span>,</span>
<span id="cb15-3"><a href="#cb15-3"></a>    <span class="st">"input"</span>: <span class="st">"2023년 12월 26일, ABC 기술 회사의 제품 개발 팀은 새로운 모바일 애플리케이션 프로젝트에 대한 주간 진행 상황 회의를 가졌다. 이 회의에는 프로젝트 매니저인 최현수, 주요 개발자인 황지연, UI/UX 디자이너인 김태영이 참석했다. 회의의 주요 목적은 프로젝트의 현재 진행 상황을 검토하고, 다가오는 마일스톤에 대한 계획을 수립하는 것이었다. 각 팀원은 자신의 작업 영역에 대한 업데이트를 제공했고, 팀은 다음 주까지의 목표를 설정했다."</span>,</span>
<span id="cb15-4"><a href="#cb15-4"></a>}</span>
<span id="cb15-5"><a href="#cb15-5"></a></span>
<span id="cb15-6"><a href="#cb15-6"></a>example_selector.select_examples(question)</span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="625b2371" class="cell" data-execution_count="16">
<details class="code-fold">
<summary>코드</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1"></a>final_prompt <span class="op">=</span> ChatPromptTemplate.from_messages(</span>
<span id="cb16-2"><a href="#cb16-2"></a>    [</span>
<span id="cb16-3"><a href="#cb16-3"></a>        (</span>
<span id="cb16-4"><a href="#cb16-4"></a>            <span class="st">"system"</span>,</span>
<span id="cb16-5"><a href="#cb16-5"></a>            <span class="st">"You are a helpful assistant."</span>,</span>
<span id="cb16-6"><a href="#cb16-6"></a>        ),</span>
<span id="cb16-7"><a href="#cb16-7"></a>        few_shot_prompt,</span>
<span id="cb16-8"><a href="#cb16-8"></a>        (<span class="st">"human"</span>, <span class="st">"</span><span class="sc">{instruction}</span><span class="ch">\n</span><span class="sc">{input}</span><span class="st">"</span>),</span>
<span id="cb16-9"><a href="#cb16-9"></a>    ]</span>
<span id="cb16-10"><a href="#cb16-10"></a>)</span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="66860572" class="cell" data-execution_count="17">
<details class="code-fold">
<summary>코드</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1"></a><span class="co"># chain 생성</span></span>
<span id="cb17-2"><a href="#cb17-2"></a>chain <span class="op">=</span> final_prompt <span class="op">|</span> llm</span>
<span id="cb17-3"><a href="#cb17-3"></a></span>
<span id="cb17-4"><a href="#cb17-4"></a><span class="co"># 실행 및 결과 출력</span></span>
<span id="cb17-5"><a href="#cb17-5"></a>answer <span class="op">=</span> chain.stream(question)</span>
<span id="cb17-6"><a href="#cb17-6"></a>stream_response(answer)</span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="example-selector-의-유사도-검색-문제-해결" class="level3" data-number="2.1">
<h3 data-number="2.1" class="anchored" data-anchor-id="example-selector-의-유사도-검색-문제-해결"><span class="header-section-number">2.1</span> Example Selector 의 유사도 검색 문제 해결</h3>
<p>유사도 계산시 <code>instruction</code> 과 <code>input</code> 을 사용하고 있습니다. 하지만, <code>instruction</code> 만 사용하여 검색시 제대로된 유사도 결과가 나오지 않습니다.</p>
<p>이를 해결하기 위해 커스텀 유사도 계산을 위한 클래스를 정의합니다.</p>
<p>아래는 잘못 검색된 결과의 예시입니다.</p>
<div id="90fc41bb" class="cell" data-execution_count="18">
<details class="code-fold">
<summary>코드</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1"></a>question <span class="op">=</span> {</span>
<span id="cb18-2"><a href="#cb18-2"></a>    <span class="st">"instruction"</span>: <span class="st">"회의록을 작성해 주세요"</span>,</span>
<span id="cb18-3"><a href="#cb18-3"></a>}</span>
<span id="cb18-4"><a href="#cb18-4"></a></span>
<span id="cb18-5"><a href="#cb18-5"></a>example_selector.select_examples(question)</span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="7807b18b" class="cell" data-execution_count="19">
<details class="code-fold">
<summary>코드</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1"></a><span class="co"># 커스텀 하지 않은 기본 예제 선택기를 사용했을 때 결과</span></span>
<span id="cb19-2"><a href="#cb19-2"></a>example_selector.select_examples({<span class="st">"instruction"</span>: <span class="st">"다음 문장을 요약해 주세요"</span>})</span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="a5db37da" class="cell" data-execution_count="20">
<details class="code-fold">
<summary>코드</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1"></a><span class="im">from</span> langchain_teddynote.prompts <span class="im">import</span> CustomExampleSelector</span>
<span id="cb20-2"><a href="#cb20-2"></a></span>
<span id="cb20-3"><a href="#cb20-3"></a><span class="co"># 커스텀 예제 선택기 생성</span></span>
<span id="cb20-4"><a href="#cb20-4"></a>custom_selector <span class="op">=</span> CustomExampleSelector(examples, OpenAIEmbeddings())</span>
<span id="cb20-5"><a href="#cb20-5"></a></span>
<span id="cb20-6"><a href="#cb20-6"></a><span class="co"># 커스텀 예제 선택기를 사용했을 때 결과</span></span>
<span id="cb20-7"><a href="#cb20-7"></a>custom_selector.select_examples({<span class="st">"instruction"</span>: <span class="st">"다음 문장을 회의록 작성해 주세요"</span>})</span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="d1251638" class="cell" data-execution_count="21">
<details class="code-fold">
<summary>코드</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1"></a>example_prompt <span class="op">=</span> ChatPromptTemplate.from_messages(</span>
<span id="cb21-2"><a href="#cb21-2"></a>    [</span>
<span id="cb21-3"><a href="#cb21-3"></a>        (<span class="st">"human"</span>, <span class="st">"</span><span class="sc">{instruction}</span><span class="st">:</span><span class="ch">\n</span><span class="sc">{input}</span><span class="st">"</span>),</span>
<span id="cb21-4"><a href="#cb21-4"></a>        (<span class="st">"ai"</span>, <span class="st">"</span><span class="sc">{answer}</span><span class="st">"</span>),</span>
<span id="cb21-5"><a href="#cb21-5"></a>    ]</span>
<span id="cb21-6"><a href="#cb21-6"></a>)</span>
<span id="cb21-7"><a href="#cb21-7"></a></span>
<span id="cb21-8"><a href="#cb21-8"></a>custom_fewshot_prompt <span class="op">=</span> FewShotChatMessagePromptTemplate(</span>
<span id="cb21-9"><a href="#cb21-9"></a>    example_selector<span class="op">=</span>custom_selector,  <span class="co"># 커스텀 예제 선택기 사용</span></span>
<span id="cb21-10"><a href="#cb21-10"></a>    example_prompt<span class="op">=</span>example_prompt,  <span class="co"># 예제 프롬프트 사용</span></span>
<span id="cb21-11"><a href="#cb21-11"></a>)</span>
<span id="cb21-12"><a href="#cb21-12"></a></span>
<span id="cb21-13"><a href="#cb21-13"></a>custom_prompt <span class="op">=</span> ChatPromptTemplate.from_messages(</span>
<span id="cb21-14"><a href="#cb21-14"></a>    [</span>
<span id="cb21-15"><a href="#cb21-15"></a>        (</span>
<span id="cb21-16"><a href="#cb21-16"></a>            <span class="st">"system"</span>,</span>
<span id="cb21-17"><a href="#cb21-17"></a>            <span class="st">"You are a helpful assistant."</span>,</span>
<span id="cb21-18"><a href="#cb21-18"></a>        ),</span>
<span id="cb21-19"><a href="#cb21-19"></a>        custom_fewshot_prompt,</span>
<span id="cb21-20"><a href="#cb21-20"></a>        (<span class="st">"human"</span>, <span class="st">"</span><span class="sc">{instruction}</span><span class="ch">\n</span><span class="sc">{input}</span><span class="st">"</span>),</span>
<span id="cb21-21"><a href="#cb21-21"></a>    ]</span>
<span id="cb21-22"><a href="#cb21-22"></a>)</span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="9472e04c" class="cell" data-execution_count="22">
<details class="code-fold">
<summary>코드</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1"></a><span class="co"># chain 을 생성합니다.</span></span>
<span id="cb22-2"><a href="#cb22-2"></a>chain <span class="op">=</span> custom_prompt <span class="op">|</span> llm</span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="cf29398a" class="cell" data-execution_count="23">
<details class="code-fold">
<summary>코드</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1"></a>question <span class="op">=</span> {</span>
<span id="cb23-2"><a href="#cb23-2"></a>    <span class="st">"instruction"</span>: <span class="st">"회의록을 작성해 주세요"</span>,</span>
<span id="cb23-3"><a href="#cb23-3"></a>    <span class="st">"input"</span>: <span class="st">"2023년 12월 26일, ABC 기술 회사의 제품 개발 팀은 새로운 모바일 애플리케이션 프로젝트에 대한 주간 진행 상황 회의를 가졌다. 이 회의에는 프로젝트 매니저인 최현수, 주요 개발자인 황지연, UI/UX 디자이너인 김태영이 참석했다. 회의의 주요 목적은 프로젝트의 현재 진행 상황을 검토하고, 다가오는 마일스톤에 대한 계획을 수립하는 것이었다. 각 팀원은 자신의 작업 영역에 대한 업데이트를 제공했고, 팀은 다음 주까지의 목표를 설정했다."</span>,</span>
<span id="cb23-4"><a href="#cb23-4"></a>}</span>
<span id="cb23-5"><a href="#cb23-5"></a></span>
<span id="cb23-6"><a href="#cb23-6"></a><span class="co"># 실행 및 결과 출력</span></span>
<span id="cb23-7"><a href="#cb23-7"></a>stream_response(chain.stream(question))</span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="187d8c02" class="cell" data-execution_count="24">
<details class="code-fold">
<summary>코드</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1"></a>question <span class="op">=</span> {</span>
<span id="cb24-2"><a href="#cb24-2"></a>    <span class="st">"instruction"</span>: <span class="st">"문서를 요약해 주세요"</span>,</span>
<span id="cb24-3"><a href="#cb24-3"></a>    <span class="st">"input"</span>: <span class="st">"이 문서는 '2023년 글로벌 경제 전망'에 관한 30페이지에 달하는 상세한 보고서입니다. 보고서는 세계 경제의 현재 상태, 주요 국가들의 경제 성장률, 글로벌 무역 동향, 그리고 다가오는 해에 대한 경제 예측을 다룹니다. 이 보고서는 또한 다양한 경제적, 정치적, 환경적 요인들이 세계 경제에 미칠 영향을 분석하고 있습니다."</span>,</span>
<span id="cb24-4"><a href="#cb24-4"></a>}</span>
<span id="cb24-5"><a href="#cb24-5"></a></span>
<span id="cb24-6"><a href="#cb24-6"></a><span class="co"># 실행 및 결과 출력</span></span>
<span id="cb24-7"><a href="#cb24-7"></a>stream_response(chain.stream(question))</span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="3575ea4e" class="cell" data-execution_count="25">
<details class="code-fold">
<summary>코드</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1"></a>question <span class="op">=</span> {</span>
<span id="cb25-2"><a href="#cb25-2"></a>    <span class="st">"instruction"</span>: <span class="st">"문장을 교정해 주세요"</span>,</span>
<span id="cb25-3"><a href="#cb25-3"></a>    <span class="st">"input"</span>: <span class="st">"회사는 올해 매출이 증가할 것으로 예상한다. 새로운 전략이 잘 작동하고 있다."</span>,</span>
<span id="cb25-4"><a href="#cb25-4"></a>}</span>
<span id="cb25-5"><a href="#cb25-5"></a></span>
<span id="cb25-6"><a href="#cb25-6"></a><span class="co"># 실행 및 결과 출력</span></span>
<span id="cb25-7"><a href="#cb25-7"></a>stream_response(chain.stream(question))</span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>


</section>
</section>

</main> <!-- /main -->
<script type="text/javascript">

// replace cmd keyboard shortcut w/ control on non-Mac platforms
const kPlatformMac = typeof navigator !== 'undefined' ? /Mac/.test(navigator.platform) : false;
if (!kPlatformMac) {
   var kbds = document.querySelectorAll("kbd")
   kbds.forEach(function(kbd) {
      kbd.innerHTML = kbd.innerHTML.replace(/⌘/g, '⌃');
   });
}

// tweak headings in pymd
document.querySelectorAll(".pymd span.co").forEach(el => {
   if (!el.innerText.startsWith("#|")) {
      el.style.fontWeight = 1000;
   }
});

</script>
<!-- Begin Mailchimp Signup Form -->
<div id="mc_embed_signup" style="padding-bottom: 1em; max-width: 400px;" class="ms-auto me-auto">
  <p style="font-weight: 600; margin-bottom: 0;">Subscribe</p>
  <span style="font-size: 0.9em;">Enjoy this blog? Get notified of new posts by email:</span>
<form action="https://quarto.us14.list-manage.com/subscribe/post?u=c79fb56a311ae347fbe916740&amp;id=ec05dfca03" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate="">
    <div id="mc_embed_signup_scroll">
	
        <div class="input-group mt-1 mb-2">
        <input type="email" class="form-control" placeholder="Email Address" aria-label="Email Address" name="EMAIL" style="font-size: 0.8em; padding: .2em;">
        </div>              

	<div id="mce-responses" class="clear foot">
		<div class="response" id="mce-error-response" style="display:none"></div>
		<div class="response" id="mce-success-response" style="display:none"></div>
	</div>    <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->
    <div style="position: absolute; left: -5000px;" aria-hidden="true"><input type="text" name="b_c79fb56a311ae347fbe916740_ec05dfca03" tabindex="-1" value=""></div>
        <div class="optionalParent">
            <div class="clear foot" style="display: flex; align-items: center; justify-content: center;">
              
              
                <input type="submit" value="Subscribe" name="subscribe" style="min-width: 150px; font-size: 0.8em;" id="mc-embedded-subscribe" class="button btn btn-light btn-sm ms-auto me-auto">
            </div>
        </div>
    </div>
</form>
</div>

<!--End mc_embed_signup-->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "복사완료!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "복사완료!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://giscus.app/client.js" data-repo="kmink3225/blog" data-repo-id="R_kgDOLCZyDg" data-category="Blog" data-category-id="" data-mapping="title" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="light" data-lang="en" crossorigin="anonymous" async="">
</script>
<input type="hidden" id="giscus-base-theme" value="light">
<input type="hidden" id="giscus-alt-theme" value="dark">
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>© Kwangmin Kim</p>
</div>   
    <div class="nav-footer-center">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
    <a class="nav-link" href="../../../../../about.html">
<p>About</p>
</a>
  </li>  
</ul>
    </div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/kmink3225/blog">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>




</body></html>