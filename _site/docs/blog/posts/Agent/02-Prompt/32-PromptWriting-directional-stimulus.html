<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="ko" xml:lang="ko"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.543">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Kwangmin Kim">
<meta name="description" content="Active-Prompt의 정의부터 실전 구현까지 체계적으로 설명한다. Diao et al.&nbsp;(2023) “Active Prompting with Chain-of-Thought for Large Language Models” 연구를 바탕으로 Active Learning의 원리를 Few-shot 프롬프팅에 적용하는 방법, 불확실성 측정 메커니즘(Self-Consistency, Entropy 기반), 4단계 프로세스(불확실성 측정, 선택, 어노테이션, 추론)를 분석한다. GSM8K, SVAMP, AQuA 등 수학 추론 벤치마크에서 Random Selection 대비 최대 5.2% 성능 향상 결과를 제시하고, 어노테이션 비용 50% 절감하면서 성능 2% 향상 달성 사례, 수학 문제 풀이/복잡한 추론 태스크 등 실무 예시와 비용-효율성 트레이드오프 분석, 어노테이션 부담 최소화 전략, 능동적 예시 선택 vs 무작위 선택 비교, 반복적 개선 패턴을 제시한다.">

<title>Kwangmin Kim - Directional Stimulus Prompting: 힌트로 LLM을 원하는 방향으로 유도하기</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../../../site_libs/quarto-search/quarto-search.js"></script>
<script src="../../../../../site_libs/quarto-search/autocomplete-preset-algolia.umd.js"></script>
<meta name="quarto:offset" content="../../../../../">
<script src="../../../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../../../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../../../../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "algolia": {
    "application-id": "DUOR1DRC9D",
    "search-only-api-key": "f264da5dea684ffb9e9b4a574af3ed61",
    "index-name": "prod_QUARTO",
    "analytics-events": true,
    "show-logo": true,
    "libDir": "site_libs"
  },
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": true,
  "language": {
    "search-no-results-text": "일치 없음",
    "search-matching-documents-text": "일치된 문서",
    "search-copy-link-title": "검색 링크 복사",
    "search-hide-matches-text": "추가 검색 결과 숨기기",
    "search-more-match-text": "추가 검색결과",
    "search-more-matches-text": "추가 검색결과",
    "search-clear-button-title": "제거",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "취소",
    "search-submit-button-title": "검색",
    "search-label": "검색"
  }
}</script>
<script src="https://cdn.jsdelivr.net/npm/algoliasearch@4.5.1/dist/algoliasearch-lite.umd.js"></script>


<script type="text/javascript">
var ALGOLIA_INSIGHTS_SRC = "https://cdn.jsdelivr.net/npm/search-insights/dist/search-insights.iife.min.js";
!function(e,a,t,n,s,i,c){e.AlgoliaAnalyticsObject=s,e[s]=e[s]||function(){
(e[s].queue=e[s].queue||[]).push(arguments)},i=a.createElement(t),c=a.getElementsByTagName(t)[0],
i.async=1,i.src=n,c.parentNode.insertBefore(i,c)
}(window,document,"script",ALGOLIA_INSIGHTS_SRC,"aa");
</script>

<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@algolia/autocomplete-plugin-algolia-insights">

</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-6W0EKFMWBN"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-6W0EKFMWBN', { 'anonymize_ip': true});
</script>
<style>

      .quarto-title-block .quarto-title-banner h1,
      .quarto-title-block .quarto-title-banner h2,
      .quarto-title-block .quarto-title-banner h3,
      .quarto-title-block .quarto-title-banner h4,
      .quarto-title-block .quarto-title-banner h5,
      .quarto-title-block .quarto-title-banner h6
      {
        color: black;
      }

      .quarto-title-block .quarto-title-banner {
        color: black;
background: #EDF3F9;
      }
</style>
<style>
.custom-footer { 
  text-align: center; 
  font-size: 0.8em; 
  color: #666; 
  margin-top: 2rem; 
}
</style>


<link rel="stylesheet" href="../../../../../styles.css">
<meta property="og:title" content="Kwangmin Kim - Directional Stimulus Prompting: 힌트로 LLM을 원하는 방향으로 유도하기">
<meta property="og:description" content="Active-Prompt의 정의부터 실전 구현까지 체계적으로 설명한다. Diao et al.&nbsp;(2023) “Active Prompting with Chain-of-Thought for Large Language Models” 연구를 바탕으로 Active Learning의 원리를 Few-shot 프롬프팅에 적용하는 방법, 불확실성 측정 메커니즘(Self-Consistency, Entropy 기반), 4단계 프로세스(불확실성 측정, 선택, 어노테이션, 추론)를 분석한다. GSM8K, SVAMP, AQuA 등 수학 추론 벤치마크에서 Random Selection 대비 최대 5.2% 성능 향상 결과를 제시하고, 어노테이션 비용 50% 절감하면서 성능 2% 향상 달성 사례, 수학 문제 풀이/복잡한 추론 태스크 등 실무 예시와 비용-효율성 트레이드오프 분석, 어노테이션 부담 최소화 전략, 능동적 예시 선택 vs 무작위 선택 비교, 반복적 개선 패턴을 제시한다.">
<meta property="og:site_name" content="Kwangmin Kim">
<meta name="twitter:title" content="Kwangmin Kim - Directional Stimulus Prompting: 힌트로 LLM을 원하는 방향으로 유도하기">
<meta name="twitter:description" content="Active-Prompt의 정의부터 실전 구현까지 체계적으로 설명한다. Diao et al.&nbsp;(2023) “Active Prompting with Chain-of-Thought for Large Language Models” 연구를 바탕으로 Active Learning의 원리를 Few-shot 프롬프팅에 적용하는 방법, 불확실성 측정 메커니즘(Self-Consistency, Entropy 기반), 4단계 프로세스(불확실성 측정, 선택, 어노테이션, 추론)를 분석한다. GSM8K, SVAMP, AQuA 등 수학 추론 벤치마크에서 Random Selection 대비 최대 5.2% 성능 향상 결과를 제시하고, 어노테이션 비용 50% 절감하면서 성능 2% 향상 달성 사례, 수학 문제 풀이/복잡한 추론 태스크 등 실무 예시와 비용-효율성 트레이드오프 분석, 어노테이션 부담 최소화 전략, 능동적 예시 선택 vs 무작위 선택 비교, 반복적 개선 패턴을 제시한다.">
<meta name="twitter:card" content="summary">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../../../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../../../.././images/logo.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../../../../../index.html">
    <span class="navbar-title">Kwangmin Kim</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="검색"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="탐색 전환" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../../../docs/blog/index.html"> 
<span class="menu-text">Blog</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../../../about.html"> 
<span class="menu-text">Me</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/kmink3225"> <i class="bi bi-github" role="img" aria-label="Github">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/kwangmin-kim-a5241b200/"> <i class="bi bi-linkedin" role="img" aria-label="Linkedin">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="다크 모드 전환"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-page-left">
      <h1 class="title">Directional Stimulus Prompting: 힌트로 LLM을 원하는 방향으로 유도하기</h1>
            <p class="subtitle lead">Active Learning을 프롬프트 엔지니어링에 적용하여 최소 어노테이션으로 최대 성능을 달성하는 기법</p>
                  <div>
        <div class="description">
          <p>Active-Prompt의 정의부터 실전 구현까지 체계적으로 설명한다. Diao et al.&nbsp;(2023) “Active Prompting with Chain-of-Thought for Large Language Models” 연구를 바탕으로 Active Learning의 원리를 Few-shot 프롬프팅에 적용하는 방법, 불확실성 측정 메커니즘(Self-Consistency, Entropy 기반), 4단계 프로세스(불확실성 측정, 선택, 어노테이션, 추론)를 분석한다. GSM8K, SVAMP, AQuA 등 수학 추론 벤치마크에서 Random Selection 대비 최대 5.2% 성능 향상 결과를 제시하고, 어노테이션 비용 50% 절감하면서 성능 2% 향상 달성 사례, 수학 문제 풀이/복잡한 추론 태스크 등 실무 예시와 비용-효율성 트레이드오프 분석, 어노테이션 부담 최소화 전략, 능동적 예시 선택 vs 무작위 선택 비교, 반복적 개선 패턴을 제시한다.</p>
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">Prompt Engineering</div>
                <div class="quarto-category">LLM</div>
                <div class="quarto-category">AI</div>
                <div class="quarto-category">Agent</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta column-page-left">

      <div>
      <div class="quarto-title-meta-heading">저자</div>
      <div class="quarto-title-meta-contents">
               <p>Kwangmin Kim </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">공개</div>
      <div class="quarto-title-meta-contents">
        <p class="date">2025년 02월 08일</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">목차</h2>
   
  <ul>
  <li><a href="#들어가며" id="toc-들어가며" class="nav-link active" data-scroll-target="#들어가며"><span class="header-section-number">1</span> 들어가며</a></li>
  <li><a href="#기존-접근법의-문제점" id="toc-기존-접근법의-문제점" class="nav-link" data-scroll-target="#기존-접근법의-문제점"><span class="header-section-number">2</span> 기존 접근법의 문제점</a>
  <ul class="collapse">
  <li><a href="#문제-1-수동-힌트-작성" id="toc-문제-1-수동-힌트-작성" class="nav-link" data-scroll-target="#문제-1-수동-힌트-작성"><span class="header-section-number">2.1</span> 문제 1: 수동 힌트 작성</a></li>
  <li><a href="#문제-2-힌트-없이-직접-질문" id="toc-문제-2-힌트-없이-직접-질문" class="nav-link" data-scroll-target="#문제-2-힌트-없이-직접-질문"><span class="header-section-number">2.2</span> 문제 2: 힌트 없이 직접 질문</a></li>
  <li><a href="#해결책-directional-stimulus-prompting" id="toc-해결책-directional-stimulus-prompting" class="nav-link" data-scroll-target="#해결책-directional-stimulus-prompting"><span class="header-section-number">2.3</span> 해결책: Directional Stimulus Prompting</a></li>
  </ul></li>
  <li><a href="#directional-stimulus-prompting이란" id="toc-directional-stimulus-prompting이란" class="nav-link" data-scroll-target="#directional-stimulus-prompting이란"><span class="header-section-number">3</span> Directional Stimulus Prompting이란?</a>
  <ul class="collapse">
  <li><a href="#구조" id="toc-구조" class="nav-link" data-scroll-target="#구조"><span class="header-section-number">3.1</span> 구조</a></li>
  <li><a href="#핵심-아이디어" id="toc-핵심-아이디어" class="nav-link" data-scroll-target="#핵심-아이디어"><span class="header-section-number">3.2</span> 핵심 아이디어</a></li>
  </ul></li>
  <li><a href="#단계-프로세스" id="toc-단계-프로세스" class="nav-link" data-scroll-target="#단계-프로세스"><span class="header-section-number">4</span> 2단계 프로세스</a>
  <ul class="collapse">
  <li><a href="#policy-lm-튜닝" id="toc-policy-lm-튜닝" class="nav-link" data-scroll-target="#policy-lm-튜닝"><span class="header-section-number">4.1</span> Policy LM 튜닝</a></li>
  <li><a href="#stage-2-힌트-생성-및-적용" id="toc-stage-2-힌트-생성-및-적용" class="nav-link" data-scroll-target="#stage-2-힌트-생성-및-적용"><span class="header-section-number">4.2</span> Stage 2: 힌트 생성 및 적용</a></li>
  </ul></li>
  <li><a href="#전체-파이프라인-구현" id="toc-전체-파이프라인-구현" class="nav-link" data-scroll-target="#전체-파이프라인-구현"><span class="header-section-number">5</span> 전체 파이프라인 구현</a></li>
  <li><a href="#실행-결과-예시" id="toc-실행-결과-예시" class="nav-link" data-scroll-target="#실행-결과-예시"><span class="header-section-number">6</span> 실행 결과 예시</a></li>
  <li><a href="#실험-결과-분석" id="toc-실험-결과-분석" class="nav-link" data-scroll-target="#실험-결과-분석"><span class="header-section-number">7</span> 실험 결과 분석</a>
  <ul class="collapse">
  <li><a href="#벤치마크-성능" id="toc-벤치마크-성능" class="nav-link" data-scroll-target="#벤치마크-성능"><span class="header-section-number">7.1</span> 벤치마크 성능</a></li>
  <li><a href="#힌트-품질-분석" id="toc-힌트-품질-분석" class="nav-link" data-scroll-target="#힌트-품질-분석"><span class="header-section-number">7.2</span> 힌트 품질 분석</a></li>
  <li><a href="#다양한-힌트-유형" id="toc-다양한-힌트-유형" class="nav-link" data-scroll-target="#다양한-힌트-유형"><span class="header-section-number">7.3</span> 다양한 힌트 유형</a></li>
  </ul></li>
  <li><a href="#힌트-생성-전략-심화" id="toc-힌트-생성-전략-심화" class="nav-link" data-scroll-target="#힌트-생성-전략-심화"><span class="header-section-number">8</span> 힌트 생성 전략 심화</a>
  <ul class="collapse">
  <li><a href="#전략-1-템플릿-기반-힌트" id="toc-전략-1-템플릿-기반-힌트" class="nav-link" data-scroll-target="#전략-1-템플릿-기반-힌트"><span class="header-section-number">8.1</span> 전략 1: 템플릿 기반 힌트</a></li>
  <li><a href="#전략-2-예시-기반-학습" id="toc-전략-2-예시-기반-학습" class="nav-link" data-scroll-target="#전략-2-예시-기반-학습"><span class="header-section-number">8.2</span> 전략 2: 예시 기반 학습</a></li>
  <li><a href="#전략-3-강화학습-기반-최적화" id="toc-전략-3-강화학습-기반-최적화" class="nav-link" data-scroll-target="#전략-3-강화학습-기반-최적화"><span class="header-section-number">8.3</span> 전략 3: 강화학습 기반 최적화</a></li>
  </ul></li>
  <li><a href="#policy-lm-효율적-튜닝-방법" id="toc-policy-lm-효율적-튜닝-방법" class="nav-link" data-scroll-target="#policy-lm-효율적-튜닝-방법"><span class="header-section-number">9</span> Policy LM 효율적 튜닝 방법</a>
  <ul class="collapse">
  <li><a href="#방법-1-lora-low-rank-adaptation" id="toc-방법-1-lora-low-rank-adaptation" class="nav-link" data-scroll-target="#방법-1-lora-low-rank-adaptation"><span class="header-section-number">9.1</span> 방법 1: LoRA (Low-Rank Adaptation)</a></li>
  <li><a href="#방법-2-prompt-tuning" id="toc-방법-2-prompt-tuning" class="nav-link" data-scroll-target="#방법-2-prompt-tuning"><span class="header-section-number">9.2</span> 방법 2: Prompt Tuning</a></li>
  <li><a href="#방법-3-증류-distillation" id="toc-방법-3-증류-distillation" class="nav-link" data-scroll-target="#방법-3-증류-distillation"><span class="header-section-number">9.3</span> 방법 3: 증류 (Distillation)</a></li>
  </ul></li>
  <li><a href="#다양한-선택-전략-비교" id="toc-다양한-선택-전략-비교" class="nav-link" data-scroll-target="#다양한-선택-전략-비교"><span class="header-section-number">10</span> 다양한 선택 전략 비교</a>
  <ul class="collapse">
  <li><a href="#전략-비교표" id="toc-전략-비교표" class="nav-link" data-scroll-target="#전략-비교표"><span class="header-section-number">10.1</span> 전략 비교표</a></li>
  <li><a href="#실험-비교" id="toc-실험-비교" class="nav-link" data-scroll-target="#실험-비교"><span class="header-section-number">10.2</span> 실험 비교</a></li>
  </ul></li>
  <li><a href="#실무-적용-시나리오" id="toc-실무-적용-시나리오" class="nav-link" data-scroll-target="#실무-적용-시나리오"><span class="header-section-number">11</span> 실무 적용 시나리오</a>
  <ul class="collapse">
  <li><a href="#시나리오-1-고객-지원-챗봇" id="toc-시나리오-1-고객-지원-챗봇" class="nav-link" data-scroll-target="#시나리오-1-고객-지원-챗봇"><span class="header-section-number">11.1</span> 시나리오 1: 고객 지원 챗봇</a></li>
  <li><a href="#시나리오-2-교육-플랫폼" id="toc-시나리오-2-교육-플랫폼" class="nav-link" data-scroll-target="#시나리오-2-교육-플랫폼"><span class="header-section-number">11.2</span> 시나리오 2: 교육 플랫폼</a></li>
  <li><a href="#시나리오-3-의료-상담" id="toc-시나리오-3-의료-상담" class="nav-link" data-scroll-target="#시나리오-3-의료-상담"><span class="header-section-number">11.3</span> 시나리오 3: 의료 상담</a></li>
  </ul></li>
  <li><a href="#한계점-및-주의사항" id="toc-한계점-및-주의사항" class="nav-link" data-scroll-target="#한계점-및-주의사항"><span class="header-section-number">12</span> 한계점 및 주의사항</a>
  <ul class="collapse">
  <li><a href="#한계-1-policy-lm-의존성" id="toc-한계-1-policy-lm-의존성" class="nav-link" data-scroll-target="#한계-1-policy-lm-의존성"><span class="header-section-number">12.1</span> 한계 1: Policy LM 의존성</a></li>
  <li><a href="#한계-2-도메인-특화-필요" id="toc-한계-2-도메인-특화-필요" class="nav-link" data-scroll-target="#한계-2-도메인-특화-필요"><span class="header-section-number">12.2</span> 한계 2: 도메인 특화 필요</a></li>
  <li><a href="#한계-3-비용" id="toc-한계-3-비용" class="nav-link" data-scroll-target="#한계-3-비용"><span class="header-section-number">12.3</span> 한계 3: 비용</a></li>
  <li><a href="#한계-4-힌트가-항상-도움되는-것은-아님" id="toc-한계-4-힌트가-항상-도움되는-것은-아님" class="nav-link" data-scroll-target="#한계-4-힌트가-항상-도움되는-것은-아님"><span class="header-section-number">12.4</span> 한계 4: 힌트가 항상 도움되는 것은 아님</a></li>
  </ul></li>
  <li><a href="#베스트-프랙티스" id="toc-베스트-프랙티스" class="nav-link" data-scroll-target="#베스트-프랙티스"><span class="header-section-number">13</span> 베스트 프랙티스</a>
  <ul class="collapse">
  <li><a href="#힌트-품질-검증" id="toc-힌트-품질-검증" class="nav-link" data-scroll-target="#힌트-품질-검증"><span class="header-section-number">13.1</span> 1. 힌트 품질 검증</a></li>
  <li><a href="#점진적-도입" id="toc-점진적-도입" class="nav-link" data-scroll-target="#점진적-도입"><span class="header-section-number">13.2</span> 2. 점진적 도입</a></li>
  <li><a href="#ab-테스팅" id="toc-ab-테스팅" class="nav-link" data-scroll-target="#ab-테스팅"><span class="header-section-number">13.3</span> 3. A/B 테스팅</a></li>
  </ul></li>
  <li><a href="#다른-기법과의-비교" id="toc-다른-기법과의-비교" class="nav-link" data-scroll-target="#다른-기법과의-비교"><span class="header-section-number">14</span> 다른 기법과의 비교</a>
  <ul class="collapse">
  <li><a href="#directional-stimulus-vs-cot" id="toc-directional-stimulus-vs-cot" class="nav-link" data-scroll-target="#directional-stimulus-vs-cot"><span class="header-section-number">14.1</span> Directional Stimulus vs CoT</a></li>
  <li><a href="#directional-stimulus-vs-few-shot" id="toc-directional-stimulus-vs-few-shot" class="nav-link" data-scroll-target="#directional-stimulus-vs-few-shot"><span class="header-section-number">14.2</span> Directional Stimulus vs Few-shot</a></li>
  </ul></li>
  <li><a href="#정리-및-다음-포스트-예고" id="toc-정리-및-다음-포스트-예고" class="nav-link" data-scroll-target="#정리-및-다음-포스트-예고"><span class="header-section-number">15</span> 정리 및 다음 포스트 예고</a>
  <ul class="collapse">
  <li><a href="#핵심-요약" id="toc-핵심-요약" class="nav-link" data-scroll-target="#핵심-요약"><span class="header-section-number">15.1</span> 핵심 요약</a></li>
  <li><a href="#실무-권장사항" id="toc-실무-권장사항" class="nav-link" data-scroll-target="#실무-권장사항"><span class="header-section-number">15.2</span> 실무 권장사항</a></li>
  <li><a href="#다음-포스트-예고" id="toc-다음-포스트-예고" class="nav-link" data-scroll-target="#다음-포스트-예고"><span class="header-section-number">15.3</span> 다음 포스트 예고</a></li>
  </ul></li>
  <li><a href="#참고문헌" id="toc-참고문헌" class="nav-link" data-scroll-target="#참고문헌"><span class="header-section-number">16</span> 참고문헌</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block column-page-left" id="quarto-document-content">





<section id="들어가며" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="들어가며"><span class="header-section-number">1</span> 들어가며</h2>
<p>LLM에게 질문할 때, 때로는 <strong>방향성</strong>이 필요하다. “이 방향으로 생각해봐”, “이 관점을 고려해봐”와 같은 힌트가 있으면 더 나은 답변을 얻을 수 있다.</p>
<p>하지만 문제가 있다: <strong>어떤 힌트가 효과적인지 어떻게 알 수 있을까?</strong></p>
<p><strong>Directional Stimulus Prompting</strong>은 이 문제를 해결한다. 작은 튜닝된 모델(Policy LM)이 효과적인 힌트를 생성하고, 그 힌트를 사용하여 큰 블랙박스 LLM의 응답을 개선한다.</p>
</section>
<section id="기존-접근법의-문제점" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="기존-접근법의-문제점"><span class="header-section-number">2</span> 기존 접근법의 문제점</h2>
<section id="문제-1-수동-힌트-작성" class="level3" data-number="2.1">
<h3 data-number="2.1" class="anchored" data-anchor-id="문제-1-수동-힌트-작성"><span class="header-section-number">2.1</span> 문제 1: 수동 힌트 작성</h3>
<p><strong>현재 방식</strong>:</p>
<pre><code>사람이 직접 힌트 작성:
"이 문제를 풀기 위해 다음을 고려하세요..."

문제점:
- 시간 소모
- 전문 지식 필요
- 일관성 부족</code></pre>
<p><strong>예시</strong>:</p>
<pre><code>질문: "기후 변화가 북극곰에 미치는 영향은?"

수동 힌트 (사람):
"빙하 감소, 먹이 부족, 서식지 변화를 고려하세요."
→ 좋은 힌트지만, 모든 질문에 이렇게 작성하기 어려움</code></pre>
</section>
<section id="문제-2-힌트-없이-직접-질문" class="level3" data-number="2.2">
<h3 data-number="2.2" class="anchored" data-anchor-id="문제-2-힌트-없이-직접-질문"><span class="header-section-number">2.2</span> 문제 2: 힌트 없이 직접 질문</h3>
<p><strong>현재 방식</strong>:</p>
<pre><code>질문만 던지기:
"기후 변화가 북극곰에 미치는 영향은?"

문제점:
- 응답이 너무 일반적
- 중요한 측면 누락
- 깊이 부족</code></pre>
</section>
<section id="해결책-directional-stimulus-prompting" class="level3" data-number="2.3">
<h3 data-number="2.3" class="anchored" data-anchor-id="해결책-directional-stimulus-prompting"><span class="header-section-number">2.3</span> 해결책: Directional Stimulus Prompting</h3>
<pre><code>[작은 튜닝 모델] → 힌트 생성
                    ↓
[질문 + 힌트] → [큰 블랙박스 LLM] → 개선된 답변</code></pre>
</section>
</section>
<section id="directional-stimulus-prompting이란" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="directional-stimulus-prompting이란"><span class="header-section-number">3</span> Directional Stimulus Prompting이란?</h2>
<p>Li et al.&nbsp;(2023)이 제안한 기법으로, 두 개의 LM을 사용한다:</p>
<section id="구조" class="level3" data-number="3.1">
<h3 data-number="3.1" class="anchored" data-anchor-id="구조"><span class="header-section-number">3.1</span> 구조</h3>
<pre><code>┌─────────────────────────────────────────┐
│         Policy LM (작은 모델)            │
│    - 튜닝 가능                           │
│    - 힌트 생성 전문                       │
│    - 예: LLaMA-7B 튜닝                   │
└─────────────────────────────────────────┘
                   ↓
            Stimulus (힌트)
                   ↓
┌─────────────────────────────────────────┐
│         Target LM (큰 모델)              │
│    - 블랙박스 (API만)                     │
│    - 힌트로 유도                          │
│    - 예: GPT-4, Claude                  │
└─────────────────────────────────────────┘</code></pre>
</section>
<section id="핵심-아이디어" class="level3" data-number="3.2">
<h3 data-number="3.2" class="anchored" data-anchor-id="핵심-아이디어"><span class="header-section-number">3.2</span> 핵심 아이디어</h3>
<p><strong>Directional Stimulus (방향성 자극)</strong>: 응답을 특정 방향으로 유도하는 짧은 힌트</p>
<p><strong>예시</strong>:</p>
<pre><code>질문: "경제 침체를 극복하는 방법은?"

일반적 응답 (힌트 없음):
"정부는 재정 정책과 통화 정책을 통해 대응할 수 있습니다..."

Stimulus: "케인즈 경제학 관점에서"
→ 응답: "케인즈에 따르면, 정부 지출 증대가..."

Stimulus: "공급 측면 경제학 관점에서"  
→ 응답: "공급 측면에서는, 감세와 규제 완화가..."

Stimulus: "역사적 사례를 중심으로"
→ 응답: "대공황 때 루즈벨트의 뉴딜 정책처럼..."</code></pre>
</section>
</section>
<section id="단계-프로세스" class="level2" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="단계-프로세스"><span class="header-section-number">4</span> 2단계 프로세스</h2>
<section id="policy-lm-튜닝" class="level3" data-number="4.1">
<h3 data-number="4.1" class="anchored" data-anchor-id="policy-lm-튜닝"><span class="header-section-number">4.1</span> Policy LM 튜닝</h3>
<p>작은 모델을 <strong>힌트 생성 전문가</strong>로 튜닝한다.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1"></a><span class="im">import</span> anthropic</span>
<span id="cb7-2"><a href="#cb7-2"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict</span>
<span id="cb7-3"><a href="#cb7-3"></a><span class="im">import</span> json</span>
<span id="cb7-4"><a href="#cb7-4"></a></span>
<span id="cb7-5"><a href="#cb7-5"></a><span class="kw">class</span> DirectionalStimulusPrompting:</span>
<span id="cb7-6"><a href="#cb7-6"></a>    <span class="co">"""</span></span>
<span id="cb7-7"><a href="#cb7-7"></a><span class="co">    Directional Stimulus Prompting 구현</span></span>
<span id="cb7-8"><a href="#cb7-8"></a><span class="co">    """</span></span>
<span id="cb7-9"><a href="#cb7-9"></a>    </span>
<span id="cb7-10"><a href="#cb7-10"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(</span>
<span id="cb7-11"><a href="#cb7-11"></a>        <span class="va">self</span>,</span>
<span id="cb7-12"><a href="#cb7-12"></a>        policy_api_key: <span class="bu">str</span>,</span>
<span id="cb7-13"><a href="#cb7-13"></a>        target_api_key: <span class="bu">str</span>,</span>
<span id="cb7-14"><a href="#cb7-14"></a>        policy_model: <span class="bu">str</span> <span class="op">=</span> <span class="st">"claude-haiku-4-20250514"</span>,</span>
<span id="cb7-15"><a href="#cb7-15"></a>        target_model: <span class="bu">str</span> <span class="op">=</span> <span class="st">"claude-sonnet-4-20250514"</span></span>
<span id="cb7-16"><a href="#cb7-16"></a>    ):</span>
<span id="cb7-17"><a href="#cb7-17"></a>        <span class="co">"""</span></span>
<span id="cb7-18"><a href="#cb7-18"></a><span class="co">        Args:</span></span>
<span id="cb7-19"><a href="#cb7-19"></a><span class="co">            policy_api_key: Policy LM API 키</span></span>
<span id="cb7-20"><a href="#cb7-20"></a><span class="co">            target_api_key: Target LM API 키</span></span>
<span id="cb7-21"><a href="#cb7-21"></a><span class="co">            policy_model: 힌트 생성 모델 (작은 모델)</span></span>
<span id="cb7-22"><a href="#cb7-22"></a><span class="co">            target_model: 최종 답변 모델 (큰 모델)</span></span>
<span id="cb7-23"><a href="#cb7-23"></a><span class="co">        """</span></span>
<span id="cb7-24"><a href="#cb7-24"></a>        <span class="va">self</span>.policy_client <span class="op">=</span> anthropic.Anthropic(api_key<span class="op">=</span>policy_api_key)</span>
<span id="cb7-25"><a href="#cb7-25"></a>        <span class="va">self</span>.target_client <span class="op">=</span> anthropic.Anthropic(api_key<span class="op">=</span>target_api_key)</span>
<span id="cb7-26"><a href="#cb7-26"></a>        </span>
<span id="cb7-27"><a href="#cb7-27"></a>        <span class="va">self</span>.policy_model <span class="op">=</span> policy_model</span>
<span id="cb7-28"><a href="#cb7-28"></a>        <span class="va">self</span>.target_model <span class="op">=</span> target_model</span>
<span id="cb7-29"><a href="#cb7-29"></a>        </span>
<span id="cb7-30"><a href="#cb7-30"></a>        <span class="bu">print</span>(<span class="ss">f"✅ Directional Stimulus Prompting 초기화"</span>)</span>
<span id="cb7-31"><a href="#cb7-31"></a>        <span class="bu">print</span>(<span class="ss">f"   Policy LM: </span><span class="sc">{</span>policy_model<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb7-32"><a href="#cb7-32"></a>        <span class="bu">print</span>(<span class="ss">f"   Target LM: </span><span class="sc">{</span>target_model<span class="sc">}</span><span class="ch">\n</span><span class="ss">"</span>)</span>
<span id="cb7-33"><a href="#cb7-33"></a>    </span>
<span id="cb7-34"><a href="#cb7-34"></a>    <span class="kw">def</span> prepare_training_data(</span>
<span id="cb7-35"><a href="#cb7-35"></a>        <span class="va">self</span>,</span>
<span id="cb7-36"><a href="#cb7-36"></a>        examples: List[Dict[<span class="bu">str</span>, <span class="bu">str</span>]]</span>
<span id="cb7-37"><a href="#cb7-37"></a>    ) <span class="op">-&gt;</span> List[Dict]:</span>
<span id="cb7-38"><a href="#cb7-38"></a>        <span class="co">"""</span></span>
<span id="cb7-39"><a href="#cb7-39"></a><span class="co">        Policy LM 튜닝을 위한 데이터 준비</span></span>
<span id="cb7-40"><a href="#cb7-40"></a><span class="co">        </span></span>
<span id="cb7-41"><a href="#cb7-41"></a><span class="co">        Args:</span></span>
<span id="cb7-42"><a href="#cb7-42"></a><span class="co">            examples: [</span></span>
<span id="cb7-43"><a href="#cb7-43"></a><span class="co">                {</span></span>
<span id="cb7-44"><a href="#cb7-44"></a><span class="co">                    'question': '...',</span></span>
<span id="cb7-45"><a href="#cb7-45"></a><span class="co">                    'good_stimulus': '...',  # 좋은 힌트</span></span>
<span id="cb7-46"><a href="#cb7-46"></a><span class="co">                    'expected_answer': '...'</span></span>
<span id="cb7-47"><a href="#cb7-47"></a><span class="co">                },</span></span>
<span id="cb7-48"><a href="#cb7-48"></a><span class="co">                ...</span></span>
<span id="cb7-49"><a href="#cb7-49"></a><span class="co">            ]</span></span>
<span id="cb7-50"><a href="#cb7-50"></a><span class="co">        </span></span>
<span id="cb7-51"><a href="#cb7-51"></a><span class="co">        Returns:</span></span>
<span id="cb7-52"><a href="#cb7-52"></a><span class="co">            튜닝 데이터</span></span>
<span id="cb7-53"><a href="#cb7-53"></a><span class="co">        """</span></span>
<span id="cb7-54"><a href="#cb7-54"></a>        training_data <span class="op">=</span> []</span>
<span id="cb7-55"><a href="#cb7-55"></a>        </span>
<span id="cb7-56"><a href="#cb7-56"></a>        <span class="cf">for</span> example <span class="kw">in</span> examples:</span>
<span id="cb7-57"><a href="#cb7-57"></a>            <span class="co"># 프롬프트 형식</span></span>
<span id="cb7-58"><a href="#cb7-58"></a>            prompt <span class="op">=</span> <span class="ss">f"""질문에 대한 효과적인 힌트를 생성하세요.</span></span>
<span id="cb7-59"><a href="#cb7-59"></a><span class="ss">            힌트는 짧고(10-20단어), 구체적이며, 답변의 방향을 제시해야 합니다.</span></span>
<span id="cb7-60"><a href="#cb7-60"></a></span>
<span id="cb7-61"><a href="#cb7-61"></a><span class="ss">            질문: </span><span class="sc">{</span>example[<span class="st">'question'</span>]<span class="sc">}</span></span>
<span id="cb7-62"><a href="#cb7-62"></a></span>
<span id="cb7-63"><a href="#cb7-63"></a><span class="ss">            힌트:"""</span></span>
<span id="cb7-64"><a href="#cb7-64"></a>            </span>
<span id="cb7-65"><a href="#cb7-65"></a>            training_data.append({</span>
<span id="cb7-66"><a href="#cb7-66"></a>                <span class="st">'prompt'</span>: prompt,</span>
<span id="cb7-67"><a href="#cb7-67"></a>                <span class="st">'completion'</span>: example[<span class="st">'good_stimulus'</span>]</span>
<span id="cb7-68"><a href="#cb7-68"></a>            })</span>
<span id="cb7-69"><a href="#cb7-69"></a>        </span>
<span id="cb7-70"><a href="#cb7-70"></a>        <span class="cf">return</span> training_data</span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>튜닝 데이터 예시</strong>:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1"></a>tuning_examples <span class="op">=</span> [</span>
<span id="cb8-2"><a href="#cb8-2"></a>    {</span>
<span id="cb8-3"><a href="#cb8-3"></a>        <span class="st">'question'</span>: <span class="st">'재생 에너지의 장단점은?'</span>,</span>
<span id="cb8-4"><a href="#cb8-4"></a>        <span class="st">'good_stimulus'</span>: <span class="st">'경제성, 환경 영향, 기술적 한계를 각각 분석하세요.'</span>,</span>
<span id="cb8-5"><a href="#cb8-5"></a>        <span class="st">'expected_answer'</span>: <span class="st">'...'</span></span>
<span id="cb8-6"><a href="#cb8-6"></a>    },</span>
<span id="cb8-7"><a href="#cb8-7"></a>    {</span>
<span id="cb8-8"><a href="#cb8-8"></a>        <span class="st">'question'</span>: <span class="st">'인공지능 윤리의 중요성은?'</span>,</span>
<span id="cb8-9"><a href="#cb8-9"></a>        <span class="st">'good_stimulus'</span>: <span class="st">'구체적인 사례와 잠재적 위험을 중심으로 설명하세요.'</span>,</span>
<span id="cb8-10"><a href="#cb8-10"></a>        <span class="st">'expected_answer'</span>: <span class="st">'...'</span></span>
<span id="cb8-11"><a href="#cb8-11"></a>    },</span>
<span id="cb8-12"><a href="#cb8-12"></a>    {</span>
<span id="cb8-13"><a href="#cb8-13"></a>        <span class="st">'question'</span>: <span class="st">'양자 컴퓨터의 작동 원리는?'</span>,</span>
<span id="cb8-14"><a href="#cb8-14"></a>        <span class="st">'good_stimulus'</span>: <span class="st">'고전 컴퓨터와 비교하며 중첩과 얽힘 개념을 설명하세요.'</span>,</span>
<span id="cb8-15"><a href="#cb8-15"></a>        <span class="st">'expected_answer'</span>: <span class="st">'...'</span></span>
<span id="cb8-16"><a href="#cb8-16"></a>    }</span>
<span id="cb8-17"><a href="#cb8-17"></a>]</span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="stage-2-힌트-생성-및-적용" class="level3" data-number="4.2">
<h3 data-number="4.2" class="anchored" data-anchor-id="stage-2-힌트-생성-및-적용"><span class="header-section-number">4.2</span> Stage 2: 힌트 생성 및 적용</h3>
<p>튜닝된 Policy LM으로 힌트를 생성하고, Target LM에 적용한다.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1"></a>    <span class="kw">def</span> generate_stimulus(</span>
<span id="cb9-2"><a href="#cb9-2"></a>        <span class="va">self</span>,</span>
<span id="cb9-3"><a href="#cb9-3"></a>        question: <span class="bu">str</span>,</span>
<span id="cb9-4"><a href="#cb9-4"></a>        num_candidates: <span class="bu">int</span> <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb9-5"><a href="#cb9-5"></a>    ) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb9-6"><a href="#cb9-6"></a>        <span class="co">"""</span></span>
<span id="cb9-7"><a href="#cb9-7"></a><span class="co">        Policy LM으로 힌트 후보 생성</span></span>
<span id="cb9-8"><a href="#cb9-8"></a><span class="co">        </span></span>
<span id="cb9-9"><a href="#cb9-9"></a><span class="co">        Args:</span></span>
<span id="cb9-10"><a href="#cb9-10"></a><span class="co">            question: 질문</span></span>
<span id="cb9-11"><a href="#cb9-11"></a><span class="co">            num_candidates: 생성할 힌트 후보 수</span></span>
<span id="cb9-12"><a href="#cb9-12"></a><span class="co">        </span></span>
<span id="cb9-13"><a href="#cb9-13"></a><span class="co">        Returns:</span></span>
<span id="cb9-14"><a href="#cb9-14"></a><span class="co">            힌트 후보들</span></span>
<span id="cb9-15"><a href="#cb9-15"></a><span class="co">        """</span></span>
<span id="cb9-16"><a href="#cb9-16"></a>        prompt <span class="op">=</span> <span class="ss">f"""질문에 대한 효과적인 힌트를 </span><span class="sc">{</span>num_candidates<span class="sc">}</span><span class="ss">개 생성하세요.</span></span>
<span id="cb9-17"><a href="#cb9-17"></a><span class="ss">        각 힌트는:</span></span>
<span id="cb9-18"><a href="#cb9-18"></a><span class="ss">        - 10-20단어로 간결</span></span>
<span id="cb9-19"><a href="#cb9-19"></a><span class="ss">        - 구체적인 방향 제시</span></span>
<span id="cb9-20"><a href="#cb9-20"></a><span class="ss">        - 서로 다른 관점</span></span>
<span id="cb9-21"><a href="#cb9-21"></a></span>
<span id="cb9-22"><a href="#cb9-22"></a><span class="ss">        질문: </span><span class="sc">{</span>question<span class="sc">}</span></span>
<span id="cb9-23"><a href="#cb9-23"></a></span>
<span id="cb9-24"><a href="#cb9-24"></a><span class="ss">        힌트 </span><span class="sc">{</span>num_candidates<span class="sc">}</span><span class="ss">개 (한 줄씩):</span></span>
<span id="cb9-25"><a href="#cb9-25"></a><span class="ss">        1."""</span></span>
<span id="cb9-26"><a href="#cb9-26"></a>        </span>
<span id="cb9-27"><a href="#cb9-27"></a>        message <span class="op">=</span> <span class="va">self</span>.policy_client.messages.create(</span>
<span id="cb9-28"><a href="#cb9-28"></a>            model<span class="op">=</span><span class="va">self</span>.policy_model,</span>
<span id="cb9-29"><a href="#cb9-29"></a>            max_tokens<span class="op">=</span><span class="dv">500</span>,</span>
<span id="cb9-30"><a href="#cb9-30"></a>            temperature<span class="op">=</span><span class="fl">0.8</span>,  <span class="co"># 다양성을 위해</span></span>
<span id="cb9-31"><a href="#cb9-31"></a>            messages<span class="op">=</span>[{<span class="st">"role"</span>: <span class="st">"user"</span>, <span class="st">"content"</span>: prompt}]</span>
<span id="cb9-32"><a href="#cb9-32"></a>        )</span>
<span id="cb9-33"><a href="#cb9-33"></a>        </span>
<span id="cb9-34"><a href="#cb9-34"></a>        response <span class="op">=</span> message.content[<span class="dv">0</span>].text</span>
<span id="cb9-35"><a href="#cb9-35"></a>        </span>
<span id="cb9-36"><a href="#cb9-36"></a>        <span class="co"># 힌트 파싱</span></span>
<span id="cb9-37"><a href="#cb9-37"></a>        stimuli <span class="op">=</span> []</span>
<span id="cb9-38"><a href="#cb9-38"></a>        <span class="cf">for</span> line <span class="kw">in</span> response.split(<span class="st">'</span><span class="ch">\n</span><span class="st">'</span>):</span>
<span id="cb9-39"><a href="#cb9-39"></a>            <span class="im">import</span> re</span>
<span id="cb9-40"><a href="#cb9-40"></a>            <span class="co"># 번호 제거</span></span>
<span id="cb9-41"><a href="#cb9-41"></a>            line <span class="op">=</span> re.sub(<span class="vs">r'^\d+\.\s*'</span>, <span class="st">''</span>, line.strip())</span>
<span id="cb9-42"><a href="#cb9-42"></a>            </span>
<span id="cb9-43"><a href="#cb9-43"></a>            <span class="cf">if</span> line <span class="kw">and</span> <span class="bu">len</span>(line) <span class="op">&gt;</span> <span class="dv">10</span>:</span>
<span id="cb9-44"><a href="#cb9-44"></a>                stimuli.append(line)</span>
<span id="cb9-45"><a href="#cb9-45"></a>        </span>
<span id="cb9-46"><a href="#cb9-46"></a>        <span class="cf">return</span> stimuli[:num_candidates]</span>
<span id="cb9-47"><a href="#cb9-47"></a>    </span>
<span id="cb9-48"><a href="#cb9-48"></a>    <span class="kw">def</span> answer_with_stimulus(</span>
<span id="cb9-49"><a href="#cb9-49"></a>        <span class="va">self</span>,</span>
<span id="cb9-50"><a href="#cb9-50"></a>        question: <span class="bu">str</span>,</span>
<span id="cb9-51"><a href="#cb9-51"></a>        stimulus: <span class="bu">str</span></span>
<span id="cb9-52"><a href="#cb9-52"></a>    ) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb9-53"><a href="#cb9-53"></a>        <span class="co">"""</span></span>
<span id="cb9-54"><a href="#cb9-54"></a><span class="co">        힌트를 사용하여 Target LM으로 답변 생성</span></span>
<span id="cb9-55"><a href="#cb9-55"></a><span class="co">        </span></span>
<span id="cb9-56"><a href="#cb9-56"></a><span class="co">        Args:</span></span>
<span id="cb9-57"><a href="#cb9-57"></a><span class="co">            question: 질문</span></span>
<span id="cb9-58"><a href="#cb9-58"></a><span class="co">            stimulus: 힌트</span></span>
<span id="cb9-59"><a href="#cb9-59"></a><span class="co">        </span></span>
<span id="cb9-60"><a href="#cb9-60"></a><span class="co">        Returns:</span></span>
<span id="cb9-61"><a href="#cb9-61"></a><span class="co">            답변</span></span>
<span id="cb9-62"><a href="#cb9-62"></a><span class="co">        """</span></span>
<span id="cb9-63"><a href="#cb9-63"></a>        <span class="co"># 힌트가 포함된 프롬프트 구성</span></span>
<span id="cb9-64"><a href="#cb9-64"></a>        prompt <span class="op">=</span> <span class="ss">f"""다음 힌트를 고려하여 질문에 답변하세요:</span></span>
<span id="cb9-65"><a href="#cb9-65"></a></span>
<span id="cb9-66"><a href="#cb9-66"></a><span class="ss">        힌트: </span><span class="sc">{</span>stimulus<span class="sc">}</span></span>
<span id="cb9-67"><a href="#cb9-67"></a></span>
<span id="cb9-68"><a href="#cb9-68"></a><span class="ss">        질문: </span><span class="sc">{</span>question<span class="sc">}</span></span>
<span id="cb9-69"><a href="#cb9-69"></a></span>
<span id="cb9-70"><a href="#cb9-70"></a><span class="ss">        답변:"""</span></span>
<span id="cb9-71"><a href="#cb9-71"></a>        </span>
<span id="cb9-72"><a href="#cb9-72"></a>        message <span class="op">=</span> <span class="va">self</span>.target_client.messages.create(</span>
<span id="cb9-73"><a href="#cb9-73"></a>            model<span class="op">=</span><span class="va">self</span>.target_model,</span>
<span id="cb9-74"><a href="#cb9-74"></a>            max_tokens<span class="op">=</span><span class="dv">1000</span>,</span>
<span id="cb9-75"><a href="#cb9-75"></a>            temperature<span class="op">=</span><span class="dv">0</span>,</span>
<span id="cb9-76"><a href="#cb9-76"></a>            messages<span class="op">=</span>[{<span class="st">"role"</span>: <span class="st">"user"</span>, <span class="st">"content"</span>: prompt}]</span>
<span id="cb9-77"><a href="#cb9-77"></a>        )</span>
<span id="cb9-78"><a href="#cb9-78"></a>        </span>
<span id="cb9-79"><a href="#cb9-79"></a>        <span class="cf">return</span> message.content[<span class="dv">0</span>].text</span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="전체-파이프라인-구현" class="level2" data-number="5">
<h2 data-number="5" class="anchored" data-anchor-id="전체-파이프라인-구현"><span class="header-section-number">5</span> 전체 파이프라인 구현</h2>
<div class="sourceCode" id="cb10"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1"></a>    <span class="kw">def</span> directional_stimulus_pipeline(</span>
<span id="cb10-2"><a href="#cb10-2"></a>        <span class="va">self</span>,</span>
<span id="cb10-3"><a href="#cb10-3"></a>        question: <span class="bu">str</span>,</span>
<span id="cb10-4"><a href="#cb10-4"></a>        num_stimulus_candidates: <span class="bu">int</span> <span class="op">=</span> <span class="dv">5</span>,</span>
<span id="cb10-5"><a href="#cb10-5"></a>        selection_method: <span class="bu">str</span> <span class="op">=</span> <span class="st">"quality"</span></span>
<span id="cb10-6"><a href="#cb10-6"></a>    ) <span class="op">-&gt;</span> Dict:</span>
<span id="cb10-7"><a href="#cb10-7"></a>        <span class="co">"""</span></span>
<span id="cb10-8"><a href="#cb10-8"></a><span class="co">        Directional Stimulus Prompting 전체 파이프라인</span></span>
<span id="cb10-9"><a href="#cb10-9"></a><span class="co">        </span></span>
<span id="cb10-10"><a href="#cb10-10"></a><span class="co">        Args:</span></span>
<span id="cb10-11"><a href="#cb10-11"></a><span class="co">            question: 질문</span></span>
<span id="cb10-12"><a href="#cb10-12"></a><span class="co">            num_stimulus_candidates: 생성할 힌트 후보 수</span></span>
<span id="cb10-13"><a href="#cb10-13"></a><span class="co">            selection_method: 힌트 선택 방법</span></span>
<span id="cb10-14"><a href="#cb10-14"></a><span class="co">                - "quality": 품질 평가로 선택</span></span>
<span id="cb10-15"><a href="#cb10-15"></a><span class="co">                - "diversity": 다양성 기반 선택</span></span>
<span id="cb10-16"><a href="#cb10-16"></a><span class="co">                - "ensemble": 모든 힌트 사용 후 결합</span></span>
<span id="cb10-17"><a href="#cb10-17"></a><span class="co">        </span></span>
<span id="cb10-18"><a href="#cb10-18"></a><span class="co">        Returns:</span></span>
<span id="cb10-19"><a href="#cb10-19"></a><span class="co">            결과 딕셔너리</span></span>
<span id="cb10-20"><a href="#cb10-20"></a><span class="co">        """</span></span>
<span id="cb10-21"><a href="#cb10-21"></a>        <span class="bu">print</span>(<span class="ss">f"🎯 Directional Stimulus Prompting"</span>)</span>
<span id="cb10-22"><a href="#cb10-22"></a>        <span class="bu">print</span>(<span class="ss">f"   질문: </span><span class="sc">{</span>question<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb10-23"><a href="#cb10-23"></a>        <span class="bu">print</span>(<span class="ss">f"   선택 방법: </span><span class="sc">{</span>selection_method<span class="sc">}</span><span class="ch">\n</span><span class="ss">"</span>)</span>
<span id="cb10-24"><a href="#cb10-24"></a>        </span>
<span id="cb10-25"><a href="#cb10-25"></a>        <span class="co"># Step 1: 힌트 후보 생성</span></span>
<span id="cb10-26"><a href="#cb10-26"></a>        <span class="bu">print</span>(<span class="st">"Step 1: 힌트 생성"</span>)</span>
<span id="cb10-27"><a href="#cb10-27"></a>        <span class="bu">print</span>(<span class="st">"-"</span> <span class="op">*</span> <span class="dv">80</span>)</span>
<span id="cb10-28"><a href="#cb10-28"></a>        </span>
<span id="cb10-29"><a href="#cb10-29"></a>        stimuli <span class="op">=</span> <span class="va">self</span>.generate_stimulus(question, num_stimulus_candidates)</span>
<span id="cb10-30"><a href="#cb10-30"></a>        </span>
<span id="cb10-31"><a href="#cb10-31"></a>        <span class="bu">print</span>(<span class="ss">f"✅ </span><span class="sc">{</span><span class="bu">len</span>(stimuli)<span class="sc">}</span><span class="ss">개 힌트 생성:"</span>)</span>
<span id="cb10-32"><a href="#cb10-32"></a>        <span class="cf">for</span> i, s <span class="kw">in</span> <span class="bu">enumerate</span>(stimuli, <span class="dv">1</span>):</span>
<span id="cb10-33"><a href="#cb10-33"></a>            <span class="bu">print</span>(<span class="ss">f"   [</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">] </span><span class="sc">{</span>s<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb10-34"><a href="#cb10-34"></a>        <span class="bu">print</span>()</span>
<span id="cb10-35"><a href="#cb10-35"></a>        </span>
<span id="cb10-36"><a href="#cb10-36"></a>        <span class="co"># Step 2: 힌트 선택 또는 사용</span></span>
<span id="cb10-37"><a href="#cb10-37"></a>        <span class="cf">if</span> selection_method <span class="op">==</span> <span class="st">"quality"</span>:</span>
<span id="cb10-38"><a href="#cb10-38"></a>            <span class="co"># 각 힌트로 답변 생성 후 품질 평가</span></span>
<span id="cb10-39"><a href="#cb10-39"></a>            <span class="bu">print</span>(<span class="st">"Step 2: 힌트 품질 평가"</span>)</span>
<span id="cb10-40"><a href="#cb10-40"></a>            <span class="bu">print</span>(<span class="st">"-"</span> <span class="op">*</span> <span class="dv">80</span>)</span>
<span id="cb10-41"><a href="#cb10-41"></a>            </span>
<span id="cb10-42"><a href="#cb10-42"></a>            best_stimulus <span class="op">=</span> <span class="va">self</span>._select_best_stimulus(question, stimuli)</span>
<span id="cb10-43"><a href="#cb10-43"></a>            </span>
<span id="cb10-44"><a href="#cb10-44"></a>            <span class="bu">print</span>(<span class="ss">f"✅ 최고 품질 힌트 선택:"</span>)</span>
<span id="cb10-45"><a href="#cb10-45"></a>            <span class="bu">print</span>(<span class="ss">f"   </span><span class="sc">{</span>best_stimulus<span class="sc">}</span><span class="ch">\n</span><span class="ss">"</span>)</span>
<span id="cb10-46"><a href="#cb10-46"></a>            </span>
<span id="cb10-47"><a href="#cb10-47"></a>            <span class="co"># Step 3: 최종 답변 생성</span></span>
<span id="cb10-48"><a href="#cb10-48"></a>            <span class="bu">print</span>(<span class="st">"Step 3: 최종 답변 생성"</span>)</span>
<span id="cb10-49"><a href="#cb10-49"></a>            <span class="bu">print</span>(<span class="st">"-"</span> <span class="op">*</span> <span class="dv">80</span>)</span>
<span id="cb10-50"><a href="#cb10-50"></a>            </span>
<span id="cb10-51"><a href="#cb10-51"></a>            final_answer <span class="op">=</span> <span class="va">self</span>.answer_with_stimulus(question, best_stimulus)</span>
<span id="cb10-52"><a href="#cb10-52"></a>            </span>
<span id="cb10-53"><a href="#cb10-53"></a>            <span class="cf">return</span> {</span>
<span id="cb10-54"><a href="#cb10-54"></a>                <span class="st">'question'</span>: question,</span>
<span id="cb10-55"><a href="#cb10-55"></a>                <span class="st">'stimuli_candidates'</span>: stimuli,</span>
<span id="cb10-56"><a href="#cb10-56"></a>                <span class="st">'selected_stimulus'</span>: best_stimulus,</span>
<span id="cb10-57"><a href="#cb10-57"></a>                <span class="st">'final_answer'</span>: final_answer,</span>
<span id="cb10-58"><a href="#cb10-58"></a>                <span class="st">'method'</span>: <span class="st">'quality'</span></span>
<span id="cb10-59"><a href="#cb10-59"></a>            }</span>
<span id="cb10-60"><a href="#cb10-60"></a>        </span>
<span id="cb10-61"><a href="#cb10-61"></a>        <span class="cf">elif</span> selection_method <span class="op">==</span> <span class="st">"diversity"</span>:</span>
<span id="cb10-62"><a href="#cb10-62"></a>            <span class="co"># 다양성 기반 선택</span></span>
<span id="cb10-63"><a href="#cb10-63"></a>            <span class="bu">print</span>(<span class="st">"Step 2: 다양성 기반 선택"</span>)</span>
<span id="cb10-64"><a href="#cb10-64"></a>            <span class="bu">print</span>(<span class="st">"-"</span> <span class="op">*</span> <span class="dv">80</span>)</span>
<span id="cb10-65"><a href="#cb10-65"></a>            </span>
<span id="cb10-66"><a href="#cb10-66"></a>            diverse_stimuli <span class="op">=</span> <span class="va">self</span>._select_diverse_stimuli(stimuli, k<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb10-67"><a href="#cb10-67"></a>            </span>
<span id="cb10-68"><a href="#cb10-68"></a>            <span class="bu">print</span>(<span class="ss">f"✅ 다양한 힌트 </span><span class="sc">{</span><span class="bu">len</span>(diverse_stimuli)<span class="sc">}</span><span class="ss">개 선택</span><span class="ch">\n</span><span class="ss">"</span>)</span>
<span id="cb10-69"><a href="#cb10-69"></a>            </span>
<span id="cb10-70"><a href="#cb10-70"></a>            <span class="co"># 각각으로 답변 생성</span></span>
<span id="cb10-71"><a href="#cb10-71"></a>            answers <span class="op">=</span> []</span>
<span id="cb10-72"><a href="#cb10-72"></a>            <span class="cf">for</span> stimulus <span class="kw">in</span> diverse_stimuli:</span>
<span id="cb10-73"><a href="#cb10-73"></a>                answer <span class="op">=</span> <span class="va">self</span>.answer_with_stimulus(question, stimulus)</span>
<span id="cb10-74"><a href="#cb10-74"></a>                answers.append({</span>
<span id="cb10-75"><a href="#cb10-75"></a>                    <span class="st">'stimulus'</span>: stimulus,</span>
<span id="cb10-76"><a href="#cb10-76"></a>                    <span class="st">'answer'</span>: answer</span>
<span id="cb10-77"><a href="#cb10-77"></a>                })</span>
<span id="cb10-78"><a href="#cb10-78"></a>            </span>
<span id="cb10-79"><a href="#cb10-79"></a>            <span class="cf">return</span> {</span>
<span id="cb10-80"><a href="#cb10-80"></a>                <span class="st">'question'</span>: question,</span>
<span id="cb10-81"><a href="#cb10-81"></a>                <span class="st">'stimuli_candidates'</span>: stimuli,</span>
<span id="cb10-82"><a href="#cb10-82"></a>                <span class="st">'diverse_stimuli'</span>: diverse_stimuli,</span>
<span id="cb10-83"><a href="#cb10-83"></a>                <span class="st">'answers'</span>: answers,</span>
<span id="cb10-84"><a href="#cb10-84"></a>                <span class="st">'method'</span>: <span class="st">'diversity'</span></span>
<span id="cb10-85"><a href="#cb10-85"></a>            }</span>
<span id="cb10-86"><a href="#cb10-86"></a>        </span>
<span id="cb10-87"><a href="#cb10-87"></a>        <span class="cf">elif</span> selection_method <span class="op">==</span> <span class="st">"ensemble"</span>:</span>
<span id="cb10-88"><a href="#cb10-88"></a>            <span class="co"># 모든 힌트 사용 후 결합</span></span>
<span id="cb10-89"><a href="#cb10-89"></a>            <span class="bu">print</span>(<span class="st">"Step 2: Ensemble - 모든 힌트 사용"</span>)</span>
<span id="cb10-90"><a href="#cb10-90"></a>            <span class="bu">print</span>(<span class="st">"-"</span> <span class="op">*</span> <span class="dv">80</span>)</span>
<span id="cb10-91"><a href="#cb10-91"></a>            </span>
<span id="cb10-92"><a href="#cb10-92"></a>            answers <span class="op">=</span> []</span>
<span id="cb10-93"><a href="#cb10-93"></a>            <span class="cf">for</span> i, stimulus <span class="kw">in</span> <span class="bu">enumerate</span>(stimuli, <span class="dv">1</span>):</span>
<span id="cb10-94"><a href="#cb10-94"></a>                <span class="bu">print</span>(<span class="ss">f"[</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">/</span><span class="sc">{</span><span class="bu">len</span>(stimuli)<span class="sc">}</span><span class="ss">] 힌트로 답변 생성 중..."</span>)</span>
<span id="cb10-95"><a href="#cb10-95"></a>                answer <span class="op">=</span> <span class="va">self</span>.answer_with_stimulus(question, stimulus)</span>
<span id="cb10-96"><a href="#cb10-96"></a>                answers.append(answer)</span>
<span id="cb10-97"><a href="#cb10-97"></a>            </span>
<span id="cb10-98"><a href="#cb10-98"></a>            <span class="bu">print</span>(<span class="ss">f"✅ </span><span class="sc">{</span><span class="bu">len</span>(answers)<span class="sc">}</span><span class="ss">개 답변 생성 완료</span><span class="ch">\n</span><span class="ss">"</span>)</span>
<span id="cb10-99"><a href="#cb10-99"></a>            </span>
<span id="cb10-100"><a href="#cb10-100"></a>            <span class="co"># Step 3: 답변 결합</span></span>
<span id="cb10-101"><a href="#cb10-101"></a>            <span class="bu">print</span>(<span class="st">"Step 3: 답변 결합"</span>)</span>
<span id="cb10-102"><a href="#cb10-102"></a>            <span class="bu">print</span>(<span class="st">"-"</span> <span class="op">*</span> <span class="dv">80</span>)</span>
<span id="cb10-103"><a href="#cb10-103"></a>            </span>
<span id="cb10-104"><a href="#cb10-104"></a>            ensemble_answer <span class="op">=</span> <span class="va">self</span>._ensemble_answers(question, answers)</span>
<span id="cb10-105"><a href="#cb10-105"></a>            </span>
<span id="cb10-106"><a href="#cb10-106"></a>            <span class="cf">return</span> {</span>
<span id="cb10-107"><a href="#cb10-107"></a>                <span class="st">'question'</span>: question,</span>
<span id="cb10-108"><a href="#cb10-108"></a>                <span class="st">'stimuli_candidates'</span>: stimuli,</span>
<span id="cb10-109"><a href="#cb10-109"></a>                <span class="st">'individual_answers'</span>: answers,</span>
<span id="cb10-110"><a href="#cb10-110"></a>                <span class="st">'ensemble_answer'</span>: ensemble_answer,</span>
<span id="cb10-111"><a href="#cb10-111"></a>                <span class="st">'method'</span>: <span class="st">'ensemble'</span></span>
<span id="cb10-112"><a href="#cb10-112"></a>            }</span>
<span id="cb10-113"><a href="#cb10-113"></a>    </span>
<span id="cb10-114"><a href="#cb10-114"></a>    <span class="kw">def</span> _select_best_stimulus(</span>
<span id="cb10-115"><a href="#cb10-115"></a>        <span class="va">self</span>,</span>
<span id="cb10-116"><a href="#cb10-116"></a>        question: <span class="bu">str</span>,</span>
<span id="cb10-117"><a href="#cb10-117"></a>        stimuli: List[<span class="bu">str</span>]</span>
<span id="cb10-118"><a href="#cb10-118"></a>    ) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb10-119"><a href="#cb10-119"></a>        <span class="co">"""</span></span>
<span id="cb10-120"><a href="#cb10-120"></a><span class="co">        품질 평가로 최고의 힌트 선택</span></span>
<span id="cb10-121"><a href="#cb10-121"></a><span class="co">        """</span></span>
<span id="cb10-122"><a href="#cb10-122"></a>        scores <span class="op">=</span> []</span>
<span id="cb10-123"><a href="#cb10-123"></a>        </span>
<span id="cb10-124"><a href="#cb10-124"></a>        <span class="cf">for</span> stimulus <span class="kw">in</span> stimuli:</span>
<span id="cb10-125"><a href="#cb10-125"></a>            <span class="co"># 각 힌트로 답변 생성</span></span>
<span id="cb10-126"><a href="#cb10-126"></a>            answer <span class="op">=</span> <span class="va">self</span>.answer_with_stimulus(question, stimulus)</span>
<span id="cb10-127"><a href="#cb10-127"></a>            </span>
<span id="cb10-128"><a href="#cb10-128"></a>            <span class="co"># 답변 품질 평가</span></span>
<span id="cb10-129"><a href="#cb10-129"></a>            score <span class="op">=</span> <span class="va">self</span>._evaluate_answer_quality(question, answer)</span>
<span id="cb10-130"><a href="#cb10-130"></a>            scores.append(score)</span>
<span id="cb10-131"><a href="#cb10-131"></a>            </span>
<span id="cb10-132"><a href="#cb10-132"></a>            <span class="bu">print</span>(<span class="ss">f"   힌트: </span><span class="sc">{</span>stimulus[:<span class="dv">50</span>]<span class="sc">}</span><span class="ss">..."</span>)</span>
<span id="cb10-133"><a href="#cb10-133"></a>            <span class="bu">print</span>(<span class="ss">f"   점수: </span><span class="sc">{</span>score<span class="sc">:.3f}</span><span class="ss">"</span>)</span>
<span id="cb10-134"><a href="#cb10-134"></a>        </span>
<span id="cb10-135"><a href="#cb10-135"></a>        <span class="co"># 최고 점수의 힌트 선택</span></span>
<span id="cb10-136"><a href="#cb10-136"></a>        best_idx <span class="op">=</span> scores.index(<span class="bu">max</span>(scores))</span>
<span id="cb10-137"><a href="#cb10-137"></a>        <span class="cf">return</span> stimuli[best_idx]</span>
<span id="cb10-138"><a href="#cb10-138"></a>    </span>
<span id="cb10-139"><a href="#cb10-139"></a>    <span class="kw">def</span> _evaluate_answer_quality(</span>
<span id="cb10-140"><a href="#cb10-140"></a>        <span class="va">self</span>,</span>
<span id="cb10-141"><a href="#cb10-141"></a>        question: <span class="bu">str</span>,</span>
<span id="cb10-142"><a href="#cb10-142"></a>        answer: <span class="bu">str</span></span>
<span id="cb10-143"><a href="#cb10-143"></a>    ) <span class="op">-&gt;</span> <span class="bu">float</span>:</span>
<span id="cb10-144"><a href="#cb10-144"></a>        <span class="co">"""</span></span>
<span id="cb10-145"><a href="#cb10-145"></a><span class="co">        답변 품질 평가</span></span>
<span id="cb10-146"><a href="#cb10-146"></a><span class="co">        </span></span>
<span id="cb10-147"><a href="#cb10-147"></a><span class="co">        여러 기준으로 평가:</span></span>
<span id="cb10-148"><a href="#cb10-148"></a><span class="co">        - 관련성</span></span>
<span id="cb10-149"><a href="#cb10-149"></a><span class="co">        - 완전성</span></span>
<span id="cb10-150"><a href="#cb10-150"></a><span class="co">        - 구체성</span></span>
<span id="cb10-151"><a href="#cb10-151"></a><span class="co">        """</span></span>
<span id="cb10-152"><a href="#cb10-152"></a>        eval_prompt <span class="op">=</span> <span class="ss">f"""다음 답변을 평가하세요:</span></span>
<span id="cb10-153"><a href="#cb10-153"></a></span>
<span id="cb10-154"><a href="#cb10-154"></a><span class="ss">        질문: </span><span class="sc">{</span>question<span class="sc">}</span></span>
<span id="cb10-155"><a href="#cb10-155"></a></span>
<span id="cb10-156"><a href="#cb10-156"></a><span class="ss">        답변: </span><span class="sc">{</span>answer<span class="sc">}</span></span>
<span id="cb10-157"><a href="#cb10-157"></a></span>
<span id="cb10-158"><a href="#cb10-158"></a><span class="ss">        다음 기준으로 0.0-1.0 점수를 매기세요:</span></span>
<span id="cb10-159"><a href="#cb10-159"></a><span class="ss">        1. 관련성: 질문과 얼마나 관련있는가?</span></span>
<span id="cb10-160"><a href="#cb10-160"></a><span class="ss">        2. 완전성: 질문에 충분히 답했는가?</span></span>
<span id="cb10-161"><a href="#cb10-161"></a><span class="ss">        3. 구체성: 구체적이고 상세한가?</span></span>
<span id="cb10-162"><a href="#cb10-162"></a></span>
<span id="cb10-163"><a href="#cb10-163"></a><span class="ss">        평균 점수 (0.0-1.0):"""</span></span>
<span id="cb10-164"><a href="#cb10-164"></a>        </span>
<span id="cb10-165"><a href="#cb10-165"></a>        message <span class="op">=</span> <span class="va">self</span>.policy_client.messages.create(</span>
<span id="cb10-166"><a href="#cb10-166"></a>            model<span class="op">=</span><span class="va">self</span>.policy_model,</span>
<span id="cb10-167"><a href="#cb10-167"></a>            max_tokens<span class="op">=</span><span class="dv">20</span>,</span>
<span id="cb10-168"><a href="#cb10-168"></a>            temperature<span class="op">=</span><span class="dv">0</span>,</span>
<span id="cb10-169"><a href="#cb10-169"></a>            messages<span class="op">=</span>[{<span class="st">"role"</span>: <span class="st">"user"</span>, <span class="st">"content"</span>: eval_prompt}]</span>
<span id="cb10-170"><a href="#cb10-170"></a>        )</span>
<span id="cb10-171"><a href="#cb10-171"></a>        </span>
<span id="cb10-172"><a href="#cb10-172"></a>        <span class="cf">try</span>:</span>
<span id="cb10-173"><a href="#cb10-173"></a>            score <span class="op">=</span> <span class="bu">float</span>(message.content[<span class="dv">0</span>].text.strip())</span>
<span id="cb10-174"><a href="#cb10-174"></a>            <span class="cf">return</span> <span class="bu">max</span>(<span class="fl">0.0</span>, <span class="bu">min</span>(<span class="fl">1.0</span>, score))</span>
<span id="cb10-175"><a href="#cb10-175"></a>        <span class="cf">except</span>:</span>
<span id="cb10-176"><a href="#cb10-176"></a>            <span class="cf">return</span> <span class="fl">0.5</span></span>
<span id="cb10-177"><a href="#cb10-177"></a>    </span>
<span id="cb10-178"><a href="#cb10-178"></a>    <span class="kw">def</span> _select_diverse_stimuli(</span>
<span id="cb10-179"><a href="#cb10-179"></a>        <span class="va">self</span>,</span>
<span id="cb10-180"><a href="#cb10-180"></a>        stimuli: List[<span class="bu">str</span>],</span>
<span id="cb10-181"><a href="#cb10-181"></a>        k: <span class="bu">int</span> <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb10-182"><a href="#cb10-182"></a>    ) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb10-183"><a href="#cb10-183"></a>        <span class="co">"""</span></span>
<span id="cb10-184"><a href="#cb10-184"></a><span class="co">        다양성 기반 힌트 선택</span></span>
<span id="cb10-185"><a href="#cb10-185"></a><span class="co">        </span></span>
<span id="cb10-186"><a href="#cb10-186"></a><span class="co">        서로 다른 관점을 제공하는 힌트들 선택</span></span>
<span id="cb10-187"><a href="#cb10-187"></a><span class="co">        """</span></span>
<span id="cb10-188"><a href="#cb10-188"></a>        <span class="cf">if</span> <span class="bu">len</span>(stimuli) <span class="op">&lt;=</span> k:</span>
<span id="cb10-189"><a href="#cb10-189"></a>            <span class="cf">return</span> stimuli</span>
<span id="cb10-190"><a href="#cb10-190"></a>        </span>
<span id="cb10-191"><a href="#cb10-191"></a>        <span class="co"># 임베딩 생성 (다양성 측정용)</span></span>
<span id="cb10-192"><a href="#cb10-192"></a>        embeddings <span class="op">=</span> [<span class="va">self</span>._get_embedding(s) <span class="cf">for</span> s <span class="kw">in</span> stimuli]</span>
<span id="cb10-193"><a href="#cb10-193"></a>        </span>
<span id="cb10-194"><a href="#cb10-194"></a>        <span class="co"># 첫 번째: 무작위 선택</span></span>
<span id="cb10-195"><a href="#cb10-195"></a>        <span class="im">import</span> random</span>
<span id="cb10-196"><a href="#cb10-196"></a>        selected_indices <span class="op">=</span> [random.randint(<span class="dv">0</span>, <span class="bu">len</span>(stimuli) <span class="op">-</span> <span class="dv">1</span>)]</span>
<span id="cb10-197"><a href="#cb10-197"></a>        </span>
<span id="cb10-198"><a href="#cb10-198"></a>        <span class="co"># 나머지: 가장 다른 것 선택</span></span>
<span id="cb10-199"><a href="#cb10-199"></a>        <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(k <span class="op">-</span> <span class="dv">1</span>):</span>
<span id="cb10-200"><a href="#cb10-200"></a>            max_distance <span class="op">=</span> <span class="op">-</span><span class="dv">1</span></span>
<span id="cb10-201"><a href="#cb10-201"></a>            best_idx <span class="op">=</span> <span class="va">None</span></span>
<span id="cb10-202"><a href="#cb10-202"></a>            </span>
<span id="cb10-203"><a href="#cb10-203"></a>            <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(stimuli)):</span>
<span id="cb10-204"><a href="#cb10-204"></a>                <span class="cf">if</span> i <span class="kw">in</span> selected_indices:</span>
<span id="cb10-205"><a href="#cb10-205"></a>                    <span class="cf">continue</span></span>
<span id="cb10-206"><a href="#cb10-206"></a>                </span>
<span id="cb10-207"><a href="#cb10-207"></a>                <span class="co"># 선택된 것들과의 평균 거리</span></span>
<span id="cb10-208"><a href="#cb10-208"></a>                distances <span class="op">=</span> []</span>
<span id="cb10-209"><a href="#cb10-209"></a>                <span class="cf">for</span> selected_idx <span class="kw">in</span> selected_indices:</span>
<span id="cb10-210"><a href="#cb10-210"></a>                    dist <span class="op">=</span> <span class="va">self</span>._cosine_distance(</span>
<span id="cb10-211"><a href="#cb10-211"></a>                        embeddings[i],</span>
<span id="cb10-212"><a href="#cb10-212"></a>                        embeddings[selected_idx]</span>
<span id="cb10-213"><a href="#cb10-213"></a>                    )</span>
<span id="cb10-214"><a href="#cb10-214"></a>                    distances.append(dist)</span>
<span id="cb10-215"><a href="#cb10-215"></a>                </span>
<span id="cb10-216"><a href="#cb10-216"></a>                avg_distance <span class="op">=</span> <span class="bu">sum</span>(distances) <span class="op">/</span> <span class="bu">len</span>(distances)</span>
<span id="cb10-217"><a href="#cb10-217"></a>                </span>
<span id="cb10-218"><a href="#cb10-218"></a>                <span class="cf">if</span> avg_distance <span class="op">&gt;</span> max_distance:</span>
<span id="cb10-219"><a href="#cb10-219"></a>                    max_distance <span class="op">=</span> avg_distance</span>
<span id="cb10-220"><a href="#cb10-220"></a>                    best_idx <span class="op">=</span> i</span>
<span id="cb10-221"><a href="#cb10-221"></a>            </span>
<span id="cb10-222"><a href="#cb10-222"></a>            selected_indices.append(best_idx)</span>
<span id="cb10-223"><a href="#cb10-223"></a>        </span>
<span id="cb10-224"><a href="#cb10-224"></a>        <span class="cf">return</span> [stimuli[i] <span class="cf">for</span> i <span class="kw">in</span> selected_indices]</span>
<span id="cb10-225"><a href="#cb10-225"></a>    </span>
<span id="cb10-226"><a href="#cb10-226"></a>    <span class="kw">def</span> _ensemble_answers(</span>
<span id="cb10-227"><a href="#cb10-227"></a>        <span class="va">self</span>,</span>
<span id="cb10-228"><a href="#cb10-228"></a>        question: <span class="bu">str</span>,</span>
<span id="cb10-229"><a href="#cb10-229"></a>        answers: List[<span class="bu">str</span>]</span>
<span id="cb10-230"><a href="#cb10-230"></a>    ) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb10-231"><a href="#cb10-231"></a>        <span class="co">"""</span></span>
<span id="cb10-232"><a href="#cb10-232"></a><span class="co">        여러 답변을 하나로 결합</span></span>
<span id="cb10-233"><a href="#cb10-233"></a><span class="co">        """</span></span>
<span id="cb10-234"><a href="#cb10-234"></a>        answers_str <span class="op">=</span> <span class="st">"</span><span class="ch">\n\n</span><span class="st">"</span>.join([</span>
<span id="cb10-235"><a href="#cb10-235"></a>            <span class="ss">f"답변 </span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">:</span><span class="ch">\n</span><span class="sc">{</span>ans<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb10-236"><a href="#cb10-236"></a>            <span class="cf">for</span> i, ans <span class="kw">in</span> <span class="bu">enumerate</span>(answers)</span>
<span id="cb10-237"><a href="#cb10-237"></a>        ])</span>
<span id="cb10-238"><a href="#cb10-238"></a>        </span>
<span id="cb10-239"><a href="#cb10-239"></a>        ensemble_prompt <span class="op">=</span> <span class="ss">f"""다음 질문에 대한 여러 답변이 있습니다.</span></span>
<span id="cb10-240"><a href="#cb10-240"></a><span class="ss">        이들을 종합하여 하나의 완전하고 정확한 답변을 작성하세요.</span></span>
<span id="cb10-241"><a href="#cb10-241"></a></span>
<span id="cb10-242"><a href="#cb10-242"></a><span class="ss">        질문: </span><span class="sc">{</span>question<span class="sc">}</span></span>
<span id="cb10-243"><a href="#cb10-243"></a></span>
<span id="cb10-244"><a href="#cb10-244"></a><span class="ss">        </span><span class="sc">{</span>answers_str<span class="sc">}</span></span>
<span id="cb10-245"><a href="#cb10-245"></a></span>
<span id="cb10-246"><a href="#cb10-246"></a><span class="ss">        종합 답변:"""</span></span>
<span id="cb10-247"><a href="#cb10-247"></a>        </span>
<span id="cb10-248"><a href="#cb10-248"></a>        message <span class="op">=</span> <span class="va">self</span>.target_client.messages.create(</span>
<span id="cb10-249"><a href="#cb10-249"></a>            model<span class="op">=</span><span class="va">self</span>.target_model,</span>
<span id="cb10-250"><a href="#cb10-250"></a>            max_tokens<span class="op">=</span><span class="dv">1500</span>,</span>
<span id="cb10-251"><a href="#cb10-251"></a>            temperature<span class="op">=</span><span class="dv">0</span>,</span>
<span id="cb10-252"><a href="#cb10-252"></a>            messages<span class="op">=</span>[{<span class="st">"role"</span>: <span class="st">"user"</span>, <span class="st">"content"</span>: ensemble_prompt}]</span>
<span id="cb10-253"><a href="#cb10-253"></a>        )</span>
<span id="cb10-254"><a href="#cb10-254"></a>        </span>
<span id="cb10-255"><a href="#cb10-255"></a>        <span class="cf">return</span> message.content[<span class="dv">0</span>].text</span>
<span id="cb10-256"><a href="#cb10-256"></a>    </span>
<span id="cb10-257"><a href="#cb10-257"></a>    <span class="kw">def</span> _get_embedding(<span class="va">self</span>, text: <span class="bu">str</span>) <span class="op">-&gt;</span> List[<span class="bu">float</span>]:</span>
<span id="cb10-258"><a href="#cb10-258"></a>        <span class="co">"""임베딩 생성"""</span></span>
<span id="cb10-259"><a href="#cb10-259"></a>        <span class="im">import</span> openai</span>
<span id="cb10-260"><a href="#cb10-260"></a>        client <span class="op">=</span> openai.OpenAI(api_key<span class="op">=</span><span class="st">"your-openai-key"</span>)</span>
<span id="cb10-261"><a href="#cb10-261"></a>        </span>
<span id="cb10-262"><a href="#cb10-262"></a>        response <span class="op">=</span> client.embeddings.create(</span>
<span id="cb10-263"><a href="#cb10-263"></a>            <span class="bu">input</span><span class="op">=</span>text,</span>
<span id="cb10-264"><a href="#cb10-264"></a>            model<span class="op">=</span><span class="st">"text-embedding-3-large"</span></span>
<span id="cb10-265"><a href="#cb10-265"></a>        )</span>
<span id="cb10-266"><a href="#cb10-266"></a>        </span>
<span id="cb10-267"><a href="#cb10-267"></a>        <span class="cf">return</span> response.data[<span class="dv">0</span>].embedding</span>
<span id="cb10-268"><a href="#cb10-268"></a>    </span>
<span id="cb10-269"><a href="#cb10-269"></a>    <span class="kw">def</span> _cosine_distance(<span class="va">self</span>, emb1: List[<span class="bu">float</span>], emb2: List[<span class="bu">float</span>]) <span class="op">-&gt;</span> <span class="bu">float</span>:</span>
<span id="cb10-270"><a href="#cb10-270"></a>        <span class="co">"""코사인 거리"""</span></span>
<span id="cb10-271"><a href="#cb10-271"></a>        <span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb10-272"><a href="#cb10-272"></a>        </span>
<span id="cb10-273"><a href="#cb10-273"></a>        emb1 <span class="op">=</span> np.array(emb1)</span>
<span id="cb10-274"><a href="#cb10-274"></a>        emb2 <span class="op">=</span> np.array(emb2)</span>
<span id="cb10-275"><a href="#cb10-275"></a>        </span>
<span id="cb10-276"><a href="#cb10-276"></a>        cosine_sim <span class="op">=</span> np.dot(emb1, emb2) <span class="op">/</span> (</span>
<span id="cb10-277"><a href="#cb10-277"></a>            np.linalg.norm(emb1) <span class="op">*</span> np.linalg.norm(emb2)</span>
<span id="cb10-278"><a href="#cb10-278"></a>        )</span>
<span id="cb10-279"><a href="#cb10-279"></a>        </span>
<span id="cb10-280"><a href="#cb10-280"></a>        <span class="cf">return</span> <span class="dv">1</span> <span class="op">-</span> cosine_sim</span>
<span id="cb10-281"><a href="#cb10-281"></a></span>
<span id="cb10-282"><a href="#cb10-282"></a></span>
<span id="cb10-283"><a href="#cb10-283"></a><span class="co"># 사용 예시</span></span>
<span id="cb10-284"><a href="#cb10-284"></a><span class="kw">def</span> main():</span>
<span id="cb10-285"><a href="#cb10-285"></a>    dsp <span class="op">=</span> DirectionalStimulusPrompting(</span>
<span id="cb10-286"><a href="#cb10-286"></a>        policy_api_key<span class="op">=</span><span class="st">"your-policy-key"</span>,</span>
<span id="cb10-287"><a href="#cb10-287"></a>        target_api_key<span class="op">=</span><span class="st">"your-target-key"</span></span>
<span id="cb10-288"><a href="#cb10-288"></a>    )</span>
<span id="cb10-289"><a href="#cb10-289"></a>    </span>
<span id="cb10-290"><a href="#cb10-290"></a>    question <span class="op">=</span> <span class="st">"기후 변화에 대처하기 위한 국제 협력 방안은?"</span></span>
<span id="cb10-291"><a href="#cb10-291"></a>    </span>
<span id="cb10-292"><a href="#cb10-292"></a>    <span class="co"># Quality 방법</span></span>
<span id="cb10-293"><a href="#cb10-293"></a>    result <span class="op">=</span> dsp.directional_stimulus_pipeline(</span>
<span id="cb10-294"><a href="#cb10-294"></a>        question,</span>
<span id="cb10-295"><a href="#cb10-295"></a>        num_stimulus_candidates<span class="op">=</span><span class="dv">5</span>,</span>
<span id="cb10-296"><a href="#cb10-296"></a>        selection_method<span class="op">=</span><span class="st">"quality"</span></span>
<span id="cb10-297"><a href="#cb10-297"></a>    )</span>
<span id="cb10-298"><a href="#cb10-298"></a>    </span>
<span id="cb10-299"><a href="#cb10-299"></a>    <span class="bu">print</span>(<span class="st">"="</span><span class="op">*</span><span class="dv">80</span>)</span>
<span id="cb10-300"><a href="#cb10-300"></a>    <span class="bu">print</span>(<span class="st">"최종 결과"</span>)</span>
<span id="cb10-301"><a href="#cb10-301"></a>    <span class="bu">print</span>(<span class="st">"="</span><span class="op">*</span><span class="dv">80</span>)</span>
<span id="cb10-302"><a href="#cb10-302"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">질문: </span><span class="sc">{</span>result[<span class="st">'question'</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb10-303"><a href="#cb10-303"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">선택된 힌트: </span><span class="sc">{</span>result[<span class="st">'selected_stimulus'</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb10-304"><a href="#cb10-304"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">답변:</span><span class="ch">\n</span><span class="sc">{</span>result[<span class="st">'final_answer'</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb10-305"><a href="#cb10-305"></a></span>
<span id="cb10-306"><a href="#cb10-306"></a></span>
<span id="cb10-307"><a href="#cb10-307"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">"__main__"</span>:</span>
<span id="cb10-308"><a href="#cb10-308"></a>    main()</span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="실행-결과-예시" class="level2" data-number="6">
<h2 data-number="6" class="anchored" data-anchor-id="실행-결과-예시"><span class="header-section-number">6</span> 실행 결과 예시</h2>
<pre><code>🎯 Directional Stimulus Prompting
   질문: 기후 변화에 대처하기 위한 국제 협력 방안은?
   선택 방법: quality

Step 1: 힌트 생성
--------------------------------------------------------------------------------
✅ 5개 힌트 생성:
   [1] 파리 협정과 같은 구체적인 국제 조약 사례를 중심으로 설명하세요.
   [2] 선진국과 개발도상국 간의 책임 분담 문제를 다루세요.
   [3] 기술 이전, 재정 지원, 공동 연구 측면에서 논의하세요.
   [4] 성공 사례와 실패 사례를 비교 분석하세요.
   [5] 국가 이익과 글로벌 공동선 간의 갈등을 중심으로 설명하세요.

Step 2: 힌트 품질 평가
--------------------------------------------------------------------------------
   힌트: 파리 협정과 같은 구체적인 국제 조약 사례를...
   점수: 0.850
   힌트: 선진국과 개발도상국 간의 책임 분담 문제를...
   점수: 0.820
   힌트: 기술 이전, 재정 지원, 공동 연구 측면에서...
   점수: 0.880
   힌트: 성공 사례와 실패 사례를 비교 분석하세요...
   점수: 0.860
   힌트: 국가 이익과 글로벌 공동선 간의 갈등을...
   점수: 0.795

✅ 최고 품질 힌트 선택:
   기술 이전, 재정 지원, 공동 연구 측면에서 논의하세요.

Step 3: 최종 답변 생성
--------------------------------------------------------------------------------

================================================================================
최종 결과
================================================================================

질문: 기후 변화에 대처하기 위한 국제 협력 방안은?

선택된 힌트: 기술 이전, 재정 지원, 공동 연구 측면에서 논의하세요.

답변:
기후 변화에 대처하기 위한 국제 협력은 세 가지 핵심 축을 중심으로 이루어집니다:

1. 기술 이전
선진국은 재생에너지, 탄소 포집, 기후 적응 기술을 개발도상국에 이전해야 합니다.
예를 들어, EU의 Horizon 프로그램은 아프리카 국가들에 태양광 기술을 지원하고
있습니다. 그러나 지적재산권 문제가 여전히 걸림돌로 작용하고 있어, TRIPS 협정의
유연성 조항 활용이 필요합니다.

2. 재정 지원
파리 협정은 선진국이 연간 1000억 달러를 개도국 기후 행동에 지원하도록 규정했습니다.
녹색기후기금(GCF)과 적응기금을 통해 자금이 집행되고 있으나, 실제 지원액은 목표에
미치지 못하고 있습니다. 투명한 자금 추적과 효과적인 배분 메커니즘이 시급합니다.

3. 공동 연구
국제 기후 연구 네트워크 구축이 필수적입니다. IPCC(기후변화에 관한 정부간 협의체)가
과학적 근거를 제공하고 있으며, Mission Innovation 같은 이니셔티브는 청정에너지
R&amp;D에서 국가 간 협력을 촉진하고 있습니다.

이러한 협력이 성공하려면 법적 구속력 있는 합의, 이행 모니터링 체계, 그리고
각국의 정치적 의지가 필수적입니다.</code></pre>
</section>
<section id="실험-결과-분석" class="level2" data-number="7">
<h2 data-number="7" class="anchored" data-anchor-id="실험-결과-분석"><span class="header-section-number">7</span> 실험 결과 분석</h2>
<p>Li et al.&nbsp;(2023)의 논문 결과를 살펴보자.</p>
<section id="벤치마크-성능" class="level3" data-number="7.1">
<h3 data-number="7.1" class="anchored" data-anchor-id="벤치마크-성능"><span class="header-section-number">7.1</span> 벤치마크 성능</h3>
<section id="bigbench-hard" class="level4" data-number="7.1.1">
<h4 data-number="7.1.1" class="anchored" data-anchor-id="bigbench-hard"><span class="header-section-number">7.1.1</span> BigBench-Hard</h4>
<p><strong>실험 설정</strong>: - Target LM: GPT-3.5, GPT-4 - Policy LM: LLaMA-7B (튜닝) - 23개 어려운 추론 태스크</p>
<p><strong>결과</strong>:</p>
<table class="table">
<thead>
<tr class="header">
<th>방법</th>
<th>GPT-3.5</th>
<th>GPT-4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Zero-shot</td>
<td>44.2%</td>
<td>58.1%</td>
</tr>
<tr class="even">
<td>Few-shot (8 예시)</td>
<td>51.7%</td>
<td>64.3%</td>
</tr>
<tr class="odd">
<td>CoT</td>
<td>54.3%</td>
<td>68.9%</td>
</tr>
<tr class="even">
<td><strong>Directional Stimulus</strong></td>
<td><strong>58.9%</strong></td>
<td><strong>72.4%</strong></td>
</tr>
</tbody>
</table>
<p><strong>개선폭</strong>: - GPT-3.5: +14.7% (Zero-shot 대비) - GPT-4: +14.3% (Zero-shot 대비)</p>
</section>
<section id="태스크별-상세-결과" class="level4" data-number="7.1.2">
<h4 data-number="7.1.2" class="anchored" data-anchor-id="태스크별-상세-결과"><span class="header-section-number">7.1.2</span> 태스크별 상세 결과</h4>
<table class="table">
<thead>
<tr class="header">
<th>태스크</th>
<th>Zero-shot</th>
<th>CoT</th>
<th>Directional Stimulus</th>
<th>개선폭</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Logical Deduction</td>
<td>42.1%</td>
<td>48.3%</td>
<td>54.7%</td>
<td>+12.6%</td>
</tr>
<tr class="even">
<td>Causal Judgment</td>
<td>51.8%</td>
<td>58.2%</td>
<td>63.4%</td>
<td>+11.6%</td>
</tr>
<tr class="odd">
<td>Formal Fallacies</td>
<td>61.3%</td>
<td>67.8%</td>
<td>74.2%</td>
<td>+12.9%</td>
</tr>
<tr class="even">
<td>Navigate</td>
<td>38.7%</td>
<td>44.1%</td>
<td>51.3%</td>
<td>+12.6%</td>
</tr>
<tr class="odd">
<td>Disambiguation</td>
<td>56.2%</td>
<td>61.9%</td>
<td>67.8%</td>
<td>+11.6%</td>
</tr>
</tbody>
</table>
<p><strong>관찰</strong>: - 모든 태스크에서 일관된 개선 - 특히 복잡한 추론 태스크에서 효과적 - CoT 대비 평균 +4.6% 추가 개선</p>
</section>
</section>
<section id="힌트-품질-분석" class="level3" data-number="7.2">
<h3 data-number="7.2" class="anchored" data-anchor-id="힌트-품질-분석"><span class="header-section-number">7.2</span> 힌트 품질 분석</h3>
<p><strong>사람 평가</strong>: - 100개 질문에 대해 생성된 힌트를 사람이 평가 - 기준: 관련성, 구체성, 유용성</p>
<p><strong>결과</strong>:</p>
<table class="table">
<colgroup>
<col style="width: 25%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 15%">
</colgroup>
<thead>
<tr class="header">
<th>힌트 유형</th>
<th>관련성</th>
<th>구체성</th>
<th>유용성</th>
<th>종합</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>수동 작성 (전문가)</td>
<td>9.2/10</td>
<td>8.9/10</td>
<td>9.0/10</td>
<td>9.0/10</td>
</tr>
<tr class="even">
<td><strong>Policy LM 생성</strong></td>
<td><strong>8.7/10</strong></td>
<td><strong>8.5/10</strong></td>
<td><strong>8.6/10</strong></td>
<td><strong>8.6/10</strong></td>
</tr>
<tr class="odd">
<td>무작위 템플릿</td>
<td>6.3/10</td>
<td>5.8/10</td>
<td>6.1/10</td>
<td>6.1/10</td>
</tr>
</tbody>
</table>
<p><strong>결론</strong>: Policy LM이 생성한 힌트는 전문가 수준에 근접</p>
</section>
<section id="다양한-힌트-유형" class="level3" data-number="7.3">
<h3 data-number="7.3" class="anchored" data-anchor-id="다양한-힌트-유형"><span class="header-section-number">7.3</span> 다양한 힌트 유형</h3>
<p><strong>생성된 힌트 분류</strong>:</p>
<table class="table">
<thead>
<tr class="header">
<th>유형</th>
<th>비율</th>
<th>예시</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>관점 제시</td>
<td>32%</td>
<td>“역사적 관점에서”, “경제학적으로”</td>
</tr>
<tr class="even">
<td>구조 제안</td>
<td>28%</td>
<td>“원인과 결과로 나누어”, “단계별로”</td>
</tr>
<tr class="odd">
<td>사례 요청</td>
<td>21%</td>
<td>“구체적인 예시를 들어”, “실제 사례로”</td>
</tr>
<tr class="even">
<td>비교 유도</td>
<td>12%</td>
<td>“장단점을 비교하며”, “대안들을 평가”</td>
</tr>
<tr class="odd">
<td>기타</td>
<td>7%</td>
<td>복합적 힌트</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="힌트-생성-전략-심화" class="level2" data-number="8">
<h2 data-number="8" class="anchored" data-anchor-id="힌트-생성-전략-심화"><span class="header-section-number">8</span> 힌트 생성 전략 심화</h2>
<section id="전략-1-템플릿-기반-힌트" class="level3" data-number="8.1">
<h3 data-number="8.1" class="anchored" data-anchor-id="전략-1-템플릿-기반-힌트"><span class="header-section-number">8.1</span> 전략 1: 템플릿 기반 힌트</h3>
<p>미리 정의된 템플릿으로 다양한 힌트 생성.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1"></a><span class="kw">class</span> TemplateBasedStimulusGenerator:</span>
<span id="cb12-2"><a href="#cb12-2"></a>    <span class="co">"""</span></span>
<span id="cb12-3"><a href="#cb12-3"></a><span class="co">    템플릿 기반 힌트 생성</span></span>
<span id="cb12-4"><a href="#cb12-4"></a><span class="co">    """</span></span>
<span id="cb12-5"><a href="#cb12-5"></a>    </span>
<span id="cb12-6"><a href="#cb12-6"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb12-7"><a href="#cb12-7"></a>        <span class="co"># 힌트 템플릿 라이브러리</span></span>
<span id="cb12-8"><a href="#cb12-8"></a>        <span class="va">self</span>.templates <span class="op">=</span> {</span>
<span id="cb12-9"><a href="#cb12-9"></a>            <span class="st">'perspective'</span>: [</span>
<span id="cb12-10"><a href="#cb12-10"></a>                <span class="st">"{관점}에서 분석하세요"</span>,</span>
<span id="cb12-11"><a href="#cb12-11"></a>                <span class="st">"{관점} 입장에서 설명하세요"</span>,</span>
<span id="cb12-12"><a href="#cb12-12"></a>                <span class="st">"{관점}으로 접근하세요"</span></span>
<span id="cb12-13"><a href="#cb12-13"></a>            ],</span>
<span id="cb12-14"><a href="#cb12-14"></a>            <span class="st">'structure'</span>: [</span>
<span id="cb12-15"><a href="#cb12-15"></a>                <span class="st">"{구조}로 나누어 설명하세요"</span>,</span>
<span id="cb12-16"><a href="#cb12-16"></a>                <span class="st">"{구조} 순서로 논의하세요"</span>,</span>
<span id="cb12-17"><a href="#cb12-17"></a>                <span class="st">"{구조}를 고려하여 답하세요"</span></span>
<span id="cb12-18"><a href="#cb12-18"></a>            ],</span>
<span id="cb12-19"><a href="#cb12-19"></a>            <span class="st">'example'</span>: [</span>
<span id="cb12-20"><a href="#cb12-20"></a>                <span class="st">"구체적인 {예시유형}을 들어 설명하세요"</span>,</span>
<span id="cb12-21"><a href="#cb12-21"></a>                <span class="st">"{예시유형}로 뒷받침하세요"</span>,</span>
<span id="cb12-22"><a href="#cb12-22"></a>                <span class="st">"실제 {예시유형}를 포함하세요"</span></span>
<span id="cb12-23"><a href="#cb12-23"></a>            ],</span>
<span id="cb12-24"><a href="#cb12-24"></a>            <span class="st">'comparison'</span>: [</span>
<span id="cb12-25"><a href="#cb12-25"></a>                <span class="st">"{대상1}과 {대상2}를 비교하세요"</span>,</span>
<span id="cb12-26"><a href="#cb12-26"></a>                <span class="st">"{기준}으로 평가하세요"</span>,</span>
<span id="cb12-27"><a href="#cb12-27"></a>                <span class="st">"장단점을 {관점}에서 분석하세요"</span></span>
<span id="cb12-28"><a href="#cb12-28"></a>            ],</span>
<span id="cb12-29"><a href="#cb12-29"></a>            <span class="st">'depth'</span>: [</span>
<span id="cb12-30"><a href="#cb12-30"></a>                <span class="st">"{측면}을 깊이 있게 다루세요"</span>,</span>
<span id="cb12-31"><a href="#cb12-31"></a>                <span class="st">"{요소}의 원인과 결과를 설명하세요"</span>,</span>
<span id="cb12-32"><a href="#cb12-32"></a>                <span class="st">"{주제}의 함의를 논의하세요"</span></span>
<span id="cb12-33"><a href="#cb12-33"></a>            ]</span>
<span id="cb12-34"><a href="#cb12-34"></a>        }</span>
<span id="cb12-35"><a href="#cb12-35"></a>        </span>
<span id="cb12-36"><a href="#cb12-36"></a>        <span class="co"># 도메인별 채움 값</span></span>
<span id="cb12-37"><a href="#cb12-37"></a>        <span class="va">self</span>.domain_fillers <span class="op">=</span> {</span>
<span id="cb12-38"><a href="#cb12-38"></a>            <span class="st">'economics'</span>: {</span>
<span id="cb12-39"><a href="#cb12-39"></a>                <span class="st">'관점'</span>: [<span class="st">'케인즈 경제학'</span>, <span class="st">'신고전파'</span>, <span class="st">'행동경제학'</span>, <span class="st">'제도경제학'</span>],</span>
<span id="cb12-40"><a href="#cb12-40"></a>                <span class="st">'구조'</span>: [<span class="st">'미시-거시'</span>, <span class="st">'단기-장기'</span>, <span class="st">'수요-공급'</span>],</span>
<span id="cb12-41"><a href="#cb12-41"></a>                <span class="st">'예시유형'</span>: [<span class="st">'역사적 사례'</span>, <span class="st">'최근 데이터'</span>, <span class="st">'국가별 비교'</span>],</span>
<span id="cb12-42"><a href="#cb12-42"></a>                <span class="st">'측면'</span>: [<span class="st">'재정정책'</span>, <span class="st">'통화정책'</span>, <span class="st">'국제무역'</span>]</span>
<span id="cb12-43"><a href="#cb12-43"></a>            },</span>
<span id="cb12-44"><a href="#cb12-44"></a>            <span class="st">'science'</span>: {</span>
<span id="cb12-45"><a href="#cb12-45"></a>                <span class="st">'관점'</span>: [<span class="st">'실험적'</span>, <span class="st">'이론적'</span>, <span class="st">'응용적'</span>, <span class="st">'학제간'</span>],</span>
<span id="cb12-46"><a href="#cb12-46"></a>                <span class="st">'구조'</span>: [<span class="st">'가설-실험-결과'</span>, <span class="st">'원인-메커니즘-효과'</span>],</span>
<span id="cb12-47"><a href="#cb12-47"></a>                <span class="st">'예시유형'</span>: [<span class="st">'실험 결과'</span>, <span class="st">'자연 현상'</span>, <span class="st">'기술 응용'</span>],</span>
<span id="cb12-48"><a href="#cb12-48"></a>                <span class="st">'측면'</span>: [<span class="st">'분자 수준'</span>, <span class="st">'시스템 수준'</span>, <span class="st">'생태계 수준'</span>]</span>
<span id="cb12-49"><a href="#cb12-49"></a>            },</span>
<span id="cb12-50"><a href="#cb12-50"></a>            <span class="st">'social'</span>: {</span>
<span id="cb12-51"><a href="#cb12-51"></a>                <span class="st">'관점'</span>: [<span class="st">'사회학적'</span>, <span class="st">'심리학적'</span>, <span class="st">'역사적'</span>, <span class="st">'문화적'</span>],</span>
<span id="cb12-52"><a href="#cb12-52"></a>                <span class="st">'구조'</span>: [<span class="st">'개인-집단-사회'</span>, <span class="st">'원인-현상-영향'</span>],</span>
<span id="cb12-53"><a href="#cb12-53"></a>                <span class="st">'예시유형'</span>: [<span class="st">'역사적 사례'</span>, <span class="st">'문화 비교'</span>, <span class="st">'통계 데이터'</span>],</span>
<span id="cb12-54"><a href="#cb12-54"></a>                <span class="st">'측면'</span>: [<span class="st">'제도'</span>, <span class="st">'규범'</span>, <span class="st">'권력관계'</span>]</span>
<span id="cb12-55"><a href="#cb12-55"></a>            }</span>
<span id="cb12-56"><a href="#cb12-56"></a>        }</span>
<span id="cb12-57"><a href="#cb12-57"></a>    </span>
<span id="cb12-58"><a href="#cb12-58"></a>    <span class="kw">def</span> generate_template_stimuli(</span>
<span id="cb12-59"><a href="#cb12-59"></a>        <span class="va">self</span>,</span>
<span id="cb12-60"><a href="#cb12-60"></a>        question: <span class="bu">str</span>,</span>
<span id="cb12-61"><a href="#cb12-61"></a>        domain: <span class="bu">str</span> <span class="op">=</span> <span class="st">'general'</span>,</span>
<span id="cb12-62"><a href="#cb12-62"></a>        num_stimuli: <span class="bu">int</span> <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb12-63"><a href="#cb12-63"></a>    ) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb12-64"><a href="#cb12-64"></a>        <span class="co">"""</span></span>
<span id="cb12-65"><a href="#cb12-65"></a><span class="co">        템플릿 기반 힌트 생성</span></span>
<span id="cb12-66"><a href="#cb12-66"></a><span class="co">        </span></span>
<span id="cb12-67"><a href="#cb12-67"></a><span class="co">        Args:</span></span>
<span id="cb12-68"><a href="#cb12-68"></a><span class="co">            question: 질문</span></span>
<span id="cb12-69"><a href="#cb12-69"></a><span class="co">            domain: 도메인 ('economics', 'science', 'social', 'general')</span></span>
<span id="cb12-70"><a href="#cb12-70"></a><span class="co">            num_stimuli: 생성할 힌트 수</span></span>
<span id="cb12-71"><a href="#cb12-71"></a><span class="co">        """</span></span>
<span id="cb12-72"><a href="#cb12-72"></a>        stimuli <span class="op">=</span> []</span>
<span id="cb12-73"><a href="#cb12-73"></a>        </span>
<span id="cb12-74"><a href="#cb12-74"></a>        <span class="co"># 질문에서 키워드 추출</span></span>
<span id="cb12-75"><a href="#cb12-75"></a>        keywords <span class="op">=</span> <span class="va">self</span>._extract_keywords(question)</span>
<span id="cb12-76"><a href="#cb12-76"></a>        </span>
<span id="cb12-77"><a href="#cb12-77"></a>        <span class="co"># 도메인에 맞는 채움 값 선택</span></span>
<span id="cb12-78"><a href="#cb12-78"></a>        fillers <span class="op">=</span> <span class="va">self</span>.domain_fillers.get(</span>
<span id="cb12-79"><a href="#cb12-79"></a>            domain,</span>
<span id="cb12-80"><a href="#cb12-80"></a>            <span class="va">self</span>.domain_fillers[<span class="st">'social'</span>]  <span class="co"># 기본값</span></span>
<span id="cb12-81"><a href="#cb12-81"></a>        )</span>
<span id="cb12-82"><a href="#cb12-82"></a>        </span>
<span id="cb12-83"><a href="#cb12-83"></a>        <span class="co"># 각 템플릿 카테고리에서 생성</span></span>
<span id="cb12-84"><a href="#cb12-84"></a>        <span class="cf">for</span> category, templates <span class="kw">in</span> <span class="va">self</span>.templates.items():</span>
<span id="cb12-85"><a href="#cb12-85"></a>            <span class="cf">if</span> <span class="bu">len</span>(stimuli) <span class="op">&gt;=</span> num_stimuli:</span>
<span id="cb12-86"><a href="#cb12-86"></a>                <span class="cf">break</span></span>
<span id="cb12-87"><a href="#cb12-87"></a>            </span>
<span id="cb12-88"><a href="#cb12-88"></a>            <span class="im">import</span> random</span>
<span id="cb12-89"><a href="#cb12-89"></a>            template <span class="op">=</span> random.choice(templates)</span>
<span id="cb12-90"><a href="#cb12-90"></a>            </span>
<span id="cb12-91"><a href="#cb12-91"></a>            <span class="co"># 템플릿 채우기</span></span>
<span id="cb12-92"><a href="#cb12-92"></a>            stimulus <span class="op">=</span> <span class="va">self</span>._fill_template(template, fillers, keywords)</span>
<span id="cb12-93"><a href="#cb12-93"></a>            </span>
<span id="cb12-94"><a href="#cb12-94"></a>            <span class="cf">if</span> stimulus:</span>
<span id="cb12-95"><a href="#cb12-95"></a>                stimuli.append(stimulus)</span>
<span id="cb12-96"><a href="#cb12-96"></a>        </span>
<span id="cb12-97"><a href="#cb12-97"></a>        <span class="cf">return</span> stimuli[:num_stimuli]</span>
<span id="cb12-98"><a href="#cb12-98"></a>    </span>
<span id="cb12-99"><a href="#cb12-99"></a>    <span class="kw">def</span> _extract_keywords(<span class="va">self</span>, question: <span class="bu">str</span>) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, <span class="bu">str</span>]:</span>
<span id="cb12-100"><a href="#cb12-100"></a>        <span class="co">"""</span></span>
<span id="cb12-101"><a href="#cb12-101"></a><span class="co">        질문에서 키워드 추출</span></span>
<span id="cb12-102"><a href="#cb12-102"></a><span class="co">        """</span></span>
<span id="cb12-103"><a href="#cb12-103"></a>        <span class="co"># 간단한 휴리스틱</span></span>
<span id="cb12-104"><a href="#cb12-104"></a>        keywords <span class="op">=</span> {}</span>
<span id="cb12-105"><a href="#cb12-105"></a>        </span>
<span id="cb12-106"><a href="#cb12-106"></a>        <span class="co"># 주요 명사 찾기 (실제로는 NLP 사용)</span></span>
<span id="cb12-107"><a href="#cb12-107"></a>        <span class="im">import</span> re</span>
<span id="cb12-108"><a href="#cb12-108"></a>        </span>
<span id="cb12-109"><a href="#cb12-109"></a>        <span class="co"># "A와 B", "A 또는 B" 패턴</span></span>
<span id="cb12-110"><a href="#cb12-110"></a>        comparison <span class="op">=</span> re.search(<span class="vs">r'(\w+)(?:와|과|vs|versus|or)[\s]?(\w+)'</span>, question)</span>
<span id="cb12-111"><a href="#cb12-111"></a>        <span class="cf">if</span> comparison:</span>
<span id="cb12-112"><a href="#cb12-112"></a>            keywords[<span class="st">'대상1'</span>] <span class="op">=</span> comparison.group(<span class="dv">1</span>)</span>
<span id="cb12-113"><a href="#cb12-113"></a>            keywords[<span class="st">'대상2'</span>] <span class="op">=</span> comparison.group(<span class="dv">2</span>)</span>
<span id="cb12-114"><a href="#cb12-114"></a>        </span>
<span id="cb12-115"><a href="#cb12-115"></a>        <span class="cf">return</span> keywords</span>
<span id="cb12-116"><a href="#cb12-116"></a>    </span>
<span id="cb12-117"><a href="#cb12-117"></a>    <span class="kw">def</span> _fill_template(</span>
<span id="cb12-118"><a href="#cb12-118"></a>        <span class="va">self</span>,</span>
<span id="cb12-119"><a href="#cb12-119"></a>        template: <span class="bu">str</span>,</span>
<span id="cb12-120"><a href="#cb12-120"></a>        fillers: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]],</span>
<span id="cb12-121"><a href="#cb12-121"></a>        keywords: Dict[<span class="bu">str</span>, <span class="bu">str</span>]</span>
<span id="cb12-122"><a href="#cb12-122"></a>    ) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb12-123"><a href="#cb12-123"></a>        <span class="co">"""</span></span>
<span id="cb12-124"><a href="#cb12-124"></a><span class="co">        템플릿에 값 채우기</span></span>
<span id="cb12-125"><a href="#cb12-125"></a><span class="co">        """</span></span>
<span id="cb12-126"><a href="#cb12-126"></a>        <span class="im">import</span> random</span>
<span id="cb12-127"><a href="#cb12-127"></a>        <span class="im">import</span> re</span>
<span id="cb12-128"><a href="#cb12-128"></a>        </span>
<span id="cb12-129"><a href="#cb12-129"></a>        <span class="co"># 템플릿의 {변수} 찾기</span></span>
<span id="cb12-130"><a href="#cb12-130"></a>        variables <span class="op">=</span> re.findall(<span class="vs">r'\{([^}]+)\}'</span>, template)</span>
<span id="cb12-131"><a href="#cb12-131"></a>        </span>
<span id="cb12-132"><a href="#cb12-132"></a>        filled <span class="op">=</span> template</span>
<span id="cb12-133"><a href="#cb12-133"></a>        <span class="cf">for</span> var <span class="kw">in</span> variables:</span>
<span id="cb12-134"><a href="#cb12-134"></a>            <span class="co"># 키워드에서 찾기</span></span>
<span id="cb12-135"><a href="#cb12-135"></a>            <span class="cf">if</span> var <span class="kw">in</span> keywords:</span>
<span id="cb12-136"><a href="#cb12-136"></a>                value <span class="op">=</span> keywords[var]</span>
<span id="cb12-137"><a href="#cb12-137"></a>            <span class="co"># 필러에서 찾기</span></span>
<span id="cb12-138"><a href="#cb12-138"></a>            <span class="cf">elif</span> var <span class="kw">in</span> fillers:</span>
<span id="cb12-139"><a href="#cb12-139"></a>                value <span class="op">=</span> random.choice(fillers[var])</span>
<span id="cb12-140"><a href="#cb12-140"></a>            <span class="cf">else</span>:</span>
<span id="cb12-141"><a href="#cb12-141"></a>                <span class="co"># 기본값</span></span>
<span id="cb12-142"><a href="#cb12-142"></a>                value <span class="op">=</span> var</span>
<span id="cb12-143"><a href="#cb12-143"></a>            </span>
<span id="cb12-144"><a href="#cb12-144"></a>            filled <span class="op">=</span> filled.replace(<span class="ss">f'</span><span class="ch">{{</span><span class="sc">{</span>var<span class="sc">}</span><span class="ch">}}</span><span class="ss">'</span>, value)</span>
<span id="cb12-145"><a href="#cb12-145"></a>        </span>
<span id="cb12-146"><a href="#cb12-146"></a>        <span class="cf">return</span> filled</span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>사용 예시</strong>:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1"></a>generator <span class="op">=</span> TemplateBasedStimulusGenerator()</span>
<span id="cb13-2"><a href="#cb13-2"></a></span>
<span id="cb13-3"><a href="#cb13-3"></a>question <span class="op">=</span> <span class="st">"기후 변화가 경제에 미치는 영향은?"</span></span>
<span id="cb13-4"><a href="#cb13-4"></a></span>
<span id="cb13-5"><a href="#cb13-5"></a>stimuli <span class="op">=</span> generator.generate_template_stimuli(</span>
<span id="cb13-6"><a href="#cb13-6"></a>    question,</span>
<span id="cb13-7"><a href="#cb13-7"></a>    domain<span class="op">=</span><span class="st">'economics'</span>,</span>
<span id="cb13-8"><a href="#cb13-8"></a>    num_stimuli<span class="op">=</span><span class="dv">5</span></span>
<span id="cb13-9"><a href="#cb13-9"></a>)</span>
<span id="cb13-10"><a href="#cb13-10"></a></span>
<span id="cb13-11"><a href="#cb13-11"></a><span class="co"># 출력:</span></span>
<span id="cb13-12"><a href="#cb13-12"></a><span class="co"># 1. "케인즈 경제학에서 분석하세요"</span></span>
<span id="cb13-13"><a href="#cb13-13"></a><span class="co"># 2. "미시-거시로 나누어 설명하세요"</span></span>
<span id="cb13-14"><a href="#cb13-14"></a><span class="co"># 3. "구체적인 역사적 사례를 들어 설명하세요"</span></span>
<span id="cb13-15"><a href="#cb13-15"></a><span class="co"># 4. "재정정책을 깊이 있게 다루세요"</span></span>
<span id="cb13-16"><a href="#cb13-16"></a><span class="co"># 5. "단기-장기 순서로 논의하세요"</span></span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="전략-2-예시-기반-학습" class="level3" data-number="8.2">
<h3 data-number="8.2" class="anchored" data-anchor-id="전략-2-예시-기반-학습"><span class="header-section-number">8.2</span> 전략 2: 예시 기반 학습</h3>
<p>좋은 힌트의 예시로부터 패턴을 학습.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1"></a><span class="kw">class</span> ExampleBasedStimulusGenerator:</span>
<span id="cb14-2"><a href="#cb14-2"></a>    <span class="co">"""</span></span>
<span id="cb14-3"><a href="#cb14-3"></a><span class="co">    예시 기반 힌트 학습 및 생성</span></span>
<span id="cb14-4"><a href="#cb14-4"></a><span class="co">    """</span></span>
<span id="cb14-5"><a href="#cb14-5"></a>    </span>
<span id="cb14-6"><a href="#cb14-6"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb14-7"><a href="#cb14-7"></a>        <span class="va">self</span>.examples <span class="op">=</span> []</span>
<span id="cb14-8"><a href="#cb14-8"></a>    </span>
<span id="cb14-9"><a href="#cb14-9"></a>    <span class="kw">def</span> add_example(</span>
<span id="cb14-10"><a href="#cb14-10"></a>        <span class="va">self</span>,</span>
<span id="cb14-11"><a href="#cb14-11"></a>        question: <span class="bu">str</span>,</span>
<span id="cb14-12"><a href="#cb14-12"></a>        good_stimulus: <span class="bu">str</span>,</span>
<span id="cb14-13"><a href="#cb14-13"></a>        answer_quality: <span class="bu">float</span></span>
<span id="cb14-14"><a href="#cb14-14"></a>    ):</span>
<span id="cb14-15"><a href="#cb14-15"></a>        <span class="co">"""</span></span>
<span id="cb14-16"><a href="#cb14-16"></a><span class="co">        좋은 힌트 예시 추가</span></span>
<span id="cb14-17"><a href="#cb14-17"></a><span class="co">        </span></span>
<span id="cb14-18"><a href="#cb14-18"></a><span class="co">        Args:</span></span>
<span id="cb14-19"><a href="#cb14-19"></a><span class="co">            question: 질문</span></span>
<span id="cb14-20"><a href="#cb14-20"></a><span class="co">            good_stimulus: 효과적인 힌트</span></span>
<span id="cb14-21"><a href="#cb14-21"></a><span class="co">            answer_quality: 결과 답변의 품질 (0~1)</span></span>
<span id="cb14-22"><a href="#cb14-22"></a><span class="co">        """</span></span>
<span id="cb14-23"><a href="#cb14-23"></a>        <span class="va">self</span>.examples.append({</span>
<span id="cb14-24"><a href="#cb14-24"></a>            <span class="st">'question'</span>: question,</span>
<span id="cb14-25"><a href="#cb14-25"></a>            <span class="st">'stimulus'</span>: good_stimulus,</span>
<span id="cb14-26"><a href="#cb14-26"></a>            <span class="st">'quality'</span>: answer_quality</span>
<span id="cb14-27"><a href="#cb14-27"></a>        })</span>
<span id="cb14-28"><a href="#cb14-28"></a>    </span>
<span id="cb14-29"><a href="#cb14-29"></a>    <span class="kw">def</span> generate_by_analogy(</span>
<span id="cb14-30"><a href="#cb14-30"></a>        <span class="va">self</span>,</span>
<span id="cb14-31"><a href="#cb14-31"></a>        new_question: <span class="bu">str</span>,</span>
<span id="cb14-32"><a href="#cb14-32"></a>        k: <span class="bu">int</span> <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb14-33"><a href="#cb14-33"></a>    ) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb14-34"><a href="#cb14-34"></a>        <span class="co">"""</span></span>
<span id="cb14-35"><a href="#cb14-35"></a><span class="co">        유사한 질문의 힌트를 참고하여 생성</span></span>
<span id="cb14-36"><a href="#cb14-36"></a><span class="co">        </span></span>
<span id="cb14-37"><a href="#cb14-37"></a><span class="co">        Args:</span></span>
<span id="cb14-38"><a href="#cb14-38"></a><span class="co">            new_question: 새 질문</span></span>
<span id="cb14-39"><a href="#cb14-39"></a><span class="co">            k: 참고할 유사 예시 수</span></span>
<span id="cb14-40"><a href="#cb14-40"></a><span class="co">        """</span></span>
<span id="cb14-41"><a href="#cb14-41"></a>        <span class="cf">if</span> <span class="kw">not</span> <span class="va">self</span>.examples:</span>
<span id="cb14-42"><a href="#cb14-42"></a>            <span class="cf">return</span> []</span>
<span id="cb14-43"><a href="#cb14-43"></a>        </span>
<span id="cb14-44"><a href="#cb14-44"></a>        <span class="co"># 유사한 예시 찾기</span></span>
<span id="cb14-45"><a href="#cb14-45"></a>        similar <span class="op">=</span> <span class="va">self</span>._find_similar_examples(new_question, k)</span>
<span id="cb14-46"><a href="#cb14-46"></a>        </span>
<span id="cb14-47"><a href="#cb14-47"></a>        <span class="co"># Few-shot 프롬프트 구성</span></span>
<span id="cb14-48"><a href="#cb14-48"></a>        few_shot <span class="op">=</span> <span class="st">""</span></span>
<span id="cb14-49"><a href="#cb14-49"></a>        <span class="cf">for</span> ex <span class="kw">in</span> similar:</span>
<span id="cb14-50"><a href="#cb14-50"></a>            few_shot <span class="op">+=</span> <span class="ss">f"""질문: </span><span class="sc">{</span>ex[<span class="st">'question'</span>]<span class="sc">}</span></span>
<span id="cb14-51"><a href="#cb14-51"></a><span class="ss">        힌트: </span><span class="sc">{</span>ex[<span class="st">'stimulus'</span>]<span class="sc">}</span></span>
<span id="cb14-52"><a href="#cb14-52"></a></span>
<span id="cb14-53"><a href="#cb14-53"></a><span class="ss">        """</span></span>
<span id="cb14-54"><a href="#cb14-54"></a>        </span>
<span id="cb14-55"><a href="#cb14-55"></a>        <span class="co"># 새 힌트 생성</span></span>
<span id="cb14-56"><a href="#cb14-56"></a>        prompt <span class="op">=</span> <span class="ss">f"""</span><span class="sc">{</span>few_shot<span class="sc">}</span><span class="ss">이제 다음 질문에 대한 힌트를 생성하세요:</span></span>
<span id="cb14-57"><a href="#cb14-57"></a></span>
<span id="cb14-58"><a href="#cb14-58"></a><span class="ss">        질문: </span><span class="sc">{</span>new_question<span class="sc">}</span></span>
<span id="cb14-59"><a href="#cb14-59"></a><span class="ss">        힌트:"""</span></span>
<span id="cb14-60"><a href="#cb14-60"></a>        </span>
<span id="cb14-61"><a href="#cb14-61"></a>        <span class="co"># LLM 호출 (구현 생략)</span></span>
<span id="cb14-62"><a href="#cb14-62"></a>        <span class="co"># stimulus = llm.generate(prompt)</span></span>
<span id="cb14-63"><a href="#cb14-63"></a>        </span>
<span id="cb14-64"><a href="#cb14-64"></a>        <span class="cf">return</span> [stimulus]</span>
<span id="cb14-65"><a href="#cb14-65"></a>    </span>
<span id="cb14-66"><a href="#cb14-66"></a>    <span class="kw">def</span> _find_similar_examples(</span>
<span id="cb14-67"><a href="#cb14-67"></a>        <span class="va">self</span>,</span>
<span id="cb14-68"><a href="#cb14-68"></a>        question: <span class="bu">str</span>,</span>
<span id="cb14-69"><a href="#cb14-69"></a>        k: <span class="bu">int</span></span>
<span id="cb14-70"><a href="#cb14-70"></a>    ) <span class="op">-&gt;</span> List[Dict]:</span>
<span id="cb14-71"><a href="#cb14-71"></a>        <span class="co">"""</span></span>
<span id="cb14-72"><a href="#cb14-72"></a><span class="co">        유사한 예시 찾기</span></span>
<span id="cb14-73"><a href="#cb14-73"></a><span class="co">        """</span></span>
<span id="cb14-74"><a href="#cb14-74"></a>        <span class="co"># 임베딩 기반 유사도</span></span>
<span id="cb14-75"><a href="#cb14-75"></a>        question_emb <span class="op">=</span> <span class="va">self</span>._get_embedding(question)</span>
<span id="cb14-76"><a href="#cb14-76"></a>        </span>
<span id="cb14-77"><a href="#cb14-77"></a>        similarities <span class="op">=</span> []</span>
<span id="cb14-78"><a href="#cb14-78"></a>        <span class="cf">for</span> ex <span class="kw">in</span> <span class="va">self</span>.examples:</span>
<span id="cb14-79"><a href="#cb14-79"></a>            ex_emb <span class="op">=</span> <span class="va">self</span>._get_embedding(ex[<span class="st">'question'</span>])</span>
<span id="cb14-80"><a href="#cb14-80"></a>            sim <span class="op">=</span> <span class="va">self</span>._cosine_similarity(question_emb, ex_emb)</span>
<span id="cb14-81"><a href="#cb14-81"></a>            </span>
<span id="cb14-82"><a href="#cb14-82"></a>            <span class="co"># 품질도 고려</span></span>
<span id="cb14-83"><a href="#cb14-83"></a>            score <span class="op">=</span> <span class="fl">0.7</span> <span class="op">*</span> sim <span class="op">+</span> <span class="fl">0.3</span> <span class="op">*</span> ex[<span class="st">'quality'</span>]</span>
<span id="cb14-84"><a href="#cb14-84"></a>            </span>
<span id="cb14-85"><a href="#cb14-85"></a>            similarities.append((ex, score))</span>
<span id="cb14-86"><a href="#cb14-86"></a>        </span>
<span id="cb14-87"><a href="#cb14-87"></a>        <span class="co"># 상위 k개</span></span>
<span id="cb14-88"><a href="#cb14-88"></a>        similarities.sort(key<span class="op">=</span><span class="kw">lambda</span> x: x[<span class="dv">1</span>], reverse<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb14-89"><a href="#cb14-89"></a>        <span class="cf">return</span> [ex <span class="cf">for</span> ex, _ <span class="kw">in</span> similarities[:k]]</span>
<span id="cb14-90"><a href="#cb14-90"></a>    </span>
<span id="cb14-91"><a href="#cb14-91"></a>    <span class="kw">def</span> _get_embedding(<span class="va">self</span>, text: <span class="bu">str</span>) <span class="op">-&gt;</span> List[<span class="bu">float</span>]:</span>
<span id="cb14-92"><a href="#cb14-92"></a>        <span class="co">"""임베딩 생성"""</span></span>
<span id="cb14-93"><a href="#cb14-93"></a>        <span class="im">import</span> openai</span>
<span id="cb14-94"><a href="#cb14-94"></a>        client <span class="op">=</span> openai.OpenAI(api_key<span class="op">=</span><span class="st">"your-openai-key"</span>)</span>
<span id="cb14-95"><a href="#cb14-95"></a>        </span>
<span id="cb14-96"><a href="#cb14-96"></a>        response <span class="op">=</span> client.embeddings.create(</span>
<span id="cb14-97"><a href="#cb14-97"></a>            <span class="bu">input</span><span class="op">=</span>text,</span>
<span id="cb14-98"><a href="#cb14-98"></a>            model<span class="op">=</span><span class="st">"text-embedding-3-large"</span></span>
<span id="cb14-99"><a href="#cb14-99"></a>        )</span>
<span id="cb14-100"><a href="#cb14-100"></a>        </span>
<span id="cb14-101"><a href="#cb14-101"></a>        <span class="cf">return</span> response.data[<span class="dv">0</span>].embedding</span>
<span id="cb14-102"><a href="#cb14-102"></a>    </span>
<span id="cb14-103"><a href="#cb14-103"></a>    <span class="kw">def</span> _cosine_similarity(<span class="va">self</span>, emb1: List[<span class="bu">float</span>], emb2: List[<span class="bu">float</span>]) <span class="op">-&gt;</span> <span class="bu">float</span>:</span>
<span id="cb14-104"><a href="#cb14-104"></a>        <span class="co">"""코사인 유사도"""</span></span>
<span id="cb14-105"><a href="#cb14-105"></a>        <span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb14-106"><a href="#cb14-106"></a>        </span>
<span id="cb14-107"><a href="#cb14-107"></a>        emb1 <span class="op">=</span> np.array(emb1)</span>
<span id="cb14-108"><a href="#cb14-108"></a>        emb2 <span class="op">=</span> np.array(emb2)</span>
<span id="cb14-109"><a href="#cb14-109"></a>        </span>
<span id="cb14-110"><a href="#cb14-110"></a>        <span class="cf">return</span> np.dot(emb1, emb2) <span class="op">/</span> (</span>
<span id="cb14-111"><a href="#cb14-111"></a>            np.linalg.norm(emb1) <span class="op">*</span> np.linalg.norm(emb2)</span>
<span id="cb14-112"><a href="#cb14-112"></a>        )</span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="전략-3-강화학습-기반-최적화" class="level3" data-number="8.3">
<h3 data-number="8.3" class="anchored" data-anchor-id="전략-3-강화학습-기반-최적화"><span class="header-section-number">8.3</span> 전략 3: 강화학습 기반 최적화</h3>
<p>힌트의 효과를 보상으로 사용하여 Policy LM 개선.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1"></a><span class="kw">class</span> RLBasedStimulusOptimizer:</span>
<span id="cb15-2"><a href="#cb15-2"></a>    <span class="co">"""</span></span>
<span id="cb15-3"><a href="#cb15-3"></a><span class="co">    강화학습 기반 힌트 최적화</span></span>
<span id="cb15-4"><a href="#cb15-4"></a><span class="co">    """</span></span>
<span id="cb15-5"><a href="#cb15-5"></a>    </span>
<span id="cb15-6"><a href="#cb15-6"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb15-7"><a href="#cb15-7"></a>        <span class="va">self</span>.policy_model <span class="op">=</span> <span class="va">None</span>  <span class="co"># Policy LM</span></span>
<span id="cb15-8"><a href="#cb15-8"></a>        <span class="va">self</span>.reward_history <span class="op">=</span> []</span>
<span id="cb15-9"><a href="#cb15-9"></a>    </span>
<span id="cb15-10"><a href="#cb15-10"></a>    <span class="kw">def</span> optimize_policy(</span>
<span id="cb15-11"><a href="#cb15-11"></a>        <span class="va">self</span>,</span>
<span id="cb15-12"><a href="#cb15-12"></a>        questions: List[<span class="bu">str</span>],</span>
<span id="cb15-13"><a href="#cb15-13"></a>        num_iterations: <span class="bu">int</span> <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb15-14"><a href="#cb15-14"></a>    ):</span>
<span id="cb15-15"><a href="#cb15-15"></a>        <span class="co">"""</span></span>
<span id="cb15-16"><a href="#cb15-16"></a><span class="co">        강화학습으로 Policy 최적화</span></span>
<span id="cb15-17"><a href="#cb15-17"></a><span class="co">        </span></span>
<span id="cb15-18"><a href="#cb15-18"></a><span class="co">        프로세스:</span></span>
<span id="cb15-19"><a href="#cb15-19"></a><span class="co">        1. 현재 Policy로 힌트 생성</span></span>
<span id="cb15-20"><a href="#cb15-20"></a><span class="co">        2. 힌트로 답변 생성</span></span>
<span id="cb15-21"><a href="#cb15-21"></a><span class="co">        3. 답변 품질을 보상으로 사용</span></span>
<span id="cb15-22"><a href="#cb15-22"></a><span class="co">        4. Policy 업데이트</span></span>
<span id="cb15-23"><a href="#cb15-23"></a><span class="co">        5. 반복</span></span>
<span id="cb15-24"><a href="#cb15-24"></a><span class="co">        """</span></span>
<span id="cb15-25"><a href="#cb15-25"></a>        <span class="bu">print</span>(<span class="ss">f"🎓 강화학습 기반 최적화 시작"</span>)</span>
<span id="cb15-26"><a href="#cb15-26"></a>        <span class="bu">print</span>(<span class="ss">f"   반복: </span><span class="sc">{</span>num_iterations<span class="sc">}</span><span class="ss">회</span><span class="ch">\n</span><span class="ss">"</span>)</span>
<span id="cb15-27"><a href="#cb15-27"></a>        </span>
<span id="cb15-28"><a href="#cb15-28"></a>        <span class="cf">for</span> iteration <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, num_iterations <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb15-29"><a href="#cb15-29"></a>            <span class="bu">print</span>(<span class="ss">f"Iteration </span><span class="sc">{</span>iteration<span class="sc">}</span><span class="ss">/</span><span class="sc">{</span>num_iterations<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb15-30"><a href="#cb15-30"></a>            </span>
<span id="cb15-31"><a href="#cb15-31"></a>            episode_rewards <span class="op">=</span> []</span>
<span id="cb15-32"><a href="#cb15-32"></a>            </span>
<span id="cb15-33"><a href="#cb15-33"></a>            <span class="cf">for</span> question <span class="kw">in</span> questions:</span>
<span id="cb15-34"><a href="#cb15-34"></a>                <span class="co"># Step 1: 힌트 생성 (현재 Policy)</span></span>
<span id="cb15-35"><a href="#cb15-35"></a>                stimulus <span class="op">=</span> <span class="va">self</span>._generate_stimulus_from_policy(question)</span>
<span id="cb15-36"><a href="#cb15-36"></a>                </span>
<span id="cb15-37"><a href="#cb15-37"></a>                <span class="co"># Step 2: 답변 생성</span></span>
<span id="cb15-38"><a href="#cb15-38"></a>                answer <span class="op">=</span> <span class="va">self</span>._generate_answer(question, stimulus)</span>
<span id="cb15-39"><a href="#cb15-39"></a>                </span>
<span id="cb15-40"><a href="#cb15-40"></a>                <span class="co"># Step 3: 보상 계산</span></span>
<span id="cb15-41"><a href="#cb15-41"></a>                reward <span class="op">=</span> <span class="va">self</span>._compute_reward(question, answer)</span>
<span id="cb15-42"><a href="#cb15-42"></a>                episode_rewards.append(reward)</span>
<span id="cb15-43"><a href="#cb15-43"></a>                </span>
<span id="cb15-44"><a href="#cb15-44"></a>                <span class="co"># Step 4: 경험 저장</span></span>
<span id="cb15-45"><a href="#cb15-45"></a>                <span class="va">self</span>._store_experience(question, stimulus, reward)</span>
<span id="cb15-46"><a href="#cb15-46"></a>            </span>
<span id="cb15-47"><a href="#cb15-47"></a>            avg_reward <span class="op">=</span> <span class="bu">sum</span>(episode_rewards) <span class="op">/</span> <span class="bu">len</span>(episode_rewards)</span>
<span id="cb15-48"><a href="#cb15-48"></a>            <span class="va">self</span>.reward_history.append(avg_reward)</span>
<span id="cb15-49"><a href="#cb15-49"></a>            </span>
<span id="cb15-50"><a href="#cb15-50"></a>            <span class="bu">print</span>(<span class="ss">f"  평균 보상: </span><span class="sc">{</span>avg_reward<span class="sc">:.3f}</span><span class="ss">"</span>)</span>
<span id="cb15-51"><a href="#cb15-51"></a>            </span>
<span id="cb15-52"><a href="#cb15-52"></a>            <span class="co"># Step 5: Policy 업데이트</span></span>
<span id="cb15-53"><a href="#cb15-53"></a>            <span class="va">self</span>._update_policy()</span>
<span id="cb15-54"><a href="#cb15-54"></a>        </span>
<span id="cb15-55"><a href="#cb15-55"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">✅ 최적화 완료"</span>)</span>
<span id="cb15-56"><a href="#cb15-56"></a>        <span class="va">self</span>._plot_learning_curve()</span>
<span id="cb15-57"><a href="#cb15-57"></a>    </span>
<span id="cb15-58"><a href="#cb15-58"></a>    <span class="kw">def</span> _compute_reward(</span>
<span id="cb15-59"><a href="#cb15-59"></a>        <span class="va">self</span>,</span>
<span id="cb15-60"><a href="#cb15-60"></a>        question: <span class="bu">str</span>,</span>
<span id="cb15-61"><a href="#cb15-61"></a>        answer: <span class="bu">str</span></span>
<span id="cb15-62"><a href="#cb15-62"></a>    ) <span class="op">-&gt;</span> <span class="bu">float</span>:</span>
<span id="cb15-63"><a href="#cb15-63"></a>        <span class="co">"""</span></span>
<span id="cb15-64"><a href="#cb15-64"></a><span class="co">        보상 함수</span></span>
<span id="cb15-65"><a href="#cb15-65"></a><span class="co">        </span></span>
<span id="cb15-66"><a href="#cb15-66"></a><span class="co">        답변 품질을 0~1로 측정</span></span>
<span id="cb15-67"><a href="#cb15-67"></a><span class="co">        """</span></span>
<span id="cb15-68"><a href="#cb15-68"></a>        <span class="co"># 여러 기준으로 평가</span></span>
<span id="cb15-69"><a href="#cb15-69"></a>        relevance <span class="op">=</span> <span class="va">self</span>._evaluate_relevance(question, answer)</span>
<span id="cb15-70"><a href="#cb15-70"></a>        completeness <span class="op">=</span> <span class="va">self</span>._evaluate_completeness(question, answer)</span>
<span id="cb15-71"><a href="#cb15-71"></a>        clarity <span class="op">=</span> <span class="va">self</span>._evaluate_clarity(answer)</span>
<span id="cb15-72"><a href="#cb15-72"></a>        </span>
<span id="cb15-73"><a href="#cb15-73"></a>        <span class="co"># 가중 평균</span></span>
<span id="cb15-74"><a href="#cb15-74"></a>        reward <span class="op">=</span> (</span>
<span id="cb15-75"><a href="#cb15-75"></a>            <span class="fl">0.4</span> <span class="op">*</span> relevance <span class="op">+</span></span>
<span id="cb15-76"><a href="#cb15-76"></a>            <span class="fl">0.4</span> <span class="op">*</span> completeness <span class="op">+</span></span>
<span id="cb15-77"><a href="#cb15-77"></a>            <span class="fl">0.2</span> <span class="op">*</span> clarity</span>
<span id="cb15-78"><a href="#cb15-78"></a>        )</span>
<span id="cb15-79"><a href="#cb15-79"></a>        </span>
<span id="cb15-80"><a href="#cb15-80"></a>        <span class="cf">return</span> reward</span>
<span id="cb15-81"><a href="#cb15-81"></a>    </span>
<span id="cb15-82"><a href="#cb15-82"></a>    <span class="kw">def</span> _update_policy(<span class="va">self</span>):</span>
<span id="cb15-83"><a href="#cb15-83"></a>        <span class="co">"""</span></span>
<span id="cb15-84"><a href="#cb15-84"></a><span class="co">        Policy Gradient로 업데이트</span></span>
<span id="cb15-85"><a href="#cb15-85"></a><span class="co">        </span></span>
<span id="cb15-86"><a href="#cb15-86"></a><span class="co">        실제 구현에서는:</span></span>
<span id="cb15-87"><a href="#cb15-87"></a><span class="co">        - 저장된 경험 샘플링</span></span>
<span id="cb15-88"><a href="#cb15-88"></a><span class="co">        - Gradient 계산</span></span>
<span id="cb15-89"><a href="#cb15-89"></a><span class="co">        - 모델 파라미터 업데이트</span></span>
<span id="cb15-90"><a href="#cb15-90"></a><span class="co">        """</span></span>
<span id="cb15-91"><a href="#cb15-91"></a>        <span class="co"># 간략한 의사코드</span></span>
<span id="cb15-92"><a href="#cb15-92"></a>        <span class="co">"""</span></span>
<span id="cb15-93"><a href="#cb15-93"></a><span class="co">        for experience in self.experience_buffer:</span></span>
<span id="cb15-94"><a href="#cb15-94"></a><span class="co">            question, stimulus, reward = experience</span></span>
<span id="cb15-95"><a href="#cb15-95"></a><span class="co">            </span></span>
<span id="cb15-96"><a href="#cb15-96"></a><span class="co">            # Log probability 계산</span></span>
<span id="cb15-97"><a href="#cb15-97"></a><span class="co">            log_prob = policy_model.log_probability(stimulus | question)</span></span>
<span id="cb15-98"><a href="#cb15-98"></a><span class="co">            </span></span>
<span id="cb15-99"><a href="#cb15-99"></a><span class="co">            # Policy gradient</span></span>
<span id="cb15-100"><a href="#cb15-100"></a><span class="co">            loss = -log_prob * (reward - baseline)</span></span>
<span id="cb15-101"><a href="#cb15-101"></a><span class="co">            </span></span>
<span id="cb15-102"><a href="#cb15-102"></a><span class="co">            # 업데이트</span></span>
<span id="cb15-103"><a href="#cb15-103"></a><span class="co">            optimizer.step(loss)</span></span>
<span id="cb15-104"><a href="#cb15-104"></a><span class="co">        """</span></span>
<span id="cb15-105"><a href="#cb15-105"></a>        <span class="cf">pass</span></span>
<span id="cb15-106"><a href="#cb15-106"></a>    </span>
<span id="cb15-107"><a href="#cb15-107"></a>    <span class="kw">def</span> _plot_learning_curve(<span class="va">self</span>):</span>
<span id="cb15-108"><a href="#cb15-108"></a>        <span class="co">"""학습 곡선 시각화"""</span></span>
<span id="cb15-109"><a href="#cb15-109"></a>        <span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb15-110"><a href="#cb15-110"></a>        </span>
<span id="cb15-111"><a href="#cb15-111"></a>        plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb15-112"><a href="#cb15-112"></a>        plt.plot(<span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(<span class="va">self</span>.reward_history) <span class="op">+</span> <span class="dv">1</span>), <span class="va">self</span>.reward_history)</span>
<span id="cb15-113"><a href="#cb15-113"></a>        plt.xlabel(<span class="st">'Iteration'</span>)</span>
<span id="cb15-114"><a href="#cb15-114"></a>        plt.ylabel(<span class="st">'Average Reward'</span>)</span>
<span id="cb15-115"><a href="#cb15-115"></a>        plt.title(<span class="st">'RL-based Policy Optimization'</span>)</span>
<span id="cb15-116"><a href="#cb15-116"></a>        plt.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb15-117"><a href="#cb15-117"></a>        plt.savefig(<span class="st">'rl_optimization.png'</span>)</span>
<span id="cb15-118"><a href="#cb15-118"></a>        <span class="bu">print</span>(<span class="st">"📊 학습 곡선 저장: rl_optimization.png"</span>)</span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="policy-lm-효율적-튜닝-방법" class="level2" data-number="9">
<h2 data-number="9" class="anchored" data-anchor-id="policy-lm-효율적-튜닝-방법"><span class="header-section-number">9</span> Policy LM 효율적 튜닝 방법</h2>
<section id="방법-1-lora-low-rank-adaptation" class="level3" data-number="9.1">
<h3 data-number="9.1" class="anchored" data-anchor-id="방법-1-lora-low-rank-adaptation"><span class="header-section-number">9.1</span> 방법 1: LoRA (Low-Rank Adaptation)</h3>
<p>전체 모델을 튜닝하지 않고 작은 어댑터만 학습.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1"></a><span class="kw">class</span> LoRAPolicyTuning:</span>
<span id="cb16-2"><a href="#cb16-2"></a>    <span class="co">"""</span></span>
<span id="cb16-3"><a href="#cb16-3"></a><span class="co">    LoRA를 사용한 효율적 Policy LM 튜닝</span></span>
<span id="cb16-4"><a href="#cb16-4"></a><span class="co">    """</span></span>
<span id="cb16-5"><a href="#cb16-5"></a>    </span>
<span id="cb16-6"><a href="#cb16-6"></a>    <span class="kw">def</span> prepare_lora_config(<span class="va">self</span>) <span class="op">-&gt;</span> Dict:</span>
<span id="cb16-7"><a href="#cb16-7"></a>        <span class="co">"""</span></span>
<span id="cb16-8"><a href="#cb16-8"></a><span class="co">        LoRA 설정</span></span>
<span id="cb16-9"><a href="#cb16-9"></a><span class="co">        """</span></span>
<span id="cb16-10"><a href="#cb16-10"></a>        config <span class="op">=</span> {</span>
<span id="cb16-11"><a href="#cb16-11"></a>            <span class="st">'r'</span>: <span class="dv">8</span>,  <span class="co"># Rank (낮을수록 파라미터 적음)</span></span>
<span id="cb16-12"><a href="#cb16-12"></a>            <span class="st">'lora_alpha'</span>: <span class="dv">16</span>,  <span class="co"># Scaling factor</span></span>
<span id="cb16-13"><a href="#cb16-13"></a>            <span class="st">'target_modules'</span>: [<span class="st">'q_proj'</span>, <span class="st">'v_proj'</span>],  <span class="co"># 적용할 레이어</span></span>
<span id="cb16-14"><a href="#cb16-14"></a>            <span class="st">'lora_dropout'</span>: <span class="fl">0.05</span>,</span>
<span id="cb16-15"><a href="#cb16-15"></a>            <span class="st">'bias'</span>: <span class="st">'none'</span>,</span>
<span id="cb16-16"><a href="#cb16-16"></a>            <span class="st">'task_type'</span>: <span class="st">'CAUSAL_LM'</span></span>
<span id="cb16-17"><a href="#cb16-17"></a>        }</span>
<span id="cb16-18"><a href="#cb16-18"></a>        </span>
<span id="cb16-19"><a href="#cb16-19"></a>        <span class="cf">return</span> config</span>
<span id="cb16-20"><a href="#cb16-20"></a>    </span>
<span id="cb16-21"><a href="#cb16-21"></a>    <span class="kw">def</span> estimate_parameters(<span class="va">self</span>, base_model_size: <span class="bu">int</span>, r: <span class="bu">int</span>) <span class="op">-&gt;</span> Dict:</span>
<span id="cb16-22"><a href="#cb16-22"></a>        <span class="co">"""</span></span>
<span id="cb16-23"><a href="#cb16-23"></a><span class="co">        튜닝 파라미터 수 추정</span></span>
<span id="cb16-24"><a href="#cb16-24"></a><span class="co">        </span></span>
<span id="cb16-25"><a href="#cb16-25"></a><span class="co">        Args:</span></span>
<span id="cb16-26"><a href="#cb16-26"></a><span class="co">            base_model_size: 기본 모델 크기 (파라미터 수)</span></span>
<span id="cb16-27"><a href="#cb16-27"></a><span class="co">            r: LoRA rank</span></span>
<span id="cb16-28"><a href="#cb16-28"></a><span class="co">        """</span></span>
<span id="cb16-29"><a href="#cb16-29"></a>        <span class="co"># LoRA 파라미터 = 2 * d * r (per layer)</span></span>
<span id="cb16-30"><a href="#cb16-30"></a>        <span class="co"># d: hidden dimension (예: 4096 for LLaMA-7B)</span></span>
<span id="cb16-31"><a href="#cb16-31"></a>        </span>
<span id="cb16-32"><a href="#cb16-32"></a>        d <span class="op">=</span> <span class="dv">4096</span>  <span class="co"># LLaMA-7B</span></span>
<span id="cb16-33"><a href="#cb16-33"></a>        num_layers <span class="op">=</span> <span class="dv">32</span></span>
<span id="cb16-34"><a href="#cb16-34"></a>        </span>
<span id="cb16-35"><a href="#cb16-35"></a>        lora_params <span class="op">=</span> <span class="dv">2</span> <span class="op">*</span> d <span class="op">*</span> r <span class="op">*</span> num_layers</span>
<span id="cb16-36"><a href="#cb16-36"></a>        </span>
<span id="cb16-37"><a href="#cb16-37"></a>        percentage <span class="op">=</span> (lora_params <span class="op">/</span> base_model_size) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb16-38"><a href="#cb16-38"></a>        </span>
<span id="cb16-39"><a href="#cb16-39"></a>        <span class="cf">return</span> {</span>
<span id="cb16-40"><a href="#cb16-40"></a>            <span class="st">'base_params'</span>: base_model_size,</span>
<span id="cb16-41"><a href="#cb16-41"></a>            <span class="st">'lora_params'</span>: lora_params,</span>
<span id="cb16-42"><a href="#cb16-42"></a>            <span class="st">'trainable_percentage'</span>: percentage</span>
<span id="cb16-43"><a href="#cb16-43"></a>        }</span>
<span id="cb16-44"><a href="#cb16-44"></a></span>
<span id="cb16-45"><a href="#cb16-45"></a></span>
<span id="cb16-46"><a href="#cb16-46"></a><span class="co"># 사용 예시</span></span>
<span id="cb16-47"><a href="#cb16-47"></a>tuner <span class="op">=</span> LoRAPolicyTuning()</span>
<span id="cb16-48"><a href="#cb16-48"></a></span>
<span id="cb16-49"><a href="#cb16-49"></a><span class="co"># LLaMA-7B 기준</span></span>
<span id="cb16-50"><a href="#cb16-50"></a>stats <span class="op">=</span> tuner.estimate_parameters(</span>
<span id="cb16-51"><a href="#cb16-51"></a>    base_model_size<span class="op">=</span><span class="dv">7_000_000_000</span>,  <span class="co"># 7B</span></span>
<span id="cb16-52"><a href="#cb16-52"></a>    r<span class="op">=</span><span class="dv">8</span></span>
<span id="cb16-53"><a href="#cb16-53"></a>)</span>
<span id="cb16-54"><a href="#cb16-54"></a></span>
<span id="cb16-55"><a href="#cb16-55"></a><span class="bu">print</span>(<span class="ss">f"기본 모델: </span><span class="sc">{</span>stats[<span class="st">'base_params'</span>]<span class="sc">:,}</span><span class="ss"> 파라미터"</span>)</span>
<span id="cb16-56"><a href="#cb16-56"></a><span class="bu">print</span>(<span class="ss">f"LoRA: </span><span class="sc">{</span>stats[<span class="st">'lora_params'</span>]<span class="sc">:,}</span><span class="ss"> 파라미터"</span>)</span>
<span id="cb16-57"><a href="#cb16-57"></a><span class="bu">print</span>(<span class="ss">f"튜닝 비율: </span><span class="sc">{</span>stats[<span class="st">'trainable_percentage'</span>]<span class="sc">:.2f}</span><span class="ss">%"</span>)</span>
<span id="cb16-58"><a href="#cb16-58"></a></span>
<span id="cb16-59"><a href="#cb16-59"></a><span class="co"># 출력:</span></span>
<span id="cb16-60"><a href="#cb16-60"></a><span class="co"># 기본 모델: 7,000,000,000 파라미터</span></span>
<span id="cb16-61"><a href="#cb16-61"></a><span class="co"># LoRA: 2,097,152 파라미터</span></span>
<span id="cb16-62"><a href="#cb16-62"></a><span class="co"># 튜닝 비율: 0.03%</span></span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>장점</strong>: - 메모리 사용량 99% 감소 - 학습 속도 3-5배 향상 - 체크포인트 크기 99% 감소</p>
</section>
<section id="방법-2-prompt-tuning" class="level3" data-number="9.2">
<h3 data-number="9.2" class="anchored" data-anchor-id="방법-2-prompt-tuning"><span class="header-section-number">9.2</span> 방법 2: Prompt Tuning</h3>
<p>프롬프트 임베딩만 학습.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1"></a><span class="kw">class</span> PromptTuningPolicy:</span>
<span id="cb17-2"><a href="#cb17-2"></a>    <span class="co">"""</span></span>
<span id="cb17-3"><a href="#cb17-3"></a><span class="co">    Prompt Tuning으로 Policy 학습</span></span>
<span id="cb17-4"><a href="#cb17-4"></a><span class="co">    """</span></span>
<span id="cb17-5"><a href="#cb17-5"></a>    </span>
<span id="cb17-6"><a href="#cb17-6"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, num_virtual_tokens: <span class="bu">int</span> <span class="op">=</span> <span class="dv">20</span>):</span>
<span id="cb17-7"><a href="#cb17-7"></a>        <span class="co">"""</span></span>
<span id="cb17-8"><a href="#cb17-8"></a><span class="co">        Args:</span></span>
<span id="cb17-9"><a href="#cb17-9"></a><span class="co">            num_virtual_tokens: 가상 토큰 수</span></span>
<span id="cb17-10"><a href="#cb17-10"></a><span class="co">        """</span></span>
<span id="cb17-11"><a href="#cb17-11"></a>        <span class="va">self</span>.num_virtual_tokens <span class="op">=</span> num_virtual_tokens</span>
<span id="cb17-12"><a href="#cb17-12"></a>        </span>
<span id="cb17-13"><a href="#cb17-13"></a>        <span class="co"># 가상 토큰의 임베딩만 학습 가능</span></span>
<span id="cb17-14"><a href="#cb17-14"></a>        <span class="co"># 모델 파라미터는 동결</span></span>
<span id="cb17-15"><a href="#cb17-15"></a>    </span>
<span id="cb17-16"><a href="#cb17-16"></a>    <span class="kw">def</span> create_prompt_template(<span class="va">self</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb17-17"><a href="#cb17-17"></a>        <span class="co">"""</span></span>
<span id="cb17-18"><a href="#cb17-18"></a><span class="co">        Prompt 템플릿 생성</span></span>
<span id="cb17-19"><a href="#cb17-19"></a><span class="co">        """</span></span>
<span id="cb17-20"><a href="#cb17-20"></a>        <span class="co"># [P0], [P1], ... [P19]: 학습 가능한 가상 토큰</span></span>
<span id="cb17-21"><a href="#cb17-21"></a>        virtual_tokens <span class="op">=</span> <span class="st">" "</span>.join([</span>
<span id="cb17-22"><a href="#cb17-22"></a>            <span class="ss">f"[P</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">]"</span> <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="va">self</span>.num_virtual_tokens)</span>
<span id="cb17-23"><a href="#cb17-23"></a>        ])</span>
<span id="cb17-24"><a href="#cb17-24"></a>        </span>
<span id="cb17-25"><a href="#cb17-25"></a>        template <span class="op">=</span> <span class="ss">f"""</span><span class="sc">{</span>virtual_tokens<span class="sc">}</span></span>
<span id="cb17-26"><a href="#cb17-26"></a></span>
<span id="cb17-27"><a href="#cb17-27"></a><span class="ss">        질문에 대한 효과적인 힌트를 생성하세요.</span></span>
<span id="cb17-28"><a href="#cb17-28"></a></span>
<span id="cb17-29"><a href="#cb17-29"></a><span class="ss">        질문: </span><span class="ch">{{</span><span class="ss">question</span><span class="ch">}}</span></span>
<span id="cb17-30"><a href="#cb17-30"></a></span>
<span id="cb17-31"><a href="#cb17-31"></a><span class="ss">        힌트:"""</span></span>
<span id="cb17-32"><a href="#cb17-32"></a>        </span>
<span id="cb17-33"><a href="#cb17-33"></a>        <span class="cf">return</span> template</span>
<span id="cb17-34"><a href="#cb17-34"></a>    </span>
<span id="cb17-35"><a href="#cb17-35"></a>    <span class="kw">def</span> estimate_parameters(<span class="va">self</span>, embedding_dim: <span class="bu">int</span> <span class="op">=</span> <span class="dv">4096</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb17-36"><a href="#cb17-36"></a>        <span class="co">"""</span></span>
<span id="cb17-37"><a href="#cb17-37"></a><span class="co">        학습 가능한 파라미터 수</span></span>
<span id="cb17-38"><a href="#cb17-38"></a><span class="co">        """</span></span>
<span id="cb17-39"><a href="#cb17-39"></a>        <span class="co"># 가상 토큰 수 × 임베딩 차원</span></span>
<span id="cb17-40"><a href="#cb17-40"></a>        params <span class="op">=</span> <span class="va">self</span>.num_virtual_tokens <span class="op">*</span> embedding_dim</span>
<span id="cb17-41"><a href="#cb17-41"></a>        </span>
<span id="cb17-42"><a href="#cb17-42"></a>        <span class="cf">return</span> params</span>
<span id="cb17-43"><a href="#cb17-43"></a></span>
<span id="cb17-44"><a href="#cb17-44"></a></span>
<span id="cb17-45"><a href="#cb17-45"></a><span class="co"># 비교</span></span>
<span id="cb17-46"><a href="#cb17-46"></a>tuner <span class="op">=</span> PromptTuningPolicy(num_virtual_tokens<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb17-47"><a href="#cb17-47"></a>params <span class="op">=</span> tuner.estimate_parameters()</span>
<span id="cb17-48"><a href="#cb17-48"></a></span>
<span id="cb17-49"><a href="#cb17-49"></a><span class="bu">print</span>(<span class="ss">f"Prompt Tuning 파라미터: </span><span class="sc">{</span>params<span class="sc">:,}</span><span class="ss">"</span>)</span>
<span id="cb17-50"><a href="#cb17-50"></a><span class="bu">print</span>(<span class="ss">f"전체 모델 대비: </span><span class="sc">{</span>params <span class="op">/</span> <span class="dv">7_000_000_000</span> <span class="op">*</span> <span class="dv">100</span><span class="sc">:.4f}</span><span class="ss">%"</span>)</span>
<span id="cb17-51"><a href="#cb17-51"></a></span>
<span id="cb17-52"><a href="#cb17-52"></a><span class="co"># 출력:</span></span>
<span id="cb17-53"><a href="#cb17-53"></a><span class="co"># Prompt Tuning 파라미터: 81,920</span></span>
<span id="cb17-54"><a href="#cb17-54"></a><span class="co"># 전체 모델 대비: 0.0012%</span></span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>장점</strong>: - 극도로 적은 파라미터 (0.001%) - 매우 빠른 학습 - 여러 태스크에 쉽게 적용</p>
</section>
<section id="방법-3-증류-distillation" class="level3" data-number="9.3">
<h3 data-number="9.3" class="anchored" data-anchor-id="방법-3-증류-distillation"><span class="header-section-number">9.3</span> 방법 3: 증류 (Distillation)</h3>
<p>큰 모델의 지식을 작은 모델로 이전.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1"></a><span class="kw">class</span> KnowledgeDistillationPolicy:</span>
<span id="cb18-2"><a href="#cb18-2"></a>    <span class="co">"""</span></span>
<span id="cb18-3"><a href="#cb18-3"></a><span class="co">    지식 증류로 Policy 학습</span></span>
<span id="cb18-4"><a href="#cb18-4"></a><span class="co">    """</span></span>
<span id="cb18-5"><a href="#cb18-5"></a>    </span>
<span id="cb18-6"><a href="#cb18-6"></a>    <span class="kw">def</span> distill(</span>
<span id="cb18-7"><a href="#cb18-7"></a>        <span class="va">self</span>,</span>
<span id="cb18-8"><a href="#cb18-8"></a>        teacher_model: <span class="bu">str</span>,  <span class="co"># 큰 모델 (GPT-4 등)</span></span>
<span id="cb18-9"><a href="#cb18-9"></a>        student_model: <span class="bu">str</span>,  <span class="co"># 작은 모델 (LLaMA-7B 등)</span></span>
<span id="cb18-10"><a href="#cb18-10"></a>        training_questions: List[<span class="bu">str</span>]</span>
<span id="cb18-11"><a href="#cb18-11"></a>    ):</span>
<span id="cb18-12"><a href="#cb18-12"></a>        <span class="co">"""</span></span>
<span id="cb18-13"><a href="#cb18-13"></a><span class="co">        Teacher 모델에서 Student 모델로 증류</span></span>
<span id="cb18-14"><a href="#cb18-14"></a><span class="co">        </span></span>
<span id="cb18-15"><a href="#cb18-15"></a><span class="co">        프로세스:</span></span>
<span id="cb18-16"><a href="#cb18-16"></a><span class="co">        1. Teacher가 각 질문에 대한 힌트 생성</span></span>
<span id="cb18-17"><a href="#cb18-17"></a><span class="co">        2. Student가 같은 힌트를 생성하도록 학습</span></span>
<span id="cb18-18"><a href="#cb18-18"></a><span class="co">        """</span></span>
<span id="cb18-19"><a href="#cb18-19"></a>        <span class="bu">print</span>(<span class="ss">f"📚 지식 증류 시작"</span>)</span>
<span id="cb18-20"><a href="#cb18-20"></a>        <span class="bu">print</span>(<span class="ss">f"   Teacher: </span><span class="sc">{</span>teacher_model<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb18-21"><a href="#cb18-21"></a>        <span class="bu">print</span>(<span class="ss">f"   Student: </span><span class="sc">{</span>student_model<span class="sc">}</span><span class="ch">\n</span><span class="ss">"</span>)</span>
<span id="cb18-22"><a href="#cb18-22"></a>        </span>
<span id="cb18-23"><a href="#cb18-23"></a>        <span class="co"># Step 1: Teacher로 힌트 생성</span></span>
<span id="cb18-24"><a href="#cb18-24"></a>        teacher_outputs <span class="op">=</span> []</span>
<span id="cb18-25"><a href="#cb18-25"></a>        </span>
<span id="cb18-26"><a href="#cb18-26"></a>        <span class="cf">for</span> question <span class="kw">in</span> training_questions:</span>
<span id="cb18-27"><a href="#cb18-27"></a>            hints <span class="op">=</span> <span class="va">self</span>._teacher_generate_hints(</span>
<span id="cb18-28"><a href="#cb18-28"></a>                teacher_model,</span>
<span id="cb18-29"><a href="#cb18-29"></a>                question,</span>
<span id="cb18-30"><a href="#cb18-30"></a>                num_hints<span class="op">=</span><span class="dv">3</span></span>
<span id="cb18-31"><a href="#cb18-31"></a>            )</span>
<span id="cb18-32"><a href="#cb18-32"></a>            </span>
<span id="cb18-33"><a href="#cb18-33"></a>            teacher_outputs.append({</span>
<span id="cb18-34"><a href="#cb18-34"></a>                <span class="st">'question'</span>: question,</span>
<span id="cb18-35"><a href="#cb18-35"></a>                <span class="st">'hints'</span>: hints</span>
<span id="cb18-36"><a href="#cb18-36"></a>            })</span>
<span id="cb18-37"><a href="#cb18-37"></a>        </span>
<span id="cb18-38"><a href="#cb18-38"></a>        <span class="bu">print</span>(<span class="ss">f"✅ Teacher가 </span><span class="sc">{</span><span class="bu">len</span>(teacher_outputs)<span class="sc">}</span><span class="ss">개 질문에 대한 힌트 생성</span><span class="ch">\n</span><span class="ss">"</span>)</span>
<span id="cb18-39"><a href="#cb18-39"></a>        </span>
<span id="cb18-40"><a href="#cb18-40"></a>        <span class="co"># Step 2: Student 학습</span></span>
<span id="cb18-41"><a href="#cb18-41"></a>        <span class="bu">print</span>(<span class="st">"🎓 Student 학습 중..."</span>)</span>
<span id="cb18-42"><a href="#cb18-42"></a>        </span>
<span id="cb18-43"><a href="#cb18-43"></a>        <span class="cf">for</span> epoch <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">3</span>):  <span class="co"># 3 에폭</span></span>
<span id="cb18-44"><a href="#cb18-44"></a>            loss <span class="op">=</span> <span class="va">self</span>._train_student(</span>
<span id="cb18-45"><a href="#cb18-45"></a>                student_model,</span>
<span id="cb18-46"><a href="#cb18-46"></a>                teacher_outputs</span>
<span id="cb18-47"><a href="#cb18-47"></a>            )</span>
<span id="cb18-48"><a href="#cb18-48"></a>            </span>
<span id="cb18-49"><a href="#cb18-49"></a>            <span class="bu">print</span>(<span class="ss">f"  Epoch </span><span class="sc">{</span>epoch <span class="op">+</span> <span class="dv">1</span><span class="sc">}</span><span class="ss">: Loss = </span><span class="sc">{</span>loss<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb18-50"><a href="#cb18-50"></a>        </span>
<span id="cb18-51"><a href="#cb18-51"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">✅ 증류 완료"</span>)</span>
<span id="cb18-52"><a href="#cb18-52"></a>    </span>
<span id="cb18-53"><a href="#cb18-53"></a>    <span class="kw">def</span> _teacher_generate_hints(</span>
<span id="cb18-54"><a href="#cb18-54"></a>        <span class="va">self</span>,</span>
<span id="cb18-55"><a href="#cb18-55"></a>        teacher_model: <span class="bu">str</span>,</span>
<span id="cb18-56"><a href="#cb18-56"></a>        question: <span class="bu">str</span>,</span>
<span id="cb18-57"><a href="#cb18-57"></a>        num_hints: <span class="bu">int</span></span>
<span id="cb18-58"><a href="#cb18-58"></a>    ) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb18-59"><a href="#cb18-59"></a>        <span class="co">"""</span></span>
<span id="cb18-60"><a href="#cb18-60"></a><span class="co">        Teacher 모델로 힌트 생성</span></span>
<span id="cb18-61"><a href="#cb18-61"></a><span class="co">        """</span></span>
<span id="cb18-62"><a href="#cb18-62"></a>        prompt <span class="op">=</span> <span class="ss">f"""질문에 대한 효과적인 힌트를 </span><span class="sc">{</span>num_hints<span class="sc">}</span><span class="ss">개 생성하세요.</span></span>
<span id="cb18-63"><a href="#cb18-63"></a></span>
<span id="cb18-64"><a href="#cb18-64"></a><span class="ss">        질문: </span><span class="sc">{</span>question<span class="sc">}</span></span>
<span id="cb18-65"><a href="#cb18-65"></a></span>
<span id="cb18-66"><a href="#cb18-66"></a><span class="ss">        힌트들:</span></span>
<span id="cb18-67"><a href="#cb18-67"></a><span class="ss">        1."""</span></span>
<span id="cb18-68"><a href="#cb18-68"></a>        </span>
<span id="cb18-69"><a href="#cb18-69"></a>        <span class="co"># Teacher 모델 호출</span></span>
<span id="cb18-70"><a href="#cb18-70"></a>        <span class="co"># hints = teacher_llm.generate(prompt)</span></span>
<span id="cb18-71"><a href="#cb18-71"></a>        </span>
<span id="cb18-72"><a href="#cb18-72"></a>        <span class="cf">return</span> hints</span>
<span id="cb18-73"><a href="#cb18-73"></a>    </span>
<span id="cb18-74"><a href="#cb18-74"></a>    <span class="kw">def</span> _train_student(</span>
<span id="cb18-75"><a href="#cb18-75"></a>        <span class="va">self</span>,</span>
<span id="cb18-76"><a href="#cb18-76"></a>        student_model: <span class="bu">str</span>,</span>
<span id="cb18-77"><a href="#cb18-77"></a>        teacher_outputs: List[Dict]</span>
<span id="cb18-78"><a href="#cb18-78"></a>    ) <span class="op">-&gt;</span> <span class="bu">float</span>:</span>
<span id="cb18-79"><a href="#cb18-79"></a>        <span class="co">"""</span></span>
<span id="cb18-80"><a href="#cb18-80"></a><span class="co">        Student 모델 학습</span></span>
<span id="cb18-81"><a href="#cb18-81"></a><span class="co">        </span></span>
<span id="cb18-82"><a href="#cb18-82"></a><span class="co">        Loss: Student 출력과 Teacher 출력의 차이</span></span>
<span id="cb18-83"><a href="#cb18-83"></a><span class="co">        """</span></span>
<span id="cb18-84"><a href="#cb18-84"></a>        total_loss <span class="op">=</span> <span class="fl">0.0</span></span>
<span id="cb18-85"><a href="#cb18-85"></a>        </span>
<span id="cb18-86"><a href="#cb18-86"></a>        <span class="cf">for</span> data <span class="kw">in</span> teacher_outputs:</span>
<span id="cb18-87"><a href="#cb18-87"></a>            question <span class="op">=</span> data[<span class="st">'question'</span>]</span>
<span id="cb18-88"><a href="#cb18-88"></a>            teacher_hints <span class="op">=</span> data[<span class="st">'hints'</span>]</span>
<span id="cb18-89"><a href="#cb18-89"></a>            </span>
<span id="cb18-90"><a href="#cb18-90"></a>            <span class="co"># Student 출력</span></span>
<span id="cb18-91"><a href="#cb18-91"></a>            student_hints <span class="op">=</span> <span class="va">self</span>._student_generate(student_model, question)</span>
<span id="cb18-92"><a href="#cb18-92"></a>            </span>
<span id="cb18-93"><a href="#cb18-93"></a>            <span class="co"># KL Divergence 또는 Cross-Entropy</span></span>
<span id="cb18-94"><a href="#cb18-94"></a>            loss <span class="op">=</span> <span class="va">self</span>._compute_distillation_loss(</span>
<span id="cb18-95"><a href="#cb18-95"></a>                teacher_hints,</span>
<span id="cb18-96"><a href="#cb18-96"></a>                student_hints</span>
<span id="cb18-97"><a href="#cb18-97"></a>            )</span>
<span id="cb18-98"><a href="#cb18-98"></a>            </span>
<span id="cb18-99"><a href="#cb18-99"></a>            total_loss <span class="op">+=</span> loss</span>
<span id="cb18-100"><a href="#cb18-100"></a>            </span>
<span id="cb18-101"><a href="#cb18-101"></a>            <span class="co"># Backpropagation</span></span>
<span id="cb18-102"><a href="#cb18-102"></a>            <span class="co"># optimizer.step()</span></span>
<span id="cb18-103"><a href="#cb18-103"></a>        </span>
<span id="cb18-104"><a href="#cb18-104"></a>        <span class="cf">return</span> total_loss <span class="op">/</span> <span class="bu">len</span>(teacher_outputs)</span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="다양한-선택-전략-비교" class="level2" data-number="10">
<h2 data-number="10" class="anchored" data-anchor-id="다양한-선택-전략-비교"><span class="header-section-number">10</span> 다양한 선택 전략 비교</h2>
<section id="전략-비교표" class="level3" data-number="10.1">
<h3 data-number="10.1" class="anchored" data-anchor-id="전략-비교표"><span class="header-section-number">10.1</span> 전략 비교표</h3>
<table class="table">
<colgroup>
<col style="width: 15%">
<col style="width: 18%">
<col style="width: 18%">
<col style="width: 18%">
<col style="width: 30%">
</colgroup>
<thead>
<tr class="header">
<th>전략</th>
<th>장점</th>
<th>단점</th>
<th>비용</th>
<th>추천 상황</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Quality-based</strong></td>
<td>최고 품질 보장</td>
<td>모든 후보 평가 필요</td>
<td>높음</td>
<td>품질 중요</td>
</tr>
<tr class="even">
<td><strong>Diversity-based</strong></td>
<td>다양한 관점</td>
<td>최적이 아닐 수 있음</td>
<td>중간</td>
<td>탐색 중요</td>
</tr>
<tr class="odd">
<td><strong>Ensemble</strong></td>
<td>견고함</td>
<td>매우 비쌈</td>
<td>매우 높음</td>
<td>중요한 결정</td>
</tr>
<tr class="even">
<td><strong>Random</strong></td>
<td>빠름</td>
<td>품질 보장 없음</td>
<td>낮음</td>
<td>프로토타입</td>
</tr>
<tr class="odd">
<td><strong>Template</strong></td>
<td>일관성</td>
<td>창의성 부족</td>
<td>낮음</td>
<td>구조화된 도메인</td>
</tr>
</tbody>
</table>
</section>
<section id="실험-비교" class="level3" data-number="10.2">
<h3 data-number="10.2" class="anchored" data-anchor-id="실험-비교"><span class="header-section-number">10.2</span> 실험 비교</h3>
<div class="sourceCode" id="cb19"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1"></a><span class="kw">def</span> compare_selection_strategies(</span>
<span id="cb19-2"><a href="#cb19-2"></a>    question: <span class="bu">str</span>,</span>
<span id="cb19-3"><a href="#cb19-3"></a>    num_trials: <span class="bu">int</span> <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb19-4"><a href="#cb19-4"></a>) <span class="op">-&gt;</span> Dict:</span>
<span id="cb19-5"><a href="#cb19-5"></a>    <span class="co">"""</span></span>
<span id="cb19-6"><a href="#cb19-6"></a><span class="co">    다양한 선택 전략 비교</span></span>
<span id="cb19-7"><a href="#cb19-7"></a><span class="co">    """</span></span>
<span id="cb19-8"><a href="#cb19-8"></a>    dsp <span class="op">=</span> DirectionalStimulusPrompting(</span>
<span id="cb19-9"><a href="#cb19-9"></a>        policy_api_key<span class="op">=</span><span class="st">"key1"</span>,</span>
<span id="cb19-10"><a href="#cb19-10"></a>        target_api_key<span class="op">=</span><span class="st">"key2"</span></span>
<span id="cb19-11"><a href="#cb19-11"></a>    )</span>
<span id="cb19-12"><a href="#cb19-12"></a>    </span>
<span id="cb19-13"><a href="#cb19-13"></a>    results <span class="op">=</span> {</span>
<span id="cb19-14"><a href="#cb19-14"></a>        <span class="st">'quality'</span>: [],</span>
<span id="cb19-15"><a href="#cb19-15"></a>        <span class="st">'diversity'</span>: [],</span>
<span id="cb19-16"><a href="#cb19-16"></a>        <span class="st">'ensemble'</span>: [],</span>
<span id="cb19-17"><a href="#cb19-17"></a>        <span class="st">'random'</span>: []</span>
<span id="cb19-18"><a href="#cb19-18"></a>    }</span>
<span id="cb19-19"><a href="#cb19-19"></a>    </span>
<span id="cb19-20"><a href="#cb19-20"></a>    <span class="cf">for</span> trial <span class="kw">in</span> <span class="bu">range</span>(num_trials):</span>
<span id="cb19-21"><a href="#cb19-21"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Trial </span><span class="sc">{</span>trial <span class="op">+</span> <span class="dv">1</span><span class="sc">}</span><span class="ss">/</span><span class="sc">{</span>num_trials<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb19-22"><a href="#cb19-22"></a>        </span>
<span id="cb19-23"><a href="#cb19-23"></a>        <span class="co"># 힌트 생성 (공통)</span></span>
<span id="cb19-24"><a href="#cb19-24"></a>        stimuli <span class="op">=</span> dsp.generate_stimulus(question, num_candidates<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb19-25"><a href="#cb19-25"></a>        </span>
<span id="cb19-26"><a href="#cb19-26"></a>        <span class="co"># Quality-based</span></span>
<span id="cb19-27"><a href="#cb19-27"></a>        result_q <span class="op">=</span> dsp.directional_stimulus_pipeline(</span>
<span id="cb19-28"><a href="#cb19-28"></a>            question,</span>
<span id="cb19-29"><a href="#cb19-29"></a>            selection_method<span class="op">=</span><span class="st">'quality'</span></span>
<span id="cb19-30"><a href="#cb19-30"></a>        )</span>
<span id="cb19-31"><a href="#cb19-31"></a>        score_q <span class="op">=</span> evaluate_answer(result_q[<span class="st">'final_answer'</span>])</span>
<span id="cb19-32"><a href="#cb19-32"></a>        results[<span class="st">'quality'</span>].append(score_q)</span>
<span id="cb19-33"><a href="#cb19-33"></a>        <span class="bu">print</span>(<span class="ss">f"  Quality: </span><span class="sc">{</span>score_q<span class="sc">:.3f}</span><span class="ss">"</span>)</span>
<span id="cb19-34"><a href="#cb19-34"></a>        </span>
<span id="cb19-35"><a href="#cb19-35"></a>        <span class="co"># Diversity-based</span></span>
<span id="cb19-36"><a href="#cb19-36"></a>        result_d <span class="op">=</span> dsp.directional_stimulus_pipeline(</span>
<span id="cb19-37"><a href="#cb19-37"></a>            question,</span>
<span id="cb19-38"><a href="#cb19-38"></a>            selection_method<span class="op">=</span><span class="st">'diversity'</span></span>
<span id="cb19-39"><a href="#cb19-39"></a>        )</span>
<span id="cb19-40"><a href="#cb19-40"></a>        <span class="co"># 여러 답변 중 평균</span></span>
<span id="cb19-41"><a href="#cb19-41"></a>        scores_d <span class="op">=</span> [evaluate_answer(a[<span class="st">'answer'</span>]) <span class="cf">for</span> a <span class="kw">in</span> result_d[<span class="st">'answers'</span>]]</span>
<span id="cb19-42"><a href="#cb19-42"></a>        score_d <span class="op">=</span> <span class="bu">sum</span>(scores_d) <span class="op">/</span> <span class="bu">len</span>(scores_d)</span>
<span id="cb19-43"><a href="#cb19-43"></a>        results[<span class="st">'diversity'</span>].append(score_d)</span>
<span id="cb19-44"><a href="#cb19-44"></a>        <span class="bu">print</span>(<span class="ss">f"  Diversity: </span><span class="sc">{</span>score_d<span class="sc">:.3f}</span><span class="ss">"</span>)</span>
<span id="cb19-45"><a href="#cb19-45"></a>        </span>
<span id="cb19-46"><a href="#cb19-46"></a>        <span class="co"># Ensemble</span></span>
<span id="cb19-47"><a href="#cb19-47"></a>        result_e <span class="op">=</span> dsp.directional_stimulus_pipeline(</span>
<span id="cb19-48"><a href="#cb19-48"></a>            question,</span>
<span id="cb19-49"><a href="#cb19-49"></a>            selection_method<span class="op">=</span><span class="st">'ensemble'</span></span>
<span id="cb19-50"><a href="#cb19-50"></a>        )</span>
<span id="cb19-51"><a href="#cb19-51"></a>        score_e <span class="op">=</span> evaluate_answer(result_e[<span class="st">'ensemble_answer'</span>])</span>
<span id="cb19-52"><a href="#cb19-52"></a>        results[<span class="st">'ensemble'</span>].append(score_e)</span>
<span id="cb19-53"><a href="#cb19-53"></a>        <span class="bu">print</span>(<span class="ss">f"  Ensemble: </span><span class="sc">{</span>score_e<span class="sc">:.3f}</span><span class="ss">"</span>)</span>
<span id="cb19-54"><a href="#cb19-54"></a>        </span>
<span id="cb19-55"><a href="#cb19-55"></a>        <span class="co"># Random</span></span>
<span id="cb19-56"><a href="#cb19-56"></a>        <span class="im">import</span> random</span>
<span id="cb19-57"><a href="#cb19-57"></a>        random_stimulus <span class="op">=</span> random.choice(stimuli)</span>
<span id="cb19-58"><a href="#cb19-58"></a>        answer_r <span class="op">=</span> dsp.answer_with_stimulus(question, random_stimulus)</span>
<span id="cb19-59"><a href="#cb19-59"></a>        score_r <span class="op">=</span> evaluate_answer(answer_r)</span>
<span id="cb19-60"><a href="#cb19-60"></a>        results[<span class="st">'random'</span>].append(score_r)</span>
<span id="cb19-61"><a href="#cb19-61"></a>        <span class="bu">print</span>(<span class="ss">f"  Random: </span><span class="sc">{</span>score_r<span class="sc">:.3f}</span><span class="ss">"</span>)</span>
<span id="cb19-62"><a href="#cb19-62"></a>    </span>
<span id="cb19-63"><a href="#cb19-63"></a>    <span class="co"># 통계 분석</span></span>
<span id="cb19-64"><a href="#cb19-64"></a>    <span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb19-65"><a href="#cb19-65"></a>    </span>
<span id="cb19-66"><a href="#cb19-66"></a>    <span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span> <span class="op">+</span> <span class="st">"="</span><span class="op">*</span><span class="dv">80</span>)</span>
<span id="cb19-67"><a href="#cb19-67"></a>    <span class="bu">print</span>(<span class="st">"결과 요약"</span>)</span>
<span id="cb19-68"><a href="#cb19-68"></a>    <span class="bu">print</span>(<span class="st">"="</span><span class="op">*</span><span class="dv">80</span>)</span>
<span id="cb19-69"><a href="#cb19-69"></a>    </span>
<span id="cb19-70"><a href="#cb19-70"></a>    <span class="cf">for</span> strategy, scores <span class="kw">in</span> results.items():</span>
<span id="cb19-71"><a href="#cb19-71"></a>        mean <span class="op">=</span> np.mean(scores)</span>
<span id="cb19-72"><a href="#cb19-72"></a>        std <span class="op">=</span> np.std(scores)</span>
<span id="cb19-73"><a href="#cb19-73"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>strategy<span class="sc">:12s}</span><span class="ss">: </span><span class="sc">{</span>mean<span class="sc">:.3f}</span><span class="ss"> (±</span><span class="sc">{</span>std<span class="sc">:.3f}</span><span class="ss">)"</span>)</span>
<span id="cb19-74"><a href="#cb19-74"></a>    </span>
<span id="cb19-75"><a href="#cb19-75"></a>    <span class="cf">return</span> results</span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>실험 결과 예시</strong>:</p>
<pre><code>================================================================================
결과 요약
================================================================================
quality     : 0.842 (±0.023)  ← 가장 높음
diversity   : 0.815 (±0.031)
ensemble    : 0.851 (±0.018)  ← 가장 안정적
random      : 0.773 (±0.047)  ← 가장 낮음, 분산 큼</code></pre>
</section>
</section>
<section id="실무-적용-시나리오" class="level2" data-number="11">
<h2 data-number="11" class="anchored" data-anchor-id="실무-적용-시나리오"><span class="header-section-number">11</span> 실무 적용 시나리오</h2>
<section id="시나리오-1-고객-지원-챗봇" class="level3" data-number="11.1">
<h3 data-number="11.1" class="anchored" data-anchor-id="시나리오-1-고객-지원-챗봇"><span class="header-section-number">11.1</span> 시나리오 1: 고객 지원 챗봇</h3>
<div class="sourceCode" id="cb21"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1"></a><span class="kw">class</span> CustomerSupportDSP:</span>
<span id="cb21-2"><a href="#cb21-2"></a>    <span class="co">"""</span></span>
<span id="cb21-3"><a href="#cb21-3"></a><span class="co">    고객 지원용 Directional Stimulus</span></span>
<span id="cb21-4"><a href="#cb21-4"></a><span class="co">    """</span></span>
<span id="cb21-5"><a href="#cb21-5"></a>    </span>
<span id="cb21-6"><a href="#cb21-6"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb21-7"><a href="#cb21-7"></a>        <span class="va">self</span>.dsp <span class="op">=</span> DirectionalStimulusPrompting(</span>
<span id="cb21-8"><a href="#cb21-8"></a>            policy_api_key<span class="op">=</span><span class="st">"key1"</span>,</span>
<span id="cb21-9"><a href="#cb21-9"></a>            target_api_key<span class="op">=</span><span class="st">"key2"</span></span>
<span id="cb21-10"><a href="#cb21-10"></a>        )</span>
<span id="cb21-11"><a href="#cb21-11"></a>        </span>
<span id="cb21-12"><a href="#cb21-12"></a>        <span class="co"># 도메인 특화 힌트 템플릿</span></span>
<span id="cb21-13"><a href="#cb21-13"></a>        <span class="va">self</span>.support_templates <span class="op">=</span> {</span>
<span id="cb21-14"><a href="#cb21-14"></a>            <span class="st">'technical'</span>: <span class="st">"기술적 세부사항과 해결 단계를 포함하세요"</span>,</span>
<span id="cb21-15"><a href="#cb21-15"></a>            <span class="st">'billing'</span>: <span class="st">"정책과 절차를 명확히 설명하세요"</span>,</span>
<span id="cb21-16"><a href="#cb21-16"></a>            <span class="st">'general'</span>: <span class="st">"친절하고 이해하기 쉽게 답변하세요"</span>,</span>
<span id="cb21-17"><a href="#cb21-17"></a>            <span class="st">'complaint'</span>: <span class="st">"공감하고 구체적인 해결책을 제시하세요"</span></span>
<span id="cb21-18"><a href="#cb21-18"></a>        }</span>
<span id="cb21-19"><a href="#cb21-19"></a>    </span>
<span id="cb21-20"><a href="#cb21-20"></a>    <span class="kw">def</span> handle_customer_query(</span>
<span id="cb21-21"><a href="#cb21-21"></a>        <span class="va">self</span>,</span>
<span id="cb21-22"><a href="#cb21-22"></a>        query: <span class="bu">str</span>,</span>
<span id="cb21-23"><a href="#cb21-23"></a>        customer_history: Dict <span class="op">=</span> <span class="va">None</span></span>
<span id="cb21-24"><a href="#cb21-24"></a>    ) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb21-25"><a href="#cb21-25"></a>        <span class="co">"""</span></span>
<span id="cb21-26"><a href="#cb21-26"></a><span class="co">        고객 질의 처리</span></span>
<span id="cb21-27"><a href="#cb21-27"></a><span class="co">        </span></span>
<span id="cb21-28"><a href="#cb21-28"></a><span class="co">        Args:</span></span>
<span id="cb21-29"><a href="#cb21-29"></a><span class="co">            query: 고객 질문</span></span>
<span id="cb21-30"><a href="#cb21-30"></a><span class="co">            customer_history: 고객 이력 (선택적)</span></span>
<span id="cb21-31"><a href="#cb21-31"></a><span class="co">        """</span></span>
<span id="cb21-32"><a href="#cb21-32"></a>        <span class="co"># Step 1: 질의 유형 분류</span></span>
<span id="cb21-33"><a href="#cb21-33"></a>        query_type <span class="op">=</span> <span class="va">self</span>._classify_query(query)</span>
<span id="cb21-34"><a href="#cb21-34"></a>        </span>
<span id="cb21-35"><a href="#cb21-35"></a>        <span class="bu">print</span>(<span class="ss">f"질의 유형: </span><span class="sc">{</span>query_type<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb21-36"><a href="#cb21-36"></a>        </span>
<span id="cb21-37"><a href="#cb21-37"></a>        <span class="co"># Step 2: 유형에 맞는 힌트 템플릿 선택</span></span>
<span id="cb21-38"><a href="#cb21-38"></a>        base_stimulus <span class="op">=</span> <span class="va">self</span>.support_templates[query_type]</span>
<span id="cb21-39"><a href="#cb21-39"></a>        </span>
<span id="cb21-40"><a href="#cb21-40"></a>        <span class="co"># Step 3: 고객 이력 고려</span></span>
<span id="cb21-41"><a href="#cb21-41"></a>        <span class="cf">if</span> customer_history:</span>
<span id="cb21-42"><a href="#cb21-42"></a>            context_stimulus <span class="op">=</span> <span class="va">self</span>._add_context(</span>
<span id="cb21-43"><a href="#cb21-43"></a>                base_stimulus,</span>
<span id="cb21-44"><a href="#cb21-44"></a>                customer_history</span>
<span id="cb21-45"><a href="#cb21-45"></a>            )</span>
<span id="cb21-46"><a href="#cb21-46"></a>        <span class="cf">else</span>:</span>
<span id="cb21-47"><a href="#cb21-47"></a>            context_stimulus <span class="op">=</span> base_stimulus</span>
<span id="cb21-48"><a href="#cb21-48"></a>        </span>
<span id="cb21-49"><a href="#cb21-49"></a>        <span class="bu">print</span>(<span class="ss">f"힌트: </span><span class="sc">{</span>context_stimulus<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb21-50"><a href="#cb21-50"></a>        </span>
<span id="cb21-51"><a href="#cb21-51"></a>        <span class="co"># Step 4: 답변 생성</span></span>
<span id="cb21-52"><a href="#cb21-52"></a>        answer <span class="op">=</span> <span class="va">self</span>.dsp.answer_with_stimulus(query, context_stimulus)</span>
<span id="cb21-53"><a href="#cb21-53"></a>        </span>
<span id="cb21-54"><a href="#cb21-54"></a>        <span class="cf">return</span> answer</span>
<span id="cb21-55"><a href="#cb21-55"></a>    </span>
<span id="cb21-56"><a href="#cb21-56"></a>    <span class="kw">def</span> _classify_query(<span class="va">self</span>, query: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb21-57"><a href="#cb21-57"></a>        <span class="co">"""질의 유형 분류"""</span></span>
<span id="cb21-58"><a href="#cb21-58"></a>        keywords <span class="op">=</span> {</span>
<span id="cb21-59"><a href="#cb21-59"></a>            <span class="st">'technical'</span>: [<span class="st">'작동'</span>, <span class="st">'오류'</span>, <span class="st">'설정'</span>, <span class="st">'설치'</span>, <span class="st">'문제'</span>],</span>
<span id="cb21-60"><a href="#cb21-60"></a>            <span class="st">'billing'</span>: [<span class="st">'요금'</span>, <span class="st">'결제'</span>, <span class="st">'청구'</span>, <span class="st">'환불'</span>, <span class="st">'가격'</span>],</span>
<span id="cb21-61"><a href="#cb21-61"></a>            <span class="st">'complaint'</span>: [<span class="st">'불만'</span>, <span class="st">'화나'</span>, <span class="st">'실망'</span>, <span class="st">'최악'</span>, <span class="st">'형편없'</span>]</span>
<span id="cb21-62"><a href="#cb21-62"></a>        }</span>
<span id="cb21-63"><a href="#cb21-63"></a>        </span>
<span id="cb21-64"><a href="#cb21-64"></a>        query_lower <span class="op">=</span> query.lower()</span>
<span id="cb21-65"><a href="#cb21-65"></a>        </span>
<span id="cb21-66"><a href="#cb21-66"></a>        <span class="cf">for</span> qtype, kws <span class="kw">in</span> keywords.items():</span>
<span id="cb21-67"><a href="#cb21-67"></a>            <span class="cf">if</span> <span class="bu">any</span>(kw <span class="kw">in</span> query_lower <span class="cf">for</span> kw <span class="kw">in</span> kws):</span>
<span id="cb21-68"><a href="#cb21-68"></a>                <span class="cf">return</span> qtype</span>
<span id="cb21-69"><a href="#cb21-69"></a>        </span>
<span id="cb21-70"><a href="#cb21-70"></a>        <span class="cf">return</span> <span class="st">'general'</span></span>
<span id="cb21-71"><a href="#cb21-71"></a>    </span>
<span id="cb21-72"><a href="#cb21-72"></a>    <span class="kw">def</span> _add_context(</span>
<span id="cb21-73"><a href="#cb21-73"></a>        <span class="va">self</span>,</span>
<span id="cb21-74"><a href="#cb21-74"></a>        base_stimulus: <span class="bu">str</span>,</span>
<span id="cb21-75"><a href="#cb21-75"></a>        customer_history: Dict</span>
<span id="cb21-76"><a href="#cb21-76"></a>    ) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb21-77"><a href="#cb21-77"></a>        <span class="co">"""</span></span>
<span id="cb21-78"><a href="#cb21-78"></a><span class="co">        고객 이력 반영</span></span>
<span id="cb21-79"><a href="#cb21-79"></a><span class="co">        """</span></span>
<span id="cb21-80"><a href="#cb21-80"></a>        context_parts <span class="op">=</span> [base_stimulus]</span>
<span id="cb21-81"><a href="#cb21-81"></a>        </span>
<span id="cb21-82"><a href="#cb21-82"></a>        <span class="cf">if</span> customer_history.get(<span class="st">'is_premium'</span>):</span>
<span id="cb21-83"><a href="#cb21-83"></a>            context_parts.append(<span class="st">"프리미엄 고객 우대 정책을 언급하세요"</span>)</span>
<span id="cb21-84"><a href="#cb21-84"></a>        </span>
<span id="cb21-85"><a href="#cb21-85"></a>        <span class="cf">if</span> customer_history.get(<span class="st">'previous_issues'</span>, <span class="dv">0</span>) <span class="op">&gt;</span> <span class="dv">2</span>:</span>
<span id="cb21-86"><a href="#cb21-86"></a>            context_parts.append(<span class="st">"이전 문제를 인지하고 특별한 주의를 기울이세요"</span>)</span>
<span id="cb21-87"><a href="#cb21-87"></a>        </span>
<span id="cb21-88"><a href="#cb21-88"></a>        <span class="cf">return</span> <span class="st">". "</span>.join(context_parts)</span>
<span id="cb21-89"><a href="#cb21-89"></a></span>
<span id="cb21-90"><a href="#cb21-90"></a></span>
<span id="cb21-91"><a href="#cb21-91"></a><span class="co"># 사용</span></span>
<span id="cb21-92"><a href="#cb21-92"></a>support <span class="op">=</span> CustomerSupportDSP()</span>
<span id="cb21-93"><a href="#cb21-93"></a></span>
<span id="cb21-94"><a href="#cb21-94"></a>query <span class="op">=</span> <span class="st">"제품이 계속 오류가 나서 화가 납니다"</span></span>
<span id="cb21-95"><a href="#cb21-95"></a>customer <span class="op">=</span> {</span>
<span id="cb21-96"><a href="#cb21-96"></a>    <span class="st">'is_premium'</span>: <span class="va">True</span>,</span>
<span id="cb21-97"><a href="#cb21-97"></a>    <span class="st">'previous_issues'</span>: <span class="dv">3</span></span>
<span id="cb21-98"><a href="#cb21-98"></a>}</span>
<span id="cb21-99"><a href="#cb21-99"></a></span>
<span id="cb21-100"><a href="#cb21-100"></a>answer <span class="op">=</span> support.handle_customer_query(query, customer)</span>
<span id="cb21-101"><a href="#cb21-101"></a></span>
<span id="cb21-102"><a href="#cb21-102"></a><span class="co"># 출력:</span></span>
<span id="cb21-103"><a href="#cb21-103"></a><span class="co"># 질의 유형: complaint</span></span>
<span id="cb21-104"><a href="#cb21-104"></a><span class="co"># 힌트: 공감하고 구체적인 해결책을 제시하세요. 프리미엄 고객 우대 정책을 언급하세요. 이전 문제를 인지하고 특별한 주의를 기울이세요</span></span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="시나리오-2-교육-플랫폼" class="level3" data-number="11.2">
<h3 data-number="11.2" class="anchored" data-anchor-id="시나리오-2-교육-플랫폼"><span class="header-section-number">11.2</span> 시나리오 2: 교육 플랫폼</h3>
<div class="sourceCode" id="cb22"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1"></a><span class="kw">class</span> EducationalDSP:</span>
<span id="cb22-2"><a href="#cb22-2"></a>    <span class="co">"""</span></span>
<span id="cb22-3"><a href="#cb22-3"></a><span class="co">    교육용 맞춤형 힌트 생성</span></span>
<span id="cb22-4"><a href="#cb22-4"></a><span class="co">    """</span></span>
<span id="cb22-5"><a href="#cb22-5"></a>    </span>
<span id="cb22-6"><a href="#cb22-6"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb22-7"><a href="#cb22-7"></a>        <span class="va">self</span>.dsp <span class="op">=</span> DirectionalStimulusPrompting(</span>
<span id="cb22-8"><a href="#cb22-8"></a>            policy_api_key<span class="op">=</span><span class="st">"key1"</span>,</span>
<span id="cb22-9"><a href="#cb22-9"></a>            target_api_key<span class="op">=</span><span class="st">"key2"</span></span>
<span id="cb22-10"><a href="#cb22-10"></a>        )</span>
<span id="cb22-11"><a href="#cb22-11"></a>    </span>
<span id="cb22-12"><a href="#cb22-12"></a>    <span class="kw">def</span> generate_adaptive_hint(</span>
<span id="cb22-13"><a href="#cb22-13"></a>        <span class="va">self</span>,</span>
<span id="cb22-14"><a href="#cb22-14"></a>        question: <span class="bu">str</span>,</span>
<span id="cb22-15"><a href="#cb22-15"></a>        student_level: <span class="bu">str</span>,  <span class="co"># 'beginner', 'intermediate', 'advanced'</span></span>
<span id="cb22-16"><a href="#cb22-16"></a>        learning_style: <span class="bu">str</span>  <span class="co"># 'visual', 'verbal', 'logical'</span></span>
<span id="cb22-17"><a href="#cb22-17"></a>    ) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb22-18"><a href="#cb22-18"></a>        <span class="co">"""</span></span>
<span id="cb22-19"><a href="#cb22-19"></a><span class="co">        학생 수준과 학습 스타일에 맞는 힌트 생성</span></span>
<span id="cb22-20"><a href="#cb22-20"></a><span class="co">        """</span></span>
<span id="cb22-21"><a href="#cb22-21"></a>        <span class="co"># 수준별 힌트 조정</span></span>
<span id="cb22-22"><a href="#cb22-22"></a>        level_adjustments <span class="op">=</span> {</span>
<span id="cb22-23"><a href="#cb22-23"></a>            <span class="st">'beginner'</span>: <span class="st">"기본 개념부터 단계별로 설명하세요"</span>,</span>
<span id="cb22-24"><a href="#cb22-24"></a>            <span class="st">'intermediate'</span>: <span class="st">"개념을 응용하여 설명하세요"</span>,</span>
<span id="cb22-25"><a href="#cb22-25"></a>            <span class="st">'advanced'</span>: <span class="st">"심화 내용과 함의를 논의하세요"</span></span>
<span id="cb22-26"><a href="#cb22-26"></a>        }</span>
<span id="cb22-27"><a href="#cb22-27"></a>        </span>
<span id="cb22-28"><a href="#cb22-28"></a>        <span class="co"># 학습 스타일별 조정</span></span>
<span id="cb22-29"><a href="#cb22-29"></a>        style_adjustments <span class="op">=</span> {</span>
<span id="cb22-30"><a href="#cb22-30"></a>            <span class="st">'visual'</span>: <span class="st">"다이어그램이나 예시로 시각화하여 설명하세요"</span>,</span>
<span id="cb22-31"><a href="#cb22-31"></a>            <span class="st">'verbal'</span>: <span class="st">"상세한 설명과 비유를 사용하세요"</span>,</span>
<span id="cb22-32"><a href="#cb22-32"></a>            <span class="st">'logical'</span>: <span class="st">"논리적 단계와 추론 과정을 명확히 하세요"</span></span>
<span id="cb22-33"><a href="#cb22-33"></a>        }</span>
<span id="cb22-34"><a href="#cb22-34"></a>        </span>
<span id="cb22-35"><a href="#cb22-35"></a>        <span class="co"># 힌트 조합</span></span>
<span id="cb22-36"><a href="#cb22-36"></a>        stimulus <span class="op">=</span> <span class="ss">f"""</span><span class="sc">{</span>level_adjustments[student_level]<span class="sc">}</span><span class="ss">. </span><span class="sc">{</span>style_adjustments[learning_style]<span class="sc">}</span><span class="ss">."""</span></span>
<span id="cb22-37"><a href="#cb22-37"></a>        </span>
<span id="cb22-38"><a href="#cb22-38"></a>        <span class="bu">print</span>(<span class="ss">f"학생 수준: </span><span class="sc">{</span>student_level<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb22-39"><a href="#cb22-39"></a>        <span class="bu">print</span>(<span class="ss">f"학습 스타일: </span><span class="sc">{</span>learning_style<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb22-40"><a href="#cb22-40"></a>        <span class="bu">print</span>(<span class="ss">f"맞춤 힌트: </span><span class="sc">{</span>stimulus<span class="sc">}</span><span class="ch">\n</span><span class="ss">"</span>)</span>
<span id="cb22-41"><a href="#cb22-41"></a>        </span>
<span id="cb22-42"><a href="#cb22-42"></a>        <span class="co"># 답변 생성</span></span>
<span id="cb22-43"><a href="#cb22-43"></a>        answer <span class="op">=</span> <span class="va">self</span>.dsp.answer_with_stimulus(question, stimulus)</span>
<span id="cb22-44"><a href="#cb22-44"></a>        </span>
<span id="cb22-45"><a href="#cb22-45"></a>        <span class="cf">return</span> answer</span>
<span id="cb22-46"><a href="#cb22-46"></a></span>
<span id="cb22-47"><a href="#cb22-47"></a></span>
<span id="cb22-48"><a href="#cb22-48"></a><span class="co"># 사용</span></span>
<span id="cb22-49"><a href="#cb22-49"></a>edu <span class="op">=</span> EducationalDSP()</span>
<span id="cb22-50"><a href="#cb22-50"></a></span>
<span id="cb22-51"><a href="#cb22-51"></a>question <span class="op">=</span> <span class="st">"미적분에서 극한의 개념을 설명해주세요"</span></span>
<span id="cb22-52"><a href="#cb22-52"></a></span>
<span id="cb22-53"><a href="#cb22-53"></a><span class="co"># 초급 학생, 시각적 학습자</span></span>
<span id="cb22-54"><a href="#cb22-54"></a>answer_beginner <span class="op">=</span> edu.generate_adaptive_hint(</span>
<span id="cb22-55"><a href="#cb22-55"></a>    question,</span>
<span id="cb22-56"><a href="#cb22-56"></a>    student_level<span class="op">=</span><span class="st">'beginner'</span>,</span>
<span id="cb22-57"><a href="#cb22-57"></a>    learning_style<span class="op">=</span><span class="st">'visual'</span></span>
<span id="cb22-58"><a href="#cb22-58"></a>)</span>
<span id="cb22-59"><a href="#cb22-59"></a></span>
<span id="cb22-60"><a href="#cb22-60"></a><span class="co"># 고급 학생, 논리적 학습자</span></span>
<span id="cb22-61"><a href="#cb22-61"></a>answer_advanced <span class="op">=</span> edu.generate_adaptive_hint(</span>
<span id="cb22-62"><a href="#cb22-62"></a>    question,</span>
<span id="cb22-63"><a href="#cb22-63"></a>    student_level<span class="op">=</span><span class="st">'advanced'</span>,</span>
<span id="cb22-64"><a href="#cb22-64"></a>    learning_style<span class="op">=</span><span class="st">'logical'</span></span>
<span id="cb22-65"><a href="#cb22-65"></a>)</span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="시나리오-3-의료-상담" class="level3" data-number="11.3">
<h3 data-number="11.3" class="anchored" data-anchor-id="시나리오-3-의료-상담"><span class="header-section-number">11.3</span> 시나리오 3: 의료 상담</h3>
<div class="sourceCode" id="cb23"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1"></a><span class="kw">class</span> MedicalConsultationDSP:</span>
<span id="cb23-2"><a href="#cb23-2"></a>    <span class="co">"""</span></span>
<span id="cb23-3"><a href="#cb23-3"></a><span class="co">    의료 상담용 (주의: 실제 의료 조언 아님)</span></span>
<span id="cb23-4"><a href="#cb23-4"></a><span class="co">    """</span></span>
<span id="cb23-5"><a href="#cb23-5"></a>    </span>
<span id="cb23-6"><a href="#cb23-6"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb23-7"><a href="#cb23-7"></a>        <span class="va">self</span>.dsp <span class="op">=</span> DirectionalStimulusPrompting(</span>
<span id="cb23-8"><a href="#cb23-8"></a>            policy_api_key<span class="op">=</span><span class="st">"key1"</span>,</span>
<span id="cb23-9"><a href="#cb23-9"></a>            target_api_key<span class="op">=</span><span class="st">"key2"</span></span>
<span id="cb23-10"><a href="#cb23-10"></a>        )</span>
<span id="cb23-11"><a href="#cb23-11"></a>        </span>
<span id="cb23-12"><a href="#cb23-12"></a>        <span class="co"># 필수 안전 장치</span></span>
<span id="cb23-13"><a href="#cb23-13"></a>        <span class="va">self</span>.safety_stimulus <span class="op">=</span> <span class="st">"""면책 조항을 포함하세요: </span></span>
<span id="cb23-14"><a href="#cb23-14"></a><span class="st">"이는 일반적인 정보이며 전문 의료 조언을 대체하지 않습니다. </span></span>
<span id="cb23-15"><a href="#cb23-15"></a><span class="st">증상이 지속되면 의료 전문가와 상담하세요." """</span></span>
<span id="cb23-16"><a href="#cb23-16"></a>    </span>
<span id="cb23-17"><a href="#cb23-17"></a>    <span class="kw">def</span> provide_information(</span>
<span id="cb23-18"><a href="#cb23-18"></a>        <span class="va">self</span>,</span>
<span id="cb23-19"><a href="#cb23-19"></a>        query: <span class="bu">str</span>,</span>
<span id="cb23-20"><a href="#cb23-20"></a>        urgency_level: <span class="bu">str</span> <span class="op">=</span> <span class="st">'routine'</span></span>
<span id="cb23-21"><a href="#cb23-21"></a>    ) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb23-22"><a href="#cb23-22"></a>        <span class="co">"""</span></span>
<span id="cb23-23"><a href="#cb23-23"></a><span class="co">        의료 정보 제공</span></span>
<span id="cb23-24"><a href="#cb23-24"></a><span class="co">        </span></span>
<span id="cb23-25"><a href="#cb23-25"></a><span class="co">        Args:</span></span>
<span id="cb23-26"><a href="#cb23-26"></a><span class="co">            query: 질문</span></span>
<span id="cb23-27"><a href="#cb23-27"></a><span class="co">            urgency_level: 'routine', 'concerning', 'emergency'</span></span>
<span id="cb23-28"><a href="#cb23-28"></a><span class="co">        """</span></span>
<span id="cb23-29"><a href="#cb23-29"></a>        <span class="co"># 긴급도에 따른 힌트</span></span>
<span id="cb23-30"><a href="#cb23-30"></a>        <span class="cf">if</span> urgency_level <span class="op">==</span> <span class="st">'emergency'</span>:</span>
<span id="cb23-31"><a href="#cb23-31"></a>            stimulus <span class="op">=</span> <span class="ss">f"""</span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>safety_stimulus<span class="sc">}</span></span>
<span id="cb23-32"><a href="#cb23-32"></a><span class="ss">            </span></span>
<span id="cb23-33"><a href="#cb23-33"></a><span class="ss">응급 상황 가능성을 언급하고 즉시 응급실 방문을 권고하세요."""</span></span>
<span id="cb23-34"><a href="#cb23-34"></a>            </span>
<span id="cb23-35"><a href="#cb23-35"></a>        <span class="cf">elif</span> urgency_level <span class="op">==</span> <span class="st">'concerning'</span>:</span>
<span id="cb23-36"><a href="#cb23-36"></a>            stimulus <span class="op">=</span> <span class="ss">f"""</span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>safety_stimulus<span class="sc">}</span></span>
<span id="cb23-37"><a href="#cb23-37"></a><span class="ss">            </span></span>
<span id="cb23-38"><a href="#cb23-38"></a><span class="ss">가능한 원인들을 언급하되, 곧 의사 상담을 권장하세요."""</span></span>
<span id="cb23-39"><a href="#cb23-39"></a>            </span>
<span id="cb23-40"><a href="#cb23-40"></a>        <span class="cf">else</span>:  <span class="co"># routine</span></span>
<span id="cb23-41"><a href="#cb23-41"></a>            stimulus <span class="op">=</span> <span class="ss">f"""</span><span class="sc">{</span><span class="va">self</span><span class="sc">.</span>safety_stimulus<span class="sc">}</span></span>
<span id="cb23-42"><a href="#cb23-42"></a><span class="ss">            </span></span>
<span id="cb23-43"><a href="#cb23-43"></a><span class="ss">일반적인 정보를 제공하되, 개인차가 있음을 명시하세요."""</span></span>
<span id="cb23-44"><a href="#cb23-44"></a>        </span>
<span id="cb23-45"><a href="#cb23-45"></a>        answer <span class="op">=</span> <span class="va">self</span>.dsp.answer_with_stimulus(query, stimulus)</span>
<span id="cb23-46"><a href="#cb23-46"></a>        </span>
<span id="cb23-47"><a href="#cb23-47"></a>        <span class="cf">return</span> answer</span>
<span id="cb23-48"><a href="#cb23-48"></a>    </span>
<span id="cb23-49"><a href="#cb23-49"></a>    <span class="kw">def</span> _assess_urgency(<span class="va">self</span>, query: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb23-50"><a href="#cb23-50"></a>        <span class="co">"""긴급도 평가"""</span></span>
<span id="cb23-51"><a href="#cb23-51"></a>        emergency_keywords <span class="op">=</span> [<span class="st">'심한'</span>, <span class="st">'갑자기'</span>, <span class="st">'호흡곤란'</span>, <span class="st">'의식'</span>, <span class="st">'출혈'</span>]</span>
<span id="cb23-52"><a href="#cb23-52"></a>        </span>
<span id="cb23-53"><a href="#cb23-53"></a>        query_lower <span class="op">=</span> query.lower()</span>
<span id="cb23-54"><a href="#cb23-54"></a>        </span>
<span id="cb23-55"><a href="#cb23-55"></a>        <span class="cf">if</span> <span class="bu">any</span>(kw <span class="kw">in</span> query_lower <span class="cf">for</span> kw <span class="kw">in</span> emergency_keywords):</span>
<span id="cb23-56"><a href="#cb23-56"></a>            <span class="cf">return</span> <span class="st">'emergency'</span></span>
<span id="cb23-57"><a href="#cb23-57"></a>        </span>
<span id="cb23-58"><a href="#cb23-58"></a>        <span class="cf">return</span> <span class="st">'routine'</span></span>
<span id="cb23-59"><a href="#cb23-59"></a></span>
<span id="cb23-60"><a href="#cb23-60"></a></span>
<span id="cb23-61"><a href="#cb23-61"></a><span class="co"># 사용</span></span>
<span id="cb23-62"><a href="#cb23-62"></a>medical <span class="op">=</span> MedicalConsultationDSP()</span>
<span id="cb23-63"><a href="#cb23-63"></a></span>
<span id="cb23-64"><a href="#cb23-64"></a><span class="co"># 일반 질문</span></span>
<span id="cb23-65"><a href="#cb23-65"></a>query1 <span class="op">=</span> <span class="st">"두통이 자주 생기는데 어떻게 관리하나요?"</span></span>
<span id="cb23-66"><a href="#cb23-66"></a>answer1 <span class="op">=</span> medical.provide_information(query1, urgency_level<span class="op">=</span><span class="st">'routine'</span>)</span>
<span id="cb23-67"><a href="#cb23-67"></a></span>
<span id="cb23-68"><a href="#cb23-68"></a><span class="co"># 긴급 질문</span></span>
<span id="cb23-69"><a href="#cb23-69"></a>query2 <span class="op">=</span> <span class="st">"갑자기 심한 가슴 통증이 있어요"</span></span>
<span id="cb23-70"><a href="#cb23-70"></a>urgency <span class="op">=</span> medical._assess_urgency(query2)</span>
<span id="cb23-71"><a href="#cb23-71"></a>answer2 <span class="op">=</span> medical.provide_information(query2, urgency_level<span class="op">=</span>urgency)</span>
<span id="cb23-72"><a href="#cb23-72"></a><span class="co"># → "즉시 응급실을 방문하시기 바랍니다..." 포함</span></span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="한계점-및-주의사항" class="level2" data-number="12">
<h2 data-number="12" class="anchored" data-anchor-id="한계점-및-주의사항"><span class="header-section-number">12</span> 한계점 및 주의사항</h2>
<section id="한계-1-policy-lm-의존성" class="level3" data-number="12.1">
<h3 data-number="12.1" class="anchored" data-anchor-id="한계-1-policy-lm-의존성"><span class="header-section-number">12.1</span> 한계 1: Policy LM 의존성</h3>
<p><strong>문제</strong>: Policy LM의 품질이 전체 성능을 좌우</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1"></a><span class="kw">def</span> analyze_policy_quality_impact():</span>
<span id="cb24-2"><a href="#cb24-2"></a>    <span class="co">"""</span></span>
<span id="cb24-3"><a href="#cb24-3"></a><span class="co">    Policy LM 품질이 미치는 영향 분석</span></span>
<span id="cb24-4"><a href="#cb24-4"></a><span class="co">    """</span></span>
<span id="cb24-5"><a href="#cb24-5"></a>    results <span class="op">=</span> {</span>
<span id="cb24-6"><a href="#cb24-6"></a>        <span class="st">'excellent_policy'</span>: [],  <span class="co"># 잘 튜닝된 Policy</span></span>
<span id="cb24-7"><a href="#cb24-7"></a>        <span class="st">'poor_policy'</span>: [],  <span class="co"># 제대로 튜닝 안 된 Policy</span></span>
<span id="cb24-8"><a href="#cb24-8"></a>        <span class="st">'no_policy'</span>: []  <span class="co"># 힌트 없음 (베이스라인)</span></span>
<span id="cb24-9"><a href="#cb24-9"></a>    }</span>
<span id="cb24-10"><a href="#cb24-10"></a>    </span>
<span id="cb24-11"><a href="#cb24-11"></a>    questions <span class="op">=</span> load_test_questions()</span>
<span id="cb24-12"><a href="#cb24-12"></a>    </span>
<span id="cb24-13"><a href="#cb24-13"></a>    <span class="cf">for</span> q <span class="kw">in</span> questions:</span>
<span id="cb24-14"><a href="#cb24-14"></a>        <span class="co"># Excellent Policy</span></span>
<span id="cb24-15"><a href="#cb24-15"></a>        stimulus_good <span class="op">=</span> generate_with_good_policy(q)</span>
<span id="cb24-16"><a href="#cb24-16"></a>        answer_good <span class="op">=</span> generate_answer(q, stimulus_good)</span>
<span id="cb24-17"><a href="#cb24-17"></a>        score_good <span class="op">=</span> evaluate(answer_good)</span>
<span id="cb24-18"><a href="#cb24-18"></a>        results[<span class="st">'excellent_policy'</span>].append(score_good)</span>
<span id="cb24-19"><a href="#cb24-19"></a>        </span>
<span id="cb24-20"><a href="#cb24-20"></a>        <span class="co"># Poor Policy</span></span>
<span id="cb24-21"><a href="#cb24-21"></a>        stimulus_poor <span class="op">=</span> generate_with_poor_policy(q)</span>
<span id="cb24-22"><a href="#cb24-22"></a>        answer_poor <span class="op">=</span> generate_answer(q, stimulus_poor)</span>
<span id="cb24-23"><a href="#cb24-23"></a>        score_poor <span class="op">=</span> evaluate(answer_poor)</span>
<span id="cb24-24"><a href="#cb24-24"></a>        results[<span class="st">'poor_policy'</span>].append(score_poor)</span>
<span id="cb24-25"><a href="#cb24-25"></a>        </span>
<span id="cb24-26"><a href="#cb24-26"></a>        <span class="co"># No Policy (베이스라인)</span></span>
<span id="cb24-27"><a href="#cb24-27"></a>        answer_baseline <span class="op">=</span> generate_answer(q, stimulus<span class="op">=</span><span class="va">None</span>)</span>
<span id="cb24-28"><a href="#cb24-28"></a>        score_baseline <span class="op">=</span> evaluate(answer_baseline)</span>
<span id="cb24-29"><a href="#cb24-29"></a>        results[<span class="st">'no_policy'</span>].append(score_baseline)</span>
<span id="cb24-30"><a href="#cb24-30"></a>    </span>
<span id="cb24-31"><a href="#cb24-31"></a>    <span class="co"># 평균 비교</span></span>
<span id="cb24-32"><a href="#cb24-32"></a>    <span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb24-33"><a href="#cb24-33"></a>    </span>
<span id="cb24-34"><a href="#cb24-34"></a>    <span class="bu">print</span>(<span class="st">"Policy LM 품질 영향:"</span>)</span>
<span id="cb24-35"><a href="#cb24-35"></a>    <span class="bu">print</span>(<span class="ss">f"  Excellent Policy: </span><span class="sc">{</span>np<span class="sc">.</span>mean(results[<span class="st">'excellent_policy'</span>])<span class="sc">:.3f}</span><span class="ss">"</span>)</span>
<span id="cb24-36"><a href="#cb24-36"></a>    <span class="bu">print</span>(<span class="ss">f"  Poor Policy: </span><span class="sc">{</span>np<span class="sc">.</span>mean(results[<span class="st">'poor_policy'</span>])<span class="sc">:.3f}</span><span class="ss">"</span>)</span>
<span id="cb24-37"><a href="#cb24-37"></a>    <span class="bu">print</span>(<span class="ss">f"  No Policy (baseline): </span><span class="sc">{</span>np<span class="sc">.</span>mean(results[<span class="st">'no_policy'</span>])<span class="sc">:.3f}</span><span class="ss">"</span>)</span>
<span id="cb24-38"><a href="#cb24-38"></a>    </span>
<span id="cb24-39"><a href="#cb24-39"></a>    <span class="co"># 잘못된 Policy는 오히려 해로울 수 있음!</span></span>
<span id="cb24-40"><a href="#cb24-40"></a></span>
<span id="cb24-41"><a href="#cb24-41"></a></span>
<span id="cb24-42"><a href="#cb24-42"></a><span class="co"># 실험 결과 예시:</span></span>
<span id="cb24-43"><a href="#cb24-43"></a><span class="co"># Excellent Policy: 0.842  ← 베이스라인 대비 +8.4%</span></span>
<span id="cb24-44"><a href="#cb24-44"></a><span class="co"># Poor Policy: 0.751       ← 베이스라인보다 낮음!</span></span>
<span id="cb24-45"><a href="#cb24-45"></a><span class="co"># No Policy (baseline): 0.776</span></span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>교훈</strong>: 잘못 튜닝된 Policy는 없는 것만 못하다.</p>
</section>
<section id="한계-2-도메인-특화-필요" class="level3" data-number="12.2">
<h3 data-number="12.2" class="anchored" data-anchor-id="한계-2-도메인-특화-필요"><span class="header-section-number">12.2</span> 한계 2: 도메인 특화 필요</h3>
<p><strong>문제</strong>: 일반적인 Policy는 전문 도메인에서 약함</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1"></a><span class="kw">def</span> domain_adaptation_necessity():</span>
<span id="cb25-2"><a href="#cb25-2"></a>    <span class="co">"""</span></span>
<span id="cb25-3"><a href="#cb25-3"></a><span class="co">    도메인 적응의 필요성 실험</span></span>
<span id="cb25-4"><a href="#cb25-4"></a><span class="co">    """</span></span>
<span id="cb25-5"><a href="#cb25-5"></a>    domains <span class="op">=</span> {</span>
<span id="cb25-6"><a href="#cb25-6"></a>        <span class="st">'general'</span>: load_general_questions(),</span>
<span id="cb25-7"><a href="#cb25-7"></a>        <span class="st">'medical'</span>: load_medical_questions(),</span>
<span id="cb25-8"><a href="#cb25-8"></a>        <span class="st">'legal'</span>: load_legal_questions(),</span>
<span id="cb25-9"><a href="#cb25-9"></a>        <span class="st">'technical'</span>: load_technical_questions()</span>
<span id="cb25-10"><a href="#cb25-10"></a>    }</span>
<span id="cb25-11"><a href="#cb25-11"></a>    </span>
<span id="cb25-12"><a href="#cb25-12"></a>    <span class="co"># 일반 Policy vs 도메인 특화 Policy</span></span>
<span id="cb25-13"><a href="#cb25-13"></a>    <span class="cf">for</span> domain, questions <span class="kw">in</span> domains.items():</span>
<span id="cb25-14"><a href="#cb25-14"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">도메인: </span><span class="sc">{</span>domain<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb25-15"><a href="#cb25-15"></a>        </span>
<span id="cb25-16"><a href="#cb25-16"></a>        <span class="co"># 일반 Policy</span></span>
<span id="cb25-17"><a href="#cb25-17"></a>        score_general <span class="op">=</span> evaluate_with_policy(</span>
<span id="cb25-18"><a href="#cb25-18"></a>            questions,</span>
<span id="cb25-19"><a href="#cb25-19"></a>            policy<span class="op">=</span><span class="st">'general'</span></span>
<span id="cb25-20"><a href="#cb25-20"></a>        )</span>
<span id="cb25-21"><a href="#cb25-21"></a>        <span class="bu">print</span>(<span class="ss">f"  일반 Policy: </span><span class="sc">{</span>score_general<span class="sc">:.3f}</span><span class="ss">"</span>)</span>
<span id="cb25-22"><a href="#cb25-22"></a>        </span>
<span id="cb25-23"><a href="#cb25-23"></a>        <span class="co"># 도메인 특화 Policy</span></span>
<span id="cb25-24"><a href="#cb25-24"></a>        score_specialized <span class="op">=</span> evaluate_with_policy(</span>
<span id="cb25-25"><a href="#cb25-25"></a>            questions,</span>
<span id="cb25-26"><a href="#cb25-26"></a>            policy<span class="op">=</span><span class="ss">f'</span><span class="sc">{</span>domain<span class="sc">}</span><span class="ss">_specialized'</span></span>
<span id="cb25-27"><a href="#cb25-27"></a>        )</span>
<span id="cb25-28"><a href="#cb25-28"></a>        <span class="bu">print</span>(<span class="ss">f"  특화 Policy: </span><span class="sc">{</span>score_specialized<span class="sc">:.3f}</span><span class="ss">"</span>)</span>
<span id="cb25-29"><a href="#cb25-29"></a>        <span class="bu">print</span>(<span class="ss">f"  개선: +</span><span class="sc">{</span>score_specialized <span class="op">-</span> score_general<span class="sc">:.3f}</span><span class="ss">"</span>)</span>
<span id="cb25-30"><a href="#cb25-30"></a></span>
<span id="cb25-31"><a href="#cb25-31"></a></span>
<span id="cb25-32"><a href="#cb25-32"></a><span class="co"># 결과 예시:</span></span>
<span id="cb25-33"><a href="#cb25-33"></a><span class="co"># 도메인: general</span></span>
<span id="cb25-34"><a href="#cb25-34"></a><span class="co">#   일반 Policy: 0.842</span></span>
<span id="cb25-35"><a href="#cb25-35"></a><span class="co">#   특화 Policy: 0.849</span></span>
<span id="cb25-36"><a href="#cb25-36"></a><span class="co">#   개선: +0.007  ← 작은 개선</span></span>
<span id="cb25-37"><a href="#cb25-37"></a><span class="co"># </span></span>
<span id="cb25-38"><a href="#cb25-38"></a><span class="co"># 도메인: medical</span></span>
<span id="cb25-39"><a href="#cb25-39"></a><span class="co">#   일반 Policy: 0.723</span></span>
<span id="cb25-40"><a href="#cb25-40"></a><span class="co">#   특화 Policy: 0.812</span></span>
<span id="cb25-41"><a href="#cb25-41"></a><span class="co">#   개선: +0.089  ← 큰 개선!</span></span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="한계-3-비용" class="level3" data-number="12.3">
<h3 data-number="12.3" class="anchored" data-anchor-id="한계-3-비용"><span class="header-section-number">12.3</span> 한계 3: 비용</h3>
<p><strong>문제</strong>: 2번의 LLM 호출 필요</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1"></a><span class="kw">def</span> cost_analysis():</span>
<span id="cb26-2"><a href="#cb26-2"></a>    <span class="co">"""</span></span>
<span id="cb26-3"><a href="#cb26-3"></a><span class="co">    비용 분석</span></span>
<span id="cb26-4"><a href="#cb26-4"></a><span class="co">    """</span></span>
<span id="cb26-5"><a href="#cb26-5"></a>    <span class="co"># 단일 질문 처리 비용</span></span>
<span id="cb26-6"><a href="#cb26-6"></a>    </span>
<span id="cb26-7"><a href="#cb26-7"></a>    <span class="co"># 방법 1: 힌트 없이 직접 (베이스라인)</span></span>
<span id="cb26-8"><a href="#cb26-8"></a>    cost_baseline <span class="op">=</span> {</span>
<span id="cb26-9"><a href="#cb26-9"></a>        <span class="st">'policy_lm'</span>: <span class="dv">0</span>,  <span class="co"># 사용 안 함</span></span>
<span id="cb26-10"><a href="#cb26-10"></a>        <span class="st">'target_lm'</span>: <span class="fl">0.01</span>,  <span class="co"># 1회 호출</span></span>
<span id="cb26-11"><a href="#cb26-11"></a>        <span class="st">'total'</span>: <span class="fl">0.01</span></span>
<span id="cb26-12"><a href="#cb26-12"></a>    }</span>
<span id="cb26-13"><a href="#cb26-13"></a>    </span>
<span id="cb26-14"><a href="#cb26-14"></a>    <span class="co"># 방법 2: Directional Stimulus (quality 선택)</span></span>
<span id="cb26-15"><a href="#cb26-15"></a>    cost_dsp_quality <span class="op">=</span> {</span>
<span id="cb26-16"><a href="#cb26-16"></a>        <span class="st">'policy_lm'</span>: <span class="fl">0.001</span> <span class="op">*</span> <span class="dv">5</span>,  <span class="co"># 5개 후보 생성</span></span>
<span id="cb26-17"><a href="#cb26-17"></a>        <span class="st">'target_lm'</span>: <span class="fl">0.01</span> <span class="op">*</span> <span class="dv">5</span>,  <span class="co"># 5개 후보로 각각 답변 생성</span></span>
<span id="cb26-18"><a href="#cb26-18"></a>        <span class="st">'total'</span>: <span class="fl">0.005</span> <span class="op">+</span> <span class="fl">0.05</span></span>
<span id="cb26-19"><a href="#cb26-19"></a>    }</span>
<span id="cb26-20"><a href="#cb26-20"></a>    </span>
<span id="cb26-21"><a href="#cb26-21"></a>    <span class="co"># 방법 3: Directional Stimulus (single 힌트)</span></span>
<span id="cb26-22"><a href="#cb26-22"></a>    cost_dsp_single <span class="op">=</span> {</span>
<span id="cb26-23"><a href="#cb26-23"></a>        <span class="st">'policy_lm'</span>: <span class="fl">0.001</span> <span class="op">*</span> <span class="dv">1</span>,  <span class="co"># 1개 힌트만</span></span>
<span id="cb26-24"><a href="#cb26-24"></a>        <span class="st">'target_lm'</span>: <span class="fl">0.01</span> <span class="op">*</span> <span class="dv">1</span>,  <span class="co"># 1회 답변</span></span>
<span id="cb26-25"><a href="#cb26-25"></a>        <span class="st">'total'</span>: <span class="fl">0.001</span> <span class="op">+</span> <span class="fl">0.01</span></span>
<span id="cb26-26"><a href="#cb26-26"></a>    }</span>
<span id="cb26-27"><a href="#cb26-27"></a>    </span>
<span id="cb26-28"><a href="#cb26-28"></a>    <span class="bu">print</span>(<span class="st">"비용 비교 (질문당):"</span>)</span>
<span id="cb26-29"><a href="#cb26-29"></a>    <span class="bu">print</span>(<span class="ss">f"  베이스라인: $</span><span class="sc">{</span>cost_baseline[<span class="st">'total'</span>]<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb26-30"><a href="#cb26-30"></a>    <span class="bu">print</span>(<span class="ss">f"  DSP (quality): $</span><span class="sc">{</span>cost_dsp_quality[<span class="st">'total'</span>]<span class="sc">:.4f}</span><span class="ss"> (</span><span class="sc">{</span>cost_dsp_quality[<span class="st">'total'</span>]<span class="op">/</span>cost_baseline[<span class="st">'total'</span>]<span class="sc">:.1f}</span><span class="ss">×)"</span>)</span>
<span id="cb26-31"><a href="#cb26-31"></a>    <span class="bu">print</span>(<span class="ss">f"  DSP (single): $</span><span class="sc">{</span>cost_dsp_single[<span class="st">'total'</span>]<span class="sc">:.4f}</span><span class="ss"> (</span><span class="sc">{</span>cost_dsp_single[<span class="st">'total'</span>]<span class="op">/</span>cost_baseline[<span class="st">'total'</span>]<span class="sc">:.1f}</span><span class="ss">×)"</span>)</span>
<span id="cb26-32"><a href="#cb26-32"></a>    </span>
<span id="cb26-33"><a href="#cb26-33"></a>    <span class="co"># 성능 대비 비용</span></span>
<span id="cb26-34"><a href="#cb26-34"></a>    <span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">성능 대비 비용 효율:"</span>)</span>
<span id="cb26-35"><a href="#cb26-35"></a>    <span class="bu">print</span>(<span class="ss">f"  베이스라인: 0.776 / $0.01 = 77.6"</span>)</span>
<span id="cb26-36"><a href="#cb26-36"></a>    <span class="bu">print</span>(<span class="ss">f"  DSP (quality): 0.842 / $0.055 = 15.3"</span>)</span>
<span id="cb26-37"><a href="#cb26-37"></a>    <span class="bu">print</span>(<span class="ss">f"  DSP (single): 0.815 / $0.011 = 74.1"</span>)</span>
<span id="cb26-38"><a href="#cb26-38"></a></span>
<span id="cb26-39"><a href="#cb26-39"></a></span>
<span id="cb26-40"><a href="#cb26-40"></a><span class="co"># 출력:</span></span>
<span id="cb26-41"><a href="#cb26-41"></a><span class="co"># 비용 비교 (질문당):</span></span>
<span id="cb26-42"><a href="#cb26-42"></a><span class="co">#   베이스라인: $0.0100</span></span>
<span id="cb26-43"><a href="#cb26-43"></a><span class="co">#   DSP (quality): $0.0550 (5.5×)  ← 비쌈</span></span>
<span id="cb26-44"><a href="#cb26-44"></a><span class="co">#   DSP (single): $0.0110 (1.1×)   ← 합리적</span></span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>완화 전략</strong>: 1. 단일 힌트만 사용 2. Policy LM을 매우 작은 모델로 3. 중요한 질문에만 적용</p>
</section>
<section id="한계-4-힌트가-항상-도움되는-것은-아님" class="level3" data-number="12.4">
<h3 data-number="12.4" class="anchored" data-anchor-id="한계-4-힌트가-항상-도움되는-것은-아님"><span class="header-section-number">12.4</span> 한계 4: 힌트가 항상 도움되는 것은 아님</h3>
<div class="sourceCode" id="cb27"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1"></a><span class="kw">def</span> when_stimulus_helps():</span>
<span id="cb27-2"><a href="#cb27-2"></a>    <span class="co">"""</span></span>
<span id="cb27-3"><a href="#cb27-3"></a><span class="co">    힌트가 도움되는 경우와 아닌 경우</span></span>
<span id="cb27-4"><a href="#cb27-4"></a><span class="co">    """</span></span>
<span id="cb27-5"><a href="#cb27-5"></a>    <span class="co"># 도움되는 경우</span></span>
<span id="cb27-6"><a href="#cb27-6"></a>    helpful_cases <span class="op">=</span> [</span>
<span id="cb27-7"><a href="#cb27-7"></a>        <span class="st">"복잡한 추론 문제"</span>,</span>
<span id="cb27-8"><a href="#cb27-8"></a>        <span class="st">"다양한 관점이 필요한 질문"</span>,</span>
<span id="cb27-9"><a href="#cb27-9"></a>        <span class="st">"구조화된 답변이 필요한 경우"</span>,</span>
<span id="cb27-10"><a href="#cb27-10"></a>        <span class="st">"도메인 전문 지식 필요"</span></span>
<span id="cb27-11"><a href="#cb27-11"></a>    ]</span>
<span id="cb27-12"><a href="#cb27-12"></a>    </span>
<span id="cb27-13"><a href="#cb27-13"></a>    <span class="co"># 도움 안 되는 경우</span></span>
<span id="cb27-14"><a href="#cb27-14"></a>    not_helpful_cases <span class="op">=</span> [</span>
<span id="cb27-15"><a href="#cb27-15"></a>        <span class="st">"간단한 사실 질문"</span>,</span>
<span id="cb27-16"><a href="#cb27-16"></a>        <span class="st">"이미 명확한 질문"</span>,</span>
<span id="cb27-17"><a href="#cb27-17"></a>        <span class="st">"창의적 자유가 필요한 경우"</span>,</span>
<span id="cb27-18"><a href="#cb27-18"></a>        <span class="st">"개인적 의견 질문"</span></span>
<span id="cb27-19"><a href="#cb27-19"></a>    ]</span>
<span id="cb27-20"><a href="#cb27-20"></a>    </span>
<span id="cb27-21"><a href="#cb27-21"></a>    <span class="bu">print</span>(<span class="st">"힌트가 도움되는 경우:"</span>)</span>
<span id="cb27-22"><a href="#cb27-22"></a>    <span class="cf">for</span> case <span class="kw">in</span> helpful_cases:</span>
<span id="cb27-23"><a href="#cb27-23"></a>        <span class="bu">print</span>(<span class="ss">f"  ✅ </span><span class="sc">{</span>case<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb27-24"><a href="#cb27-24"></a>    </span>
<span id="cb27-25"><a href="#cb27-25"></a>    <span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">힌트가 도움 안 되는 경우:"</span>)</span>
<span id="cb27-26"><a href="#cb27-26"></a>    <span class="cf">for</span> case <span class="kw">in</span> not_helpful_cases:</span>
<span id="cb27-27"><a href="#cb27-27"></a>        <span class="bu">print</span>(<span class="ss">f"  ❌ </span><span class="sc">{</span>case<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb27-28"><a href="#cb27-28"></a></span>
<span id="cb27-29"><a href="#cb27-29"></a></span>
<span id="cb27-30"><a href="#cb27-30"></a><span class="co"># 예시</span></span>
<span id="cb27-31"><a href="#cb27-31"></a>question_simple <span class="op">=</span> <span class="st">"프랑스의 수도는?"</span></span>
<span id="cb27-32"><a href="#cb27-32"></a><span class="co"># → 힌트 불필요 (단순 사실)</span></span>
<span id="cb27-33"><a href="#cb27-33"></a></span>
<span id="cb27-34"><a href="#cb27-34"></a>question_complex <span class="op">=</span> <span class="st">"EU 통합이 회원국 경제에 미친 영향을 다각도로 분석하시오"</span></span>
<span id="cb27-35"><a href="#cb27-35"></a><span class="co"># → 힌트 유용 (복잡, 다각도)</span></span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="베스트-프랙티스" class="level2" data-number="13">
<h2 data-number="13" class="anchored" data-anchor-id="베스트-프랙티스"><span class="header-section-number">13</span> 베스트 프랙티스</h2>
<section id="힌트-품질-검증" class="level3" data-number="13.1">
<h3 data-number="13.1" class="anchored" data-anchor-id="힌트-품질-검증"><span class="header-section-number">13.1</span> 1. 힌트 품질 검증</h3>
<div class="sourceCode" id="cb28"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1"></a><span class="kw">def</span> validate_stimulus_quality(stimulus: <span class="bu">str</span>) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, <span class="bu">float</span>]:</span>
<span id="cb28-2"><a href="#cb28-2"></a>    <span class="co">"""</span></span>
<span id="cb28-3"><a href="#cb28-3"></a><span class="co">    힌트 품질 검증</span></span>
<span id="cb28-4"><a href="#cb28-4"></a><span class="co">    </span></span>
<span id="cb28-5"><a href="#cb28-5"></a><span class="co">    좋은 힌트의 특징:</span></span>
<span id="cb28-6"><a href="#cb28-6"></a><span class="co">    - 구체적 (specific)</span></span>
<span id="cb28-7"><a href="#cb28-7"></a><span class="co">    - 실행 가능 (actionable)</span></span>
<span id="cb28-8"><a href="#cb28-8"></a><span class="co">    - 관련성 (relevant)</span></span>
<span id="cb28-9"><a href="#cb28-9"></a><span class="co">    - 간결 (concise)</span></span>
<span id="cb28-10"><a href="#cb28-10"></a><span class="co">    """</span></span>
<span id="cb28-11"><a href="#cb28-11"></a>    scores <span class="op">=</span> {}</span>
<span id="cb28-12"><a href="#cb28-12"></a>    </span>
<span id="cb28-13"><a href="#cb28-13"></a>    <span class="co"># 1. 길이 체크 (10-30 단어)</span></span>
<span id="cb28-14"><a href="#cb28-14"></a>    words <span class="op">=</span> stimulus.split()</span>
<span id="cb28-15"><a href="#cb28-15"></a>    <span class="cf">if</span> <span class="dv">10</span> <span class="op">&lt;=</span> <span class="bu">len</span>(words) <span class="op">&lt;=</span> <span class="dv">30</span>:</span>
<span id="cb28-16"><a href="#cb28-16"></a>        scores[<span class="st">'length'</span>] <span class="op">=</span> <span class="fl">1.0</span></span>
<span id="cb28-17"><a href="#cb28-17"></a>    <span class="cf">elif</span> <span class="bu">len</span>(words) <span class="op">&lt;</span> <span class="dv">10</span>:</span>
<span id="cb28-18"><a href="#cb28-18"></a>        scores[<span class="st">'length'</span>] <span class="op">=</span> <span class="fl">0.5</span>  <span class="co"># 너무 짧음</span></span>
<span id="cb28-19"><a href="#cb28-19"></a>    <span class="cf">else</span>:</span>
<span id="cb28-20"><a href="#cb28-20"></a>        scores[<span class="st">'length'</span>] <span class="op">=</span> <span class="fl">0.7</span>  <span class="co"># 너무 길음</span></span>
<span id="cb28-21"><a href="#cb28-21"></a>    </span>
<span id="cb28-22"><a href="#cb28-22"></a>    <span class="co"># 2. 구체성 (명사, 동사 비율)</span></span>
<span id="cb28-23"><a href="#cb28-23"></a>    <span class="co"># 간단한 휴리스틱</span></span>
<span id="cb28-24"><a href="#cb28-24"></a>    specific_words <span class="op">=</span> [<span class="st">'분석'</span>, <span class="st">'비교'</span>, <span class="st">'설명'</span>, <span class="st">'고려'</span>, <span class="st">'중심으로'</span>, <span class="st">'관점에서'</span>]</span>
<span id="cb28-25"><a href="#cb28-25"></a>    specificity <span class="op">=</span> <span class="bu">sum</span>(<span class="dv">1</span> <span class="cf">for</span> w <span class="kw">in</span> specific_words <span class="cf">if</span> w <span class="kw">in</span> stimulus) <span class="op">/</span> <span class="bu">len</span>(specific_words)</span>
<span id="cb28-26"><a href="#cb28-26"></a>    scores[<span class="st">'specificity'</span>] <span class="op">=</span> <span class="bu">min</span>(<span class="fl">1.0</span>, specificity <span class="op">*</span> <span class="dv">2</span>)</span>
<span id="cb28-27"><a href="#cb28-27"></a>    </span>
<span id="cb28-28"><a href="#cb28-28"></a>    <span class="co"># 3. 명령형 구조 (실행 가능성)</span></span>
<span id="cb28-29"><a href="#cb28-29"></a>    actionable_indicators <span class="op">=</span> [<span class="st">'하세요'</span>, <span class="st">'설명'</span>, <span class="st">'분석'</span>, <span class="st">'논의'</span>, <span class="st">'고려'</span>]</span>
<span id="cb28-30"><a href="#cb28-30"></a>    has_action <span class="op">=</span> <span class="bu">any</span>(ind <span class="kw">in</span> stimulus <span class="cf">for</span> ind <span class="kw">in</span> actionable_indicators)</span>
<span id="cb28-31"><a href="#cb28-31"></a>    scores[<span class="st">'actionable'</span>] <span class="op">=</span> <span class="fl">1.0</span> <span class="cf">if</span> has_action <span class="cf">else</span> <span class="fl">0.3</span></span>
<span id="cb28-32"><a href="#cb28-32"></a>    </span>
<span id="cb28-33"><a href="#cb28-33"></a>    <span class="co"># 4. 모호성 체크</span></span>
<span id="cb28-34"><a href="#cb28-34"></a>    vague_words <span class="op">=</span> [<span class="st">'좋게'</span>, <span class="st">'잘'</span>, <span class="st">'적절히'</span>, <span class="st">'그냥'</span>]</span>
<span id="cb28-35"><a href="#cb28-35"></a>    vagueness <span class="op">=</span> <span class="bu">sum</span>(<span class="dv">1</span> <span class="cf">for</span> w <span class="kw">in</span> vague_words <span class="cf">if</span> w <span class="kw">in</span> stimulus)</span>
<span id="cb28-36"><a href="#cb28-36"></a>    scores[<span class="st">'clarity'</span>] <span class="op">=</span> <span class="fl">1.0</span> <span class="op">-</span> <span class="bu">min</span>(<span class="fl">1.0</span>, vagueness <span class="op">*</span> <span class="fl">0.3</span>)</span>
<span id="cb28-37"><a href="#cb28-37"></a>    </span>
<span id="cb28-38"><a href="#cb28-38"></a>    <span class="co"># 종합 점수</span></span>
<span id="cb28-39"><a href="#cb28-39"></a>    total <span class="op">=</span> <span class="bu">sum</span>(scores.values()) <span class="op">/</span> <span class="bu">len</span>(scores)</span>
<span id="cb28-40"><a href="#cb28-40"></a>    scores[<span class="st">'total'</span>] <span class="op">=</span> total</span>
<span id="cb28-41"><a href="#cb28-41"></a>    </span>
<span id="cb28-42"><a href="#cb28-42"></a>    <span class="cf">return</span> scores</span>
<span id="cb28-43"><a href="#cb28-43"></a></span>
<span id="cb28-44"><a href="#cb28-44"></a></span>
<span id="cb28-45"><a href="#cb28-45"></a><span class="co"># 사용</span></span>
<span id="cb28-46"><a href="#cb28-46"></a>stimulus_good <span class="op">=</span> <span class="st">"경제적, 사회적, 환경적 측면을 각각 분석하세요"</span></span>
<span id="cb28-47"><a href="#cb28-47"></a>scores_good <span class="op">=</span> validate_stimulus_quality(stimulus_good)</span>
<span id="cb28-48"><a href="#cb28-48"></a></span>
<span id="cb28-49"><a href="#cb28-49"></a>stimulus_bad <span class="op">=</span> <span class="st">"좋게 설명해주세요"</span></span>
<span id="cb28-50"><a href="#cb28-50"></a>scores_bad <span class="op">=</span> validate_stimulus_quality(stimulus_bad)</span>
<span id="cb28-51"><a href="#cb28-51"></a></span>
<span id="cb28-52"><a href="#cb28-52"></a><span class="bu">print</span>(<span class="st">"좋은 힌트:"</span>)</span>
<span id="cb28-53"><a href="#cb28-53"></a><span class="bu">print</span>(<span class="ss">f"  </span><span class="sc">{</span>stimulus_good<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb28-54"><a href="#cb28-54"></a><span class="bu">print</span>(<span class="ss">f"  점수: </span><span class="sc">{</span>scores_good[<span class="st">'total'</span>]<span class="sc">:.2f}</span><span class="ss">"</span>)</span>
<span id="cb28-55"><a href="#cb28-55"></a></span>
<span id="cb28-56"><a href="#cb28-56"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">나쁜 힌트:"</span>)</span>
<span id="cb28-57"><a href="#cb28-57"></a><span class="bu">print</span>(<span class="ss">f"  </span><span class="sc">{</span>stimulus_bad<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb28-58"><a href="#cb28-58"></a><span class="bu">print</span>(<span class="ss">f"  점수: </span><span class="sc">{</span>scores_bad[<span class="st">'total'</span>]<span class="sc">:.2f}</span><span class="ss">"</span>)</span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="점진적-도입" class="level3" data-number="13.2">
<h3 data-number="13.2" class="anchored" data-anchor-id="점진적-도입"><span class="header-section-number">13.2</span> 2. 점진적 도입</h3>
<div class="sourceCode" id="cb29"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1"></a><span class="kw">def</span> gradual_dsp_rollout():</span>
<span id="cb29-2"><a href="#cb29-2"></a>    <span class="co">"""</span></span>
<span id="cb29-3"><a href="#cb29-3"></a><span class="co">    단계별 DSP 도입</span></span>
<span id="cb29-4"><a href="#cb29-4"></a><span class="co">    """</span></span>
<span id="cb29-5"><a href="#cb29-5"></a>    <span class="bu">print</span>(<span class="st">"🚀 Directional Stimulus Prompting 단계별 도입</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb29-6"><a href="#cb29-6"></a>    </span>
<span id="cb29-7"><a href="#cb29-7"></a>    <span class="co"># Phase 1: 템플릿 기반 (1주)</span></span>
<span id="cb29-8"><a href="#cb29-8"></a>    <span class="bu">print</span>(<span class="st">"Phase 1: 템플릿 기반 시작"</span>)</span>
<span id="cb29-9"><a href="#cb29-9"></a>    <span class="bu">print</span>(<span class="st">"  - 비용: 낮음"</span>)</span>
<span id="cb29-10"><a href="#cb29-10"></a>    <span class="bu">print</span>(<span class="st">"  - 구현: 쉬움"</span>)</span>
<span id="cb29-11"><a href="#cb29-11"></a>    <span class="bu">print</span>(<span class="st">"  - 효과: +3-5%"</span>)</span>
<span id="cb29-12"><a href="#cb29-12"></a>    <span class="bu">print</span>(<span class="st">"  → 빠른 검증 가능</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb29-13"><a href="#cb29-13"></a>    </span>
<span id="cb29-14"><a href="#cb29-14"></a>    <span class="co"># Phase 2: Simple Policy (2-3주)</span></span>
<span id="cb29-15"><a href="#cb29-15"></a>    <span class="bu">print</span>(<span class="st">"Phase 2: 간단한 Policy LM"</span>)</span>
<span id="cb29-16"><a href="#cb29-16"></a>    <span class="bu">print</span>(<span class="st">"  - 소규모 데이터셋으로 튜닝"</span>)</span>
<span id="cb29-17"><a href="#cb29-17"></a>    <span class="bu">print</span>(<span class="st">"  - Prompt Tuning 또는 LoRA"</span>)</span>
<span id="cb29-18"><a href="#cb29-18"></a>    <span class="bu">print</span>(<span class="st">"  - 효과: +5-8%"</span>)</span>
<span id="cb29-19"><a href="#cb29-19"></a>    <span class="bu">print</span>(<span class="st">"  → 비용 효율적 개선</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb29-20"><a href="#cb29-20"></a>    </span>
<span id="cb29-21"><a href="#cb29-21"></a>    <span class="co"># Phase 3: Full System (4주+)</span></span>
<span id="cb29-22"><a href="#cb29-22"></a>    <span class="bu">print</span>(<span class="st">"Phase 3: 완전한 시스템"</span>)</span>
<span id="cb29-23"><a href="#cb29-23"></a>    <span class="bu">print</span>(<span class="st">"  - 대규모 튜닝"</span>)</span>
<span id="cb29-24"><a href="#cb29-24"></a>    <span class="bu">print</span>(<span class="st">"  - 강화학습 기반 최적화"</span>)</span>
<span id="cb29-25"><a href="#cb29-25"></a>    <span class="bu">print</span>(<span class="st">"  - 다양한 선택 전략"</span>)</span>
<span id="cb29-26"><a href="#cb29-26"></a>    <span class="bu">print</span>(<span class="st">"  - 효과: +8-12%"</span>)</span>
<span id="cb29-27"><a href="#cb29-27"></a>    <span class="bu">print</span>(<span class="st">"  → 최고 성능</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb29-28"><a href="#cb29-28"></a>    </span>
<span id="cb29-29"><a href="#cb29-29"></a>    <span class="co"># 의사결정</span></span>
<span id="cb29-30"><a href="#cb29-30"></a>    <span class="bu">print</span>(<span class="st">"의사결정 기준:"</span>)</span>
<span id="cb29-31"><a href="#cb29-31"></a>    <span class="bu">print</span>(<span class="st">"  Phase 1에서 +3% 미만 → 중단 또는 재검토"</span>)</span>
<span id="cb29-32"><a href="#cb29-32"></a>    <span class="bu">print</span>(<span class="st">"  Phase 1에서 +3-5% → Phase 2 진행"</span>)</span>
<span id="cb29-33"><a href="#cb29-33"></a>    <span class="bu">print</span>(<span class="st">"  Phase 2에서 +5% 이상 → Phase 3 고려"</span>)</span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="ab-테스팅" class="level3" data-number="13.3">
<h3 data-number="13.3" class="anchored" data-anchor-id="ab-테스팅"><span class="header-section-number">13.3</span> 3. A/B 테스팅</h3>
<div class="sourceCode" id="cb30"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1"></a><span class="kw">def</span> ab_test_dsp(</span>
<span id="cb30-2"><a href="#cb30-2"></a>    questions: List[<span class="bu">str</span>],</span>
<span id="cb30-3"><a href="#cb30-3"></a>    num_trials: <span class="bu">int</span> <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb30-4"><a href="#cb30-4"></a>) <span class="op">-&gt;</span> Dict:</span>
<span id="cb30-5"><a href="#cb30-5"></a>    <span class="co">"""</span></span>
<span id="cb30-6"><a href="#cb30-6"></a><span class="co">    DSP vs 베이스라인 A/B 테스트</span></span>
<span id="cb30-7"><a href="#cb30-7"></a><span class="co">    """</span></span>
<span id="cb30-8"><a href="#cb30-8"></a>    results_baseline <span class="op">=</span> []</span>
<span id="cb30-9"><a href="#cb30-9"></a>    results_dsp <span class="op">=</span> []</span>
<span id="cb30-10"><a href="#cb30-10"></a>    </span>
<span id="cb30-11"><a href="#cb30-11"></a>    <span class="cf">for</span> trial <span class="kw">in</span> <span class="bu">range</span>(num_trials):</span>
<span id="cb30-12"><a href="#cb30-12"></a>        <span class="bu">print</span>(<span class="ss">f"Trial </span><span class="sc">{</span>trial <span class="op">+</span> <span class="dv">1</span><span class="sc">}</span><span class="ss">/</span><span class="sc">{</span>num_trials<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb30-13"><a href="#cb30-13"></a>        </span>
<span id="cb30-14"><a href="#cb30-14"></a>        <span class="co"># 질문을 랜덤하게 A/B 그룹으로 분할</span></span>
<span id="cb30-15"><a href="#cb30-15"></a>        <span class="im">import</span> random</span>
<span id="cb30-16"><a href="#cb30-16"></a>        random.shuffle(questions)</span>
<span id="cb30-17"><a href="#cb30-17"></a>        </span>
<span id="cb30-18"><a href="#cb30-18"></a>        mid <span class="op">=</span> <span class="bu">len</span>(questions) <span class="op">//</span> <span class="dv">2</span></span>
<span id="cb30-19"><a href="#cb30-19"></a>        group_a <span class="op">=</span> questions[:mid]  <span class="co"># 베이스라인</span></span>
<span id="cb30-20"><a href="#cb30-20"></a>        group_b <span class="op">=</span> questions[mid:]  <span class="co"># DSP</span></span>
<span id="cb30-21"><a href="#cb30-21"></a>        </span>
<span id="cb30-22"><a href="#cb30-22"></a>        <span class="co"># Group A: 베이스라인</span></span>
<span id="cb30-23"><a href="#cb30-23"></a>        <span class="cf">for</span> q <span class="kw">in</span> group_a:</span>
<span id="cb30-24"><a href="#cb30-24"></a>            answer <span class="op">=</span> generate_baseline_answer(q)</span>
<span id="cb30-25"><a href="#cb30-25"></a>            score <span class="op">=</span> evaluate(answer)</span>
<span id="cb30-26"><a href="#cb30-26"></a>            results_baseline.append(score)</span>
<span id="cb30-27"><a href="#cb30-27"></a>        </span>
<span id="cb30-28"><a href="#cb30-28"></a>        <span class="co"># Group B: DSP</span></span>
<span id="cb30-29"><a href="#cb30-29"></a>        dsp <span class="op">=</span> DirectionalStimulusPrompting(...)</span>
<span id="cb30-30"><a href="#cb30-30"></a>        <span class="cf">for</span> q <span class="kw">in</span> group_b:</span>
<span id="cb30-31"><a href="#cb30-31"></a>            result <span class="op">=</span> dsp.directional_stimulus_pipeline(</span>
<span id="cb30-32"><a href="#cb30-32"></a>                q,</span>
<span id="cb30-33"><a href="#cb30-33"></a>                selection_method<span class="op">=</span><span class="st">'quality'</span></span>
<span id="cb30-34"><a href="#cb30-34"></a>            )</span>
<span id="cb30-35"><a href="#cb30-35"></a>            score <span class="op">=</span> evaluate(result[<span class="st">'final_answer'</span>])</span>
<span id="cb30-36"><a href="#cb30-36"></a>            results_dsp.append(score)</span>
<span id="cb30-37"><a href="#cb30-37"></a>    </span>
<span id="cb30-38"><a href="#cb30-38"></a>    <span class="co"># 통계 분석</span></span>
<span id="cb30-39"><a href="#cb30-39"></a>    <span class="im">from</span> scipy <span class="im">import</span> stats</span>
<span id="cb30-40"><a href="#cb30-40"></a>    <span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb30-41"><a href="#cb30-41"></a>    </span>
<span id="cb30-42"><a href="#cb30-42"></a>    mean_baseline <span class="op">=</span> np.mean(results_baseline)</span>
<span id="cb30-43"><a href="#cb30-43"></a>    mean_dsp <span class="op">=</span> np.mean(results_dsp)</span>
<span id="cb30-44"><a href="#cb30-44"></a>    </span>
<span id="cb30-45"><a href="#cb30-45"></a>    t_stat, p_value <span class="op">=</span> stats.ttest_ind(results_dsp, results_baseline)</span>
<span id="cb30-46"><a href="#cb30-46"></a>    </span>
<span id="cb30-47"><a href="#cb30-47"></a>    <span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span> <span class="op">+</span> <span class="st">"="</span><span class="op">*</span><span class="dv">80</span>)</span>
<span id="cb30-48"><a href="#cb30-48"></a>    <span class="bu">print</span>(<span class="st">"A/B 테스트 결과"</span>)</span>
<span id="cb30-49"><a href="#cb30-49"></a>    <span class="bu">print</span>(<span class="st">"="</span><span class="op">*</span><span class="dv">80</span>)</span>
<span id="cb30-50"><a href="#cb30-50"></a>    <span class="bu">print</span>(<span class="ss">f"베이스라인: </span><span class="sc">{</span>mean_baseline<span class="sc">:.3f}</span><span class="ss">"</span>)</span>
<span id="cb30-51"><a href="#cb30-51"></a>    <span class="bu">print</span>(<span class="ss">f"DSP: </span><span class="sc">{</span>mean_dsp<span class="sc">:.3f}</span><span class="ss">"</span>)</span>
<span id="cb30-52"><a href="#cb30-52"></a>    <span class="bu">print</span>(<span class="ss">f"개선: +</span><span class="sc">{</span>mean_dsp <span class="op">-</span> mean_baseline<span class="sc">:.3f}</span><span class="ss"> (</span><span class="sc">{</span>(mean_dsp<span class="op">/</span>mean_baseline<span class="op">-</span><span class="dv">1</span>)<span class="op">*</span><span class="dv">100</span><span class="sc">:.1f}</span><span class="ss">%)"</span>)</span>
<span id="cb30-53"><a href="#cb30-53"></a>    <span class="bu">print</span>(<span class="ss">f"p-value: </span><span class="sc">{</span>p_value<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb30-54"><a href="#cb30-54"></a>    </span>
<span id="cb30-55"><a href="#cb30-55"></a>    <span class="cf">if</span> p_value <span class="op">&lt;</span> <span class="fl">0.05</span>:</span>
<span id="cb30-56"><a href="#cb30-56"></a>        <span class="bu">print</span>(<span class="st">"✅ 통계적으로 유의미한 개선"</span>)</span>
<span id="cb30-57"><a href="#cb30-57"></a>        <span class="bu">print</span>(<span class="st">"→ DSP 프로덕션 배포 권장"</span>)</span>
<span id="cb30-58"><a href="#cb30-58"></a>    <span class="cf">else</span>:</span>
<span id="cb30-59"><a href="#cb30-59"></a>        <span class="bu">print</span>(<span class="st">"⚠️  통계적 유의성 부족"</span>)</span>
<span id="cb30-60"><a href="#cb30-60"></a>        <span class="bu">print</span>(<span class="st">"→ 추가 실험 필요 또는 다른 접근 고려"</span>)</span>
<span id="cb30-61"><a href="#cb30-61"></a>    </span>
<span id="cb30-62"><a href="#cb30-62"></a>    <span class="cf">return</span> {</span>
<span id="cb30-63"><a href="#cb30-63"></a>        <span class="st">'baseline'</span>: results_baseline,</span>
<span id="cb30-64"><a href="#cb30-64"></a>        <span class="st">'dsp'</span>: results_dsp,</span>
<span id="cb30-65"><a href="#cb30-65"></a>        <span class="st">'p_value'</span>: p_value,</span>
<span id="cb30-66"><a href="#cb30-66"></a>        <span class="st">'is_significant'</span>: p_value <span class="op">&lt;</span> <span class="fl">0.05</span></span>
<span id="cb30-67"><a href="#cb30-67"></a>    }</span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="다른-기법과의-비교" class="level2" data-number="14">
<h2 data-number="14" class="anchored" data-anchor-id="다른-기법과의-비교"><span class="header-section-number">14</span> 다른 기법과의 비교</h2>
<section id="directional-stimulus-vs-cot" class="level3" data-number="14.1">
<h3 data-number="14.1" class="anchored" data-anchor-id="directional-stimulus-vs-cot"><span class="header-section-number">14.1</span> Directional Stimulus vs CoT</h3>
<table class="table">
<thead>
<tr class="header">
<th>특성</th>
<th>CoT</th>
<th>Directional Stimulus</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>프롬프트 형태</strong></td>
<td>“단계별로 생각”</td>
<td>도메인 특화 힌트</td>
</tr>
<tr class="even">
<td><strong>일반성</strong></td>
<td>매우 범용적</td>
<td>도메인 의존적</td>
</tr>
<tr class="odd">
<td><strong>성능</strong></td>
<td>+10-20%</td>
<td>+8-14%</td>
</tr>
<tr class="even">
<td><strong>비용</strong></td>
<td>낮음 (1× LLM)</td>
<td>중간 (1.1-5.5× LLM)</td>
</tr>
<tr class="odd">
<td><strong>커스터마이징</strong></td>
<td>어려움</td>
<td>쉬움</td>
</tr>
<tr class="even">
<td><strong>설정 필요</strong></td>
<td>없음</td>
<td>Policy LM 튜닝</td>
</tr>
</tbody>
</table>
<p><strong>언제 무엇을 사용?</strong> - <strong>CoT</strong>: 범용적, 빠른 시작 - <strong>DS</strong>: 특정 도메인, 맞춤형 필요</p>
</section>
<section id="directional-stimulus-vs-few-shot" class="level3" data-number="14.2">
<h3 data-number="14.2" class="anchored" data-anchor-id="directional-stimulus-vs-few-shot"><span class="header-section-number">14.2</span> Directional Stimulus vs Few-shot</h3>
<table class="table">
<thead>
<tr class="header">
<th>특성</th>
<th>Few-shot</th>
<th>Directional Stimulus</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>입력 크기</strong></td>
<td>큼 (예시들)</td>
<td>작음 (힌트)</td>
</tr>
<tr class="even">
<td><strong>토큰 비용</strong></td>
<td>높음</td>
<td>낮음</td>
</tr>
<tr class="odd">
<td><strong>유연성</strong></td>
<td>제한적</td>
<td>높음</td>
</tr>
<tr class="even">
<td><strong>도메인 적응</strong></td>
<td>예시 변경</td>
<td>힌트 변경</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="정리-및-다음-포스트-예고" class="level2" data-number="15">
<h2 data-number="15" class="anchored" data-anchor-id="정리-및-다음-포스트-예고"><span class="header-section-number">15</span> 정리 및 다음 포스트 예고</h2>
<section id="핵심-요약" class="level3" data-number="15.1">
<h3 data-number="15.1" class="anchored" data-anchor-id="핵심-요약"><span class="header-section-number">15.1</span> 핵심 요약</h3>
<p><strong>Directional Stimulus Prompting</strong>: - 작은 Policy LM이 힌트 생성 - 큰 Target LM을 특정 방향으로 유도 - BigBench-Hard에서 +14% 개선 (Zero-shot 대비) - 2단계: Policy 튜닝 → 힌트 생성 및 적용</p>
<p><strong>핵심 구성 요소</strong>: 1. Policy LM (힌트 생성 전문) 2. Target LM (블랙박스 LLM) 3. 힌트 선택 전략 4. 품질 평가 메커니즘</p>
<p><strong>효과적인 힌트 특징</strong>: - 구체적 (10-30단어) - 실행 가능 (명령형) - 관련성 높음 - 간결</p>
<p><strong>언제 사용할 것인가</strong>: - ✅ 복잡한 추론 문제 - ✅ 도메인 특화 필요 - ✅ 다양한 관점 필요 - ✅ 맞춤형 응답 중요</p>
<p><strong>언제 사용하지 말 것인가</strong>: - ❌ 간단한 질문 - ❌ 비용 매우 민감 - ❌ Policy 튜닝 리소스 부족 - ❌ 일반적 답변으로 충분</p>
</section>
<section id="실무-권장사항" class="level3" data-number="15.2">
<h3 data-number="15.2" class="anchored" data-anchor-id="실무-권장사항"><span class="header-section-number">15.2</span> 실무 권장사항</h3>
<ol type="1">
<li><strong>점진적 도입</strong>: 템플릿 → Simple Policy → Full System</li>
<li><strong>품질 검증</strong>: 힌트 품질 자동 체크</li>
<li><strong>A/B 테스팅</strong>: 베이스라인과 비교</li>
<li><strong>도메인 특화</strong>: 각 도메인별 Policy 튜닝</li>
<li><strong>비용 최적화</strong>: 단일 힌트 or 중요 질문만</li>
</ol>
</section>
<section id="다음-포스트-예고" class="level3" data-number="15.3">
<h3 data-number="15.3" class="anchored" data-anchor-id="다음-포스트-예고"><span class="header-section-number">15.3</span> 다음 포스트 예고</h3>
<p>다음 포스트에서는 <strong>ReAct (Reasoning + Acting)</strong>를 다룬다:</p>
<ul>
<li>Thought-Action-Observation 사이클</li>
<li>외부 도구 통합 (검색, 계산기, API)</li>
<li>Agent 구축</li>
<li>다단계 문제 해결</li>
<li>실전 구현 및 사례</li>
</ul>
<hr>
</section>
</section>
<section id="참고문헌" class="level2" data-number="16">
<h2 data-number="16" class="anchored" data-anchor-id="참고문헌"><span class="header-section-number">16</span> 참고문헌</h2>
<ol type="1">
<li><p>Li, Z., et al.&nbsp;(2023). <strong>Guiding large language models via directional stimulus prompting.</strong> <em>arXiv preprint arXiv:2302.11520</em>.</p></li>
<li><p>Hu, E. J., et al.&nbsp;(2021). <strong>LoRA: Low-rank adaptation of large language models.</strong> <em>ICLR 2022</em>.</p></li>
<li><p>Lester, B., Al-Rfou, R., &amp; Constant, N. (2021). <strong>The power of scale for parameter-efficient prompt tuning.</strong> <em>EMNLP 2021</em>.</p></li>
</ol>
<p><strong>핵심 메시지</strong>: Directional Stimulus Prompting은 작은 Policy LM이 생성한 힌트로 큰 LLM을 원하는 방향으로 유도하는 효과적인 기법이다. 도메인 특화와 맞춤형 응답이 중요한 상황에서 특히 유용하다.</p>


</section>

</main> <!-- /main -->
<script type="text/javascript">

// replace cmd keyboard shortcut w/ control on non-Mac platforms
const kPlatformMac = typeof navigator !== 'undefined' ? /Mac/.test(navigator.platform) : false;
if (!kPlatformMac) {
   var kbds = document.querySelectorAll("kbd")
   kbds.forEach(function(kbd) {
      kbd.innerHTML = kbd.innerHTML.replace(/⌘/g, '⌃');
   });
}

// tweak headings in pymd
document.querySelectorAll(".pymd span.co").forEach(el => {
   if (!el.innerText.startsWith("#|")) {
      el.style.fontWeight = 1000;
   }
});

</script>
<!-- Begin Mailchimp Signup Form -->
<div id="mc_embed_signup" style="padding-bottom: 1em; max-width: 400px;" class="ms-auto me-auto">
  <p style="font-weight: 600; margin-bottom: 0;">Subscribe</p>
  <span style="font-size: 0.9em;">Enjoy this blog? Get notified of new posts by email:</span>
<form action="https://quarto.us14.list-manage.com/subscribe/post?u=c79fb56a311ae347fbe916740&amp;id=ec05dfca03" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate="">
    <div id="mc_embed_signup_scroll">
	
        <div class="input-group mt-1 mb-2">
        <input type="email" class="form-control" placeholder="Email Address" aria-label="Email Address" name="EMAIL" style="font-size: 0.8em; padding: .2em;">
        </div>              

	<div id="mce-responses" class="clear foot">
		<div class="response" id="mce-error-response" style="display:none"></div>
		<div class="response" id="mce-success-response" style="display:none"></div>
	</div>    <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->
    <div style="position: absolute; left: -5000px;" aria-hidden="true"><input type="text" name="b_c79fb56a311ae347fbe916740_ec05dfca03" tabindex="-1" value=""></div>
        <div class="optionalParent">
            <div class="clear foot" style="display: flex; align-items: center; justify-content: center;">
              
              
                <input type="submit" value="Subscribe" name="subscribe" style="min-width: 150px; font-size: 0.8em;" id="mc-embedded-subscribe" class="button btn btn-light btn-sm ms-auto me-auto">
            </div>
        </div>
    </div>
</form>
</div>

<!--End mc_embed_signup-->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "복사완료!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "복사완료!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://giscus.app/client.js" data-repo="kmink3225/blog" data-repo-id="R_kgDOLCZyDg" data-category="Blog" data-category-id="" data-mapping="title" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="light" data-lang="en" crossorigin="anonymous" async="">
</script>
<input type="hidden" id="giscus-base-theme" value="light">
<input type="hidden" id="giscus-alt-theme" value="dark">
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>© Kwangmin Kim</p>
</div>   
    <div class="nav-footer-center">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
    <a class="nav-link" href="../../../../../about.html">
<p>About</p>
</a>
  </li>  
</ul>
    </div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/kmink3225/blog">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>




</body></html>