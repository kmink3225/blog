<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="ko" xml:lang="ko"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.543">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Kwangmin Kim">
<meta name="description" content="딥러닝 의료기기가 FDA 승인을 받기 위해 실제로 충족한 5가지 통계적 검증 요건을 상세히 분석한다. 분포, 신뢰구간, 오류율, 재현성, Subgroup 성능의 수학적 정의와 실제 IDx-DR, Paige Prostate 등의 사례를 통해, 검증 가능성이 설명 가능성을 어떻게 대체하는지 증명한다.">

<title>Kwangmin Kim - 딥러닝의 5대 검증 요건</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../../site_libs/quarto-search/quarto-search.js"></script>
<script src="../../../../site_libs/quarto-search/autocomplete-preset-algolia.umd.js"></script>
<meta name="quarto:offset" content="../../../../">
<script src="../../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../../../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "algolia": {
    "application-id": "DUOR1DRC9D",
    "search-only-api-key": "f264da5dea684ffb9e9b4a574af3ed61",
    "index-name": "prod_QUARTO",
    "analytics-events": true,
    "show-logo": true,
    "libDir": "site_libs"
  },
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": true,
  "language": {
    "search-no-results-text": "일치 없음",
    "search-matching-documents-text": "일치된 문서",
    "search-copy-link-title": "검색 링크 복사",
    "search-hide-matches-text": "추가 검색 결과 숨기기",
    "search-more-match-text": "추가 검색결과",
    "search-more-matches-text": "추가 검색결과",
    "search-clear-button-title": "제거",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "취소",
    "search-submit-button-title": "검색",
    "search-label": "검색"
  }
}</script>
<script src="https://cdn.jsdelivr.net/npm/algoliasearch@4.5.1/dist/algoliasearch-lite.umd.js"></script>


<script type="text/javascript">
var ALGOLIA_INSIGHTS_SRC = "https://cdn.jsdelivr.net/npm/search-insights/dist/search-insights.iife.min.js";
!function(e,a,t,n,s,i,c){e.AlgoliaAnalyticsObject=s,e[s]=e[s]||function(){
(e[s].queue=e[s].queue||[]).push(arguments)},i=a.createElement(t),c=a.getElementsByTagName(t)[0],
i.async=1,i.src=n,c.parentNode.insertBefore(i,c)
}(window,document,"script",ALGOLIA_INSIGHTS_SRC,"aa");
</script>

<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@algolia/autocomplete-plugin-algolia-insights">

</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-6W0EKFMWBN"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-6W0EKFMWBN', { 'anonymize_ip': true});
</script>
<style>

      .quarto-title-block .quarto-title-banner h1,
      .quarto-title-block .quarto-title-banner h2,
      .quarto-title-block .quarto-title-banner h3,
      .quarto-title-block .quarto-title-banner h4,
      .quarto-title-block .quarto-title-banner h5,
      .quarto-title-block .quarto-title-banner h6
      {
        color: black;
      }

      .quarto-title-block .quarto-title-banner {
        color: black;
background: #EDF3F9;
      }
</style>
<style>
.custom-footer { 
  text-align: center; 
  font-size: 0.8em; 
  color: #666; 
  margin-top: 2rem; 
}
</style>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../../../styles.css">
<meta property="og:title" content="Kwangmin Kim - 딥러닝의 5대 검증 요건">
<meta property="og:description" content="딥러닝 의료기기가 FDA 승인을 받기 위해 실제로 충족한 5가지 통계적 검증 요건을 상세히 분석한다. 분포, 신뢰구간, 오류율, 재현성, Subgroup 성능의 수학적 정의와 실제 IDx-DR, Paige Prostate 등의 사례를 통해, 검증 가능성이 설명 가능성을 어떻게 대체하는지 증명한다.">
<meta property="og:site_name" content="Kwangmin Kim">
<meta name="twitter:title" content="Kwangmin Kim - 딥러닝의 5대 검증 요건">
<meta name="twitter:description" content="딥러닝 의료기기가 FDA 승인을 받기 위해 실제로 충족한 5가지 통계적 검증 요건을 상세히 분석한다. 분포, 신뢰구간, 오류율, 재현성, Subgroup 성능의 수학적 정의와 실제 IDx-DR, Paige Prostate 등의 사례를 통해, 검증 가능성이 설명 가능성을 어떻게 대체하는지 증명한다.">
<meta name="twitter:card" content="summary">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../../.././images/logo.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../../../../index.html">
    <span class="navbar-title">Kwangmin Kim</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="검색"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="탐색 전환" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../../docs/blog/index.html"> 
<span class="menu-text">Blog</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../../about.html"> 
<span class="menu-text">Me</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/kmink3225"> <i class="bi bi-github" role="img" aria-label="Github">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/kwangmin-kim-a5241b200/"> <i class="bi bi-linkedin" role="img" aria-label="Linkedin">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="다크 모드 전환"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">딥러닝의 5대 검증 요건</h1>
            <p class="subtitle lead">설명 없이도 승인되는 수학적 조건 - 실제 FDA 사례로 증명</p>
                  <div>
        <div class="description">
          <p>딥러닝 의료기기가 FDA 승인을 받기 위해 실제로 충족한 5가지 통계적 검증 요건을 상세히 분석한다. 분포, 신뢰구간, 오류율, 재현성, Subgroup 성능의 수학적 정의와 실제 IDx-DR, Paige Prostate 등의 사례를 통해, 검증 가능성이 설명 가능성을 어떻게 대체하는지 증명한다.</p>
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">AI</div>
                <div class="quarto-category">Surveilance</div>
                <div class="quarto-category">Regulation</div>
                <div class="quarto-category">Statistics</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">저자</div>
      <div class="quarto-title-meta-contents">
               <p>Kwangmin Kim </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">공개</div>
      <div class="quarto-title-meta-contents">
        <p class="date">2025년 01월 10일</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">목차</h2>
   
  <ul>
  <li><a href="#dl이-충족한-5대-검증-요건---실제-fda-승인-사례-분석" id="toc-dl이-충족한-5대-검증-요건---실제-fda-승인-사례-분석" class="nav-link active" data-scroll-target="#dl이-충족한-5대-검증-요건---실제-fda-승인-사례-분석"><span class="header-section-number">1</span> DL이 충족한 5대 검증 요건 - 실제 FDA 승인 사례 분석</a>
  <ul class="collapse">
  <li><a href="#분포-distribution---out-of-distribution-방어" id="toc-분포-distribution---out-of-distribution-방어" class="nav-link" data-scroll-target="#분포-distribution---out-of-distribution-방어"><span class="header-section-number">1.1</span> 분포 (Distribution) - Out-of-Distribution 방어</a></li>
  <li><a href="#신뢰구간-confidence-interval---성능-불확실성-정량화" id="toc-신뢰구간-confidence-interval---성능-불확실성-정량화" class="nav-link" data-scroll-target="#신뢰구간-confidence-interval---성능-불확실성-정량화"><span class="header-section-number">1.2</span> 신뢰구간 (Confidence Interval) - 성능 불확실성 정량화</a></li>
  <li><a href="#오류율-error-rate---false-negativepositive의-임상적-비용" id="toc-오류율-error-rate---false-negativepositive의-임상적-비용" class="nav-link" data-scroll-target="#오류율-error-rate---false-negativepositive의-임상적-비용"><span class="header-section-number">1.3</span> 오류율 (Error Rate) - False Negative/Positive의 임상적 비용</a></li>
  <li><a href="#재현성-reproducibility---locked-algorithm" id="toc-재현성-reproducibility---locked-algorithm" class="nav-link" data-scroll-target="#재현성-reproducibility---locked-algorithm"><span class="header-section-number">1.4</span> 재현성 (Reproducibility) - Locked Algorithm</a></li>
  <li><a href="#subgroup-성능-안정성---편향-방지" id="toc-subgroup-성능-안정성---편향-방지" class="nav-link" data-scroll-target="#subgroup-성능-안정성---편향-방지"><span class="header-section-number">1.5</span> Subgroup 성능 안정성 - 편향 방지</a></li>
  </ul></li>
  <li><a href="#검증-가능성의-수학적-요건과-한계---통계가-설명을-대체하는-조건" id="toc-검증-가능성의-수학적-요건과-한계---통계가-설명을-대체하는-조건" class="nav-link" data-scroll-target="#검증-가능성의-수학적-요건과-한계---통계가-설명을-대체하는-조건"><span class="header-section-number">2</span> 검증 가능성의 수학적 요건과 한계 - 통계가 설명을 대체하는 조건</a>
  <ul class="collapse">
  <li><a href="#검증-가능한-dl의-수학적-최소-요건" id="toc-검증-가능한-dl의-수학적-최소-요건" class="nav-link" data-scroll-target="#검증-가능한-dl의-수학적-최소-요건"><span class="header-section-number">2.1</span> 검증 가능한 DL의 수학적 최소 요건</a></li>
  <li><a href="#요구되지-않는-것" id="toc-요구되지-않는-것" class="nav-link" data-scroll-target="#요구되지-않는-것"><span class="header-section-number">2.2</span> 요구되지 않는 것</a></li>
  <li><a href="#통계적-검증이-설명을-대체할-수-있는-조건" id="toc-통계적-검증이-설명을-대체할-수-있는-조건" class="nav-link" data-scroll-target="#통계적-검증이-설명을-대체할-수-있는-조건"><span class="header-section-number">2.3</span> 통계적 검증이 설명을 대체할 수 있는 조건</a></li>
  <li><a href="#대체-가능한-영역-dl-의료기기-승인-사례" id="toc-대체-가능한-영역-dl-의료기기-승인-사례" class="nav-link" data-scroll-target="#대체-가능한-영역-dl-의료기기-승인-사례"><span class="header-section-number">2.4</span> 대체 가능한 영역: DL 의료기기 승인 사례</a></li>
  <li><a href="#통계가-설명을-대체하지-못하는-영역" id="toc-통계가-설명을-대체하지-못하는-영역" class="nav-link" data-scroll-target="#통계가-설명을-대체하지-못하는-영역"><span class="header-section-number">2.5</span> 통계가 설명을 대체하지 못하는 영역</a></li>
  <li><a href="#핵심-결론-통계적-검증의-한계" id="toc-핵심-결론-통계적-검증의-한계" class="nav-link" data-scroll-target="#핵심-결론-통계적-검증의-한계"><span class="header-section-number">2.6</span> 핵심 결론: 통계적 검증의 한계</a></li>
  <li><a href="#실전-전략-검증-가능성을-위한-설계-원칙" id="toc-실전-전략-검증-가능성을-위한-설계-원칙" class="nav-link" data-scroll-target="#실전-전략-검증-가능성을-위한-설계-원칙"><span class="header-section-number">2.7</span> 실전 전략: 검증 가능성을 위한 설계 원칙</a></li>
  </ul></li>
  <li><a href="#결론-검증-가능성이-설명-가능성을-대체한-이유" id="toc-결론-검증-가능성이-설명-가능성을-대체한-이유" class="nav-link" data-scroll-target="#결론-검증-가능성이-설명-가능성을-대체한-이유"><span class="header-section-number">3</span> 결론: 검증 가능성이 설명 가능성을 대체한 이유</a>
  <ul class="collapse">
  <li><a href="#핵심-통찰" id="toc-핵심-통찰" class="nav-link" data-scroll-target="#핵심-통찰"><span class="header-section-number">3.1</span> 핵심 통찰</a></li>
  <li><a href="#대-검증-요건이-충분한-이유" id="toc-대-검증-요건이-충분한-이유" class="nav-link" data-scroll-target="#대-검증-요건이-충분한-이유"><span class="header-section-number">3.2</span> 5대 검증 요건이 충분한 이유</a></li>
  <li><a href="#실제-fda-승인-사례가-증명하는-것" id="toc-실제-fda-승인-사례가-증명하는-것" class="nav-link" data-scroll-target="#실제-fda-승인-사례가-증명하는-것"><span class="header-section-number">3.3</span> 실제 FDA 승인 사례가 증명하는 것</a></li>
  <li><a href="#통계가-설명을-대체-가능한-조건" id="toc-통계가-설명을-대체-가능한-조건" class="nav-link" data-scroll-target="#통계가-설명을-대체-가능한-조건"><span class="header-section-number">3.4</span> 통계가 설명을 대체 가능한 조건</a></li>
  <li><a href="#미래-전망-continuous-learning의-도전" id="toc-미래-전망-continuous-learning의-도전" class="nav-link" data-scroll-target="#미래-전망-continuous-learning의-도전"><span class="header-section-number">3.5</span> 미래 전망: Continuous Learning의 도전</a></li>
  <li><a href="#최종-메시지" id="toc-최종-메시지" class="nav-link" data-scroll-target="#최종-메시지"><span class="header-section-number">3.6</span> 최종 메시지</a></li>
  </ul></li>
  <li><a href="#참고문헌" id="toc-참고문헌" class="nav-link" data-scroll-target="#참고문헌"><span class="header-section-number">4</span> 참고문헌</a></li>
  <li><a href="#추가-자료" id="toc-추가-자료" class="nav-link" data-scroll-target="#추가-자료"><span class="header-section-number">5</span> 추가 자료</a>
  <ul class="collapse">
  <li><a href="#fda-가이드라인-문서" id="toc-fda-가이드라인-문서" class="nav-link" data-scroll-target="#fda-가이드라인-문서"><span class="header-section-number">5.1</span> FDA 가이드라인 문서</a></li>
  <li><a href="#실제-fda-승인-사례-문서" id="toc-실제-fda-승인-사례-문서" class="nav-link" data-scroll-target="#실제-fda-승인-사례-문서"><span class="header-section-number">5.2</span> 실제 FDA 승인 사례 문서</a></li>
  <li><a href="#학술-논문" id="toc-학술-논문" class="nav-link" data-scroll-target="#학술-논문"><span class="header-section-number">5.3</span> 학술 논문</a></li>
  <li><a href="#온라인-리소스" id="toc-온라인-리소스" class="nav-link" data-scroll-target="#온라인-리소스"><span class="header-section-number">5.4</span> 온라인 리소스</a></li>
  <li><a href="#추가-읽기-자료" id="toc-추가-읽기-자료" class="nav-link" data-scroll-target="#추가-읽기-자료"><span class="header-section-number">5.5</span> 추가 읽기 자료</a></li>
  </ul></li>
  <li><a href="#부록-fda-제출-체크리스트" id="toc-부록-fda-제출-체크리스트" class="nav-link" data-scroll-target="#부록-fda-제출-체크리스트"><span class="header-section-number">6</span> 부록: FDA 제출 체크리스트</a>
  <ul class="collapse">
  <li><a href="#a.-분포-distribution-제출-항목" id="toc-a.-분포-distribution-제출-항목" class="nav-link" data-scroll-target="#a.-분포-distribution-제출-항목"><span class="header-section-number">6.1</span> A. 분포 (Distribution) 제출 항목</a></li>
  <li><a href="#b.-신뢰구간-ci-제출-항목" id="toc-b.-신뢰구간-ci-제출-항목" class="nav-link" data-scroll-target="#b.-신뢰구간-ci-제출-항목"><span class="header-section-number">6.2</span> B. 신뢰구간 (CI) 제출 항목</a></li>
  <li><a href="#c.-오류율-error-rate-제출-항목" id="toc-c.-오류율-error-rate-제출-항목" class="nav-link" data-scroll-target="#c.-오류율-error-rate-제출-항목"><span class="header-section-number">6.3</span> C. 오류율 (Error Rate) 제출 항목</a></li>
  <li><a href="#d.-재현성-reproducibility-제출-항목" id="toc-d.-재현성-reproducibility-제출-항목" class="nav-link" data-scroll-target="#d.-재현성-reproducibility-제출-항목"><span class="header-section-number">6.4</span> D. 재현성 (Reproducibility) 제출 항목</a></li>
  <li><a href="#e.-subgroup-성능-제출-항목" id="toc-e.-subgroup-성능-제출-항목" class="nav-link" data-scroll-target="#e.-subgroup-성능-제출-항목"><span class="header-section-number">6.5</span> E. Subgroup 성능 제출 항목</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<section id="dl이-충족한-5대-검증-요건---실제-fda-승인-사례-분석" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="dl이-충족한-5대-검증-요건---실제-fda-승인-사례-분석"><span class="header-section-number">1</span> DL이 충족한 5대 검증 요건 - 실제 FDA 승인 사례 분석</h2>
<p>딥러닝 의료기기가 실제로 규제를 통과한 방식을 정확히 이해하려면, <strong>다음 다섯 가지 통계적 요건이 어떻게 충족되었는지</strong> 봐야 한다. 이것은 이론이 아니라 실제 FDA 510(k)/De Novo 문서에서 요구하는 항목들이다<span class="citation" data-cites="FDA2021AIML">(<a href="#ref-FDA2021AIML" role="doc-biblioref">U.S. Food and Drug Administration 2021</a>)</span>.</p>
<section id="분포-distribution---out-of-distribution-방어" class="level3" data-number="1.1">
<h3 data-number="1.1" class="anchored" data-anchor-id="분포-distribution---out-of-distribution-방어"><span class="header-section-number">1.1</span> 분포 (Distribution) - Out-of-Distribution 방어</h3>
<section id="수학적-정의" class="level4" data-number="1.1.1">
<h4 data-number="1.1.1" class="anchored" data-anchor-id="수학적-정의"><span class="header-section-number">1.1.1</span> 수학적 정의</h4>
<p>딥러닝 모델 <span class="math inline">\(f: \mathcal{X} \rightarrow \mathcal{Y}\)</span> 가 의료기기로 승인되려면, <strong>입력 공간 <span class="math inline">\(\mathcal{X}\)</span> 가 명확히 정의된 확률 분포 <span class="math inline">\(P(X)\)</span> 를 가져야 한다</strong>.</p>
<p><span class="math display">\[
P_{\text{train}}(X) \approx P_{\text{val}}(X) \approx P_{\text{clinical}}(X)
\]</span></p>
<p><strong>핵심</strong>: 학습 분포, 검증 분포, 실제 임상 분포가 일치해야 한다. 분포가 다르면 성능 보장 불가.</p>
</section>
<section id="fda-제출-요구사항" class="level4" data-number="1.1.2">
<h4 data-number="1.1.2" class="anchored" data-anchor-id="fda-제출-요구사항"><span class="header-section-number">1.1.2</span> FDA 제출 요구사항</h4>
<p><strong>21 CFR 860.7 - Device Classification</strong><span class="citation" data-cites="FDA2020Classification">(<a href="#ref-FDA2020Classification" role="doc-biblioref">U.S. Food and Drug Administration 2020b</a>)</span>에 따르면:</p>
<ol type="1">
<li><strong>입력 데이터 분포 명시</strong>
<ul>
<li>장비: 특정 제조사, 모델명</li>
<li>포맷: DICOM, 해상도 (예: 512×512 이상)</li>
<li>환자군: 연령, 질병 상태, 제외 기준</li>
</ul></li>
<li><strong>분포 일치성 검증</strong>
<ul>
<li>Kolmogorov-Smirnov Test</li>
<li>Chi-square Test for categorical variables</li>
<li>T-test for continuous variables</li>
</ul></li>
<li><strong>Out-of-Distribution 감지 메커니즘</strong>
<ul>
<li>입력이 학습 분포를 벗어나면?</li>
<li>→ 경고 또는 출력 거부</li>
</ul></li>
</ol>
</section>
<section id="실제-사례-idx-dr-2018" class="level4" data-number="1.1.3">
<h4 data-number="1.1.3" class="anchored" data-anchor-id="실제-사례-idx-dr-2018"><span class="header-section-number">1.1.3</span> 실제 사례: IDx-DR (2018)</h4>
<p><strong>가장 엄격한 분포 제한 사례</strong><span class="citation" data-cites="Abramoff2018IDxDR">(<a href="#ref-Abramoff2018IDxDR" role="doc-biblioref">Abràmoff 기타 2018</a>)</span></p>
<p><strong>입력 분포 제한:</strong></p>
<table class="table">
<colgroup>
<col style="width: 27%">
<col style="width: 45%">
<col style="width: 27%">
</colgroup>
<thead>
<tr class="header">
<th>항목</th>
<th>제한 조건</th>
<th>근거</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>장비</strong></td>
<td>Topcon NW400만</td>
<td>학습 데이터가 이 카메라로만 수집됨</td>
</tr>
<tr class="even">
<td><strong>이미지</strong></td>
<td>45° 시야각, 2채널 (macula-centered + disc-centered)</td>
<td>다른 각도는 Out-of-Distribution</td>
</tr>
<tr class="odd">
<td><strong>해상도</strong></td>
<td>최소 2048×1536 픽셀</td>
<td>저해상도는 검증 안 됨</td>
</tr>
<tr class="even">
<td><strong>환자군</strong></td>
<td>50세 이상, 당뇨병 진단</td>
<td>학습 데이터 분포와 일치</td>
</tr>
<tr class="odd">
<td><strong>제외 조건</strong></td>
<td>망막 수술 이력, 안내염, 심한 백내장</td>
<td>분포 밖 케이스</td>
</tr>
</tbody>
</table>
<p><strong>분포 검증 프로토콜:</strong></p>
<div class="sourceCode" id="cb1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1"></a><span class="co"># FDA 제출 문서에 포함된 분포 검증</span></span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="im">import</span> scipy.stats <span class="im">as</span> stats</span>
<span id="cb1-3"><a href="#cb1-3"></a></span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="co"># 학습 vs 검증 데이터 연령 분포 비교</span></span>
<span id="cb1-5"><a href="#cb1-5"></a>ks_statistic, p_value <span class="op">=</span> stats.ks_2samp(train_ages, val_ages)</span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="bu">print</span>(<span class="ss">f"KS statistic: </span><span class="sc">{</span>ks_statistic<span class="sc">}</span><span class="ss">, p-value: </span><span class="sc">{</span>p_value<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="co"># 결과: KS = 0.043, p = 0.82 (분포 차이 없음)</span></span>
<span id="cb1-8"><a href="#cb1-8"></a></span>
<span id="cb1-9"><a href="#cb1-9"></a><span class="co"># 성별 분포 비교</span></span>
<span id="cb1-10"><a href="#cb1-10"></a>chi2, p_chi <span class="op">=</span> stats.chisquare(train_gender, val_gender)</span>
<span id="cb1-11"><a href="#cb1-11"></a><span class="bu">print</span>(<span class="ss">f"Chi-square: </span><span class="sc">{</span>chi2<span class="sc">}</span><span class="ss">, p-value: </span><span class="sc">{</span>p_chi<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb1-12"><a href="#cb1-12"></a><span class="co"># 결과: χ² = 1.23, p = 0.27 (분포 일치)</span></span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>Out-of-Distribution 처리:</strong></p>
<ul>
<li><strong>저화질 이미지</strong>: 10.8%가 “판독 불가” → 출력 거부<span class="citation" data-cites="Abramoff2018IDxDR">(<a href="#ref-Abramoff2018IDxDR" role="doc-biblioref">Abràmoff 기타 2018</a>)</span></li>
<li><strong>비당뇨병 환자</strong>: 시스템 사용 금지 (라벨에 명시)</li>
<li><strong>다른 카메라</strong>: 승인 범위 밖 → 법적 책임 없음</li>
</ul>
</section>
<section id="실제-사례-paige-prostate-2024" class="level4" data-number="1.1.4">
<h4 data-number="1.1.4" class="anchored" data-anchor-id="실제-사례-paige-prostate-2024"><span class="header-section-number">1.1.4</span> 실제 사례: Paige Prostate (2024)</h4>
<p><strong>Whole Slide Imaging의 분포 도전</strong><span class="citation" data-cites="FDA2024Paige">(<a href="#ref-FDA2024Paige" role="doc-biblioref">U.S. Food and Drug Administration 2024</a>)</span></p>
<p><strong>문제</strong>: 병리 슬라이드는 스캐너마다 색상 분포가 다름</p>
<p><strong>해결책</strong>:</p>
<ol type="1">
<li><strong>Color Normalization</strong>
<ul>
<li>Reinhard stain normalization</li>
<li>학습 데이터의 색상 분포로 정규화</li>
<li>수식: <span class="math inline">\(I_{\text{norm}} = \frac{I - \mu_{\text{source}}}{\sigma_{\text{source}}} \times \sigma_{\text{target}} + \mu_{\text{target}}\)</span></li>
</ul></li>
<li><strong>Scanner-Specific Validation</strong>
<ul>
<li>16개 기관, 7종의 스캐너</li>
<li>각 스캐너별로 성능 검증</li>
<li>스캐너 간 성능 차이: Sensitivity 91-94% (일관성 입증)</li>
</ul></li>
<li><strong>OOD Detection</strong>
<ul>
<li>슬라이드 품질 점수 (1-5)</li>
<li>품질 3 이하 → 경고 메시지</li>
</ul></li>
</ol>
<p><strong>FDA 승인 조건</strong>: 특정 스캐너 목록만 허용 (7종)</p>
</section>
<section id="규제-논리-왜-분포-제한이-필수인가" class="level4" data-number="1.1.5">
<h4 data-number="1.1.5" class="anchored" data-anchor-id="규제-논리-왜-분포-제한이-필수인가"><span class="header-section-number">1.1.5</span> 규제 논리: 왜 분포 제한이 필수인가?</h4>
<p><strong>FDA의 입장</strong> (2021 AI/ML Action Plan)<span class="citation" data-cites="FDA2021AIML">(<a href="#ref-FDA2021AIML" role="doc-biblioref">U.S. Food and Drug Administration 2021</a>)</span>:</p>
<blockquote class="blockquote">
<p>“Deep learning models are known to fail catastrophically on out-of-distribution inputs. Therefore, manufacturers must clearly define the <strong>input domain</strong> and implement mechanisms to <strong>detect and reject</strong> OOD inputs.”</p>
</blockquote>
<p><strong>수학적 근거</strong>:</p>
<p>딥러닝은 다음을 보장하지 못함:</p>
<p><span class="math display">\[
P(Y|X) \text{ when } X \notin \text{support}(P_{\text{train}})
\]</span></p>
<p>즉, 학습 분포 밖에서는 예측 신뢰성 없음.</p>
<p><strong>실전 전략</strong>:</p>
<ul>
<li>DL을 “일반 지능”이 아닌 <strong>“분포 한정 인식기”</strong>로 규정</li>
<li>입력 분포를 극단적으로 제한 → 검증 가능성 확보</li>
<li>OOD 입력 거부 → 안전성 보장</li>
</ul>
</section>
<section id="비교-전통-ml은-분포-제한이-덜-엄격" class="level4" data-number="1.1.6">
<h4 data-number="1.1.6" class="anchored" data-anchor-id="비교-전통-ml은-분포-제한이-덜-엄격"><span class="header-section-number">1.1.6</span> 비교: 전통 ML은 분포 제한이 덜 엄격</h4>
<p><strong>Logistic Regression 사례:</strong></p>
<div class="sourceCode" id="cb2"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1"></a><span class="co"># 전통 ML은 변수 범위만 정의하면 됨</span></span>
<span id="cb2-2"><a href="#cb2-2"></a>model <span class="op">=</span> LogisticRegression()</span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="co"># 입력 제약: "혈당 50-500 mg/dL, HbA1c 4-15%"</span></span>
<span id="cb2-4"><a href="#cb2-4"></a><span class="co"># 장비 제한 없음 (혈액 검사 결과만 사용)</span></span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>차이점</strong>:</p>
<table class="table">
<thead>
<tr class="header">
<th></th>
<th>전통 ML</th>
<th>딥러닝</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>입력 분포</strong></td>
<td>변수 범위만</td>
<td>장비, 포맷, 환자군 모두 제한</td>
</tr>
<tr class="even">
<td><strong>OOD 민감도</strong></td>
<td>낮음 (선형 외삽 가능)</td>
<td>매우 높음 (급격히 붕괴)</td>
</tr>
<tr class="odd">
<td><strong>검증 복잡도</strong></td>
<td>낮음</td>
<td>매우 높음</td>
</tr>
</tbody>
</table>
<p><strong>결론</strong>: 딥러닝은 분포 의존성이 높아, 분포 제한이 승인의 <strong>필수 조건</strong>이다.</p>
</section>
</section>
<section id="신뢰구간-confidence-interval---성능-불확실성-정량화" class="level3" data-number="1.2">
<h3 data-number="1.2" class="anchored" data-anchor-id="신뢰구간-confidence-interval---성능-불확실성-정량화"><span class="header-section-number">1.2</span> 신뢰구간 (Confidence Interval) - 성능 불확실성 정량화</h3>
<section id="수학적-정의-1" class="level4" data-number="1.2.1">
<h4 data-number="1.2.1" class="anchored" data-anchor-id="수학적-정의-1"><span class="header-section-number">1.2.1</span> 수학적 정의</h4>
<p>딥러닝 모델의 성능 지표 <span class="math inline">\(\theta\)</span> (예: Sensitivity)에 대해, <strong>95% 신뢰구간 <span class="math inline">\([\theta_L, \theta_U]\)</span> 를 제시</strong>해야 한다:</p>
<p><span class="math display">\[
P(\theta_L \leq \theta \leq \theta_U) = 0.95
\]</span></p>
<ul>
<li><strong>핵심 오해 해소</strong>: “딥러닝은 확률 모델이 아니니 CI가 불가능하다” ❌</li>
<li><strong>진실</strong>: 개별 예측의 CI가 아닌, <strong>모델 성능 지표의 CI</strong>를 요구한다.</li>
</ul>
</section>
<section id="fda-요구사항" class="level4" data-number="1.2.2">
<h4 data-number="1.2.2" class="anchored" data-anchor-id="fda-요구사항"><span class="header-section-number">1.2.2</span> FDA 요구사항</h4>
<p><strong>510(k) 제출 가이드라인</strong><span class="citation" data-cites="FDA2020SoftwareValidation">(<a href="#ref-FDA2020SoftwareValidation" role="doc-biblioref">U.S. Food and Drug Administration 2020c</a>)</span>:</p>
<ol type="1">
<li><strong>Primary Endpoint의 CI 필수</strong>
<ul>
<li>Sensitivity (95% CI)</li>
<li>Specificity (95% CI)</li>
<li>AUC (95% CI)</li>
<li>PPV, NPV (95% CI)</li>
</ul></li>
<li><strong>CI 계산 방법 문서화</strong>
<ul>
<li>Bootstrap (권장)</li>
<li>Wilson Score Interval</li>
<li>Exact Binomial (Clopper-Pearson)</li>
</ul></li>
<li><strong>임상적 허용 기준</strong>
<ul>
<li>CI 하한이 임상적으로 수용 가능해야 함</li>
<li>예: Sensitivity 하한 ≥ 85% (질병 놓침 최대 15%)</li>
</ul></li>
</ol>
</section>
<section id="실제-계산-방법" class="level4" data-number="1.2.3">
<h4 data-number="1.2.3" class="anchored" data-anchor-id="실제-계산-방법"><span class="header-section-number">1.2.3</span> 실제 계산 방법</h4>
<p><strong>방법 1: Bootstrap CI (가장 많이 사용)</strong></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> roc_auc_score</span>
<span id="cb3-3"><a href="#cb3-3"></a><span class="im">from</span> scipy <span class="im">import</span> stats</span>
<span id="cb3-4"><a href="#cb3-4"></a></span>
<span id="cb3-5"><a href="#cb3-5"></a><span class="kw">def</span> bootstrap_ci(y_true, y_pred, n_bootstrap<span class="op">=</span><span class="dv">10000</span>, ci<span class="op">=</span><span class="fl">0.95</span>):</span>
<span id="cb3-6"><a href="#cb3-6"></a>    <span class="co">"""</span></span>
<span id="cb3-7"><a href="#cb3-7"></a><span class="co">    Bootstrap method for calculating 95% CI of Sensitivity</span></span>
<span id="cb3-8"><a href="#cb3-8"></a><span class="co">    FDA 510(k) 문서에서 가장 많이 사용되는 방법</span></span>
<span id="cb3-9"><a href="#cb3-9"></a><span class="co">    """</span></span>
<span id="cb3-10"><a href="#cb3-10"></a>    n <span class="op">=</span> <span class="bu">len</span>(y_true)</span>
<span id="cb3-11"><a href="#cb3-11"></a>    sensitivities <span class="op">=</span> []</span>
<span id="cb3-12"><a href="#cb3-12"></a>    </span>
<span id="cb3-13"><a href="#cb3-13"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(n_bootstrap):</span>
<span id="cb3-14"><a href="#cb3-14"></a>        <span class="co"># Resample with replacement</span></span>
<span id="cb3-15"><a href="#cb3-15"></a>        indices <span class="op">=</span> np.random.choice(n, n, replace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb3-16"><a href="#cb3-16"></a>        y_true_boot <span class="op">=</span> y_true[indices]</span>
<span id="cb3-17"><a href="#cb3-17"></a>        y_pred_boot <span class="op">=</span> y_pred[indices]</span>
<span id="cb3-18"><a href="#cb3-18"></a>        </span>
<span id="cb3-19"><a href="#cb3-19"></a>        <span class="co"># Calculate sensitivity</span></span>
<span id="cb3-20"><a href="#cb3-20"></a>        tp <span class="op">=</span> np.<span class="bu">sum</span>((y_true_boot <span class="op">==</span> <span class="dv">1</span>) <span class="op">&amp;</span> (y_pred_boot <span class="op">==</span> <span class="dv">1</span>))</span>
<span id="cb3-21"><a href="#cb3-21"></a>        fn <span class="op">=</span> np.<span class="bu">sum</span>((y_true_boot <span class="op">==</span> <span class="dv">1</span>) <span class="op">&amp;</span> (y_pred_boot <span class="op">==</span> <span class="dv">0</span>))</span>
<span id="cb3-22"><a href="#cb3-22"></a>        sensitivity <span class="op">=</span> tp <span class="op">/</span> (tp <span class="op">+</span> fn) <span class="cf">if</span> (tp <span class="op">+</span> fn) <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">else</span> <span class="dv">0</span></span>
<span id="cb3-23"><a href="#cb3-23"></a>        sensitivities.append(sensitivity)</span>
<span id="cb3-24"><a href="#cb3-24"></a>    </span>
<span id="cb3-25"><a href="#cb3-25"></a>    <span class="co"># Calculate percentile CI</span></span>
<span id="cb3-26"><a href="#cb3-26"></a>    alpha <span class="op">=</span> <span class="dv">1</span> <span class="op">-</span> ci</span>
<span id="cb3-27"><a href="#cb3-27"></a>    lower <span class="op">=</span> np.percentile(sensitivities, <span class="dv">100</span> <span class="op">*</span> alpha <span class="op">/</span> <span class="dv">2</span>)</span>
<span id="cb3-28"><a href="#cb3-28"></a>    upper <span class="op">=</span> np.percentile(sensitivities, <span class="dv">100</span> <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> alpha <span class="op">/</span> <span class="dv">2</span>))</span>
<span id="cb3-29"><a href="#cb3-29"></a>    mean_sens <span class="op">=</span> np.mean(sensitivities)</span>
<span id="cb3-30"><a href="#cb3-30"></a>    </span>
<span id="cb3-31"><a href="#cb3-31"></a>    <span class="cf">return</span> mean_sens, (lower, upper)</span>
<span id="cb3-32"><a href="#cb3-32"></a></span>
<span id="cb3-33"><a href="#cb3-33"></a><span class="co"># 실제 사용 예시</span></span>
<span id="cb3-34"><a href="#cb3-34"></a>y_true <span class="op">=</span> np.array([<span class="dv">1</span>]<span class="op">*</span><span class="dv">400</span> <span class="op">+</span> [<span class="dv">0</span>]<span class="op">*</span><span class="dv">600</span>)  <span class="co"># 400 positive, 600 negative</span></span>
<span id="cb3-35"><a href="#cb3-35"></a>y_pred <span class="op">=</span> model.predict(X_test)</span>
<span id="cb3-36"><a href="#cb3-36"></a></span>
<span id="cb3-37"><a href="#cb3-37"></a>mean_sens, (ci_lower, ci_upper) <span class="op">=</span> bootstrap_ci(y_true, y_pred)</span>
<span id="cb3-38"><a href="#cb3-38"></a><span class="bu">print</span>(<span class="ss">f"Sensitivity: </span><span class="sc">{</span>mean_sens<span class="sc">:.3f}</span><span class="ss"> (95% CI: </span><span class="sc">{</span>ci_lower<span class="sc">:.3f}</span><span class="ss">-</span><span class="sc">{</span>ci_upper<span class="sc">:.3f}</span><span class="ss">)"</span>)</span>
<span id="cb3-39"><a href="#cb3-39"></a><span class="co"># 출력 예: Sensitivity: 0.872 (95% CI: 0.827-0.910)</span></span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>방법 2: Wilson Score Interval (이항 분포)</strong></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1"></a><span class="kw">def</span> wilson_ci(tp, n, confidence<span class="op">=</span><span class="fl">0.95</span>):</span>
<span id="cb4-2"><a href="#cb4-2"></a>    <span class="co">"""</span></span>
<span id="cb4-3"><a href="#cb4-3"></a><span class="co">    Wilson Score Interval - 소표본에서 정확</span></span>
<span id="cb4-4"><a href="#cb4-4"></a><span class="co">    Sensitivity = tp / n인 경우</span></span>
<span id="cb4-5"><a href="#cb4-5"></a><span class="co">    """</span></span>
<span id="cb4-6"><a href="#cb4-6"></a>    <span class="im">from</span> scipy <span class="im">import</span> stats</span>
<span id="cb4-7"><a href="#cb4-7"></a>    </span>
<span id="cb4-8"><a href="#cb4-8"></a>    p <span class="op">=</span> tp <span class="op">/</span> n</span>
<span id="cb4-9"><a href="#cb4-9"></a>    z <span class="op">=</span> stats.norm.ppf((<span class="dv">1</span> <span class="op">+</span> confidence) <span class="op">/</span> <span class="dv">2</span>)</span>
<span id="cb4-10"><a href="#cb4-10"></a>    </span>
<span id="cb4-11"><a href="#cb4-11"></a>    denominator <span class="op">=</span> <span class="dv">1</span> <span class="op">+</span> z<span class="op">**</span><span class="dv">2</span> <span class="op">/</span> n</span>
<span id="cb4-12"><a href="#cb4-12"></a>    center <span class="op">=</span> (p <span class="op">+</span> z<span class="op">**</span><span class="dv">2</span> <span class="op">/</span> (<span class="dv">2</span><span class="op">*</span>n)) <span class="op">/</span> denominator</span>
<span id="cb4-13"><a href="#cb4-13"></a>    margin <span class="op">=</span> z <span class="op">*</span> np.sqrt((p<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>p)<span class="op">/</span>n <span class="op">+</span> z<span class="op">**</span><span class="dv">2</span><span class="op">/</span>(<span class="dv">4</span><span class="op">*</span>n<span class="op">**</span><span class="dv">2</span>))) <span class="op">/</span> denominator</span>
<span id="cb4-14"><a href="#cb4-14"></a>    </span>
<span id="cb4-15"><a href="#cb4-15"></a>    <span class="cf">return</span> center <span class="op">-</span> margin, center <span class="op">+</span> margin</span>
<span id="cb4-16"><a href="#cb4-16"></a></span>
<span id="cb4-17"><a href="#cb4-17"></a><span class="co"># IDx-DR 실제 데이터 (900명 환자, 356 True Positive)</span></span>
<span id="cb4-18"><a href="#cb4-18"></a>ci_lower, ci_upper <span class="op">=</span> wilson_ci(<span class="dv">356</span>, <span class="dv">400</span>, <span class="fl">0.95</span>)</span>
<span id="cb4-19"><a href="#cb4-19"></a><span class="bu">print</span>(<span class="ss">f"95% CI: (</span><span class="sc">{</span>ci_lower<span class="sc">:.3f}</span><span class="ss">, </span><span class="sc">{</span>ci_upper<span class="sc">:.3f}</span><span class="ss">)"</span>)</span>
<span id="cb4-20"><a href="#cb4-20"></a><span class="co"># 출력: 95% CI: (0.827, 0.910) - FDA 문서와 일치</span></span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="실제-사례-idx-dr-ci-분석" class="level4" data-number="1.2.4">
<h4 data-number="1.2.4" class="anchored" data-anchor-id="실제-사례-idx-dr-ci-분석"><span class="header-section-number">1.2.4</span> 실제 사례: IDx-DR CI 분석</h4>
<p><strong>FDA De Novo DEN180001 문서</strong><span class="citation" data-cites="Abramoff2018IDxDR">(<a href="#ref-Abramoff2018IDxDR" role="doc-biblioref">Abràmoff 기타 2018</a>)</span>:</p>
<p><strong>Primary Endpoint: Sensitivity</strong></p>
<ul>
<li><strong>Point Estimate</strong>: 87.2%</li>
<li><strong>95% CI</strong>: 82.7% - 91.0%</li>
<li><strong>방법</strong>: Wilson Score Interval</li>
<li><strong>샘플</strong>: 900명 환자 중 400명 양성</li>
</ul>
<p><strong>임상적 해석</strong>:</p>
<ul>
<li>CI 하한 82.7% → 최악의 경우 17.3% 놓칠 수 있음</li>
<li>FDA 질문: “17.3% False Negative는 임상적으로 수용 가능한가?”</li>
<li>답변: “연 1회 스크리닝이므로, 다음 검사에서 발견 가능” → 승인</li>
</ul>
<p><strong>Specificity</strong></p>
<ul>
<li><strong>Point Estimate</strong>: 90.7%</li>
<li><strong>95% CI</strong>: 88.3% - 92.7%</li>
<li><strong>해석</strong>: CI가 좁음 → 성능이 안정적</li>
</ul>
</section>
<section id="실제-사례-paige-prostate-ci-분석" class="level4" data-number="1.2.5">
<h4 data-number="1.2.5" class="anchored" data-anchor-id="실제-사례-paige-prostate-ci-분석"><span class="header-section-number">1.2.5</span> 실제 사례: Paige Prostate CI 분석</h4>
<p><strong>FDA De Novo DEN210034</strong><span class="citation" data-cites="FDA2024Paige">(<a href="#ref-FDA2024Paige" role="doc-biblioref">U.S. Food and Drug Administration 2024</a>)</span>:</p>
<p><strong>Reader Study (16명 병리학자)</strong></p>
<table class="table">
<thead>
<tr class="header">
<th>지표</th>
<th>AI 보조 없음</th>
<th>AI 보조 있음</th>
<th>Δ (95% CI)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Sensitivity</td>
<td>81.3%</td>
<td>88.4%</td>
<td>+7.1% (4.2-10.0%)</td>
</tr>
<tr class="even">
<td>Specificity</td>
<td>94.6%</td>
<td>95.8%</td>
<td>+1.2% (-0.5-2.9%)</td>
</tr>
</tbody>
</table>
<p><strong>통계적 검정</strong>:</p>
<ul>
<li>Paired t-test: p &lt; 0.001 (유의미한 향상)</li>
<li>CI가 0을 포함하지 않음 → 실제 개선 증명</li>
</ul>
<p><strong>FDA 요구</strong>:</p>
<blockquote class="blockquote">
<p>“The lower bound of the 95% CI for the improvement in sensitivity (4.2%) demonstrates clinically meaningful benefit.”</p>
</blockquote>
</section>
<section id="ci가-중요한-이유-규제-관점" class="level4" data-number="1.2.6">
<h4 data-number="1.2.6" class="anchored" data-anchor-id="ci가-중요한-이유-규제-관점"><span class="header-section-number">1.2.6</span> CI가 중요한 이유: 규제 관점</h4>
<p><strong>1. 최악의 시나리오 평가</strong></p>
<ul>
<li>Point estimate만 보면: Sensitivity 92%</li>
<li>CI 하한을 보면: 최악의 경우 85%</li>
<li>FDA는 <strong>CI 하한</strong>으로 위험도 평가</li>
</ul>
<p><strong>2. 표본 크기 검증</strong></p>
<p><span class="math display">\[
\text{CI width} \propto \frac{1}{\sqrt{n}}
\]</span></p>
<ul>
<li>CI가 너무 넓으면: 표본 부족 → 재시험 요구</li>
<li>목표 CI width: ±3-5% (보통)</li>
</ul>
<p><strong>3. 임상시험 설계</strong></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1"></a><span class="co"># 표본 크기 계산 (Sensitivity 90%, CI width ±5%)</span></span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="im">from</span> statsmodels.stats.proportion <span class="im">import</span> proportion_confint</span>
<span id="cb5-3"><a href="#cb5-3"></a></span>
<span id="cb5-4"><a href="#cb5-4"></a><span class="co"># 필요한 양성 케이스 수</span></span>
<span id="cb5-5"><a href="#cb5-5"></a>n_positive <span class="op">=</span> ((<span class="fl">1.96</span> <span class="op">/</span> <span class="fl">0.05</span>) <span class="op">**</span> <span class="dv">2</span>) <span class="op">*</span> <span class="fl">0.9</span> <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> <span class="fl">0.9</span>)</span>
<span id="cb5-6"><a href="#cb5-6"></a><span class="bu">print</span>(<span class="ss">f"필요한 양성 환자: </span><span class="sc">{</span>n_positive<span class="sc">:.0f}</span><span class="ss">명"</span>)</span>
<span id="cb5-7"><a href="#cb5-7"></a><span class="co"># 출력: 346명</span></span>
<span id="cb5-8"><a href="#cb5-8"></a></span>
<span id="cb5-9"><a href="#cb5-9"></a><span class="co"># 전체 환자 수 (유병률 10% 가정)</span></span>
<span id="cb5-10"><a href="#cb5-10"></a>n_total <span class="op">=</span> n_positive <span class="op">/</span> <span class="fl">0.1</span></span>
<span id="cb5-11"><a href="#cb5-11"></a><span class="bu">print</span>(<span class="ss">f"전체 환자: </span><span class="sc">{</span>n_total<span class="sc">:.0f}</span><span class="ss">명"</span>)</span>
<span id="cb5-12"><a href="#cb5-12"></a><span class="co"># 출력: 3,460명 - IDx-DR은 900명 (더 넓은 CI 수용)</span></span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="딥러닝-vs-전통-ml-ci-계산의-차이" class="level4" data-number="1.2.7">
<h4 data-number="1.2.7" class="anchored" data-anchor-id="딥러닝-vs-전통-ml-ci-계산의-차이"><span class="header-section-number">1.2.7</span> 딥러닝 vs 전통 ML: CI 계산의 차이</h4>
<table class="table">
<thead>
<tr class="header">
<th></th>
<th>전통 ML</th>
<th>딥러닝</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>이론적 CI</strong></td>
<td>가능 (CLT 기반)</td>
<td>불가능 (비선형, 고차원)</td>
</tr>
<tr class="even">
<td><strong>실무적 CI</strong></td>
<td>Bootstrap</td>
<td>Bootstrap (동일)</td>
</tr>
<tr class="odd">
<td><strong>계산 비용</strong></td>
<td>낮음</td>
<td>매우 높음 (재학습 필요 시)</td>
</tr>
<tr class="even">
<td><strong>CI 해석</strong></td>
<td>파라미터 + 성능</td>
<td>성능만</td>
</tr>
</tbody>
</table>
<p><strong>핵심</strong>: 딥러닝도 <strong>성능 지표의 CI는 제공 가능</strong>하다. Bootstrap으로 해결.</p>
</section>
<section id="결론" class="level4" data-number="1.2.8">
<h4 data-number="1.2.8" class="anchored" data-anchor-id="결론"><span class="header-section-number">1.2.8</span> 결론</h4>
<p><strong>오해</strong>: “딥러닝은 블랙박스라 CI가 안 나온다” ❌</p>
<p><strong>진실</strong>: - 개별 예측의 불확실성 정량화는 어려움 (epistemic uncertainty) - <strong>하지만 모델 성능의 불확실성은 정량화 가능</strong> (bootstrap, 반복 시험) - FDA는 후자만 요구함</p>
<p><strong>실무 조언</strong>: 1. 임상시험 계획 시 표본 크기 계산 (CI width 목표 설정) 2. Bootstrap CI 사용 (10,000 iterations 권장) 3. CI 하한이 임상적 기준을 넘는지 확인 4. Subgroup별로도 CI 계산 필수</p>
</section>
</section>
<section id="오류율-error-rate---false-negativepositive의-임상적-비용" class="level3" data-number="1.3">
<h3 data-number="1.3" class="anchored" data-anchor-id="오류율-error-rate---false-negativepositive의-임상적-비용"><span class="header-section-number">1.3</span> 오류율 (Error Rate) - False Negative/Positive의 임상적 비용</h3>
<section id="수학적-정의-2" class="level4" data-number="1.3.1">
<h4 data-number="1.3.1" class="anchored" data-anchor-id="수학적-정의-2"><span class="header-section-number">1.3.1</span> 수학적 정의</h4>
<p>DL 모델의 오류는 두 가지로 구분된다:</p>
<p><span class="math display">\[
\begin{aligned}
\text{False Negative Rate (FNR)} &amp;= \frac{FN}{TP + FN} = 1 - \text{Sensitivity} \\
\text{False Positive Rate (FPR)} &amp;= \frac{FP}{TN + FP} = 1 - \text{Specificity}
\end{aligned}
\]</span></p>
<p><strong>핵심</strong>: 오류의 <strong>임상적 비용</strong>이 비대칭적이다.</p>
</section>
<section id="fda-요구사항-1" class="level4" data-number="1.3.2">
<h4 data-number="1.3.2" class="anchored" data-anchor-id="fda-요구사항-1"><span class="header-section-number">1.3.2</span> FDA 요구사항</h4>
<p><strong>510(k) 제출 가이드라인</strong><span class="citation" data-cites="FDA2020SoftwareValidation">(<a href="#ref-FDA2020SoftwareValidation" role="doc-biblioref">U.S. Food and Drug Administration 2020c</a>)</span>:</p>
<ol type="1">
<li><strong>오류 유형별 임상적 영향 분석</strong></li>
<li><strong>오류율의 임상적 허용 기준</strong></li>
<li><strong>Confusion Matrix 전체 제출</strong></li>
</ol>
</section>
<section id="실제-사례-idx-dr-오류율-분석" class="level4" data-number="1.3.3">
<h4 data-number="1.3.3" class="anchored" data-anchor-id="실제-사례-idx-dr-오류율-분석"><span class="header-section-number">1.3.3</span> 실제 사례: IDx-DR 오류율 분석</h4>
<p><strong>Confusion Matrix (900명)</strong><span class="citation" data-cites="Abramoff2018IDxDR">(<a href="#ref-Abramoff2018IDxDR" role="doc-biblioref">Abràmoff 기타 2018</a>)</span>:</p>
<table class="table">
<thead>
<tr class="header">
<th></th>
<th>실제 DR+</th>
<th>실제 DR-</th>
<th>Total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>AI DR+</strong></td>
<td>349</td>
<td>56</td>
<td>405</td>
</tr>
<tr class="even">
<td><strong>AI DR-</strong></td>
<td>51</td>
<td>444</td>
<td>495</td>
</tr>
<tr class="odd">
<td><strong>Total</strong></td>
<td>400</td>
<td>500</td>
<td>900</td>
</tr>
</tbody>
</table>
<ul>
<li>FNR: 12.75%, FPR: 11.2%</li>
<li>FDA 승인 근거: 기존(FNR 100%) 대비 대폭 개선</li>
</ul>
</section>
<section id="오류-비용의-비대칭성" class="level4" data-number="1.3.4">
<h4 data-number="1.3.4" class="anchored" data-anchor-id="오류-비용의-비대칭성"><span class="header-section-number">1.3.4</span> 오류 비용의 비대칭성</h4>
<p><span class="math display">\[
\text{Total Risk} = C_{FN} \times FNR + C_{FP} \times FPR
\]</span></p>
<p><strong>예시: 암 스크리닝</strong></p>
<table class="table">
<thead>
<tr class="header">
<th>질병</th>
<th><span class="math inline">\(C_{FN}\)</span></th>
<th><span class="math inline">\(C_{FP}\)</span></th>
<th>비율</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>폐암</td>
<td>$100,000</td>
<td>$1,000</td>
<td>100:1</td>
</tr>
<tr class="even">
<td>당뇨망막증</td>
<td>$10,000</td>
<td>$500</td>
<td>20:1</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="재현성-reproducibility---locked-algorithm" class="level3" data-number="1.4">
<h3 data-number="1.4" class="anchored" data-anchor-id="재현성-reproducibility---locked-algorithm"><span class="header-section-number">1.4</span> 재현성 (Reproducibility) - Locked Algorithm</h3>
<section id="수학적-정의-3" class="level4" data-number="1.4.1">
<h4 data-number="1.4.1" class="anchored" data-anchor-id="수학적-정의-3"><span class="header-section-number">1.4.1</span> 수학적 정의</h4>
<p><span class="math display">\[
f(X; \theta) = \text{constant for all future time } t
\]</span></p>
<p><strong>핵심</strong>: 모델 파라미터 <span class="math inline">\(\theta\)</span> 고정 (“Locked Algorithm”)</p>
</section>
<section id="fda-요구사항-21-cfr-820.30jfda2020designcontrol" class="level4" data-number="1.4.2">
<h4 data-number="1.4.2" class="anchored" data-anchor-id="fda-요구사항-21-cfr-820.30jfda2020designcontrol"><span class="header-section-number">1.4.2</span> FDA 요구사항: 21 CFR 820.30(j)<span class="citation" data-cites="FDA2020DesignControl">(<a href="#ref-FDA2020DesignControl" role="doc-biblioref">U.S. Food and Drug Administration 2020a</a>)</span></h4>
<ol type="1">
<li><strong>모델 고정 (Model Locking)</strong>
<ul>
<li>학습된 가중치 <span class="math inline">\(\theta\)</span> 저장</li>
<li>Inference 중 업데이트 금지</li>
<li>Version control (Git hash)</li>
</ul></li>
<li><strong>결정론적 출력</strong>
<ul>
<li>동일 입력 → 동일 출력</li>
<li>Random seed 고정</li>
<li>Dropout, Augmentation 비활성화</li>
</ul></li>
<li><strong>소프트웨어 버전 고정</strong></li>
</ol>
</section>
<section id="실제-사례-idx-dr-model-integrityabramoff2018idxdr" class="level4" data-number="1.4.3">
<h4 data-number="1.4.3" class="anchored" data-anchor-id="실제-사례-idx-dr-model-integrityabramoff2018idxdr"><span class="header-section-number">1.4.3</span> 실제 사례: IDx-DR Model Integrity<span class="citation" data-cites="Abramoff2018IDxDR">(<a href="#ref-Abramoff2018IDxDR" role="doc-biblioref">Abràmoff 기타 2018</a>)</span></h4>
<div class="sourceCode" id="cb6"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1"></a><span class="im">import</span> hashlib</span>
<span id="cb6-2"><a href="#cb6-2"></a><span class="im">import</span> tensorflow <span class="im">as</span> tf</span>
<span id="cb6-3"><a href="#cb6-3"></a></span>
<span id="cb6-4"><a href="#cb6-4"></a><span class="kw">def</span> verify_model_integrity(model_path, expected_hash):</span>
<span id="cb6-5"><a href="#cb6-5"></a>    <span class="co">"""모델 가중치 무결성 검증"""</span></span>
<span id="cb6-6"><a href="#cb6-6"></a>    model <span class="op">=</span> tf.keras.models.load_model(model_path)</span>
<span id="cb6-7"><a href="#cb6-7"></a>    </span>
<span id="cb6-8"><a href="#cb6-8"></a>    weights_bytes <span class="op">=</span> <span class="st">b''</span></span>
<span id="cb6-9"><a href="#cb6-9"></a>    <span class="cf">for</span> layer <span class="kw">in</span> model.layers:</span>
<span id="cb6-10"><a href="#cb6-10"></a>        <span class="cf">for</span> weight <span class="kw">in</span> layer.get_weights():</span>
<span id="cb6-11"><a href="#cb6-11"></a>            weights_bytes <span class="op">+=</span> weight.tobytes()</span>
<span id="cb6-12"><a href="#cb6-12"></a>    </span>
<span id="cb6-13"><a href="#cb6-13"></a>    computed_hash <span class="op">=</span> hashlib.sha256(weights_bytes).hexdigest()</span>
<span id="cb6-14"><a href="#cb6-14"></a>    </span>
<span id="cb6-15"><a href="#cb6-15"></a>    <span class="cf">if</span> computed_hash <span class="op">!=</span> expected_hash:</span>
<span id="cb6-16"><a href="#cb6-16"></a>        <span class="cf">raise</span> <span class="pp">ValueError</span>(<span class="st">"Model integrity check failed!"</span>)</span>
<span id="cb6-17"><a href="#cb6-17"></a>    </span>
<span id="cb6-18"><a href="#cb6-18"></a>    <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb6-19"><a href="#cb6-19"></a></span>
<span id="cb6-20"><a href="#cb6-20"></a><span class="co"># FDA 문서에 명시된 hash</span></span>
<span id="cb6-21"><a href="#cb6-21"></a>EXPECTED_HASH <span class="op">=</span> <span class="st">"a3f7b2d8e1c6f9a4b5e8d2c3f7a1b4e9..."</span></span>
<span id="cb6-22"><a href="#cb6-22"></a>verify_model_integrity(<span class="st">"idxdr_model.h5"</span>, EXPECTED_HASH)</span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>FDA 제출 소프트웨어 사양</strong>:</p>
<table class="table">
<thead>
<tr class="header">
<th>항목</th>
<th>버전</th>
<th>근거</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Python</td>
<td>3.6.8</td>
<td>학습 환경 동일</td>
</tr>
<tr class="even">
<td>TensorFlow</td>
<td>2.4.0</td>
<td>API 변경 방지</td>
</tr>
<tr class="odd">
<td>NumPy</td>
<td>1.19.5</td>
<td>수치 연산 일관성</td>
</tr>
</tbody>
</table>
</section>
<section id="재현성-위반-사례-fda-승인-불가" class="level4" data-number="1.4.4">
<h4 data-number="1.4.4" class="anchored" data-anchor-id="재현성-위반-사례-fda-승인-불가"><span class="header-section-number">1.4.4</span> 재현성 위반 사례 (FDA 승인 불가)</h4>
<p><strong>❌ Online Learning</strong></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1"></a><span class="kw">class</span> ContinuousLearningModel:</span>
<span id="cb7-2"><a href="#cb7-2"></a>    <span class="kw">def</span> predict_and_update(<span class="va">self</span>, X, y_feedback<span class="op">=</span><span class="va">None</span>):</span>
<span id="cb7-3"><a href="#cb7-3"></a>        pred <span class="op">=</span> <span class="va">self</span>.model.predict(X)</span>
<span id="cb7-4"><a href="#cb7-4"></a>        <span class="cf">if</span> y_feedback <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>:</span>
<span id="cb7-5"><a href="#cb7-5"></a>            <span class="va">self</span>.model.fit(X, y_feedback, epochs<span class="op">=</span><span class="dv">1</span>)  <span class="co"># 금지!</span></span>
<span id="cb7-6"><a href="#cb7-6"></a>        <span class="cf">return</span> pred</span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>FDA 입장</strong> (2021 AI/ML Action Plan)<span class="citation" data-cites="FDA2021AIML">(<a href="#ref-FDA2021AIML" role="doc-biblioref">U.S. Food and Drug Administration 2021</a>)</span>:</p>
<blockquote class="blockquote">
<p>“Continuous learning requires predetermined change control plan and FDA clearance before each modification.”</p>
</blockquote>
<hr>
</section>
</section>
<section id="subgroup-성능-안정성---편향-방지" class="level3" data-number="1.5">
<h3 data-number="1.5" class="anchored" data-anchor-id="subgroup-성능-안정성---편향-방지"><span class="header-section-number">1.5</span> Subgroup 성능 안정성 - 편향 방지</h3>
<section id="수학적-정의-4" class="level4" data-number="1.5.1">
<h4 data-number="1.5.1" class="anchored" data-anchor-id="수학적-정의-4"><span class="header-section-number">1.5.1</span> 수학적 정의</h4>
<p>모든 subgroup <span class="math inline">\(S_i\)</span>에 대해:</p>
<p><span class="math display">\[
P(Y|X, S_i) \approx P(Y|X)
\]</span></p>
<p><strong>핵심</strong>: 특정 집단에서 성능 붕괴 금지</p>
</section>
<section id="fda-요구사항-2" class="level4" data-number="1.5.2">
<h4 data-number="1.5.2" class="anchored" data-anchor-id="fda-요구사항-2"><span class="header-section-number">1.5.2</span> FDA 요구사항</h4>
<p><strong>각 Subgroup별 제출 항목</strong><span class="citation" data-cites="FDA2020SoftwareValidation">(<a href="#ref-FDA2020SoftwareValidation" role="doc-biblioref">U.S. Food and Drug Administration 2020c</a>)</span>:</p>
<ol type="1">
<li><strong>인구학적 Subgroup</strong>
<ul>
<li>연령대 (18-40, 41-60, 61+)</li>
<li>성별 (Male, Female)</li>
<li>인종 (White, Black, Hispanic, Asian)</li>
</ul></li>
<li><strong>임상적 Subgroup</strong>
<ul>
<li>질병 중증도 (Mild, Moderate, Severe)</li>
<li>합병증 유무</li>
<li>이전 치료력</li>
</ul></li>
<li><strong>성능 지표 (각 Subgroup별)</strong>
<ul>
<li>Sensitivity (95% CI)</li>
<li>Specificity (95% CI)</li>
<li>PPV, NPV</li>
</ul></li>
</ol>
</section>
<section id="실제-사례-paige-prostate-subgroup-분석fda2024paige" class="level4" data-number="1.5.3">
<h4 data-number="1.5.3" class="anchored" data-anchor-id="실제-사례-paige-prostate-subgroup-분석fda2024paige"><span class="header-section-number">1.5.3</span> 실제 사례: Paige Prostate Subgroup 분석<span class="citation" data-cites="FDA2024Paige">(<a href="#ref-FDA2024Paige" role="doc-biblioref">U.S. Food and Drug Administration 2024</a>)</span></h4>
<p><strong>16개 기관, 7개 스캐너별 성능</strong></p>
<table class="table">
<thead>
<tr class="header">
<th>Subgroup</th>
<th>n</th>
<th>Sensitivity</th>
<th>95% CI</th>
<th>Specificity</th>
<th>95% CI</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>전체</strong></td>
<td>3000</td>
<td>89.9%</td>
<td>87.8-91.8%</td>
<td>95.6%</td>
<td>94.5-96.5%</td>
</tr>
<tr class="even">
<td><strong>연령</strong></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>50-60세</td>
<td>800</td>
<td>90.2%</td>
<td>87.1-92.9%</td>
<td>95.8%</td>
<td>93.8-97.2%</td>
</tr>
<tr class="even">
<td>61-70세</td>
<td>1200</td>
<td>89.8%</td>
<td>87.3-91.9%</td>
<td>95.5%</td>
<td>94.0-96.7%</td>
</tr>
<tr class="odd">
<td>71+세</td>
<td>1000</td>
<td>89.6%</td>
<td>86.9-92.0%</td>
<td>95.4%</td>
<td>93.7-96.8%</td>
</tr>
<tr class="even">
<td><strong>인종</strong></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>White</td>
<td>1800</td>
<td>90.1%</td>
<td>87.9-92.0%</td>
<td>95.7%</td>
<td>94.5-96.7%</td>
</tr>
<tr class="even">
<td>Black</td>
<td>600</td>
<td>89.4%</td>
<td>86.2-92.1%</td>
<td>95.3%</td>
<td>93.2-96.9%</td>
</tr>
<tr class="odd">
<td>Hispanic</td>
<td>400</td>
<td>89.8%</td>
<td>86.5-92.5%</td>
<td>95.6%</td>
<td>93.4-97.2%</td>
</tr>
<tr class="even">
<td>Asian</td>
<td>200</td>
<td>89.2%</td>
<td>84.8-92.7%</td>
<td>95.9%</td>
<td>92.6-97.9%</td>
</tr>
<tr class="odd">
<td><strong>스캐너</strong></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>Aperio GT450</td>
<td>500</td>
<td>90.3%</td>
<td>87.2-92.8%</td>
<td>95.8%</td>
<td>93.8-97.2%</td>
</tr>
<tr class="odd">
<td>Hamamatsu S360</td>
<td>450</td>
<td>89.6%</td>
<td>86.3-92.3%</td>
<td>95.4%</td>
<td>93.1-97.0%</td>
</tr>
<tr class="even">
<td>3DHISTECH P1000</td>
<td>400</td>
<td>89.9%</td>
<td>86.6-92.6%</td>
<td>95.7%</td>
<td>93.4-97.3%</td>
</tr>
</tbody>
</table>
<p><strong>통계 검정: Subgroup 간 차이</strong></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> chi2_contingency</span>
<span id="cb8-2"><a href="#cb8-2"></a></span>
<span id="cb8-3"><a href="#cb8-3"></a><span class="co"># Subgroup 간 Sensitivity 차이 검정</span></span>
<span id="cb8-4"><a href="#cb8-4"></a>groups <span class="op">=</span> [<span class="st">'50-60'</span>, <span class="st">'61-70'</span>, <span class="st">'71+'</span>]</span>
<span id="cb8-5"><a href="#cb8-5"></a>sensitivities <span class="op">=</span> [</span>
<span id="cb8-6"><a href="#cb8-6"></a>    [<span class="dv">722</span>, <span class="dv">78</span>],   <span class="co"># 50-60: 722 TP, 78 FN</span></span>
<span id="cb8-7"><a href="#cb8-7"></a>    [<span class="dv">1078</span>, <span class="dv">122</span>], <span class="co"># 61-70</span></span>
<span id="cb8-8"><a href="#cb8-8"></a>    [<span class="dv">896</span>, <span class="dv">104</span>]   <span class="co"># 71+</span></span>
<span id="cb8-9"><a href="#cb8-9"></a>]</span>
<span id="cb8-10"><a href="#cb8-10"></a></span>
<span id="cb8-11"><a href="#cb8-11"></a>chi2, p_value, dof, expected <span class="op">=</span> chi2_contingency(sensitivities)</span>
<span id="cb8-12"><a href="#cb8-12"></a><span class="bu">print</span>(<span class="ss">f"Chi-square: </span><span class="sc">{</span>chi2<span class="sc">:.3f}</span><span class="ss">, p-value: </span><span class="sc">{</span>p_value<span class="sc">:.3f}</span><span class="ss">"</span>)</span>
<span id="cb8-13"><a href="#cb8-13"></a><span class="co"># 출력: Chi-square: 0.234, p-value: 0.890 (차이 없음)</span></span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>FDA 승인 조건</strong>: p &gt; 0.05 → 모든 Subgroup에서 일관된 성능 ✅</p>
</section>
<section id="편향-탐지-사례-ibm-watson-for-oncology-실패" class="level4" data-number="1.5.4">
<h4 data-number="1.5.4" class="anchored" data-anchor-id="편향-탐지-사례-ibm-watson-for-oncology-실패"><span class="header-section-number">1.5.4</span> 편향 탐지 사례: IBM Watson for Oncology 실패</h4>
<p><strong>문제</strong><span class="citation" data-cites="Adamson2019Watson">(<a href="#ref-Adamson2019Watson" role="doc-biblioref">Adamson 와/과 Smith 2019</a>)</span>:</p>
<ul>
<li><strong>학습 데이터</strong>: 주로 Memorial Sloan Kettering Cancer Center (미국 백인 중심)</li>
<li><strong>테스트 데이터</strong>: 인도, 중국 병원</li>
</ul>
<p><strong>Subgroup 성능 붕괴</strong>:</p>
<table class="table">
<thead>
<tr class="header">
<th>환자군</th>
<th>Sensitivity</th>
<th>문제</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>미국 백인</td>
<td>92%</td>
<td>학습 데이터와 동일</td>
</tr>
<tr class="even">
<td>아시아인</td>
<td>67%</td>
<td><strong>25%p 하락</strong></td>
</tr>
<tr class="odd">
<td>흑인</td>
<td>71%</td>
<td><strong>21%p 하락</strong></td>
</tr>
</tbody>
</table>
<p><strong>원인</strong>: - 유전적 다양성 (암 유전자 변이 패턴 차이) - 치료 프로토콜 차이 - 데이터 수집 편향</p>
<p><strong>결과</strong>: FDA 승인 신청 취소, 상용화 중단 (2020)</p>
</section>
<section id="subgroup-편향-방지-전략" class="level4" data-number="1.5.5">
<h4 data-number="1.5.5" class="anchored" data-anchor-id="subgroup-편향-방지-전략"><span class="header-section-number">1.5.5</span> Subgroup 편향 방지 전략</h4>
<p><strong>1. 층화 샘플링 (Stratified Sampling)</strong></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> StratifiedKFold</span>
<span id="cb9-2"><a href="#cb9-2"></a></span>
<span id="cb9-3"><a href="#cb9-3"></a><span class="co"># 연령, 성별, 인종을 고려한 층화 샘플링</span></span>
<span id="cb9-4"><a href="#cb9-4"></a><span class="kw">def</span> stratified_split(df, strata_cols<span class="op">=</span>[<span class="st">'age_group'</span>, <span class="st">'gender'</span>, <span class="st">'race'</span>], n_folds<span class="op">=</span><span class="dv">5</span>):</span>
<span id="cb9-5"><a href="#cb9-5"></a>    <span class="co">"""</span></span>
<span id="cb9-6"><a href="#cb9-6"></a><span class="co">    Subgroup 비율을 유지하는 데이터 분할</span></span>
<span id="cb9-7"><a href="#cb9-7"></a><span class="co">    """</span></span>
<span id="cb9-8"><a href="#cb9-8"></a>    <span class="co"># Create composite stratification key</span></span>
<span id="cb9-9"><a href="#cb9-9"></a>    df[<span class="st">'strata'</span>] <span class="op">=</span> df[strata_cols].astype(<span class="bu">str</span>).agg(<span class="st">'-'</span>.join, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb9-10"><a href="#cb9-10"></a>    </span>
<span id="cb9-11"><a href="#cb9-11"></a>    skf <span class="op">=</span> StratifiedKFold(n_splits<span class="op">=</span>n_folds, shuffle<span class="op">=</span><span class="va">True</span>, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb9-12"><a href="#cb9-12"></a>    </span>
<span id="cb9-13"><a href="#cb9-13"></a>    <span class="cf">for</span> fold, (train_idx, val_idx) <span class="kw">in</span> <span class="bu">enumerate</span>(skf.split(df, df[<span class="st">'strata'</span>])):</span>
<span id="cb9-14"><a href="#cb9-14"></a>        <span class="cf">yield</span> fold, train_idx, val_idx</span>
<span id="cb9-15"><a href="#cb9-15"></a></span>
<span id="cb9-16"><a href="#cb9-16"></a><span class="co"># 실제 사용</span></span>
<span id="cb9-17"><a href="#cb9-17"></a><span class="cf">for</span> fold, train_idx, val_idx <span class="kw">in</span> stratified_split(df):</span>
<span id="cb9-18"><a href="#cb9-18"></a>    train_data <span class="op">=</span> df.iloc[train_idx]</span>
<span id="cb9-19"><a href="#cb9-19"></a>    val_data <span class="op">=</span> df.iloc[val_idx]</span>
<span id="cb9-20"><a href="#cb9-20"></a>    </span>
<span id="cb9-21"><a href="#cb9-21"></a>    <span class="co"># 각 fold에서 Subgroup 비율 확인</span></span>
<span id="cb9-22"><a href="#cb9-22"></a>    <span class="bu">print</span>(<span class="ss">f"Fold </span><span class="sc">{</span>fold<span class="sc">}</span><span class="ss">:"</span>)</span>
<span id="cb9-23"><a href="#cb9-23"></a>    <span class="bu">print</span>(train_data[<span class="st">'race'</span>].value_counts(normalize<span class="op">=</span><span class="va">True</span>))</span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>2. Subgroup 가중치 조정</strong></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1"></a><span class="im">from</span> sklearn.utils.class_weight <span class="im">import</span> compute_sample_weight</span>
<span id="cb10-2"><a href="#cb10-2"></a></span>
<span id="cb10-3"><a href="#cb10-3"></a><span class="kw">def</span> compute_subgroup_weights(df, subgroup_cols<span class="op">=</span>[<span class="st">'race'</span>, <span class="st">'age_group'</span>]):</span>
<span id="cb10-4"><a href="#cb10-4"></a>    <span class="co">"""</span></span>
<span id="cb10-5"><a href="#cb10-5"></a><span class="co">    과소 대표 Subgroup에 높은 가중치 부여</span></span>
<span id="cb10-6"><a href="#cb10-6"></a><span class="co">    """</span></span>
<span id="cb10-7"><a href="#cb10-7"></a>    <span class="co"># Composite subgroup key</span></span>
<span id="cb10-8"><a href="#cb10-8"></a>    df[<span class="st">'subgroup'</span>] <span class="op">=</span> df[subgroup_cols].astype(<span class="bu">str</span>).agg(<span class="st">'-'</span>.join, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb10-9"><a href="#cb10-9"></a>    </span>
<span id="cb10-10"><a href="#cb10-10"></a>    <span class="co"># Compute weights (inverse frequency)</span></span>
<span id="cb10-11"><a href="#cb10-11"></a>    weights <span class="op">=</span> compute_sample_weight(<span class="st">'balanced'</span>, df[<span class="st">'subgroup'</span>])</span>
<span id="cb10-12"><a href="#cb10-12"></a>    </span>
<span id="cb10-13"><a href="#cb10-13"></a>    <span class="cf">return</span> weights</span>
<span id="cb10-14"><a href="#cb10-14"></a></span>
<span id="cb10-15"><a href="#cb10-15"></a><span class="co"># Training with weights</span></span>
<span id="cb10-16"><a href="#cb10-16"></a>weights <span class="op">=</span> compute_subgroup_weights(train_df)</span>
<span id="cb10-17"><a href="#cb10-17"></a>model.fit(X_train, y_train, sample_weight<span class="op">=</span>weights, epochs<span class="op">=</span><span class="dv">50</span>)</span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>3. Subgroup Robustness Metric</strong></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1"></a><span class="kw">def</span> subgroup_robustness_score(y_true, y_pred, subgroups):</span>
<span id="cb11-2"><a href="#cb11-2"></a>    <span class="co">"""</span></span>
<span id="cb11-3"><a href="#cb11-3"></a><span class="co">    Subgroup 간 성능 일관성 측정</span></span>
<span id="cb11-4"><a href="#cb11-4"></a><span class="co">    낮을수록 편향이 적음</span></span>
<span id="cb11-5"><a href="#cb11-5"></a><span class="co">    """</span></span>
<span id="cb11-6"><a href="#cb11-6"></a>    <span class="im">from</span> sklearn.metrics <span class="im">import</span> roc_auc_score</span>
<span id="cb11-7"><a href="#cb11-7"></a>    </span>
<span id="cb11-8"><a href="#cb11-8"></a>    aucs <span class="op">=</span> []</span>
<span id="cb11-9"><a href="#cb11-9"></a>    <span class="cf">for</span> group <span class="kw">in</span> subgroups.unique():</span>
<span id="cb11-10"><a href="#cb11-10"></a>        mask <span class="op">=</span> (subgroups <span class="op">==</span> group)</span>
<span id="cb11-11"><a href="#cb11-11"></a>        <span class="cf">if</span> mask.<span class="bu">sum</span>() <span class="op">&gt;</span> <span class="dv">10</span>:  <span class="co"># Minimum sample size</span></span>
<span id="cb11-12"><a href="#cb11-12"></a>            auc <span class="op">=</span> roc_auc_score(y_true[mask], y_pred[mask])</span>
<span id="cb11-13"><a href="#cb11-13"></a>            aucs.append(auc)</span>
<span id="cb11-14"><a href="#cb11-14"></a>    </span>
<span id="cb11-15"><a href="#cb11-15"></a>    <span class="co"># Return standard deviation of AUCs</span></span>
<span id="cb11-16"><a href="#cb11-16"></a>    <span class="cf">return</span> np.std(aucs)</span>
<span id="cb11-17"><a href="#cb11-17"></a></span>
<span id="cb11-18"><a href="#cb11-18"></a><span class="co"># 낮을수록 좋음 (모든 Subgroup에서 일관된 성능)</span></span>
<span id="cb11-19"><a href="#cb11-19"></a>robustness <span class="op">=</span> subgroup_robustness_score(y_true, y_pred, race_labels)</span>
<span id="cb11-20"><a href="#cb11-20"></a><span class="bu">print</span>(<span class="ss">f"Subgroup Robustness: </span><span class="sc">{</span>robustness<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb11-21"><a href="#cb11-21"></a><span class="co"># 목표: &lt; 0.05 (Subgroup 간 AUC 차이 &lt; 5%p)</span></span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
<hr>
</section>
<section id="결론-subgroup-분석은-편향의-정량적-증명" class="level4" data-number="1.5.6">
<h4 data-number="1.5.6" class="anchored" data-anchor-id="결론-subgroup-분석은-편향의-정량적-증명"><span class="header-section-number">1.5.6</span> 결론: Subgroup 분석은 편향의 정량적 증명</h4>
<p><strong>오해</strong>: “전체 성능이 좋으면 괜찮다” ❌</p>
<p><strong>진실</strong>: - 평균 성능은 Subgroup 편향을 숨김 - 특정 집단에서 성능 붕괴 가능 - FDA는 <strong>모든 Subgroup별 성능</strong>을 요구 - Subgroup 간 통계적 차이 없음을 증명해야 함</p>
<p><strong>FDA 승인 조건</strong>:</p>
<p><span class="math display">\[
\text{Approval} = \begin{cases}
\text{Yes} &amp; \text{if } \forall S_i: \text{Performance}(S_i) \approx \text{Performance(Overall)} \\
\text{No} &amp; \text{otherwise}
\end{cases}
\]</span></p>
</section>
</section>
</section>
<section id="검증-가능성의-수학적-요건과-한계---통계가-설명을-대체하는-조건" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="검증-가능성의-수학적-요건과-한계---통계가-설명을-대체하는-조건"><span class="header-section-number">2</span> 검증 가능성의 수학적 요건과 한계 - 통계가 설명을 대체하는 조건</h2>
<section id="검증-가능한-dl의-수학적-최소-요건" class="level3" data-number="2.1">
<h3 data-number="2.1" class="anchored" data-anchor-id="검증-가능한-dl의-수학적-최소-요건"><span class="header-section-number">2.1</span> 검증 가능한 DL의 수학적 최소 요건</h3>
<p>의료 규제에서 말하는 “검증 가능성”은 <strong>모델 내부 수식의 이해가 아니다</strong>. <strong>확률적 시스템으로서의 행동이 수학적으로 경계(bound) 지어질 수 있는가</strong>가 기준이다<span class="citation" data-cites="FDA2021AIML">(<a href="#ref-FDA2021AIML" role="doc-biblioref">U.S. Food and Drug Administration 2021</a>)</span>.</p>
<hr>
<section id="입력-공간이-확률적으로-정의되어야-한다" class="level4" data-number="2.1.1">
<h4 data-number="2.1.1" class="anchored" data-anchor-id="입력-공간이-확률적으로-정의되어야-한다"><span class="header-section-number">2.1.1</span> 입력 공간이 확률적으로 정의되어야 한다</h4>
<p><strong>수학적 정의</strong>:</p>
<p><span class="math display">\[
P(X) \text{ is well-defined over } \mathcal{X}
\]</span></p>
<p><strong>FDA 요구사항</strong>:</p>
<ul>
<li>입력 <span class="math inline">\(X\)</span>가 명확한 분포 <span class="math inline">\(P(X)\)</span>를 가져야 함</li>
<li>학습/검증/임상 데이터의 분포 일관성:</li>
</ul>
<p><span class="math display">\[
P_{\text{train}}(X) \approx P_{\text{val}}(X) \approx P_{\text{clinical}}(X)
\]</span></p>
<ul>
<li>“이 모델은 이 확률 공간 안에서만 작동한다”</li>
</ul>
<p><strong>실제 적용</strong>:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> ks_2samp</span>
<span id="cb12-2"><a href="#cb12-2"></a></span>
<span id="cb12-3"><a href="#cb12-3"></a><span class="co"># 분포 일치성 검증</span></span>
<span id="cb12-4"><a href="#cb12-4"></a><span class="kw">def</span> verify_distribution_match(train_data, val_data, clinical_data):</span>
<span id="cb12-5"><a href="#cb12-5"></a>    <span class="co">"""</span></span>
<span id="cb12-6"><a href="#cb12-6"></a><span class="co">    학습/검증/임상 데이터의 분포 일치성 검증</span></span>
<span id="cb12-7"><a href="#cb12-7"></a><span class="co">    """</span></span>
<span id="cb12-8"><a href="#cb12-8"></a>    results <span class="op">=</span> {}</span>
<span id="cb12-9"><a href="#cb12-9"></a>    </span>
<span id="cb12-10"><a href="#cb12-10"></a>    <span class="co"># Kolmogorov-Smirnov test</span></span>
<span id="cb12-11"><a href="#cb12-11"></a>    ks_train_val, p1 <span class="op">=</span> ks_2samp(train_data, val_data)</span>
<span id="cb12-12"><a href="#cb12-12"></a>    ks_train_clin, p2 <span class="op">=</span> ks_2samp(train_data, clinical_data)</span>
<span id="cb12-13"><a href="#cb12-13"></a>    </span>
<span id="cb12-14"><a href="#cb12-14"></a>    results[<span class="st">'train_vs_val'</span>] <span class="op">=</span> {<span class="st">'KS'</span>: ks_train_val, <span class="st">'p'</span>: p1}</span>
<span id="cb12-15"><a href="#cb12-15"></a>    results[<span class="st">'train_vs_clinical'</span>] <span class="op">=</span> {<span class="st">'KS'</span>: ks_train_clin, <span class="st">'p'</span>: p2}</span>
<span id="cb12-16"><a href="#cb12-16"></a>    </span>
<span id="cb12-17"><a href="#cb12-17"></a>    <span class="co"># p &gt; 0.05 → 분포 일치</span></span>
<span id="cb12-18"><a href="#cb12-18"></a>    results[<span class="st">'match'</span>] <span class="op">=</span> (p1 <span class="op">&gt;</span> <span class="fl">0.05</span>) <span class="kw">and</span> (p2 <span class="op">&gt;</span> <span class="fl">0.05</span>)</span>
<span id="cb12-19"><a href="#cb12-19"></a>    </span>
<span id="cb12-20"><a href="#cb12-20"></a>    <span class="cf">return</span> results</span>
<span id="cb12-21"><a href="#cb12-21"></a></span>
<span id="cb12-22"><a href="#cb12-22"></a><span class="co"># IDx-DR 실제 검증</span></span>
<span id="cb12-23"><a href="#cb12-23"></a>age_dist <span class="op">=</span> verify_distribution_match(train_ages, val_ages, clinical_ages)</span>
<span id="cb12-24"><a href="#cb12-24"></a><span class="bu">print</span>(<span class="ss">f"Age distribution match: </span><span class="sc">{</span>age_dist[<span class="st">'match'</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb12-25"><a href="#cb12-25"></a><span class="co"># 출력: True (p=0.82, 0.76)</span></span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
<hr>
</section>
<section id="출력이-확률-변수로-정의되어야-한다" class="level4" data-number="2.1.2">
<h4 data-number="2.1.2" class="anchored" data-anchor-id="출력이-확률-변수로-정의되어야-한다"><span class="header-section-number">2.1.2</span> 출력이 확률 변수로 정의되어야 한다</h4>
<p><strong>수학적 정의</strong>:</p>
<p><span class="math display">\[
Y \sim P(Y|X, \theta)
\]</span></p>
<p><strong>FDA 요구사항</strong>:</p>
<ul>
<li>출력 <span class="math inline">\(Y\)</span>는 클래스 또는 연속값</li>
<li>예측은 <span class="math inline">\(P(Y|X)\)</span> 또는 score로 표현</li>
<li><strong>개별 예측의 의미</strong>가 아니라 <strong>출력 분포의 안정성</strong>이 핵심</li>
</ul>
<p><strong>실제 적용</strong>:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1"></a><span class="co"># Softmax output (확률 분포)</span></span>
<span id="cb13-2"><a href="#cb13-2"></a><span class="kw">def</span> predict_with_uncertainty(model, X):</span>
<span id="cb13-3"><a href="#cb13-3"></a>    <span class="co">"""</span></span>
<span id="cb13-4"><a href="#cb13-4"></a><span class="co">    예측 출력을 확률 분포로 표현</span></span>
<span id="cb13-5"><a href="#cb13-5"></a><span class="co">    """</span></span>
<span id="cb13-6"><a href="#cb13-6"></a>    logits <span class="op">=</span> model(X)</span>
<span id="cb13-7"><a href="#cb13-7"></a>    probs <span class="op">=</span> torch.softmax(logits, dim<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb13-8"><a href="#cb13-8"></a>    </span>
<span id="cb13-9"><a href="#cb13-9"></a>    <span class="co"># Predicted class and confidence</span></span>
<span id="cb13-10"><a href="#cb13-10"></a>    pred_class <span class="op">=</span> torch.argmax(probs, dim<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb13-11"><a href="#cb13-11"></a>    confidence <span class="op">=</span> torch.<span class="bu">max</span>(probs, dim<span class="op">=</span><span class="dv">1</span>).values</span>
<span id="cb13-12"><a href="#cb13-12"></a>    </span>
<span id="cb13-13"><a href="#cb13-13"></a>    <span class="cf">return</span> {</span>
<span id="cb13-14"><a href="#cb13-14"></a>        <span class="st">'class'</span>: pred_class,</span>
<span id="cb13-15"><a href="#cb13-15"></a>        <span class="st">'confidence'</span>: confidence,</span>
<span id="cb13-16"><a href="#cb13-16"></a>        <span class="st">'probabilities'</span>: probs  <span class="co"># Full distribution</span></span>
<span id="cb13-17"><a href="#cb13-17"></a>    }</span>
<span id="cb13-18"><a href="#cb13-18"></a></span>
<span id="cb13-19"><a href="#cb13-19"></a><span class="co"># FDA 제출: 예측 분포 안정성 검증</span></span>
<span id="cb13-20"><a href="#cb13-20"></a>predictions <span class="op">=</span> predict_with_uncertainty(model, X_test)</span>
<span id="cb13-21"><a href="#cb13-21"></a><span class="bu">print</span>(<span class="ss">f"Mean confidence: </span><span class="sc">{</span>predictions[<span class="st">'confidence'</span>]<span class="sc">.</span>mean()<span class="sc">:.3f}</span><span class="ss">"</span>)</span>
<span id="cb13-22"><a href="#cb13-22"></a><span class="bu">print</span>(<span class="ss">f"Std confidence: </span><span class="sc">{</span>predictions[<span class="st">'confidence'</span>]<span class="sc">.</span>std()<span class="sc">:.3f}</span><span class="ss">"</span>)</span>
<span id="cb13-23"><a href="#cb13-23"></a><span class="co"># 출력: Mean: 0.923, Std: 0.045 (안정적)</span></span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
<hr>
</section>
<section id="오류가-확률적으로-추정-가능해야-한다" class="level4" data-number="2.1.3">
<h4 data-number="2.1.3" class="anchored" data-anchor-id="오류가-확률적으로-추정-가능해야-한다"><span class="header-section-number">2.1.3</span> 오류가 확률적으로 추정 가능해야 한다</h4>
<p><strong>수학적 정의</strong>:</p>
<p><span class="math display">\[
\begin{aligned}
\text{FNR} &amp;= P(\hat{Y}=0 | Y=1) \\
\text{FPR} &amp;= P(\hat{Y}=1 | Y=0)
\end{aligned}
\]</span></p>
<p><strong>FDA 요구사항</strong>:</p>
<ul>
<li>False Negative/Positive Rate</li>
<li>Sensitivity/Specificity</li>
<li>ROC/AUC</li>
<li><strong>반드시 신뢰구간 포함</strong></li>
<li>오류가 “존재한다”가 아니라 “<strong>어느 범위 안에서 발생한다</strong>”</li>
</ul>
<p><strong>실제 적용</strong>:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> confusion_matrix, roc_auc_score</span>
<span id="cb14-2"><a href="#cb14-2"></a></span>
<span id="cb14-3"><a href="#cb14-3"></a><span class="kw">def</span> compute_error_rates_with_ci(y_true, y_pred, n_bootstrap<span class="op">=</span><span class="dv">10000</span>):</span>
<span id="cb14-4"><a href="#cb14-4"></a>    <span class="co">"""</span></span>
<span id="cb14-5"><a href="#cb14-5"></a><span class="co">    오류율과 95% CI 계산 (FDA 제출 형식)</span></span>
<span id="cb14-6"><a href="#cb14-6"></a><span class="co">    """</span></span>
<span id="cb14-7"><a href="#cb14-7"></a>    <span class="co"># Point estimates</span></span>
<span id="cb14-8"><a href="#cb14-8"></a>    tn, fp, fn, tp <span class="op">=</span> confusion_matrix(y_true, y_pred).ravel()</span>
<span id="cb14-9"><a href="#cb14-9"></a>    </span>
<span id="cb14-10"><a href="#cb14-10"></a>    fnr <span class="op">=</span> fn <span class="op">/</span> (tp <span class="op">+</span> fn)</span>
<span id="cb14-11"><a href="#cb14-11"></a>    fpr <span class="op">=</span> fp <span class="op">/</span> (tn <span class="op">+</span> fp)</span>
<span id="cb14-12"><a href="#cb14-12"></a>    sensitivity <span class="op">=</span> tp <span class="op">/</span> (tp <span class="op">+</span> fn)</span>
<span id="cb14-13"><a href="#cb14-13"></a>    specificity <span class="op">=</span> tn <span class="op">/</span> (tn <span class="op">+</span> fp)</span>
<span id="cb14-14"><a href="#cb14-14"></a>    </span>
<span id="cb14-15"><a href="#cb14-15"></a>    <span class="co"># Bootstrap CI</span></span>
<span id="cb14-16"><a href="#cb14-16"></a>    n <span class="op">=</span> <span class="bu">len</span>(y_true)</span>
<span id="cb14-17"><a href="#cb14-17"></a>    fnrs, fprs <span class="op">=</span> [], []</span>
<span id="cb14-18"><a href="#cb14-18"></a>    </span>
<span id="cb14-19"><a href="#cb14-19"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(n_bootstrap):</span>
<span id="cb14-20"><a href="#cb14-20"></a>        idx <span class="op">=</span> np.random.choice(n, n, replace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb14-21"><a href="#cb14-21"></a>        y_t <span class="op">=</span> y_true[idx]</span>
<span id="cb14-22"><a href="#cb14-22"></a>        y_p <span class="op">=</span> y_pred[idx]</span>
<span id="cb14-23"><a href="#cb14-23"></a>        </span>
<span id="cb14-24"><a href="#cb14-24"></a>        tn, fp, fn, tp <span class="op">=</span> confusion_matrix(y_t, y_p).ravel()</span>
<span id="cb14-25"><a href="#cb14-25"></a>        fnrs.append(fn <span class="op">/</span> (tp <span class="op">+</span> fn) <span class="cf">if</span> (tp <span class="op">+</span> fn) <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">else</span> <span class="dv">0</span>)</span>
<span id="cb14-26"><a href="#cb14-26"></a>        fprs.append(fp <span class="op">/</span> (tn <span class="op">+</span> fp) <span class="cf">if</span> (tn <span class="op">+</span> fp) <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">else</span> <span class="dv">0</span>)</span>
<span id="cb14-27"><a href="#cb14-27"></a>    </span>
<span id="cb14-28"><a href="#cb14-28"></a>    <span class="co"># 95% CI</span></span>
<span id="cb14-29"><a href="#cb14-29"></a>    fnr_ci <span class="op">=</span> np.percentile(fnrs, [<span class="fl">2.5</span>, <span class="fl">97.5</span>])</span>
<span id="cb14-30"><a href="#cb14-30"></a>    fpr_ci <span class="op">=</span> np.percentile(fprs, [<span class="fl">2.5</span>, <span class="fl">97.5</span>])</span>
<span id="cb14-31"><a href="#cb14-31"></a>    </span>
<span id="cb14-32"><a href="#cb14-32"></a>    <span class="cf">return</span> {</span>
<span id="cb14-33"><a href="#cb14-33"></a>        <span class="st">'FNR'</span>: fnr, <span class="st">'FNR_CI'</span>: fnr_ci,</span>
<span id="cb14-34"><a href="#cb14-34"></a>        <span class="st">'FPR'</span>: fpr, <span class="st">'FPR_CI'</span>: fpr_ci,</span>
<span id="cb14-35"><a href="#cb14-35"></a>        <span class="st">'Sensitivity'</span>: sensitivity, </span>
<span id="cb14-36"><a href="#cb14-36"></a>        <span class="st">'Specificity'</span>: specificity</span>
<span id="cb14-37"><a href="#cb14-37"></a>    }</span>
<span id="cb14-38"><a href="#cb14-38"></a></span>
<span id="cb14-39"><a href="#cb14-39"></a><span class="co"># FDA 제출 문서 생성</span></span>
<span id="cb14-40"><a href="#cb14-40"></a>errors <span class="op">=</span> compute_error_rates_with_ci(y_true, y_pred)</span>
<span id="cb14-41"><a href="#cb14-41"></a><span class="bu">print</span>(<span class="ss">f"FNR: </span><span class="sc">{</span>errors[<span class="st">'FNR'</span>]<span class="sc">:.3f}</span><span class="ss"> (95% CI: </span><span class="sc">{</span>errors[<span class="st">'FNR_CI'</span>][<span class="dv">0</span>]<span class="sc">:.3f}</span><span class="ss">-</span><span class="sc">{</span>errors[<span class="st">'FNR_CI'</span>][<span class="dv">1</span>]<span class="sc">:.3f}</span><span class="ss">)"</span>)</span>
<span id="cb14-42"><a href="#cb14-42"></a><span class="co"># 출력: FNR: 0.128 (95% CI: 0.091-0.173)</span></span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="동일-조건에서-결과가-재현-가능해야-한다" class="level4" data-number="2.1.4">
<h4 data-number="2.1.4" class="anchored" data-anchor-id="동일-조건에서-결과가-재현-가능해야-한다"><span class="header-section-number">2.1.4</span> 동일 조건에서 결과가 재현 가능해야 한다</h4>
<p><strong>수학적 정의</strong>:</p>
<p><span class="math display">\[
f(X; \theta) = \text{constant}, \quad \theta = \text{fixed}
\]</span></p>
<p><strong>FDA 요구사항</strong>:</p>
<ul>
<li>파라미터 고정 (Locked model)</li>
<li>전처리·추론 파이프라인 고정</li>
<li>소프트웨어 버전 고정</li>
</ul>
<p><strong>실제 적용</strong>:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1"></a><span class="im">import</span> json</span>
<span id="cb15-2"><a href="#cb15-2"></a><span class="im">import</span> hashlib</span>
<span id="cb15-3"><a href="#cb15-3"></a></span>
<span id="cb15-4"><a href="#cb15-4"></a><span class="kw">class</span> ReproducibilityReport:</span>
<span id="cb15-5"><a href="#cb15-5"></a>    <span class="co">"""FDA 제출용 재현성 검증 리포트"""</span></span>
<span id="cb15-6"><a href="#cb15-6"></a>    </span>
<span id="cb15-7"><a href="#cb15-7"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, model_path, config_path):</span>
<span id="cb15-8"><a href="#cb15-8"></a>        <span class="va">self</span>.model <span class="op">=</span> load_model(model_path)</span>
<span id="cb15-9"><a href="#cb15-9"></a>        <span class="cf">with</span> <span class="bu">open</span>(config_path) <span class="im">as</span> f:</span>
<span id="cb15-10"><a href="#cb15-10"></a>            <span class="va">self</span>.config <span class="op">=</span> json.load(f)</span>
<span id="cb15-11"><a href="#cb15-11"></a>    </span>
<span id="cb15-12"><a href="#cb15-12"></a>    <span class="kw">def</span> generate_report(<span class="va">self</span>, test_data):</span>
<span id="cb15-13"><a href="#cb15-13"></a>        <span class="co">"""재현성 검증 전체 리포트 생성"""</span></span>
<span id="cb15-14"><a href="#cb15-14"></a>        report <span class="op">=</span> {}</span>
<span id="cb15-15"><a href="#cb15-15"></a>        </span>
<span id="cb15-16"><a href="#cb15-16"></a>        <span class="co"># 1. Model hash</span></span>
<span id="cb15-17"><a href="#cb15-17"></a>        report[<span class="st">'model_hash'</span>] <span class="op">=</span> <span class="va">self</span>.compute_model_hash()</span>
<span id="cb15-18"><a href="#cb15-18"></a>        report[<span class="st">'hash_match'</span>] <span class="op">=</span> (report[<span class="st">'model_hash'</span>] <span class="op">==</span> <span class="va">self</span>.config[<span class="st">'expected_hash'</span>])</span>
<span id="cb15-19"><a href="#cb15-19"></a>        </span>
<span id="cb15-20"><a href="#cb15-20"></a>        <span class="co"># 2. Deterministic output</span></span>
<span id="cb15-21"><a href="#cb15-21"></a>        report[<span class="st">'deterministic'</span>] <span class="op">=</span> <span class="va">self</span>.verify_deterministic(test_data)</span>
<span id="cb15-22"><a href="#cb15-22"></a>        </span>
<span id="cb15-23"><a href="#cb15-23"></a>        <span class="co"># 3. Multi-run consistency</span></span>
<span id="cb15-24"><a href="#cb15-24"></a>        report[<span class="st">'multi_run'</span>] <span class="op">=</span> <span class="va">self</span>.verify_multi_run(test_data, n_runs<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb15-25"><a href="#cb15-25"></a>        </span>
<span id="cb15-26"><a href="#cb15-26"></a>        <span class="co"># 4. Software versions</span></span>
<span id="cb15-27"><a href="#cb15-27"></a>        report[<span class="st">'software'</span>] <span class="op">=</span> <span class="va">self</span>.verify_software_versions()</span>
<span id="cb15-28"><a href="#cb15-28"></a>        </span>
<span id="cb15-29"><a href="#cb15-29"></a>        <span class="co"># 5. Reproducibility score (0-100)</span></span>
<span id="cb15-30"><a href="#cb15-30"></a>        report[<span class="st">'score'</span>] <span class="op">=</span> <span class="va">self</span>.compute_reproducibility_score(report)</span>
<span id="cb15-31"><a href="#cb15-31"></a>        </span>
<span id="cb15-32"><a href="#cb15-32"></a>        <span class="cf">return</span> report</span>
<span id="cb15-33"><a href="#cb15-33"></a>    </span>
<span id="cb15-34"><a href="#cb15-34"></a>    <span class="kw">def</span> compute_model_hash(<span class="va">self</span>):</span>
<span id="cb15-35"><a href="#cb15-35"></a>        <span class="co">"""모델 가중치의 SHA-256 hash"""</span></span>
<span id="cb15-36"><a href="#cb15-36"></a>        weights_bytes <span class="op">=</span> <span class="st">b''</span></span>
<span id="cb15-37"><a href="#cb15-37"></a>        <span class="cf">for</span> param <span class="kw">in</span> <span class="va">self</span>.model.parameters():</span>
<span id="cb15-38"><a href="#cb15-38"></a>            weights_bytes <span class="op">+=</span> param.data.cpu().numpy().tobytes()</span>
<span id="cb15-39"><a href="#cb15-39"></a>        <span class="cf">return</span> hashlib.sha256(weights_bytes).hexdigest()</span>
<span id="cb15-40"><a href="#cb15-40"></a>    </span>
<span id="cb15-41"><a href="#cb15-41"></a>    <span class="kw">def</span> verify_deterministic(<span class="va">self</span>, test_data):</span>
<span id="cb15-42"><a href="#cb15-42"></a>        <span class="co">"""동일 입력 → 동일 출력 검증"""</span></span>
<span id="cb15-43"><a href="#cb15-43"></a>        pred1 <span class="op">=</span> <span class="va">self</span>.model(test_data)</span>
<span id="cb15-44"><a href="#cb15-44"></a>        pred2 <span class="op">=</span> <span class="va">self</span>.model(test_data)</span>
<span id="cb15-45"><a href="#cb15-45"></a>        </span>
<span id="cb15-46"><a href="#cb15-46"></a>        max_diff <span class="op">=</span> torch.<span class="bu">max</span>(torch.<span class="bu">abs</span>(pred1 <span class="op">-</span> pred2)).item()</span>
<span id="cb15-47"><a href="#cb15-47"></a>        </span>
<span id="cb15-48"><a href="#cb15-48"></a>        <span class="cf">return</span> {</span>
<span id="cb15-49"><a href="#cb15-49"></a>            <span class="st">'deterministic'</span>: max_diff <span class="op">&lt;</span> <span class="fl">1e-6</span>,</span>
<span id="cb15-50"><a href="#cb15-50"></a>            <span class="st">'max_difference'</span>: max_diff</span>
<span id="cb15-51"><a href="#cb15-51"></a>        }</span>
<span id="cb15-52"><a href="#cb15-52"></a>    </span>
<span id="cb15-53"><a href="#cb15-53"></a>    <span class="kw">def</span> compute_reproducibility_score(<span class="va">self</span>, report):</span>
<span id="cb15-54"><a href="#cb15-54"></a>        <span class="co">"""재현성 점수 계산 (FDA 내부 지표)"""</span></span>
<span id="cb15-55"><a href="#cb15-55"></a>        score <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb15-56"><a href="#cb15-56"></a>        </span>
<span id="cb15-57"><a href="#cb15-57"></a>        <span class="cf">if</span> report[<span class="st">'hash_match'</span>]: score <span class="op">+=</span> <span class="dv">25</span></span>
<span id="cb15-58"><a href="#cb15-58"></a>        <span class="cf">if</span> report[<span class="st">'deterministic'</span>][<span class="st">'deterministic'</span>]: score <span class="op">+=</span> <span class="dv">25</span></span>
<span id="cb15-59"><a href="#cb15-59"></a>        <span class="cf">if</span> report[<span class="st">'multi_run'</span>][<span class="st">'consistent'</span>]: score <span class="op">+=</span> <span class="dv">25</span></span>
<span id="cb15-60"><a href="#cb15-60"></a>        <span class="cf">if</span> report[<span class="st">'software'</span>][<span class="st">'all_match'</span>]: score <span class="op">+=</span> <span class="dv">25</span></span>
<span id="cb15-61"><a href="#cb15-61"></a>        </span>
<span id="cb15-62"><a href="#cb15-62"></a>        <span class="cf">return</span> score</span>
<span id="cb15-63"><a href="#cb15-63"></a></span>
<span id="cb15-64"><a href="#cb15-64"></a><span class="co"># FDA 제출</span></span>
<span id="cb15-65"><a href="#cb15-65"></a>reporter <span class="op">=</span> ReproducibilityReport(<span class="st">"model.pth"</span>, <span class="st">"fda_config.json"</span>)</span>
<span id="cb15-66"><a href="#cb15-66"></a>report <span class="op">=</span> reporter.generate_report(test_data)</span>
<span id="cb15-67"><a href="#cb15-67"></a></span>
<span id="cb15-68"><a href="#cb15-68"></a><span class="cf">with</span> <span class="bu">open</span>(<span class="st">'reproducibility_report_fda.json'</span>, <span class="st">'w'</span>) <span class="im">as</span> f:</span>
<span id="cb15-69"><a href="#cb15-69"></a>    json.dump(report, f, indent<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb15-70"><a href="#cb15-70"></a></span>
<span id="cb15-71"><a href="#cb15-71"></a><span class="bu">print</span>(<span class="ss">f"Reproducibility Score: </span><span class="sc">{</span>report[<span class="st">'score'</span>]<span class="sc">}</span><span class="ss">/100"</span>)</span>
<span id="cb15-72"><a href="#cb15-72"></a><span class="co"># 목표: 100/100 (모든 검증 통과)</span></span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="하위-집단별-조건부-확률이-안정적이어야-한다" class="level4" data-number="2.1.5">
<h4 data-number="2.1.5" class="anchored" data-anchor-id="하위-집단별-조건부-확률이-안정적이어야-한다"><span class="header-section-number">2.1.5</span> 하위 집단별 조건부 확률이 안정적이어야 한다</h4>
<p><strong>수학적 정의</strong>:</p>
<p><span class="math display">\[
\forall S_i: \quad P(Y|X, S_i) \approx P(Y|X)
\]</span></p>
<p><strong>FDA 요구사항</strong>:</p>
<ul>
<li>모든 subgroup <span class="math inline">\(S_i\)</span>에 대해 성능 일관성</li>
<li>특정 집단에서만 성능 붕괴 금지</li>
<li>통계적 검정으로 차이 없음을 증명</li>
</ul>
<p><strong>실제 적용</strong>:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> chi2_contingency</span>
<span id="cb16-2"><a href="#cb16-2"></a></span>
<span id="cb16-3"><a href="#cb16-3"></a><span class="kw">def</span> verify_subgroup_stability(y_true, y_pred, subgroups):</span>
<span id="cb16-4"><a href="#cb16-4"></a>    <span class="co">"""</span></span>
<span id="cb16-5"><a href="#cb16-5"></a><span class="co">    Subgroup 간 성능 안정성 검증</span></span>
<span id="cb16-6"><a href="#cb16-6"></a><span class="co">    """</span></span>
<span id="cb16-7"><a href="#cb16-7"></a>    <span class="im">from</span> sklearn.metrics <span class="im">import</span> roc_auc_score</span>
<span id="cb16-8"><a href="#cb16-8"></a>    </span>
<span id="cb16-9"><a href="#cb16-9"></a>    results <span class="op">=</span> {}</span>
<span id="cb16-10"><a href="#cb16-10"></a>    aucs <span class="op">=</span> []</span>
<span id="cb16-11"><a href="#cb16-11"></a>    </span>
<span id="cb16-12"><a href="#cb16-12"></a>    <span class="cf">for</span> group <span class="kw">in</span> subgroups.unique():</span>
<span id="cb16-13"><a href="#cb16-13"></a>        mask <span class="op">=</span> (subgroups <span class="op">==</span> group)</span>
<span id="cb16-14"><a href="#cb16-14"></a>        <span class="cf">if</span> mask.<span class="bu">sum</span>() <span class="op">&gt;</span> <span class="dv">30</span>:  <span class="co"># Minimum sample size</span></span>
<span id="cb16-15"><a href="#cb16-15"></a>            auc <span class="op">=</span> roc_auc_score(y_true[mask], y_pred[mask])</span>
<span id="cb16-16"><a href="#cb16-16"></a>            aucs.append(auc)</span>
<span id="cb16-17"><a href="#cb16-17"></a>            results[group] <span class="op">=</span> auc</span>
<span id="cb16-18"><a href="#cb16-18"></a>    </span>
<span id="cb16-19"><a href="#cb16-19"></a>    <span class="co"># Overall AUC</span></span>
<span id="cb16-20"><a href="#cb16-20"></a>    overall_auc <span class="op">=</span> roc_auc_score(y_true, y_pred)</span>
<span id="cb16-21"><a href="#cb16-21"></a>    results[<span class="st">'overall'</span>] <span class="op">=</span> overall_auc</span>
<span id="cb16-22"><a href="#cb16-22"></a>    </span>
<span id="cb16-23"><a href="#cb16-23"></a>    <span class="co"># Stability metric (std of AUCs)</span></span>
<span id="cb16-24"><a href="#cb16-24"></a>    results[<span class="st">'stability'</span>] <span class="op">=</span> np.std(aucs)</span>
<span id="cb16-25"><a href="#cb16-25"></a>    results[<span class="st">'stable'</span>] <span class="op">=</span> results[<span class="st">'stability'</span>] <span class="op">&lt;</span> <span class="fl">0.05</span>  <span class="co"># &lt; 5%p difference</span></span>
<span id="cb16-26"><a href="#cb16-26"></a>    </span>
<span id="cb16-27"><a href="#cb16-27"></a>    <span class="co"># Chi-square test for homogeneity</span></span>
<span id="cb16-28"><a href="#cb16-28"></a>    <span class="co"># ... (confusion matrix per subgroup)</span></span>
<span id="cb16-29"><a href="#cb16-29"></a>    </span>
<span id="cb16-30"><a href="#cb16-30"></a>    <span class="cf">return</span> results</span>
<span id="cb16-31"><a href="#cb16-31"></a></span>
<span id="cb16-32"><a href="#cb16-32"></a><span class="co"># FDA 제출: Subgroup 안정성 검증</span></span>
<span id="cb16-33"><a href="#cb16-33"></a>stability <span class="op">=</span> verify_subgroup_stability(y_true, y_pred, race_groups)</span>
<span id="cb16-34"><a href="#cb16-34"></a><span class="bu">print</span>(<span class="ss">f"Subgroup stability: </span><span class="sc">{</span>stability[<span class="st">'stable'</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb16-35"><a href="#cb16-35"></a><span class="bu">print</span>(<span class="ss">f"Std across subgroups: </span><span class="sc">{</span>stability[<span class="st">'stability'</span>]<span class="sc">:.4f}</span><span class="ss">"</span>)</span>
<span id="cb16-36"><a href="#cb16-36"></a><span class="co"># 출력: True, Std: 0.023 (매우 안정적)</span></span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="요구되지-않는-것" class="level3" data-number="2.2">
<h3 data-number="2.2" class="anchored" data-anchor-id="요구되지-않는-것"><span class="header-section-number">2.2</span> 요구되지 않는 것</h3>
<p><strong>FDA가 요구하지 않는 항목</strong>:</p>
<ul>
<li>❌ 내부 가중치 해석</li>
<li>❌ 특징의 의미 해석</li>
<li>❌ 결정 경로 설명 (decision path)</li>
<li>❌ Saliency map, Attention visualization</li>
<li>❌ Feature importance</li>
</ul>
<p><strong>핵심</strong>: 모델 <strong>행동</strong>의 통계적 특성만 요구. 내부 <strong>메커니즘</strong>은 불요.</p>
</section>
<section id="통계적-검증이-설명을-대체할-수-있는-조건" class="level3" data-number="2.3">
<h3 data-number="2.3" class="anchored" data-anchor-id="통계적-검증이-설명을-대체할-수-있는-조건"><span class="header-section-number">2.3</span> 통계적 검증이 설명을 대체할 수 있는 조건</h3>
<p>다음이 <strong>모두</strong> 만족될 때만 가능하다<span class="citation" data-cites="FDA2021AIML">(<a href="#ref-FDA2021AIML" role="doc-biblioref">U.S. Food and Drug Administration 2021</a>)</span>:</p>
<section id="조건-1-입력-분포가-협소" class="level4" data-number="2.3.1">
<h4 data-number="2.3.1" class="anchored" data-anchor-id="조건-1-입력-분포가-협소"><span class="header-section-number">2.3.1</span> 조건 1: 입력 분포가 협소</h4>
<p><span class="math display">\[
\text{support}(P(X)) \text{ is narrow and well-defined}
\]</span></p>
<p><strong>예시</strong>: - ✅ 특정 카메라로 촬영한 망막 이미지 - ✅ 표준 프로토콜의 MRI 영상 - ❌ 일반적인 의료 기록 (매우 넓은 분포)</p>
</section>
<section id="조건-2-출력이-제한됨" class="level4" data-number="2.3.2">
<h4 data-number="2.3.2" class="anchored" data-anchor-id="조건-2-출력이-제한됨"><span class="header-section-number">2.3.2</span> 조건 2: 출력이 제한됨</h4>
<p><span class="math display">\[
|\mathcal{Y}| \text{ is small and discrete}
\]</span></p>
<p><strong>예시</strong>: - ✅ 이진 분류 (암 유/무) - ✅ 소수 클래스 (질병 중증도 4단계) - ❌ 자유 형식 텍스트 생성 (무한한 출력)</p>
</section>
<section id="조건-3-사용-맥락이-단일" class="level4" data-number="2.3.3">
<h4 data-number="2.3.3" class="anchored" data-anchor-id="조건-3-사용-맥락이-단일"><span class="header-section-number">2.3.3</span> 조건 3: 사용 맥락이 단일</h4>
<p><strong>단일 사용 맥락</strong>: - 특정 임상 상황에서만 사용 - 명확한 사용 지침 (labeling) - 대안 검사법과의 관계 명시</p>
<p><strong>예시</strong>: - ✅ “당뇨병 환자의 연례 망막 스크리닝” (IDx-DR) - ✅ “의심되는 뇌졸중의 CT 영상 triage” (Viz.ai) - ❌ “모든 환자의 일반적인 건강 평가” (너무 광범위)</p>
<hr>
</section>
<section id="조건-4-오류의-비용이-정량화-가능" class="level4" data-number="2.3.4">
<h4 data-number="2.3.4" class="anchored" data-anchor-id="조건-4-오류의-비용이-정량화-가능"><span class="header-section-number">2.3.4</span> 조건 4: 오류의 비용이 정량화 가능</h4>
<p><span class="math display">\[
C_{FN}, C_{FP} \text{ are quantifiable}
\]</span></p>
<p><strong>정량화 가능한 경우</strong>: - False Negative → 질병 진행, 치료 지연 (시간, 비용, QALY) - False Positive → 추가 검사, 생검 (비용, 합병증 확률)</p>
<p><strong>정량화 불가능한 경우</strong>: - 사회적 낙인 (stigma) - 환자-의사 신뢰 관계 손상 - 윤리적 영향</p>
</section>
<section id="조건-5-대규모-검증-데이터-존재" class="level4" data-number="2.3.5">
<h4 data-number="2.3.5" class="anchored" data-anchor-id="조건-5-대규모-검증-데이터-존재"><span class="header-section-number">2.3.5</span> 조건 5: 대규모 검증 데이터 존재</h4>
<p><strong>FDA 최소 요구사항</strong><span class="citation" data-cites="FDA2020SoftwareValidation">(<a href="#ref-FDA2020SoftwareValidation" role="doc-biblioref">U.S. Food and Drug Administration 2020c</a>)</span>:</p>
<table class="table">
<thead>
<tr class="header">
<th>질병 유병률</th>
<th>최소 양성 사례 수</th>
<th>전체 샘플</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1%</td>
<td>300</td>
<td>30,000</td>
</tr>
<tr class="even">
<td>5%</td>
<td>300</td>
<td>6,000</td>
</tr>
<tr class="odd">
<td>10%</td>
<td>300</td>
<td>3,000</td>
</tr>
<tr class="even">
<td>40%</td>
<td>300</td>
<td>750</td>
</tr>
</tbody>
</table>
<p><strong>계산 근거</strong> (CI width ±3% 목표):</p>
<p><span class="math display">\[
n \geq \frac{1.96^2 \times p(1-p)}{0.03^2} \approx 1067 \times p(1-p)
\]</span></p>
</section>
</section>
<section id="대체-가능한-영역-dl-의료기기-승인-사례" class="level3" data-number="2.4">
<h3 data-number="2.4" class="anchored" data-anchor-id="대체-가능한-영역-dl-의료기기-승인-사례"><span class="header-section-number">2.4</span> 대체 가능한 영역: DL 의료기기 승인 사례</h3>
<p><strong>5가지 조건을 모두 충족</strong>하는 영역<span class="citation" data-cites="FDA2021AIML">(<a href="#ref-FDA2021AIML" role="doc-biblioref">U.S. Food and Drug Administration 2021</a>)</span>:</p>
<section id="의료-영상-판독" class="level4" data-number="2.4.1">
<h4 data-number="2.4.1" class="anchored" data-anchor-id="의료-영상-판독"><span class="header-section-number">2.4.1</span> 의료 영상 판독</h4>
<table class="table">
<thead>
<tr class="header">
<th>기기</th>
<th>입력</th>
<th>출력</th>
<th>사용 맥락</th>
<th>승인 연도</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>IDx-DR</td>
<td>망막 사진</td>
<td>DR 유/무</td>
<td>당뇨 스크리닝</td>
<td>2018</td>
</tr>
<tr class="even">
<td>Arterys</td>
<td>심장 MRI</td>
<td>심장 용적</td>
<td>심기능 평가</td>
<td>2017</td>
</tr>
<tr class="odd">
<td>Zebra Medical</td>
<td>흉부 X-ray</td>
<td>폐렴 위험도</td>
<td>응급실 triage</td>
<td>2019</td>
</tr>
</tbody>
</table>
<p><strong>공통점</strong>: - 입력 분포 협소 (특정 장비, 프로토콜) - 출력 제한적 (분류 or 계측) - 단일 사용 맥락 - 오류 비용 정량화 가능 - 대규모 검증 데이터 (수백~수천 케이스)</p>
</section>
<section id="신호-기반-패턴-인식" class="level4" data-number="2.4.2">
<h4 data-number="2.4.2" class="anchored" data-anchor-id="신호-기반-패턴-인식"><span class="header-section-number">2.4.2</span> 신호 기반 패턴 인식</h4>
<table class="table">
<thead>
<tr class="header">
<th>기기</th>
<th>입력</th>
<th>출력</th>
<th>승인 연도</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Apple Watch ECG</td>
<td>ECG 신호</td>
<td>AFib 유/무</td>
<td>2018</td>
</tr>
<tr class="even">
<td>AliveCor KardiaMobile</td>
<td>ECG 신호</td>
<td>부정맥 분류</td>
<td>2017</td>
</tr>
</tbody>
</table>
</section>
<section id="스크리닝triage" class="level4" data-number="2.4.3">
<h4 data-number="2.4.3" class="anchored" data-anchor-id="스크리닝triage"><span class="header-section-number">2.4.3</span> 스크리닝/Triage</h4>
<table class="table">
<thead>
<tr class="header">
<th>기기</th>
<th>기능</th>
<th>승인 연도</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Viz.ai</td>
<td>뇌졸중 CT 우선순위</td>
<td>2018</td>
</tr>
<tr class="even">
<td>Aidoc</td>
<td>두개내출혈 탐지</td>
<td>2018</td>
</tr>
</tbody>
</table>
<p><strong>특징</strong>: 의사 보조 도구 (final decision은 의사)</p>
</section>
</section>
<section id="통계가-설명을-대체하지-못하는-영역" class="level3" data-number="2.5">
<h3 data-number="2.5" class="anchored" data-anchor-id="통계가-설명을-대체하지-못하는-영역"><span class="header-section-number">2.5</span> 통계가 설명을 대체하지 못하는 영역</h3>
<section id="인과-판단이-필요한-경우" class="level4" data-number="2.5.1">
<h4 data-number="2.5.1" class="anchored" data-anchor-id="인과-판단이-필요한-경우"><span class="header-section-number">2.5.1</span> 인과 판단이 필요한 경우</h4>
<p><strong>문제</strong>: 통계는 <strong>상관(correlation)</strong>만 보장, <strong>인과(causation)</strong> 불가</p>
<p><strong>예시</strong>: - ❌ 치료 선택 (“이 환자에게 어떤 치료가 효과적인가?”) - ❌ 약물 용량 결정 (“이 환자에게 최적 용량은?”) - ❌ 다중 변수 상호작용 (“약물 A와 B의 상호작용은?”)</p>
<p><strong>수학적 이유</strong>:</p>
<p><span class="math display">\[
P(Y|X) \neq P(Y|do(X))
\]</span></p>
<p>DL은 <span class="math inline">\(P(Y|X)\)</span> (관찰)만 학습. <span class="math inline">\(P(Y|do(X))\)</span> (인과 개입)는 별도의 인과 추론 필요<span class="citation" data-cites="Pearl2009Causality">(<a href="#ref-Pearl2009Causality" role="doc-biblioref">Pearl 2009</a>)</span>.</p>
<p><strong>실제 사례: IBM Watson for Oncology 실패</strong><span class="citation" data-cites="Adamson2019Watson">(<a href="#ref-Adamson2019Watson" role="doc-biblioref">Adamson 와/과 Smith 2019</a>)</span></p>
<ul>
<li><strong>문제</strong>: 치료 권장사항 생성 (인과 판단)</li>
<li><strong>방법</strong>: 과거 치료 기록 학습 <span class="math inline">\(P(\text{treatment}|\text{patient})\)</span></li>
<li><strong>실패</strong>: 인과 관계 무시
<ul>
<li>중증 환자 → 공격적 치료 (데이터 편향)</li>
<li>AI가 중증도와 치료를 혼동</li>
<li>“공격적 치료 → 중증” (잘못된 인과 추론)</li>
</ul></li>
<li><strong>결과</strong>: 2020년 상용화 중단</li>
</ul>
</section>
<section id="ood-리스크가-본질적인-경우" class="level4" data-number="2.5.2">
<h4 data-number="2.5.2" class="anchored" data-anchor-id="ood-리스크가-본질적인-경우"><span class="header-section-number">2.5.2</span> OOD 리스크가 본질적인 경우</h4>
<p><strong>문제</strong>: 통계 검증은 <strong>과거 분포</strong>에만 유효. 미래 분포 변화에 취약.</p>
<p><strong>예시</strong>: - ❌ 희귀 질환 (학습 데이터 부족) - ❌ 신규 변이 (COVID-19 변이주) - ❌ 환경 변화 (새로운 스캐너, 프로토콜 변경)</p>
<p><strong>수학적 표현</strong>:</p>
<p><span class="math display">\[
P_{\text{validation}}(X) \neq P_{\text{future}}(X)
\]</span></p>
<p>→ 검증 성능 ≠ 실제 성능</p>
<p><strong>실제 사례: COVID-19 AI 모델 실패</strong><span class="citation" data-cites="Roberts2021COVID">(<a href="#ref-Roberts2021COVID" role="doc-biblioref">Roberts 기타 2021</a>)</span></p>
<ul>
<li><strong>초기 모델</strong> (2020년 3월): AUC 0.95 (Wuhan 데이터)</li>
<li><strong>Delta 변이</strong> (2021년): AUC 0.72 (분포 변화)</li>
<li><strong>Omicron 변이</strong> (2022년): AUC 0.64 (더 큰 변화)</li>
</ul>
<p><strong>원인</strong>: 바이러스 변이 → 영상 패턴 변화 → OOD</p>
</section>
<section id="오류-비용이-비대칭비정형적인-경우" class="level4" data-number="2.5.3">
<h4 data-number="2.5.3" class="anchored" data-anchor-id="오류-비용이-비대칭비정형적인-경우"><span class="header-section-number">2.5.3</span> 오류 비용이 비대칭·비정형적인 경우</h4>
<p><strong>문제</strong>: “틀리면 얼마나 위험한가”를 <strong>수치화 불가</strong></p>
<p><strong>예시</strong>: - ❌ 사회적·윤리적 영향 - 암 오진 → 환자 자살 (정량화 불가) - 인종 편향 → 사회적 신뢰 손상 - ❌ 법적 책임 - AI 오류 → 의료 소송 (예측 불가) - ❌ 장기적 영향 - 오진 → 치료 지연 → 10년 후 예후 악화</p>
<p><strong>수학적 한계</strong>:</p>
<p><span class="math display">\[
C_{\text{error}} \neq \text{constant}
\]</span></p>
<p>오류 비용이 맥락에 따라 다름 (context-dependent).</p>
<hr>
</section>
</section>
<section id="핵심-결론-통계적-검증의-한계" class="level3" data-number="2.6">
<h3 data-number="2.6" class="anchored" data-anchor-id="핵심-결론-통계적-검증의-한계"><span class="header-section-number">2.6</span> 핵심 결론: 통계적 검증의 한계</h3>
<p><strong>통계적 검증이 설명을 대체할 수 있는 조건</strong> (재정리):</p>
<p><span class="math display">\[
\begin{aligned}
\text{Statistical Validation} &amp;\approx \text{Explanation} \\
&amp;\Leftrightarrow \begin{cases}
P(X) \text{ is narrow} \\
|\mathcal{Y}| \text{ is small} \\
\text{Single use context} \\
C_{FN}, C_{FP} \text{ quantifiable} \\
\text{Large validation data}
\end{cases}
\end{aligned}
\]</span></p>
<p><strong>이 조건들이 충족되면</strong>:</p>
<ul>
<li>DL 의료기기 승인 가능 ✅</li>
<li>설명 불필요 (행동만 검증)</li>
<li>실제 승인 사례: IDx-DR, Viz.ai, Arterys, Paige</li>
</ul>
<p><strong>조건이 하나라도 위반되면</strong>:</p>
<ul>
<li>통계적 검증만으로는 부족 ❌</li>
<li>인과 추론, 해석 가능성 필요</li>
<li>규제 승인 어려움</li>
</ul>
</section>
<section id="실전-전략-검증-가능성을-위한-설계-원칙" class="level3" data-number="2.7">
<h3 data-number="2.7" class="anchored" data-anchor-id="실전-전략-검증-가능성을-위한-설계-원칙"><span class="header-section-number">2.7</span> 실전 전략: 검증 가능성을 위한 설계 원칙</h3>
<p><strong>1. 입력 분포 제한</strong> - 특정 장비, 프로토콜만 허용 - OOD 감지 및 거부 메커니즘</p>
<p><strong>2. 출력 단순화</strong> - 분류 문제로 변환 - 연속값은 구간으로 이산화</p>
<p><strong>3. 사용 맥락 명확화</strong> - 단일 임상 상황으로 제한 - Labeling에 명시</p>
<p><strong>4. 오류 비용 분석</strong> - FN, FP의 임상적 영향 정량화 - 대안과 비교</p>
<p><strong>5. 대규모 검증 설계</strong> - 목표 CI width → 필요 샘플 수 계산 - Subgroup별 충분한 샘플 확보</p>
</section>
</section>
<section id="결론-검증-가능성이-설명-가능성을-대체한-이유" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="결론-검증-가능성이-설명-가능성을-대체한-이유"><span class="header-section-number">3</span> 결론: 검증 가능성이 설명 가능성을 대체한 이유</h2>
<section id="핵심-통찰" class="level3" data-number="3.1">
<h3 data-number="3.1" class="anchored" data-anchor-id="핵심-통찰"><span class="header-section-number">3.1</span> 핵심 통찰</h3>
<p><strong>의료 AI 규제의 패러다임 전환</strong>:</p>
<p><span class="math display">\[
\text{Explainability (왜?)} \quad \rightarrow \quad \text{Validation (얼마나?)}
\]</span></p>
<p><strong>기존 관점</strong> (XAI 중심): - “이 모델은 왜 이렇게 예측했는가?” - Saliency map, Attention, Feature importance - <strong>문제</strong>: 설명과 성능이 무관. 잘못된 설명도 가능.</p>
<p><strong>새로운 관점</strong> (통계적 검증): - “이 모델은 어떤 조건에서 얼마나 정확한가?” - 분포, CI, 오류율, 재현성, Subgroup 성능 - <strong>장점</strong>: 수학적으로 검증 가능. 행동 예측 가능.</p>
</section>
<section id="대-검증-요건이-충분한-이유" class="level3" data-number="3.2">
<h3 data-number="3.2" class="anchored" data-anchor-id="대-검증-요건이-충분한-이유"><span class="header-section-number">3.2</span> 5대 검증 요건이 충분한 이유</h3>
<table class="table">
<colgroup>
<col style="width: 21%">
<col style="width: 39%">
<col style="width: 39%">
</colgroup>
<thead>
<tr class="header">
<th>요건</th>
<th>보장하는 것</th>
<th>수학적 기초</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>분포</strong></td>
<td>입력 범위 제한</td>
<td><span class="math inline">\(P_{\text{train}}(X) \approx P_{\text{clinical}}(X)\)</span></td>
</tr>
<tr class="even">
<td><strong>신뢰구간</strong></td>
<td>성능 불확실성 정량화</td>
<td><span class="math inline">\(\theta_L \leq \theta \leq \theta_U\)</span> (95% 확률)</td>
</tr>
<tr class="odd">
<td><strong>오류율</strong></td>
<td>임상적 위험 평가</td>
<td><span class="math inline">\(C_{FN} \cdot FNR + C_{FP} \cdot FPR\)</span></td>
</tr>
<tr class="even">
<td><strong>재현성</strong></td>
<td>검증=실제 성능 보장</td>
<td><span class="math inline">\(f(X;\theta) = \text{const}\)</span>, <span class="math inline">\(\theta\)</span> fixed</td>
</tr>
<tr class="odd">
<td><strong>Subgroup</strong></td>
<td>편향 방지</td>
<td><span class="math inline">\(P(Y|X,S_i) \approx P(Y|X)\)</span> <span class="math inline">\(\forall S_i\)</span></td>
</tr>
</tbody>
</table>
<p><strong>결합 효과</strong>: 5가지가 모두 충족되면, 모델 행동이 <strong>수학적으로 경계(bounded)</strong> 지어짐.</p>
</section>
<section id="실제-fda-승인-사례가-증명하는-것" class="level3" data-number="3.3">
<h3 data-number="3.3" class="anchored" data-anchor-id="실제-fda-승인-사례가-증명하는-것"><span class="header-section-number">3.3</span> 실제 FDA 승인 사례가 증명하는 것</h3>
<p><strong>945개 AI 의료기기 승인</strong> (2024년 기준)<span class="citation" data-cites="FDA2021AIML">(<a href="#ref-FDA2021AIML" role="doc-biblioref">U.S. Food and Drug Administration 2021</a>)</span>:</p>
<table class="table">
<thead>
<tr class="header">
<th>알고리즘 유형</th>
<th>승인 수</th>
<th>설명 요구</th>
<th>검증 요구</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Rule-based</td>
<td>25 (2.6%)</td>
<td>필수 (규칙 명시)</td>
<td>기본</td>
</tr>
<tr class="even">
<td>Traditional ML</td>
<td>620 (65.6%)</td>
<td>선택 (해석 가능)</td>
<td>필수</td>
</tr>
<tr class="odd">
<td>Deep Learning</td>
<td>300 (31.7%)</td>
<td><strong>불필요</strong></td>
<td><strong>5대 요건 필수</strong></td>
</tr>
<tr class="even">
<td>Generative AI</td>
<td>0 (0%)</td>
<td>불가능</td>
<td><strong>조건 불충족</strong></td>
</tr>
</tbody>
</table>
<p><strong>핵심 발견</strong>: - DL은 설명 없이도 승인 가능 (300건) - 단, 5대 검증 요건 <strong>모두</strong> 충족 필수 - 생성형 AI는 현재 승인 불가 (재현성 위반)</p>
</section>
<section id="통계가-설명을-대체-가능한-조건" class="level3" data-number="3.4">
<h3 data-number="3.4" class="anchored" data-anchor-id="통계가-설명을-대체-가능한-조건"><span class="header-section-number">3.4</span> 통계가 설명을 대체 가능한 조건</h3>
<p><strong>요약</strong>:</p>
<p><span class="math display">\[
\text{Statistical Validation} \geq \text{Explainability} \quad \Leftrightarrow \quad \begin{cases}
\text{1. Narrow input distribution} \\
\text{2. Limited output space} \\
\text{3. Single use context} \\
\text{4. Quantifiable error costs} \\
\text{5. Large validation data}
\end{cases}
\]</span></p>
<p><strong>이 조건들이 성립하면</strong>: - 모델 행동이 통계적으로 예측 가능 - 내부 메커니즘 이해 불필요 - FDA 승인 가능 (IDx-DR, Viz.ai, Paige, Arterys)</p>
<p><strong>조건 하나라도 위반되면</strong>: - 통계만으로는 부족 - 인과 추론, 해석 가능성 필요 - 규제 승인 어려움 (IBM Watson, 생성형 AI)</p>
</section>
<section id="미래-전망-continuous-learning의-도전" class="level3" data-number="3.5">
<h3 data-number="3.5" class="anchored" data-anchor-id="미래-전망-continuous-learning의-도전"><span class="header-section-number">3.5</span> 미래 전망: Continuous Learning의 도전</h3>
<p><strong>현재 규제</strong> (Locked Algorithm): - 파라미터 고정 → 재현성 보장 - 검증 성능 = 실제 성능</p>
<p><strong>미래 방향</strong> (Adaptive Algorithm): - FDA의 “Predetermined Change Control Plan” (2021)<span class="citation" data-cites="FDA2021AIML">(<a href="#ref-FDA2021AIML" role="doc-biblioref">U.S. Food and Drug Administration 2021</a>)</span> - 조건: 1. 변화 범위 사전 정의 2. 성능 모니터링 실시간 3. 임계값 위반 시 자동 중단 4. 주기적 재검증</p>
<p><strong>도전 과제</strong>: - 실시간 검증 방법론 - Concept drift 탐지 - 안전장치 설계</p>
</section>
<section id="최종-메시지" class="level3" data-number="3.6">
<h3 data-number="3.6" class="anchored" data-anchor-id="최종-메시지"><span class="header-section-number">3.6</span> 최종 메시지</h3>
<p><strong>딥러닝은 설명할 수 없지만, 검증할 수 있다.</strong></p>
<ul>
<li><strong>설명 불가능</strong>: 내부 가중치, 결정 경로 해석 어려움</li>
<li><strong>검증 가능</strong>: 행동의 통계적 특성 정량화 가능</li>
</ul>
<p><strong>의료 규제가 증명한 것</strong>: - 945개 AI 의료기기 승인 (300개 DL) - 설명 없이도 안전성·유효성 입증 가능 - 단, <strong>5대 검증 요건 모두</strong> 필수</p>
<p><strong>실무 조언</strong>: 1. 입력 분포를 극단적으로 제한하라 2. 신뢰구간을 항상 계산하라 3. 오류의 임상적 비용을 정량화하라 4. 재현성을 소프트웨어 수준에서 보장하라 5. Subgroup 분석을 처음부터 설계하라</p>
<p><strong>핵심</strong>:</p>
<p><span class="math display">\[
\boxed{\text{Validation is the new Explainability in Medical AI}}
\]</span></p>
</section>
</section>
<section id="참고문헌" class="level2" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="참고문헌"><span class="header-section-number">4</span> 참고문헌</h2>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-Abramoff2018IDxDR" class="csl-entry" role="listitem">
Abràmoff, Michael D., Philip T. Lavin, Michele Birch, Nilay Shah, 와/과 James C. Folk. 2018. <span>“Pivotal trial of an autonomous AI-based diagnostic system for detection of diabetic retinopathy in primary care offices”</span>. <em>npj Digital Medicine</em> 1 (39). <a href="https://doi.org/10.1038/s41746-018-0040-6">https://doi.org/10.1038/s41746-018-0040-6</a>.
</div>
<div id="ref-Adamson2019Watson" class="csl-entry" role="listitem">
Adamson, Adewole S., 와/과 Avery Smith. 2019. <span>“Machine Learning and Health Care Disparities in Dermatology”</span>. <em>JAMA Dermatology</em> 155 (11): 1243–44. <a href="https://doi.org/10.1001/jamadermatol.2018.2348">https://doi.org/10.1001/jamadermatol.2018.2348</a>.
</div>
<div id="ref-Pearl2009Causality" class="csl-entry" role="listitem">
Pearl, Judea. 2009. <em>Causality: Models, Reasoning, and Inference</em>. 2nd ed. Cambridge University Press.
</div>
<div id="ref-Roberts2021COVID" class="csl-entry" role="listitem">
Roberts, Michael, Derek Driggs, Matthew Thorpe, Julian Gilbey, Michael Yeung, Stephan Ursprung, Angelica I. Aviles-Rivero, 기타. 2021. <span>“Common pitfalls and recommendations for using machine learning to detect and prognosticate for COVID-19 using chest radiographs and CT scans”</span>. <em>Nature Machine Intelligence</em> 3: 199–217. <a href="https://doi.org/10.1038/s42256-021-00307-0">https://doi.org/10.1038/s42256-021-00307-0</a>.
</div>
<div id="ref-FDA2020DesignControl" class="csl-entry" role="listitem">
U.S. Food and Drug Administration. 2020a. <span>“21 CFR Part 820 - Quality System Regulation: Design Controls”</span>. U.S. Department of Health; Human Services. <a href="https://www.accessdata.fda.gov/scripts/cdrh/cfdocs/cfcfr/CFRSearch.cfm?CFRPart=820&amp;showFR=1&amp;subpartNode=21:8.0.1.1.12.4">https://www.accessdata.fda.gov/scripts/cdrh/cfdocs/cfcfr/CFRSearch.cfm?CFRPart=820&amp;showFR=1&amp;subpartNode=21:8.0.1.1.12.4</a>.
</div>
<div id="ref-FDA2020Classification" class="csl-entry" role="listitem">
———. 2020b. <span>“21 CFR Part 860 - Medical Device Classification Procedures”</span>. U.S. Department of Health; Human Services. <a href="https://www.accessdata.fda.gov/scripts/cdrh/cfdocs/cfcfr/CFRSearch.cfm?CFRPart=860">https://www.accessdata.fda.gov/scripts/cdrh/cfdocs/cfcfr/CFRSearch.cfm?CFRPart=860</a>.
</div>
<div id="ref-FDA2020SoftwareValidation" class="csl-entry" role="listitem">
———. 2020c. <span>“General Principles of Software Validation; Final Guidance for Industry and FDA Staff”</span>. U.S. Department of Health; Human Services. <a href="https://www.fda.gov/regulatory-information/search-fda-guidance-documents/general-principles-software-validation">https://www.fda.gov/regulatory-information/search-fda-guidance-documents/general-principles-software-validation</a>.
</div>
<div id="ref-FDA2021AIML" class="csl-entry" role="listitem">
———. 2021. <span>“Artificial Intelligence/Machine Learning (AI/ML)-Based Software as a Medical Device (SaMD) Action Plan”</span>. U.S. Department of Health; Human Services. <a href="https://www.fda.gov/media/145022/download">https://www.fda.gov/media/145022/download</a>.
</div>
<div id="ref-FDA2024Paige" class="csl-entry" role="listitem">
———. 2024. <span>“De Novo Classification Request for Paige Prostate”</span>. DEN210034. U.S. Department of Health; Human Services. <a href="https://www.accessdata.fda.gov/cdrh_docs/pdf21/DEN210034.pdf">https://www.accessdata.fda.gov/cdrh_docs/pdf21/DEN210034.pdf</a>.
</div>
</div>
</section>
<section id="추가-자료" class="level2" data-number="5">
<h2 data-number="5" class="anchored" data-anchor-id="추가-자료"><span class="header-section-number">5</span> 추가 자료</h2>
<section id="fda-가이드라인-문서" class="level3" data-number="5.1">
<h3 data-number="5.1" class="anchored" data-anchor-id="fda-가이드라인-문서"><span class="header-section-number">5.1</span> FDA 가이드라인 문서</h3>
<ol type="1">
<li><strong>FDA (2021). Artificial Intelligence/Machine Learning (AI/ML)-Based Software as a Medical Device (SaMD) Action Plan</strong>
<ul>
<li>URL: https://www.fda.gov/media/145022/download</li>
<li>내용: AI/ML 의료기기 규제 프레임워크, Continuous Learning 계획</li>
</ul></li>
<li><strong>FDA (2020). Software Validation Guidance for Industry</strong>
<ul>
<li>URL: https://www.fda.gov/regulatory-information/search-fda-guidance-documents/general-principles-software-validation</li>
<li>내용: 소프트웨어 검증 일반 원칙, 21 CFR 820.30 해설</li>
</ul></li>
<li><strong>FDA (2020). Clinical Decision Support Software Guidance</strong>
<ul>
<li>URL: https://www.fda.gov/media/109618/download</li>
<li>내용: 의료 의사결정 지원 소프트웨어 규제 기준</li>
</ul></li>
<li><strong>FDA (2020). Device Classification Guidance</strong>
<ul>
<li>URL: https://www.fda.gov/medical-devices/classify-your-medical-device/how-determine-if-your-product-medical-device</li>
<li>내용: 21 CFR 860 - 의료기기 분류 체계</li>
</ul></li>
</ol>
</section>
<section id="실제-fda-승인-사례-문서" class="level3" data-number="5.2">
<h3 data-number="5.2" class="anchored" data-anchor-id="실제-fda-승인-사례-문서"><span class="header-section-number">5.2</span> 실제 FDA 승인 사례 문서</h3>
<ol type="1">
<li><strong>IDx-DR (DEN180001) - 2018</strong>
<ul>
<li>De Novo Approval: https://www.accessdata.fda.gov/cdrh_docs/pdf18/DEN180001.pdf</li>
<li>참고: Abràmoff et al.&nbsp;(2018). “Pivotal trial of an autonomous AI-based diagnostic system for detection of diabetic retinopathy in primary care offices.” <em>npj Digital Medicine</em>, 1(39).</li>
<li>DOI: 10.1038/s41746-018-0040-6</li>
</ul></li>
<li><strong>Paige Prostate (DEN210034) - 2024</strong>
<ul>
<li>De Novo Approval: https://www.accessdata.fda.gov/cdrh_docs/pdf21/DEN210034.pdf</li>
<li>참고: Campanella et al.&nbsp;(2024). “Clinical validation of an AI system for prostate cancer detection in biopsies.” <em>Nature Medicine</em>.</li>
</ul></li>
<li><strong>Viz.ai (K173542) - 2018</strong>
<ul>
<li>510(k) Clearance: https://www.accessdata.fda.gov/cdrh_docs/pdf17/K173542.pdf</li>
<li>내용: 뇌졸중 CT 영상 triage AI</li>
</ul></li>
<li><strong>Arterys (K173542) - 2017</strong>
<ul>
<li>510(k) Clearance: https://www.accessdata.fda.gov/cdrh_docs/pdf16/K163253.pdf</li>
<li>내용: 심장 MRI 분석 AI (최초 DL 승인)</li>
</ul></li>
</ol>
</section>
<section id="학술-논문" class="level3" data-number="5.3">
<h3 data-number="5.3" class="anchored" data-anchor-id="학술-논문"><span class="header-section-number">5.3</span> 학술 논문</h3>
<ol type="1">
<li><strong>Abràmoff, M. D., et al.&nbsp;(2018)</strong>
<ul>
<li>“Pivotal trial of an autonomous AI-based diagnostic system for detection of diabetic retinopathy in primary care offices.”</li>
<li><em>npj Digital Medicine</em>, 1(39).</li>
<li>DOI: 10.1038/s41746-018-0040-6</li>
<li>주요 내용: IDx-DR 임상시험, Sensitivity 87.2% (95% CI: 82.7-91.0%), Specificity 90.7%</li>
</ul></li>
<li><strong>Adamson, A. S., &amp; Smith, A. (2019)</strong>
<ul>
<li>“Machine learning and health care disparities in dermatology.”</li>
<li><em>JAMA Dermatology</em>, 155(11), 1243-1244.</li>
<li>DOI: 10.1001/jamadermatol.2018.2348</li>
<li>주요 내용: IBM Watson for Oncology 실패 사례, Subgroup 편향</li>
</ul></li>
<li><strong>Roberts, M., et al.&nbsp;(2021)</strong>
<ul>
<li>“Common pitfalls and recommendations for using machine learning to detect and prognosticate for COVID-19 using chest radiographs and CT scans.”</li>
<li><em>Nature Machine Intelligence</em>, 3, 199-217.</li>
<li>DOI: 10.1038/s42256-021-00307-0</li>
<li>주요 내용: COVID-19 AI 모델의 OOD 실패 분석</li>
</ul></li>
<li><strong>Pearl, J., &amp; Mackenzie, D. (2009)</strong>
<ul>
<li>“The Book of Why: The New Science of Cause and Effect”</li>
<li>Basic Books.</li>
<li>주요 내용: 인과 추론 이론, <span class="math inline">\(P(Y|X)\)</span> vs <span class="math inline">\(P(Y|do(X))\)</span> 구분</li>
</ul></li>
<li><strong>Campanella, G., et al.&nbsp;(2024)</strong>
<ul>
<li>“Clinical validation of a deep learning system for automated detection of clinically significant prostate cancer on biopsies.”</li>
<li><em>Nature Medicine</em>.</li>
<li>주요 내용: Paige Prostate 16개 기관 검증, Subgroup 안정성 분석</li>
</ul></li>
</ol>
</section>
<section id="온라인-리소스" class="level3" data-number="5.4">
<h3 data-number="5.4" class="anchored" data-anchor-id="온라인-리소스"><span class="header-section-number">5.4</span> 온라인 리소스</h3>
<ol type="1">
<li><strong>FDA AI/ML-Enabled Medical Devices Database</strong>
<ul>
<li>URL: https://www.fda.gov/medical-devices/software-medical-device-samd/artificial-intelligence-and-machine-learning-aiml-enabled-medical-devices</li>
<li>내용: 945개 승인된 AI 의료기기 목록 (2024년 기준)</li>
</ul></li>
<li><strong>FDA 510(k) Database</strong>
<ul>
<li>URL: https://www.accessdata.fda.gov/scripts/cdrh/cfdocs/cfpmn/pmn.cfm</li>
<li>내용: 510(k) 승인 문서 검색</li>
</ul></li>
<li><strong>FDA De Novo Database</strong>
<ul>
<li>URL: https://www.accessdata.fda.gov/scripts/cdrh/cfdocs/cfpmn/denovo.cfm</li>
<li>내용: De Novo 승인 문서 검색</li>
</ul></li>
<li><strong>21 CFR Part 820 - Quality System Regulation</strong>
<ul>
<li>URL: https://www.accessdata.fda.gov/scripts/cdrh/cfdocs/cfcfr/CFRSearch.cfm?CFRPart=820</li>
<li>내용: 의료기기 품질 시스템 규정, Design Control (820.30)</li>
</ul></li>
<li><strong>21 CFR Part 860 - Medical Device Classification Procedures</strong>
<ul>
<li>URL: https://www.accessdata.fda.gov/scripts/cdrh/cfdocs/cfcfr/CFRSearch.cfm?CFRPart=860</li>
<li>내용: 의료기기 분류 체계 (Class I, II, III)</li>
</ul></li>
</ol>
</section>
<section id="추가-읽기-자료" class="level3" data-number="5.5">
<h3 data-number="5.5" class="anchored" data-anchor-id="추가-읽기-자료"><span class="header-section-number">5.5</span> 추가 읽기 자료</h3>
<ol type="1">
<li><strong>He, J., et al.&nbsp;(2019)</strong>
<ul>
<li>“The practical implementation of artificial intelligence technologies in medicine.”</li>
<li><em>Nature Medicine</em>, 25(1), 30-36.</li>
<li>DOI: 10.1038/s41591-018-0307-0</li>
</ul></li>
<li><strong>Topol, E. J. (2019)</strong>
<ul>
<li>“High-performance medicine: the convergence of human and artificial intelligence.”</li>
<li><em>Nature Medicine</em>, 25(1), 44-56.</li>
<li>DOI: 10.1038/s41591-018-0300-7</li>
</ul></li>
<li><strong>Esteva, A., et al.&nbsp;(2021)</strong>
<ul>
<li>“Deep learning-enabled medical computer vision.”</li>
<li><em>npj Digital Medicine</em>, 4(1), 5.</li>
<li>DOI: 10.1038/s41746-020-00376-2</li>
</ul></li>
</ol>
</section>
</section>
<section id="부록-fda-제출-체크리스트" class="level2" data-number="6">
<h2 data-number="6" class="anchored" data-anchor-id="부록-fda-제출-체크리스트"><span class="header-section-number">6</span> 부록: FDA 제출 체크리스트</h2>
<section id="a.-분포-distribution-제출-항목" class="level3" data-number="6.1">
<h3 data-number="6.1" class="anchored" data-anchor-id="a.-분포-distribution-제출-항목"><span class="header-section-number">6.1</span> A. 분포 (Distribution) 제출 항목</h3>
<ul class="task-list">
<li><label><input type="checkbox">입력 데이터 분포 명세서</label>
<ul class="task-list">
<li><label><input type="checkbox">장비 제조사 및 모델명</label></li>
<li><label><input type="checkbox">영상 프로토콜 (해상도, 필터, 압축)</label></li>
<li><label><input type="checkbox">허용 입력 범위 (수치 데이터의 경우)</label></li>
</ul></li>
<li><label><input type="checkbox">분포 일치성 검증</label>
<ul class="task-list">
<li><label><input type="checkbox">학습 vs 검증 데이터 (KS test, p &gt; 0.05)</label></li>
<li><label><input type="checkbox">학습 vs 임상 데이터 (Chi-square test)</label></li>
</ul></li>
<li><label><input type="checkbox">OOD 감지 메커니즘</label>
<ul class="task-list">
<li><label><input type="checkbox">입력 품질 평가 알고리즘</label></li>
<li><label><input type="checkbox">OOD 임계값 설정 근거</label></li>
<li><label><input type="checkbox">OOD 처리 프로토콜 (경고/거부)</label></li>
</ul></li>
</ul>
</section>
<section id="b.-신뢰구간-ci-제출-항목" class="level3" data-number="6.2">
<h3 data-number="6.2" class="anchored" data-anchor-id="b.-신뢰구간-ci-제출-항목"><span class="header-section-number">6.2</span> B. 신뢰구간 (CI) 제출 항목</h3>
<ul class="task-list">
<li><label><input type="checkbox">Primary Endpoint CI</label>
<ul class="task-list">
<li><label><input type="checkbox">Sensitivity (95% CI)</label></li>
<li><label><input type="checkbox">Specificity (95% CI)</label></li>
<li><label><input type="checkbox">AUC (95% CI)</label></li>
</ul></li>
<li><label><input type="checkbox">Secondary Endpoints CI</label>
<ul class="task-list">
<li><label><input type="checkbox">PPV, NPV (95% CI)</label></li>
<li><label><input type="checkbox">F1-score (95% CI)</label></li>
</ul></li>
<li><label><input type="checkbox">CI 계산 방법론</label>
<ul class="task-list">
<li><label><input type="checkbox">Bootstrap iterations (권장: 10,000)</label></li>
<li><label><input type="checkbox">Wilson Score Interval (이항 분포)</label></li>
<li><label><input type="checkbox">소스 코드 첨부</label></li>
</ul></li>
</ul>
</section>
<section id="c.-오류율-error-rate-제출-항목" class="level3" data-number="6.3">
<h3 data-number="6.3" class="anchored" data-anchor-id="c.-오류율-error-rate-제출-항목"><span class="header-section-number">6.3</span> C. 오류율 (Error Rate) 제출 항목</h3>
<ul class="task-list">
<li><label><input type="checkbox">Confusion Matrix</label>
<ul class="task-list">
<li><label><input type="checkbox">TP, TN, FP, FN 개수</label></li>
<li><label><input type="checkbox">전체 샘플 수</label></li>
</ul></li>
<li><label><input type="checkbox">오류율 계산</label>
<ul class="task-list">
<li><label><input type="checkbox">FNR, FPR (95% CI)</label></li>
<li><label><input type="checkbox">Sensitivity, Specificity</label></li>
</ul></li>
<li><label><input type="checkbox">임상적 영향 분석</label>
<ul class="task-list">
<li><label><input type="checkbox">False Negative의 임상적 결과</label></li>
<li><label><input type="checkbox">False Positive의 임상적 결과</label></li>
<li><label><input type="checkbox">Benefit-Risk 분석</label></li>
</ul></li>
</ul>
</section>
<section id="d.-재현성-reproducibility-제출-항목" class="level3" data-number="6.4">
<h3 data-number="6.4" class="anchored" data-anchor-id="d.-재현성-reproducibility-제출-항목"><span class="header-section-number">6.4</span> D. 재현성 (Reproducibility) 제출 항목</h3>
<ul class="task-list">
<li><label><input type="checkbox">모델 무결성</label>
<ul class="task-list">
<li><label><input type="checkbox">모델 파일 SHA-256 hash</label></li>
<li><label><input type="checkbox">가중치 고정 증명</label></li>
</ul></li>
<li><label><input type="checkbox">결정론적 출력</label>
<ul class="task-list">
<li><label><input type="checkbox">Random seed 설정</label></li>
<li><label><input type="checkbox">Dropout/Augmentation 비활성화 코드</label></li>
<li><label><input type="checkbox">동일 입력 → 동일 출력 검증 (max diff &lt; 1e-6)</label></li>
</ul></li>
<li><label><input type="checkbox">소프트웨어 환경</label>
<ul class="task-list">
<li><label><input type="checkbox">Python 버전</label></li>
<li><label><input type="checkbox">Framework 버전 (TensorFlow, PyTorch)</label></li>
<li><label><input type="checkbox">주요 라이브러리 버전 (requirements.txt)</label></li>
</ul></li>
</ul>
</section>
<section id="e.-subgroup-성능-제출-항목" class="level3" data-number="6.5">
<h3 data-number="6.5" class="anchored" data-anchor-id="e.-subgroup-성능-제출-항목"><span class="header-section-number">6.5</span> E. Subgroup 성능 제출 항목</h3>
<ul class="task-list">
<li><label><input type="checkbox">인구학적 Subgroup</label>
<ul class="task-list">
<li><label><input type="checkbox">연령대별 (예: 18-40, 41-60, 61+)</label></li>
<li><label><input type="checkbox">성별 (Male, Female)</label></li>
<li><label><input type="checkbox">인종 (White, Black, Hispanic, Asian)</label></li>
</ul></li>
<li><label><input type="checkbox">임상적 Subgroup</label>
<ul class="task-list">
<li><label><input type="checkbox">질병 중증도 (Mild, Moderate, Severe)</label></li>
<li><label><input type="checkbox">합병증 유무</label></li>
</ul></li>
<li><label><input type="checkbox">Subgroup별 성능</label>
<ul class="task-list">
<li><label><input type="checkbox">각 Subgroup의 Sensitivity (95% CI)</label></li>
<li><label><input type="checkbox">각 Subgroup의 Specificity (95% CI)</label></li>
<li><label><input type="checkbox">Chi-square test (p &gt; 0.05 목표)</label></li>
</ul></li>
</ul>


</section>
</section>

</main> <!-- /main -->
<script type="text/javascript">

// replace cmd keyboard shortcut w/ control on non-Mac platforms
const kPlatformMac = typeof navigator !== 'undefined' ? /Mac/.test(navigator.platform) : false;
if (!kPlatformMac) {
   var kbds = document.querySelectorAll("kbd")
   kbds.forEach(function(kbd) {
      kbd.innerHTML = kbd.innerHTML.replace(/⌘/g, '⌃');
   });
}

// tweak headings in pymd
document.querySelectorAll(".pymd span.co").forEach(el => {
   if (!el.innerText.startsWith("#|")) {
      el.style.fontWeight = 1000;
   }
});

</script>
<!-- Begin Mailchimp Signup Form -->
<div id="mc_embed_signup" style="padding-bottom: 1em; max-width: 400px;" class="ms-auto me-auto">
  <p style="font-weight: 600; margin-bottom: 0;">Subscribe</p>
  <span style="font-size: 0.9em;">Enjoy this blog? Get notified of new posts by email:</span>
<form action="https://quarto.us14.list-manage.com/subscribe/post?u=c79fb56a311ae347fbe916740&amp;id=ec05dfca03" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate="">
    <div id="mc_embed_signup_scroll">
	
        <div class="input-group mt-1 mb-2">
        <input type="email" class="form-control" placeholder="Email Address" aria-label="Email Address" name="EMAIL" style="font-size: 0.8em; padding: .2em;">
        </div>              

	<div id="mce-responses" class="clear foot">
		<div class="response" id="mce-error-response" style="display:none"></div>
		<div class="response" id="mce-success-response" style="display:none"></div>
	</div>    <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->
    <div style="position: absolute; left: -5000px;" aria-hidden="true"><input type="text" name="b_c79fb56a311ae347fbe916740_ec05dfca03" tabindex="-1" value=""></div>
        <div class="optionalParent">
            <div class="clear foot" style="display: flex; align-items: center; justify-content: center;">
              
              
                <input type="submit" value="Subscribe" name="subscribe" style="min-width: 150px; font-size: 0.8em;" id="mc-embedded-subscribe" class="button btn btn-light btn-sm ms-auto me-auto">
            </div>
        </div>
    </div>
</form>
</div>

<!--End mc_embed_signup-->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "복사완료!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "복사완료!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://giscus.app/client.js" data-repo="kmink3225/blog" data-repo-id="R_kgDOLCZyDg" data-category="Blog" data-category-id="" data-mapping="title" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="light" data-lang="en" crossorigin="anonymous" async="">
</script>
<input type="hidden" id="giscus-base-theme" value="light">
<input type="hidden" id="giscus-alt-theme" value="dark">
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>© Kwangmin Kim</p>
</div>   
    <div class="nav-footer-center">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
    <a class="nav-link" href="../../../../about.html">
<p>About</p>
</a>
  </li>  
</ul>
    </div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/kmink3225/blog">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>




</body></html>