<?xml version="1.0" encoding="UTF-8"?>
<rss  xmlns:atom="http://www.w3.org/2005/Atom" 
      xmlns:media="http://search.yahoo.com/mrss/" 
      xmlns:content="http://purl.org/rss/1.0/modules/content/" 
      xmlns:dc="http://purl.org/dc/elements/1.1/" 
      version="2.0">
<channel>
<title>Kwangmin Kim</title>
<link>kk3225.netlify.app/docs/blog/</link>
<atom:link href="kk3225.netlify.app/docs/blog/index.xml" rel="self" type="application/rss+xml"/>
<description>blog</description>
<generator>quarto-1.4.543</generator>
<lastBuildDate>Tue, 31 Dec 2109 15:00:00 GMT</lastBuildDate>
<item>
  <title>Data Governance</title>
  <dc:creator>Kwangmin Kim</dc:creator>
  <link>kk3225.netlify.app/docs/blog/posts/Governance/</link>
  <description><![CDATA[ 





<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="kk3225.netlify.app/images/governance/data_governance.png" class="img-fluid figure-img" style="width:50.0%"></p>
<figcaption>Governance</figcaption>
</figure>
</div>
<section id="data-governance" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Data Governance</h1>
<section id="data-governance-basic-concept" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="data-governance-basic-concept"><span class="header-section-number">1.1</span> Data Governance Basic Concept</h2>
<ul>
<li>2024-08-01, <a href="../../../../docs/blog/posts/Governance/1.basis.html">Data Governance Basic Concepts, 거버넌스 기본 개념</a></li>
<li>2024-08-02, <a href="../../../../docs/blog/posts/Governance/2.task_process.html">Task Process, 업무 절차</a></li>
<li>2024-08-03, <a href="../../../../docs/blog/posts/Governance/3.architetucre.html">Data Architecture, 구조관리</a></li>
<li>0000-00-00, [Data Pipeline Design, 파이프라인 설계]</li>
<li>0000-00-00, [Data Storage, 저장소 관리]</li>
<li>0000-00-00, [Data Management Policy, 데이터 관리 정책]</li>
<li>0000-00-00, [Data Stewardship Model, 데이터 관리 모델]</li>
</ul>
</section>
<section id="data-modeling" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="data-modeling"><span class="header-section-number">1.2</span> Data Modeling</h2>
<ul>
<li>2024-08-04, <a href="../../../../docs/blog/posts/Governance/4-0.data_model.html">Data Model (1) - Basic Concept</a></li>
<li>2024-08-05, <a href="../../../../docs/blog/posts/Governance/4-1.data_model_database.html">Data Model (2) - Database Basis</a></li>
<li>2024-08-06, <a href="../../../../docs/blog/posts/Governance/4-2.data_model_sql.html">Data Model (3) - SQL Concept</a></li>
<li>2024-08-07, <a href="../../../../docs/blog/posts/Governance/4-3.data_model_schema.html">Data Model (4) - DB Design</a></li>
<li>2024-08-08, <a href="../../../../docs/blog/posts/Governance/4-4.data_model_requirements.html">Data Model (5) - Requirement Collection</a></li>
<li>2024-08-09, <a href="../../../../docs/blog/posts/Governance/4-5-0.data_model_conceptual.html">Data Model (6) - Conceptual Design</a></li>
<li>2024-08-10, <a href="../../../../docs/blog/posts/Governance/4-5-1.data_model_conceptual_ER_model.html">Data Model (7) - ER Modeling</a></li>
</ul>
<section id="data-standardization" class="level3" data-number="1.2.1">
<h3 data-number="1.2.1" class="anchored" data-anchor-id="data-standardization"><span class="header-section-number">1.2.1</span> Data Standardization</h3>
<ul>
<li>2024-08-11, <a href="../../../../docs/blog/posts/Governance/5-0-0.data_standard.html">Data Standardization - Basic Concept</a></li>
<li>2024-08-12, <a href="../../../../docs/blog/posts/Governance/5-0-1.stndrdztn_rule.ver1.0.0.html">Data Standardization - Standard Rules</a></li>
<li>2024-11-25, <a href="../../../../docs/blog/posts/Governance/5-0-2.terminology_hierarchy.html">Data Standardization - 용어 정리</a></li>
<li>2024-08-12, <a href="../../../../docs/blog/posts/Governance/5-1.data_word_dictionary.html">Data Standardization - 표준 단어 사전</a></li>
<li>2024-08-13, <a href="../../../../docs/blog/posts/Governance/5-2.data_word_domain.html">Data Standardization - 표준 도메인 사전</a></li>
<li>2024-08-14, <a href="../../../../docs/blog/posts/Governance/5-3.data_word_glossary.html">Data Standardization - 표준 용어 사전</a></li>
<li>2024-08-15, <a href="../../../../docs/blog/posts/Governance/5-4.data_code.html">Data Standardization - 표준 코드</a></li>
<li>2024-08-16, <a href="../../../../docs/blog/posts/Governance/6-0.data_registration_process.html">Data Standardization - 등록 프로세스</a></li>
<li>2024-08-17, <a href="../../../../docs/blog/posts/Governance/6-1.data_review_process.html">Data Standardization - 용어 검토 프로세스</a></li>
<li>2024-08-18, <a href="../../../../docs/blog/posts/Governance/6-2.data_code_registration.html">Data Standardization - 코드 등록 프로세스</a></li>
<li>2024-08-19, <a href="../../../../docs/blog/posts/Governance/8-0.data_quality_measures.html">Data Standardization - 데이터 품질 측정</a></li>
</ul>
</section>
<section id="data-quality" class="level3" data-number="1.2.2">
<h3 data-number="1.2.2" class="anchored" data-anchor-id="data-quality"><span class="header-section-number">1.2.2</span> Data Quality</h3>
<ul>
<li>0000-00-00, [Data Quality Control Process, 데이터 품질 절차]</li>
<li>0000-00-00, [Data Quality Measurement, 데이터 품질 측정]</li>
<li>0000-00-00, [Data Validation, 데이터 품질 검증]</li>
</ul>
</section>
<section id="etc." class="level3" data-number="1.2.3">
<h3 data-number="1.2.3" class="anchored" data-anchor-id="etc."><span class="header-section-number">1.2.3</span> etc.</h3>
<ul>
<li>0000-00-00, [Data Governance Solutions, 데이터 관리 솔루션]</li>
<li>0000-00-00, [Metadata Management, 메타데이터 관리]</li>
<li>0000-00-00, [Data Integration, 데이터 통합]</li>
<li>0000-00-00, [Data Security, 데이터 보안]</li>
</ul>


</section>
</section>
</section>

 ]]></description>
  <category>Data Governance</category>
  <guid>kk3225.netlify.app/docs/blog/posts/Governance/</guid>
  <pubDate>Tue, 31 Dec 2109 15:00:00 GMT</pubDate>
</item>
<item>
  <title>Epidemiology</title>
  <dc:creator>Kwangmin Kim</dc:creator>
  <link>kk3225.netlify.app/docs/blog/posts/Experimentation/Epidemiology/</link>
  <description><![CDATA[ 





<section id="contents" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Contents</h1>
<section id="learning-path-for-experimentation" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="learning-path-for-experimentation"><span class="header-section-number">1.1</span> Learning Path for Experimentation</h2>
<p><strong>Priority Topics for Experimentation:</strong> 1. <strong>Experimental Studies → RCT</strong> (A/B Testing 직접 원형) 2. <strong>Causal Inference</strong> (전체 섹션 - 실험의 이론적 기초) 3. <strong>Effect Modification</strong> (Heterogeneous Treatment Effects) 4. <strong>Sample Size and Power</strong> (실험 설계 필수) 5. <strong>Propensity Score Methods</strong> (Observational causal inference)</p>
<p><strong>Recommended Study Order:</strong></p>
<p>Phase 1 (1-2주): Foundations + Study Designs → Focus on RCT and experimental principles</p>
<p>Phase 2 (1주): Measures of Association and Impact → Effect measures calculation practice</p>
<p>Phase 3 (2주): Causal Inference ⭐ → DAG practice, Counterfactual framework → Most critical for experimentation</p>
<p>Phase 4 (1주): Bias and Confounding + Study Fundamentals → Sample size calculations → Validity considerations</p>
<p>Phase 5 (선택): Advanced Topics → As needed for specific applications</p>
</section>
<section id="foundations" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="foundations"><span class="header-section-number">1.2</span> Foundations</h2>
<ul>
<li>1111-11-11, <a href="./foundations/concepts.qmd">Epidemiologic Concepts</a>
<ul>
<li>1111-11-11, <a href="./foundations/incidence_prevalence.qmd">Incidence vs.&nbsp;Prevalence (발생률 vs.&nbsp;유병률)</a></li>
<li>1111-11-11, <a href="./foundations/population_at_risk.qmd">Population at Risk (위험인구)</a></li>
<li>1111-11-11, <a href="./foundations/exposure_outcome.qmd">Exposure and Outcome (노출과 결과)</a></li>
</ul></li>
<li>1111-11-11, <a href="./foundations/framework.qmd">Study Design Framework (연구설계 프레임워크)</a>
<ul>
<li>1111-11-11, <a href="./foundations/descriptive_analytical.qmd">Descriptive vs.&nbsp;Analytical Studies (기술 vs.&nbsp;분석 연구)</a></li>
<li>1111-11-11, <a href="./foundations/observational_experimental.qmd">Observational vs.&nbsp;Experimental Studies (관찰 vs.&nbsp;실험 연구)</a></li>
<li>1111-11-11, <a href="./foundations/time_relationship.qmd">Time Relationship (시간적 관계)</a></li>
</ul></li>
</ul>
</section>
<section id="study-designs" class="level2" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="study-designs"><span class="header-section-number">1.3</span> Study Designs</h2>
<ul>
<li>2023-02-27, Types of Study Designs in Epidemiology
<ul>
<li>1111-11-11, Descriptive Studies (기술연구)
<ul>
<li>1111-11-11, <a href="./descriptive/case_reports.qmd">Case Reports and Case Series (증례보고 및 증례군)</a></li>
<li>1111-11-11, <a href="./descriptive/ecological.qmd">Ecological Studies (생태학적 연구)</a></li>
</ul></li>
<li>1111-11-11, Observational Analytical Studies (관찰 분석연구)
<ul>
<li>1111-11-11, <a href="./observational/cross_sectional.qmd">Cross-sectional Studies (단면연구)</a></li>
<li>1111-11-11, <a href="./observational/case_control.qmd">Case-control Studies (환자-대조군 연구)</a></li>
<li>1111-11-11, <a href="./observational/cohort.qmd">Cohort Studies (코호트 연구)</a>
<ul>
<li>1111-11-11, <a href="./observational/cohort_prospective.qmd">Prospective Cohort (전향적 코호트)</a></li>
<li>1111-11-11, <a href="./observational/cohort_retrospective.qmd">Retrospective Cohort (후향적 코호트)</a></li>
</ul></li>
</ul></li>
<li>1111-11-11, Experimental Studies (실험연구) ⭐
<ul>
<li>1111-11-11, <a href="./experimental/rct.qmd">Randomized Controlled Trial (무작위 대조 시험)</a> ⭐</li>
<li>1111-11-11, <a href="./experimental/quasi_experimental.qmd">Quasi-experimental Studies (준실험 연구)</a></li>
<li>1111-11-11, <a href="./experimental/before_after.qmd">Before-after Studies (전후 연구)</a></li>
<li>1111-11-11, <a href="./experimental/factorial_design.qmd">Factorial Design (요인 설계)</a></li>
</ul></li>
<li>1111-11-11, Evidence Synthesis (근거 통합)
<ul>
<li>1111-11-11, <a href="./synthesis/systematic_review.qmd">Systematic Reviews (체계적 문헌고찰)</a></li>
<li>1111-11-11, <a href="./synthesis/meta_analysis.qmd">Meta-analyses (메타분석)</a></li>
</ul></li>
</ul></li>
</ul>
</section>
<section id="measures-of-association-and-impact" class="level2" data-number="1.4">
<h2 data-number="1.4" class="anchored" data-anchor-id="measures-of-association-and-impact"><span class="header-section-number">1.4</span> Measures of Association and Impact</h2>
<ul>
<li>2023-05-23, <a href="./measures_overview.qmd">Measures in Epidemiology</a>
<ul>
<li>1111-11-11, Contingency Tables and Basic Measures (분할표와 기본 측정)
<ul>
<li>1111-11-11, <a href="./measures/contingency_table.qmd">2x2 Contingency Tables (2x2 분할표)</a></li>
<li>1111-11-11, <a href="./measures/risk_rate_odds.qmd">Risk, Rate, and Odds (위험, 비율, 오즈)</a></li>
</ul></li>
<li>1111-11-11, Measures of Association (연관성 지표)
<ul>
<li>1111-11-11, <a href="./measures/relative_risk.qmd">Relative Risk (상대위험도)</a></li>
<li>1111-11-11, <a href="./measures/odds_ratio.qmd">Odds Ratio (오즈비)</a></li>
<li>1111-11-11, <a href="./measures/rate_ratio.qmd">Rate Ratio (비율비)</a></li>
</ul></li>
<li>1111-11-11, Measures of Effect (효과 지표)
<ul>
<li>1111-11-11, <a href="./measures/risk_difference.qmd">Risk Difference (위험차이)</a></li>
<li>1111-11-11, <a href="./measures/rrr.qmd">Relative Risk Reduction (상대위험감소)</a></li>
<li>1111-11-11, <a href="./measures/arr.qmd">Absolute Risk Reduction (절대위험감소)</a></li>
<li>1111-11-11, <a href="./measures/nnt.qmd">Number Needed to Treat (치료필요수)</a></li>
</ul></li>
<li>1111-11-11, Measures of Impact (영향 지표)
<ul>
<li>1111-11-11, <a href="./measures/attributable_risk.qmd">Attributable Risk (기여위험도)</a></li>
<li>1111-11-11, <a href="./measures/ar_percent.qmd">Attributable Risk Percent (기여위험분율)</a></li>
<li>1111-11-11, <a href="./measures/population_attributable_risk.qmd">Population Attributable Risk (인구기여위험도)</a></li>
<li>1111-11-11, <a href="./measures/par_percent.qmd">Population Attributable Risk Percent (인구기여위험분율)</a></li>
</ul></li>
<li>1111-11-11, Statistical Inference (통계적 추론)
<ul>
<li>1111-11-11, <a href="./measures/confidence_intervals.qmd">Confidence Intervals (신뢰구간)</a></li>
<li>1111-11-11, <a href="./measures/hypothesis_testing.qmd">Hypothesis Testing (가설 검정)</a></li>
<li>1111-11-11, <a href="./measures/p_values.qmd">p-values and Interpretation (p-값과 해석)</a></li>
</ul></li>
</ul></li>
</ul>
</section>
<section id="causal-inference" class="level2" data-number="1.5">
<h2 data-number="1.5" class="anchored" data-anchor-id="causal-inference"><span class="header-section-number">1.5</span> Causal Inference ⭐</h2>
<ul>
<li>1111-11-11, <a href="./causation/index.qmd">Causation in Epidemiology (역학에서의 인과관계)</a>
<ul>
<li>1111-11-11, Causation Concepts (인과관계 개념)
<ul>
<li>1111-11-11, <a href="./causation/necessary_sufficient.qmd">Necessary vs.&nbsp;Sufficient Causes (필요조건 vs.&nbsp;충분조건)</a></li>
<li>1111-11-11, <a href="./causation/component_causes.qmd">Component Causes (구성요인)</a></li>
<li>1111-11-11, <a href="./causation/induction_period.qmd">Induction Period (유도기간)</a></li>
</ul></li>
<li>1111-11-11, <a href="./causation/bradford_hill.qmd">Bradford Hill Criteria (Bradford Hill 기준)</a>
<ul>
<li>1111-11-11, <a href="./causation/strength.qmd">Strength of Association (연관성의 강도)</a></li>
<li>1111-11-11, <a href="./causation/consistency.qmd">Consistency and Replication (일관성과 재현성)</a></li>
<li>1111-11-11, <a href="./causation/specificity.qmd">Specificity (특이성)</a></li>
<li>1111-11-11, <a href="./causation/temporality.qmd">Temporality (시간적 선후관계)</a></li>
<li>1111-11-11, <a href="./causation/dose_response.qmd">Biological Gradient (생물학적 기울기)</a></li>
<li>1111-11-11, <a href="./causation/plausibility.qmd">Plausibility and Coherence (개연성과 일관성)</a></li>
<li>1111-11-11, <a href="./causation/experiment_analogy.qmd">Experiment and Analogy (실험과 유추)</a></li>
</ul></li>
<li>1111-11-11, <a href="./causation/counterfactual.qmd">Counterfactual Framework (반사실적 프레임워크)</a> ⭐
<ul>
<li>1111-11-11, <a href="./causation/potential_outcomes.qmd">Potential Outcomes (잠재결과)</a></li>
<li>1111-11-11, <a href="./causation/ate.qmd">Average Treatment Effect (평균 처치효과)</a></li>
<li>1111-11-11, <a href="./causation/sutva.qmd">SUTVA (안정단위처치값 가정)</a></li>
</ul></li>
<li>1111-11-11, <a href="./causation/dag.qmd">Directed Acyclic Graphs (방향성 비순환 그래프)</a> ⭐
<ul>
<li>1111-11-11, <a href="./causation/causal_pathways.qmd">Causal Pathways (인과 경로)</a></li>
<li>1111-11-11, <a href="./causation/confounding_paths.qmd">Confounding Paths (교란 경로)</a></li>
<li>1111-11-11, <a href="./causation/colliders.qmd">Colliders and Selection Bias (충돌자와 선택 편향)</a></li>
<li>1111-11-11, <a href="./causation/d_separation.qmd">d-separation (d-분리)</a></li>
</ul></li>
<li>1111-11-11, <a href="./causation/propensity_score.qmd">Propensity Score Methods (성향점수 방법)</a>
<ul>
<li>1111-11-11, <a href="./causation/ps_matching.qmd">Propensity Score Matching (성향점수 매칭)</a></li>
<li>1111-11-11, <a href="./causation/iptw.qmd">Inverse Probability Weighting (역확률 가중)</a></li>
<li>1111-11-11, <a href="./causation/ps_stratification.qmd">Propensity Score Stratification (성향점수 층화)</a></li>
<li>1111-11-11, <a href="./causation/ps_adjustment.qmd">Covariate Adjustment (공변량 조정)</a></li>
</ul></li>
</ul></li>
</ul>
</section>
<section id="bias-and-confounding" class="level2" data-number="1.6">
<h2 data-number="1.6" class="anchored" data-anchor-id="bias-and-confounding"><span class="header-section-number">1.6</span> Bias and Confounding</h2>
<ul>
<li>1111-11-11, <a href="./bias/index.qmd">Bias in Epidemiologic Studies (역학 연구의 편향)</a>
<ul>
<li>1111-11-11, Types of Bias (편향의 종류)
<ul>
<li>1111-11-11, <a href="./bias/selection_bias.qmd">Selection Bias (선택 편향)</a></li>
<li>1111-11-11, <a href="./bias/information_bias.qmd">Information Bias (정보 편향)</a></li>
<li>1111-11-11, <a href="./bias/misclassification.qmd">Misclassification Bias (오분류 편향)</a>
<ul>
<li>1111-11-11, <a href="./bias/nondifferential.qmd">Non-differential Misclassification (비차별적 오분류)</a></li>
<li>1111-11-11, <a href="./bias/differential.qmd">Differential Misclassification (차별적 오분류)</a></li>
</ul></li>
</ul></li>
</ul></li>
<li>1111-11-11, <a href="./confounding/index.qmd">Confounding (교란)</a>
<ul>
<li>1111-11-11, <a href="./confounding/definition.qmd">Definition and Criteria (정의와 기준)</a></li>
<li>1111-11-11, <a href="./confounding/positive_negative.qmd">Positive vs.&nbsp;Negative Confounding (양성 vs.&nbsp;음성 교란)</a></li>
<li>1111-11-11, <a href="./confounding/residual.qmd">Residual Confounding (잔여 교란)</a></li>
</ul></li>
<li>1111-11-11, <a href="./effect_modification/index.qmd">Effect Modification (효과 수정)</a> ⭐
<ul>
<li>1111-11-11, <a href="./effect_modification/vs_confounding.qmd">vs.&nbsp;Confounding (교란과의 구분)</a></li>
<li>1111-11-11, <a href="./effect_modification/statistical_interaction.qmd">Statistical Interaction (통계적 상호작용)</a></li>
<li>1111-11-11, <a href="./effect_modification/biological_interaction.qmd">Biological Interaction (생물학적 상호작용)</a></li>
</ul></li>
<li>1111-11-11, <a href="./control/index.qmd">Control Methods (통제 방법)</a>
<ul>
<li>1111-11-11, Design Stage Methods (설계 단계 방법)
<ul>
<li>1111-11-11, <a href="./control/restriction.qmd">Restriction (제한)</a></li>
<li>1111-11-11, <a href="./control/matching.qmd">Matching (매칭)</a></li>
</ul></li>
<li>1111-11-11, Analysis Stage Methods (분석 단계 방법)
<ul>
<li>1111-11-11, <a href="./control/stratification.qmd">Stratification Analysis (층화 분석)</a></li>
<li>1111-11-11, <a href="./control/standardization.qmd">Standardization (표준화)</a></li>
<li>1111-11-11, <a href="./control/regression_adjustment.qmd">Regression Adjustment (회귀 조정)</a></li>
</ul></li>
</ul></li>
</ul>
</section>
<section id="study-design-fundamentals" class="level2" data-number="1.7">
<h2 data-number="1.7" class="anchored" data-anchor-id="study-design-fundamentals"><span class="header-section-number">1.7</span> Study Design Fundamentals</h2>
<ul>
<li>1111-11-11, <a href="./fundamentals/sample_size_power.qmd">Sample Size and Power (표본 크기와 검정력)</a> ⭐
<ul>
<li>1111-11-11, <a href="./fundamentals/type1_error.qmd">Type I Error (1종 오류, α)</a></li>
<li>1111-11-11, <a href="./fundamentals/type2_error.qmd">Type II Error (2종 오류, β)</a></li>
<li>1111-11-11, <a href="./fundamentals/power.qmd">Statistical Power (통계적 검정력, 1-β)</a></li>
<li>1111-11-11, <a href="./fundamentals/effect_size.qmd">Effect Size (효과 크기)</a></li>
<li>1111-11-11, <a href="./fundamentals/sample_size_calc.qmd">Sample Size Calculation (표본 크기 계산)</a></li>
</ul></li>
<li>1111-11-11, <a href="./fundamentals/randomization.qmd">Randomization Methods (무작위 배정 방법)</a>
<ul>
<li>1111-11-11, <a href="./fundamentals/simple_random.qmd">Simple Randomization (단순 무작위배정)</a></li>
<li>1111-11-11, <a href="./fundamentals/block_random.qmd">Block Randomization (블록 무작위배정)</a></li>
<li>1111-11-11, <a href="./fundamentals/stratified_random.qmd">Stratified Randomization (층화 무작위배정)</a></li>
</ul></li>
<li>1111-11-11, <a href="./fundamentals/validity.qmd">Validity in Epidemiologic Studies (역학 연구의 타당도)</a>
<ul>
<li>1111-11-11, <a href="./fundamentals/internal_validity.qmd">Internal Validity (내적 타당도)</a></li>
<li>1111-11-11, <a href="./fundamentals/external_validity.qmd">External Validity (외적 타당도)</a></li>
<li>1111-11-11, <a href="./fundamentals/construct_validity.qmd">Construct Validity (구성 타당도)</a></li>
</ul></li>
</ul>
</section>
<section id="screening-and-diagnostic-tests" class="level2" data-number="1.8">
<h2 data-number="1.8" class="anchored" data-anchor-id="screening-and-diagnostic-tests"><span class="header-section-number">1.8</span> Screening and Diagnostic Tests</h2>
<ul>
<li>1111-11-11, <a href="./screening/index.qmd">Evaluation of Diagnostic Tests (진단검사 평가)</a>
<ul>
<li>1111-11-11, Test Performance Measures (검사 성능 지표)
<ul>
<li>1111-11-11, <a href="./screening/sensitivity.qmd">Sensitivity (민감도, True Positive Rate)</a></li>
<li>1111-11-11, <a href="./screening/specificity.qmd">Specificity (특이도, True Negative Rate)</a></li>
<li>1111-11-11, <a href="./screening/ppv.qmd">Positive Predictive Value (양성 예측도, PPV)</a></li>
<li>1111-11-11, <a href="./screening/npv.qmd">Negative Predictive Value (음성 예측도, NPV)</a></li>
</ul></li>
<li>1111-11-11, <a href="./screening/likelihood_ratios.qmd">Likelihood Ratios (우도비)</a>
<ul>
<li>1111-11-11, <a href="./screening/lr_positive.qmd">Positive Likelihood Ratio (양성 우도비, LR+)</a></li>
<li>1111-11-11, <a href="./screening/lr_negative.qmd">Negative Likelihood Ratio (음성 우도비, LR-)</a></li>
<li>1111-11-11, <a href="./screening/pretest_posttest.qmd">Pre-test to Post-test Probability (사전-사후 확률)</a></li>
</ul></li>
<li>1111-11-11, Trade-offs and Optimization (상충관계와 최적화)
<ul>
<li>1111-11-11, <a href="./screening/roc_curve.qmd">ROC Curve (ROC 곡선)</a></li>
<li>1111-11-11, <a href="./screening/auc.qmd">Area Under Curve (곡선하면적, AUC)</a></li>
<li>1111-11-11, <a href="./screening/cutpoint.qmd">Optimal Cut-point Selection (최적 절단값 선택)</a></li>
</ul></li>
<li>1111-11-11, <a href="./screening/bayesian.qmd">Bayesian Interpretation (베이지안 해석)</a>
<ul>
<li>1111-11-11, <a href="./screening/bayes_theorem.qmd">Bayes’ Theorem Connection (베이즈 정리와의 연결)</a></li>
</ul></li>
</ul></li>
</ul>
</section>
<section id="survival-analysis" class="level2" data-number="1.9">
<h2 data-number="1.9" class="anchored" data-anchor-id="survival-analysis"><span class="header-section-number">1.9</span> Survival Analysis</h2>
<ul>
<li>1111-11-11, <a href="./survival/index.qmd">Time-to-Event Analysis (시간-사건 분석)</a>
<ul>
<li>1111-11-11, Basic Concepts (기본 개념)
<ul>
<li>1111-11-11, <a href="./survival/censoring.qmd">Censoring (중도절단)</a></li>
<li>1111-11-11, <a href="./survival/survival_function.qmd">Survival Function (생존함수)</a></li>
<li>1111-11-11, <a href="./survival/hazard_function.qmd">Hazard Function (위험함수)</a></li>
</ul></li>
<li>1111-11-11, <a href="./survival/kaplan_meier.qmd">Kaplan-Meier Method (Kaplan-Meier 방법)</a>
<ul>
<li>1111-11-11, <a href="./survival/nonparametric.qmd">Non-parametric Estimation (비모수 추정)</a></li>
<li>1111-11-11, <a href="./survival/logrank_test.qmd">Log-rank Test (로그순위 검정)</a></li>
</ul></li>
<li>1111-11-11, <a href="./survival/cox_model.qmd">Cox Proportional Hazards Model (Cox 비례위험모형)</a>
<ul>
<li>1111-11-11, <a href="./survival/semiparametric.qmd">Semi-parametric Model (준모수 모형)</a></li>
<li>1111-11-11, <a href="./survival/hazard_ratio.qmd">Hazard Ratio (위험비)</a></li>
<li>1111-11-11, <a href="./survival/ph_assumption.qmd">Proportional Hazards Assumption (비례위험 가정)</a></li>
</ul></li>
<li>1111-11-11, Advanced Survival Topics (고급 생존분석 주제)
<ul>
<li>1111-11-11, <a href="./survival/competing_risks.qmd">Competing Risks (경쟁위험)</a></li>
<li>1111-11-11, <a href="./survival/recurrent_events.qmd">Recurrent Events (반복사건)</a></li>
</ul></li>
</ul></li>
</ul>
</section>
<section id="advanced-topics" class="level2" data-number="1.10">
<h2 data-number="1.10" class="anchored" data-anchor-id="advanced-topics"><span class="header-section-number">1.10</span> Advanced Topics</h2>
<ul>
<li>1111-11-11, <a href="./advanced/designs/index.qmd">Advanced Study Designs (고급 연구설계)</a>
<ul>
<li>1111-11-11, <a href="./advanced/designs/cluster_rct.qmd">Cluster Randomized Trials (군집 무작위 시험)</a></li>
<li>1111-11-11, <a href="./advanced/designs/stepped_wedge.qmd">Stepped Wedge Designs (단계적 쐐기 설계)</a></li>
<li>1111-11-11, <a href="./advanced/designs/adaptive.qmd">Adaptive Designs (적응형 설계)</a></li>
<li>1111-11-11, <a href="./advanced/designs/platform_trials.qmd">Platform Trials (플랫폼 시험)</a></li>
</ul></li>
<li>1111-11-11, <a href="./advanced/causal/index.qmd">Advanced Causal Methods (고급 인과추론 방법)</a>
<ul>
<li>1111-11-11, <a href="./advanced/causal/instrumental_variables.qmd">Instrumental Variables (도구변수)</a></li>
<li>1111-11-11, <a href="./advanced/causal/rdd.qmd">Regression Discontinuity Design (회귀불연속 설계)</a></li>
<li>1111-11-11, <a href="./advanced/causal/did.qmd">Difference-in-Differences (이중차분법)</a></li>
<li>1111-11-11, <a href="./advanced/causal/synthetic_control.qmd">Synthetic Control Methods (합성 통제 방법)</a></li>
</ul></li>
<li>1111-11-11, <a href="./advanced/stats/index.qmd">Advanced Statistical Methods (고급 통계 방법)</a>
<ul>
<li>1111-11-11, <a href="./advanced/stats/multilevel_modeling.qmd">Multilevel/Hierarchical Modeling (다층/계층 모델링)</a></li>
<li>1111-11-11, <a href="./advanced/stats/meta_analysis.qmd">Meta-analysis (메타분석)</a>
<ul>
<li>1111-11-11, <a href="./advanced/stats/fixed_effects.qmd">Fixed Effects Model (고정효과 모형)</a></li>
<li>1111-11-11, <a href="./advanced/stats/random_effects.qmd">Random Effects Model (무선효과 모형)</a></li>
<li>1111-11-11, <a href="./advanced/stats/meta_regression.qmd">Meta-regression (메타회귀분석)</a></li>
</ul></li>
<li>1111-11-11, <a href="./advanced/stats/missing_data.qmd">Missing Data Methods (결측치 처리 방법)</a>
<ul>
<li>1111-11-11, <a href="./advanced/stats/missing_mechanisms.qmd">MCAR, MAR, MNAR (결측 메커니즘)</a></li>
<li>1111-11-11, <a href="./advanced/stats/multiple_imputation.qmd">Multiple Imputation (다중대체)</a></li>
</ul></li>
<li>1111-11-11, <a href="./advanced/stats/measurement_error.qmd">Measurement Error Models (측정 오차 모형)</a></li>
</ul></li>
<li>1111-11-11, <a href="./advanced/special/index.qmd">Special Topics (특수 주제)</a>
<ul>
<li>1111-11-11, <a href="./advanced/special/time_varying_confounding.qmd">Time-varying Confounding (시간가변 교란)</a></li>
<li>1111-11-11, <a href="./advanced/special/mediation.qmd">Mediation Analysis (매개분석)</a></li>
<li>1111-11-11, <a href="./advanced/special/g_methods.qmd">G-methods (G-방법)</a>
<ul>
<li>1111-11-11, <a href="./advanced/special/g_computation.qmd">G-computation (G-계산)</a></li>
<li>1111-11-11, <a href="./advanced/special/ipw.qmd">Inverse Probability Weighting (역확률 가중)</a></li>
<li>1111-11-11, <a href="./advanced/special/g_estimation.qmd">G-estimation (G-추정)</a></li>
</ul></li>
<li>1111-11-11, <a href="./advanced/special/sensitivity_analysis.qmd">Sensitivity Analysis (민감도 분석)</a></li>
</ul></li>
</ul>


</section>
</section>

 ]]></description>
  <category>Epidemiology</category>
  <guid>kk3225.netlify.app/docs/blog/posts/Experimentation/Epidemiology/</guid>
  <pubDate>Sun, 28 Feb 2100 15:00:00 GMT</pubDate>
</item>
<item>
  <title>Mathematics</title>
  <dc:creator>Kwangmin Kim</dc:creator>
  <link>kk3225.netlify.app/docs/blog/posts/Math/</link>
  <description><![CDATA[ 





<section id="contents" class="level1" data-number="1">

<section id="basic" class="level2" data-number="1.1">

<ul>
<li>2023-03-24, <a href="./variables/index.qmd">Variable types</a></li>
<li>1111-11-11, <a href="./function/index.qmd">Function</a>
<ul>
<li>2023-01-31, <a href="../../../../docs/blog/posts/Math/function/univariable_scalar_function.html">Function (1) - Univariable Scalar Function (One to One)</a></li>
<li>2023-01-31, <a href="../../../../docs/blog/posts/Math/function/multivariable_scalar_function.html">Function (2) - Multi-variable Scalar Function (Many to One)</a></li>
<li>2023-01-31, <a href="../../../../docs/blog/posts/Math/function/univariable_vector_function.html">Function (3) - Univariable Vector Function (One to Many)</a></li>
<li>2023-01-31, <a href="../../../../docs/blog/posts/Math/function/mutivariable_vector_function.html">Function (4) - Multi-variable Vector Function (Many to Many)</a></li>
<li>2023-02-18, <a href="../../../../docs/blog/posts/Math/function/composite_function.html">Function (5) - Composite Function</a></li>
</ul></li>
<li>2023-02-18, <a href="./transformation/index.qmd">Transformations of Functions</a></li>
<li>1111-11-11, Vector &amp; Matrix</li>
<li>2023-03-15, <a href="./epsilon_delta/">Limit, <img src="https://latex.codecogs.com/png.latex?%5Cepsilon-%5Cdelta"> Method</a></li>
<li>Differentiation
<ul>
<li>2023-02-04, <a href="./differentiation/2023-02-04_uni_derivative.qmd">Derivative (1) - Univariable Scalar Funtion</a></li>
<li>1111-11-11, <a href="./differentiation/2023-02-10_composite_partial_derivative.qmd">Derivative (2) - Chain Rule &amp; Partial Derivative</a></li>
<li>1111-11-11, Derivative (3) - Higher Order Derivative</li>
<li>1111-11-11, Derivative (4) - Mean Value Theorem</li>
<li>1111-11-11, Derivative (5) - Gradient</li>
</ul></li>
<li>2023-03-15, <a href="./taylor_series/index.qmd">Talyer’s Series</a></li>
<li>1111-11-11, Gradient Direction</li>
<li>1111-11-11, Random Variable</li>
<li>1111-11-11, Probability Distribution</li>
<li>1111-11-11, Information Theory - Entropy</li>
<li>1111-11-11,</li>
<li>1111-11-11,</li>
<li>1111-11-11,</li>
<li>1111-11-11,</li>
</ul>
</section>
<section id="linear-algebra" class="level2" data-number="1.2">

<ul>
<li>2023-03-30, <a href="../../../../docs/blog/posts/Math/linear_algebra/01.basic_vector.html">Basic Vector(1) - Vector Operations</a></li>
<li>2023-03-30, <a href="../../../../docs/blog/posts/Math/linear_algebra/02.norm_dot-product.html">Basic Vector(2) - Vector Norm and Dot Product”</a></li>
<li>2023-03-30, <a href="../../../../docs/blog/posts/Math/linear_algebra/03.vector_equation.html">Basic Vector(3) - Vector Equation</a></li>
<li>2023-03-30, Basic Matrix(1) - Matrix Operation</li>
<li>2023-03-30, Basic Matrix(2) - Matrix Multiplication</li>
<li>2023-03-30, <a href="../../../../docs/blog/posts/Math/linear_algebra/06.system_of_lineqr_equations.html">Basic Matrix(3) - System of Linear Equations</a></li>
<li>2023-03-30, <a href="../../../../docs/blog/posts/Math/linear_algebra/09.special_matrix.html">Basic Matrix(4) - Special Matrix</a></li>
<li>2023-04-14, [Lineqr Equations]</li>
<li>2023-04-14, [Vector Space and Subspaces]</li>
<li>2023-04-21, [Orthogonality]</li>
<li>1111-11-11, [Determinants]</li>
<li>1111-11-11, [Eigen Value &amp; Eigen Vector]</li>
<li>1111-11-11, [Linear Transformations]</li>
<li>1111-11-11, Basis, Dimension, &amp; Rank</li>
<li>1111-11-11,</li>
<li>1111-11-11, Eigen Decomposition</li>
<li>1111-11-11, Singular Value Decomposition (SVD)</li>
<li>1111-11-11, Group</li>
<li>1111-11-11, Rotation &amp; Group</li>
<li>2023-04-02, <a href="./linear_algebra/quadratic_form.qmd">Matrix Transformation (5) - Quadratic Form</a></li>
<li>2023-04-02, <a href="../../../../docs/blog/posts/Math/linear_algebra/derivative_matrix_vector.html">Matrix Calculus (1) - Quadratic Form</a></li>
<li>1111-11-11,</li>
<li>1111-11-11,</li>
<li>1111-11-11,</li>
</ul>
</section>
<section id="optimization" class="level2" data-number="1.3">

<ul>
<li>2023-03-23, <a href="./optimization/minimizer.qmd">Minimizer &amp; Minimum</a></li>
<li>1111-11-11, Convex Set</li>
<li>1111-11-11, Convex Function</li>
<li>1111-11-11, Unconstrained Optimization</li>
<li>1111-11-11, Non-linear Least Square</li>
<li>1111-11-11, Largrange Multiplier Method
<ul>
<li>1111-11-11, Largrange Primal Function</li>
<li>1111-11-11, Largrange Dual Function</li>
<li>1111-11-11, KKT conditions</li>
</ul></li>
<li>1111-11-11, Gradient Descent Optimizers</li>
<li>1111-11-11,</li>
<li>1111-11-11,</li>
<li>1111-11-11,</li>
<li>1111-11-11,</li>
<li>1111-11-11,</li>
<li>1111-11-11,</li>
</ul>


</section>
</section>

 ]]></description>
  <category>Mathematics</category>
  <guid>kk3225.netlify.app/docs/blog/posts/Math/</guid>
  <pubDate>Sun, 28 Feb 2100 15:00:00 GMT</pubDate>
</item>
<item>
  <title>SSH 개요</title>
  <dc:creator>Kwangmin Kim</dc:creator>
  <link>kk3225.netlify.app/docs/blog/posts/Engineering/Infra/Security/ssh.html</link>
  <description><![CDATA[ 





<ul>
<li>2025-11-24, <a href="./Infra/Security/ssh.qmd">SSH 기본 개념</a></li>
<li>2025-11-25, <a href="./Infra/Security/ssh.qmd">SSH 보안 매커니즘</a></li>
<li>2025-11-26, <a href="./Infra/Security/ssh.qmd">SSH 설치 및 설정</a></li>
<li>2025-11-27, <a href="./Infra/Security/ssh.qmd">SSH 접속 방법</a></li>
<li>2025-11-28, <a href="./Infra/Security/ssh.qmd">SSH Config 파일</a></li>
<li>2025-11-29, <a href="./Infra/Security/ssh.qmd">SSH 사용 - 파일 전송</a></li>
<li>2025-11-30, <a href="./Infra/Security/ssh.qmd">SSH 사용 - 포트 포워딩</a></li>
<li>2025-12-01, <a href="./Infra/Security/ssh.qmd">SSH 사용 - 고급활용</a></li>
<li>2025-12-01, <a href="./Infra/Security/ssh.qmd">SSH 보안 강화</a></li>
<li>2025-12-01, <a href="./Infra/Security/ssh.qmd">SSH 문제 해결</a></li>
</ul>
<section id="sshsecure-shell-완벽-가이드" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> SSH(Secure Shell) 완벽 가이드</h1>
<p>SSH는 원격 서버에 안전하게 접속하고 관리하기 위한 네트워크 프로토콜이다. 클라우드와 On-Premise 환경 모두에서 필수적인 도구로, 시스템 관리, 개발, 보안 업무에 광범위하게 사용된다.</p>
<section id="ssh란-무엇인가" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="ssh란-무엇인가"><span class="header-section-number">1.1</span> SSH란 무엇인가?</h2>
<section id="정의와-역사" class="level3" data-number="1.1.1">
<h3 data-number="1.1.1" class="anchored" data-anchor-id="정의와-역사"><span class="header-section-number">1.1.1</span> 정의와 역사</h3>
<p><strong>SSH (Secure Shell)</strong>는 암호화된 네트워크 프로토콜로, 안전하지 않은 네트워크에서 안전하게 네트워크 서비스를 운영하기 위해 설계되었다.</p>
<p><strong>역사:</strong> - <strong>1995년</strong>: Tatu Ylönen이 SSH-1 프로토콜 개발 (핀란드 헬싱키대학교) - <strong>1996년</strong>: SSH Communications Security 설립 - <strong>1999년</strong>: IETF에서 SSH-2 표준화 시작 - <strong>2006년</strong>: OpenSSH가 사실상 표준으로 자리잡음</p>
<p><strong>SSH가 해결한 문제:</strong></p>
<table class="table">
<thead>
<tr class="header">
<th>기존 프로토콜</th>
<th>문제점</th>
<th>SSH 해결책</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Telnet</strong></td>
<td>평문 전송 (패킷 스니핑 취약)</td>
<td>모든 데이터 암호화</td>
</tr>
<tr class="even">
<td><strong>rlogin</strong></td>
<td>약한 인증 (IP 기반)</td>
<td>Public Key 암호화 인증</td>
</tr>
<tr class="odd">
<td><strong>FTP</strong></td>
<td>비밀번호 평문 전송</td>
<td>SFTP로 안전한 파일 전송</td>
</tr>
<tr class="even">
<td><strong>rsh</strong></td>
<td>권한 상승 취약점</td>
<td>강력한 호스트 키 검증</td>
</tr>
<tr class="odd">
<td><strong>rsh</strong></td>
<td>권한 상승 취약점</td>
<td>강력한 호스트 키 검증</td>
</tr>
</tbody>
</table>
</section>
<section id="ssh가-안전한-이유" class="level3" data-number="1.1.2">
<h3 data-number="1.1.2" class="anchored" data-anchor-id="ssh가-안전한-이유"><span class="header-section-number">1.1.2</span> SSH가 안전한 이유?</h3>
<ol type="1">
<li><p><strong>공개키 암호화</strong> (Public Key Cryptography)</p>
<ul>
<li>클라이언트(PC)가 공개키를 가짐</li>
<li>서버(Azure VM)가 비공개키를 가짐</li>
<li>공개키로 암호화한 메시지는 비공개키로만 복호화 가능</li>
<li>통신 과정이 모두 암호화됨</li>
</ul></li>
<li><p><strong>Private Key 인증</strong> ``` 클라이언트 (PC) 서버 (Azure VM) test-agent_key.pem ←→ 비공개키 저장 (Private Key) (Private Key)</p>
<p>접속 요청 시:</p>
<ol type="1">
<li>클라이언트가 Public Key로 challenge를 보냄</li>
<li>서버가 비공개키로 검증</li>
<li>Private Key가 일치하면 접속 허용 ```</li>
</ol></li>
<li><p><strong>중간자 공격 방지</strong></p>
<ul>
<li>SSH 키 교환 과정에서 호스트 키를 검증</li>
<li>첫 접속 시 호스트 지문(fingerprint)을 확인</li>
<li>같은 호스트면 이후 자동 인증</li>
</ul></li>
<li><p><strong>비밀번호 방식의 문제점</strong></p>
<ul>
<li>약한 비밀번호 → 브루트포스 공격에 취약</li>
<li>비밀번호 탈취 → 전체 VM 장악</li>
<li>SSH Key는 수천 자리의 암호화된 파일 → 거의 불가능</li>
</ul></li>
</ol>
</section>
<section id="ssh의-주요-기능" class="level3" data-number="1.1.3">
<h3 data-number="1.1.3" class="anchored" data-anchor-id="ssh의-주요-기능"><span class="header-section-number">1.1.3</span> SSH의 주요 기능</h3>
<ol type="1">
<li><strong>원격 로그인 (Remote Login)</strong>
<ul>
<li>원격 서버의 쉘(Shell)에 접속</li>
<li>명령어 실행, 시스템 관리</li>
</ul></li>
<li><strong>파일 전송 (File Transfer)</strong>
<ul>
<li>SCP (Secure Copy Protocol)</li>
<li>SFTP (SSH File Transfer Protocol)</li>
</ul></li>
<li><strong>포트 포워딩 (Port Forwarding)</strong>
<ul>
<li>로컬 포트 포워딩</li>
<li>리모트 포트 포워딩</li>
<li>다이나믹 포트 포워딩 (SOCKS 프록시)</li>
</ul></li>
<li><strong>터널링 (Tunneling)</strong>
<ul>
<li>암호화된 터널을 통한 안전한 데이터 전송</li>
<li>VPN 대체 솔루션</li>
</ul></li>
<li><strong>X11 포워딩</strong>
<ul>
<li>원격 서버의 GUI 애플리케이션을 로컬에서 실행</li>
</ul></li>
</ol>
</section>
<section id="ssh-작동-원리" class="level3" data-number="1.1.4">
<h3 data-number="1.1.4" class="anchored" data-anchor-id="ssh-작동-원리"><span class="header-section-number">1.1.4</span> SSH 작동 원리</h3>
<p><strong>SSH 연결 프로세스:</strong></p>
<pre><code>클라이언트                                서버
   │                                      │
   │  1. TCP 연결 요청 (Port 22)           │
   ├─────────────────────────────────────&gt;│
   │                                      │
   │  2. 서버 버전 정보                     │
   │&lt;─────────────────────────────────────┤
   │                                      │
   │  3. 클라이언트 버전 정보                │
   ├─────────────────────────────────────&gt;│
   │                                      │
   │  4. 키 교환 (Diffie-Hellman)          │
   │&lt;────────────────────────────────────&gt;│
   │                                      │
   │  5. 호스트 키 검증                     │
   │&lt;─────────────────────────────────────┤
   │                                      │
   │  6. 세션 키 생성 (대칭키 암호화)         │
   │&lt;────────────────────────────────────&gt;│
   │                                      │
   │  7. 사용자 인증 (비밀번호 or Key)        │
   ├─────────────────────────────────────&gt;│
   │                                      │
   │  8. 인증 성공                          │
   │&lt;─────────────────────────────────────┤
   │                                      │
   │  9. 암호화된 세션 시작                  │
   │&lt;════════════════════════════════════&gt;│</code></pre>
<p><strong>암호화 계층:</strong></p>
<ol type="1">
<li><strong>트랜스포트 계층 (Transport Layer)</strong>
<ul>
<li>서버 인증</li>
<li>데이터 기밀성 (암호화)</li>
<li>데이터 무결성 (해시)</li>
</ul></li>
<li><strong>사용자 인증 계층 (User Authentication Layer)</strong>
<ul>
<li>비밀번호 인증</li>
<li>Public Key 인증</li>
<li>호스트 기반 인증</li>
<li>Keyboard-interactive 인증</li>
</ul></li>
<li><strong>연결 계층 (Connection Layer)</strong>
<ul>
<li>다중 채널 지원</li>
<li>데이터 압축</li>
<li>포트 포워딩</li>
</ul></li>
</ol>
</section>
</section>
<section id="ssh-보안-메커니즘" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="ssh-보안-메커니즘"><span class="header-section-number">1.2</span> SSH 보안 메커니즘</h2>
<section id="공개키-암호화-public-key-cryptography" class="level3" data-number="1.2.1">
<h3 data-number="1.2.1" class="anchored" data-anchor-id="공개키-암호화-public-key-cryptography"><span class="header-section-number">1.2.1</span> 공개키 암호화 (Public Key Cryptography)</h3>
<p><strong>비대칭 암호화 원리:</strong></p>
<pre><code>Public Key (공개키)         Private Key (비공개키)
    │                          │
    │  암호화 ─────────&gt;        │
    │                          │  복호화
    │  &lt;───────── 서명          │
    │          검증             │
    
특징:
- Public Key로 암호화한 데이터는 Private Key로만 복호화 가능
- Private Key로 서명한 데이터는 Public Key로 검증 가능
- Public Key는 공개해도 안전
- Private Key는 절대 공유하지 않음</code></pre>
<p><strong>SSH Key 쌍 구조:</strong></p>
<pre><code>~/.ssh/
├── id_rsa              # Private Key (절대 공유 금지!)
├── id_rsa.pub          # Public Key (서버에 등록)
├── id_ed25519          # 최신 알고리즘 Private Key
├── id_ed25519.pub      # 최신 알고리즘 Public Key
└── known_hosts         # 알려진 호스트 목록</code></pre>
</section>
<section id="호스트-키-검증-host-key-verification" class="level3" data-number="1.2.2">
<h3 data-number="1.2.2" class="anchored" data-anchor-id="호스트-키-검증-host-key-verification"><span class="header-section-number">1.2.2</span> 호스트 키 검증 (Host Key Verification)</h3>
<p><strong>중간자 공격(MITM) 방지:</strong></p>
<pre><code>첫 접속 시:
The authenticity of host '192.168.1.100' can't be established.
ED25519 key fingerprint is SHA256:xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx.
Are you sure you want to continue connecting (yes/no)?

↓ yes 입력 시

Warning: Permanently added '192.168.1.100' (ED25519) to the list of known hosts.

→ ~/.ssh/known_hosts 파일에 호스트 키 저장
→ 다음 접속부터 자동으로 검증
→ 호스트 키가 변경되면 경고</code></pre>
<p><strong>호스트 키 변경 경고:</strong></p>
<pre><code>@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@    WARNING: REMOTE HOST IDENTIFICATION HAS CHANGED!     @
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
IT IS POSSIBLE THAT SOMEONE IS DOING SOMETHING NASTY!
Someone could be eavesdropping on you right now (man-in-the-middle attack)!

→ 서버가 재설치되었거나 중간자 공격 가능성</code></pre>
</section>
<section id="암호화-알고리즘" class="level3" data-number="1.2.3">
<h3 data-number="1.2.3" class="anchored" data-anchor-id="암호화-알고리즘"><span class="header-section-number">1.2.3</span> 암호화 알고리즘</h3>
<p><strong>지원 암호화 방식:</strong></p>
<table class="table">
<thead>
<tr class="header">
<th>알고리즘</th>
<th>키 크기</th>
<th>보안 수준</th>
<th>속도</th>
<th>권장</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>RSA</strong></td>
<td>2048-4096 bit</td>
<td>중간</td>
<td>느림</td>
<td>레거시 호환용</td>
</tr>
<tr class="even">
<td><strong>DSA</strong></td>
<td>1024 bit</td>
<td>낮음</td>
<td>중간</td>
<td>사용 금지 (deprecated)</td>
</tr>
<tr class="odd">
<td><strong>ECDSA</strong></td>
<td>256-521 bit</td>
<td>높음</td>
<td>빠름</td>
<td>권장</td>
</tr>
<tr class="even">
<td><strong>Ed25519</strong></td>
<td>256 bit</td>
<td>매우 높음</td>
<td>매우 빠름</td>
<td><strong>강력 권장</strong></td>
</tr>
</tbody>
</table>
<p><strong>대칭키 암호화 (세션 암호화):</strong> - AES-256-CBC - AES-128-GCM - ChaCha20-Poly1305</p>
<p><strong>해시 함수 (무결성 검증):</strong> - SHA-256 - SHA-512 - HMAC-SHA2-256</p>
</section>
</section>
<section id="ssh-설치-및-기본-설정" class="level2" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="ssh-설치-및-기본-설정"><span class="header-section-number">1.3</span> SSH 설치 및 기본 설정</h2>
<section id="ssh-클라이언트-설치" class="level3" data-number="1.3.1">
<h3 data-number="1.3.1" class="anchored" data-anchor-id="ssh-클라이언트-설치"><span class="header-section-number">1.3.1</span> SSH 클라이언트 설치</h3>
</section>
</section>
<section id="ssh-설치-및-기본-설정-1" class="level2" data-number="1.4">
<h2 data-number="1.4" class="anchored" data-anchor-id="ssh-설치-및-기본-설정-1"><span class="header-section-number">1.4</span> SSH 설치 및 기본 설정</h2>
<section id="ssh-클라이언트-설치-1" class="level3" data-number="1.4.1">
<h3 data-number="1.4.1" class="anchored" data-anchor-id="ssh-클라이언트-설치-1"><span class="header-section-number">1.4.1</span> SSH 클라이언트 설치</h3>
<p><strong>Windows:</strong></p>
<div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode numberSource powershell number-lines code-with-copy"><code class="sourceCode powershell"><span id="cb6-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Windows 10/11은 기본 내장</span></span>
<span id="cb6-2">ssh <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>V</span>
<span id="cb6-3"></span>
<span id="cb6-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 없다면 설치:</span></span>
<span id="cb6-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 설정 → 앱 → 선택적 기능 → OpenSSH 클라이언트 추가</span></span></code></pre></div>
<p><strong>macOS:</strong></p>
<div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb7-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 기본 내장</span></span>
<span id="cb7-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ssh</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-V</span></span></code></pre></div>
<p><strong>Linux (Ubuntu/Debian):</strong></p>
<div class="sourceCode" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb8-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sudo</span> apt update</span>
<span id="cb8-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sudo</span> apt install openssh-client <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-y</span></span>
<span id="cb8-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ssh</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-V</span></span></code></pre></div>
<p><strong>Linux (CentOS/RHEL):</strong></p>
<div class="sourceCode" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb9-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sudo</span> yum install openssh-clients <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-y</span></span>
<span id="cb9-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ssh</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-V</span></span></code></pre></div>
</section>
<section id="ssh-서버-설치-접속받을-서버" class="level3" data-number="1.4.2">
<h3 data-number="1.4.2" class="anchored" data-anchor-id="ssh-서버-설치-접속받을-서버"><span class="header-section-number">1.4.2</span> SSH 서버 설치 (접속받을 서버)</h3>
<p><strong>Ubuntu/Debian:</strong></p>
<div class="sourceCode" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb10-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sudo</span> apt update</span>
<span id="cb10-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sudo</span> apt install openssh-server <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-y</span></span>
<span id="cb10-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sudo</span> systemctl status sshd</span>
<span id="cb10-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sudo</span> systemctl enable sshd  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 부팅 시 자동 시작</span></span></code></pre></div>
<p><strong>CentOS/RHEL:</strong></p>
<div class="sourceCode" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb11-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sudo</span> yum install openssh-server <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-y</span></span>
<span id="cb11-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sudo</span> systemctl start sshd</span>
<span id="cb11-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sudo</span> systemctl enable sshd</span></code></pre></div>
<p><strong>서버 설정 파일:</strong></p>
<div class="sourceCode" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb12-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># SSH 데몬 설정</span></span>
<span id="cb12-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sudo</span> nano /etc/ssh/sshd_config</span></code></pre></div>
<p><strong>주요 설정 옵션:</strong></p>
<div class="sourceCode" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb13-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 포트 변경 (기본 22 → 보안 강화를 위해 변경 권장)</span></span>
<span id="cb13-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Port</span> 2222</span>
<span id="cb13-3"></span>
<span id="cb13-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Root 로그인 금지 (보안 필수)</span></span>
<span id="cb13-5"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">PermitRootLogin</span> no</span>
<span id="cb13-6"></span>
<span id="cb13-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 비밀번호 인증 비활성화 (Key 인증만 허용)</span></span>
<span id="cb13-8"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">PasswordAuthentication</span> no</span>
<span id="cb13-9"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">PubkeyAuthentication</span> yes</span>
<span id="cb13-10"></span>
<span id="cb13-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 빈 비밀번호 금지</span></span>
<span id="cb13-12"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">PermitEmptyPasswords</span> no</span>
<span id="cb13-13"></span>
<span id="cb13-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># X11 포워딩 (GUI 필요시)</span></span>
<span id="cb13-15"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">X11Forwarding</span> yes</span>
<span id="cb13-16"></span>
<span id="cb13-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 최대 인증 시도 횟수</span></span>
<span id="cb13-18"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">MaxAuthTries</span> 3</span>
<span id="cb13-19"></span>
<span id="cb13-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 접속 허용 사용자 (화이트리스트)</span></span>
<span id="cb13-21"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">AllowUsers</span> alice bob</span>
<span id="cb13-22"></span>
<span id="cb13-23"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 접속 금지 사용자 (블랙리스트)</span></span>
<span id="cb13-24"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">DenyUsers</span> attacker</span></code></pre></div>
<p><strong>설정 변경 후 재시작:</strong></p>
<div class="sourceCode" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb14-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sudo</span> systemctl restart sshd</span></code></pre></div>
</section>
</section>
<section id="ssh-접속-방법" class="level2" data-number="1.5">
<h2 data-number="1.5" class="anchored" data-anchor-id="ssh-접속-방법"><span class="header-section-number">1.5</span> SSH 접속 방법</h2>
<section id="기본-접속-비밀번호-인증" class="level3" data-number="1.5.1">
<h3 data-number="1.5.1" class="anchored" data-anchor-id="기본-접속-비밀번호-인증"><span class="header-section-number">1.5.1</span> 1. 기본 접속 (비밀번호 인증)</h3>
<p><strong>문법:</strong></p>
<div class="sourceCode" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb15-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ssh</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">옵션</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> 사용자명@호스트주소</span></code></pre></div>
<p><strong>예시:</strong></p>
<div class="sourceCode" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb16-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 기본 포트(22) 접속</span></span>
<span id="cb16-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ssh</span> ubuntu@192.168.1.100</span>
<span id="cb16-3"></span>
<span id="cb16-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 특정 포트 접속</span></span>
<span id="cb16-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ssh</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-p</span> 2222 ubuntu@192.168.1.100</span>
<span id="cb16-6"></span>
<span id="cb16-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 도메인으로 접속</span></span>
<span id="cb16-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ssh</span> admin@myserver.example.com</span>
<span id="cb16-9"></span>
<span id="cb16-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># IPv6 접속</span></span>
<span id="cb16-11"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ssh</span> user@2001:db8::1</span></code></pre></div>
<p><strong>클라우드 서버 접속:</strong></p>
<div class="sourceCode" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb17-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Azure VM</span></span>
<span id="cb17-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ssh</span> azureuser@20.196.144.16</span>
<span id="cb17-3"></span>
<span id="cb17-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># AWS EC2</span></span>
<span id="cb17-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ssh</span> ec2-user@ec2-1-2-3-4.compute-1.amazonaws.com</span>
<span id="cb17-6"></span>
<span id="cb17-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># GCP Compute Engine</span></span>
<span id="cb17-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ssh</span> user@35.192.0.1</span>
<span id="cb17-9"></span>
<span id="cb17-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># DigitalOcean Droplet</span></span>
<span id="cb17-11"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ssh</span> root@droplet-ip-address</span></code></pre></div>
<p><strong>On-Premise 서버 접속:</strong></p>
<div class="sourceCode" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb18-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 내부 네트워크 (사내 서버)</span></span>
<span id="cb18-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ssh</span> admin@192.168.10.50</span>
<span id="cb18-3"></span>
<span id="cb18-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># VPN 연결 후 접속</span></span>
<span id="cb18-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ssh</span> engineer@10.0.1.100</span>
<span id="cb18-6"></span>
<span id="cb18-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 점프 서버 (Bastion Host)를 통한 접속</span></span>
<span id="cb18-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ssh</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-J</span> jumpuser@jumphost.company.com user@internal-server</span></code></pre></div>
</section>
<section id="ssh-key-인증-권장" class="level3" data-number="1.5.2">
<h3 data-number="1.5.2" class="anchored" data-anchor-id="ssh-key-인증-권장"><span class="header-section-number">1.5.2</span> SSH Key 인증 (권장)</h3>
<p><strong>SSH Key 생성:</strong></p>
<div class="sourceCode" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb19-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Ed25519 알고리즘 (권장)</span></span>
<span id="cb19-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ssh-keygen</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-t</span> ed25519 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-C</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"your_email@example.com"</span></span>
<span id="cb19-3"></span>
<span id="cb19-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># RSA 4096 bit (레거시 호환)</span></span>
<span id="cb19-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ssh-keygen</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-t</span> rsa <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-b</span> 4096 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-C</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"your_email@example.com"</span></span>
<span id="cb19-6"></span>
<span id="cb19-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ECDSA (대안)</span></span>
<span id="cb19-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ssh-keygen</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-t</span> ecdsa <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-b</span> 521 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-C</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"your_email@example.com"</span></span></code></pre></div>
<p><strong>Key 생성 프로세스:</strong></p>
<div class="sourceCode" id="cb20" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb20-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Generating</span> public/private ed25519 key pair.</span>
<span id="cb20-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Enter</span> file in which to save the key <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/home/user/.ssh/id_ed25519</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> </span>
<span id="cb20-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">→</span> 엔터 <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">기본</span> 경로<span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">또는</span> custom_key 입력</span>
<span id="cb20-4"></span>
<span id="cb20-5"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Enter</span> passphrase <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">empty</span> for no passphrase<span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">)</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">:</span> </span>
<span id="cb20-6"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">→</span> 추가 보안을 위한 암호 <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">선택</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb20-7"></span>
<span id="cb20-8"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Enter</span> same passphrase again: </span>
<span id="cb20-9"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">→</span> 암호 재입력</span>
<span id="cb20-10"></span>
<span id="cb20-11"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Your</span> identification has been saved in /home/user/.ssh/id_ed25519</span>
<span id="cb20-12"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Your</span> public key has been saved in /home/user/.ssh/id_ed25519.pub</span>
<span id="cb20-13"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">The</span> key fingerprint is:</span>
<span id="cb20-14"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">SHA256:xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx</span> your_email@example.com</span></code></pre></div>
<p><strong>생성된 Key 확인:</strong></p>
<div class="sourceCode" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb21-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ls</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-la</span> ~/.ssh/</span>
<span id="cb21-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">-rw-------</span>  1 user user  464 Nov 28 10:00 id_ed25519      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Private Key</span></span>
<span id="cb21-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">-rw-r--r--</span>  1 user user  102 Nov 28 10:00 id_ed25519.pub  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Public Key</span></span></code></pre></div>
<p><strong>Public Key 서버에 등록:</strong></p>
<p><strong>방법 1: ssh-copy-id 사용 (자동)</strong></p>
<div class="sourceCode" id="cb22" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb22-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ssh-copy-id</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-i</span> ~/.ssh/id_ed25519.pub user@server-ip</span>
<span id="cb22-2"></span>
<span id="cb22-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 특정 포트</span></span>
<span id="cb22-4"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ssh-copy-id</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-i</span> ~/.ssh/id_ed25519.pub <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-p</span> 2222 user@server-ip</span></code></pre></div>
<p><strong>방법 2: 수동 복사</strong></p>
<div class="sourceCode" id="cb23" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb23-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 1. Public Key 내용 확인</span></span>
<span id="cb23-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span> ~/.ssh/id_ed25519.pub</span>
<span id="cb23-3"></span>
<span id="cb23-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 2. 서버에 로그인 (비밀번호)</span></span>
<span id="cb23-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ssh</span> user@server-ip</span>
<span id="cb23-6"></span>
<span id="cb23-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 3. .ssh 디렉토리 생성 (없다면)</span></span>
<span id="cb23-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mkdir</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-p</span> ~/.ssh</span>
<span id="cb23-9"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">chmod</span> 700 ~/.ssh</span>
<span id="cb23-10"></span>
<span id="cb23-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 4. authorized_keys 파일에 Public Key 추가</span></span>
<span id="cb23-12"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ssh-ed25519 AAAAC3Nza... your_email@example.com"</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span> ~/.ssh/authorized_keys</span>
<span id="cb23-13"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">chmod</span> 600 ~/.ssh/authorized_keys</span>
<span id="cb23-14"></span>
<span id="cb23-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 5. 로그아웃</span></span>
<span id="cb23-16"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">exit</span></span></code></pre></div>
<p><strong>방법 3: 클라우드 콘솔에서 등록</strong></p>
<div class="sourceCode" id="cb24" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb24-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Azure: VM 생성 시 또는 SSH Key 관리 메뉴</span></span>
<span id="cb24-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># AWS: EC2 Key Pairs 메뉴</span></span>
<span id="cb24-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># GCP: Metadata → SSH Keys 메뉴</span></span></code></pre></div>
<p><strong>Key로 접속:</strong></p>
<div class="sourceCode" id="cb25" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb25-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 기본 Key 사용 (id_ed25519 or id_rsa)</span></span>
<span id="cb25-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ssh</span> user@server-ip</span>
<span id="cb25-3"></span>
<span id="cb25-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 특정 Key 파일 지정</span></span>
<span id="cb25-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ssh</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-i</span> ~/.ssh/custom_key user@server-ip</span>
<span id="cb25-6"></span>
<span id="cb25-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Azure VM (.pem 파일)</span></span>
<span id="cb25-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ssh</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-i</span> ~/Downloads/azure-vm.pem azureuser@20.196.144.16</span>
<span id="cb25-9"></span>
<span id="cb25-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># AWS EC2 (.pem 파일)</span></span>
<span id="cb25-11"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ssh</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-i</span> ~/Downloads/aws-key.pem ec2-user@ec2-ip</span></code></pre></div>
</section>
</section>
<section id="ssh-config-파일로-접속-간소화" class="level2" data-number="1.6">
<h2 data-number="1.6" class="anchored" data-anchor-id="ssh-config-파일로-접속-간소화"><span class="header-section-number">1.6</span> SSH Config 파일로 접속 간소화</h2>
<section id="config-파일-생성" class="level3" data-number="1.6.1">
<h3 data-number="1.6.1" class="anchored" data-anchor-id="config-파일-생성"><span class="header-section-number">1.6.1</span> Config 파일 생성</h3>
<p><strong>위치:</strong> - <strong>Linux/macOS</strong>: <code>~/.ssh/config</code> - <strong>Windows</strong>: <code>C:\Users\username\.ssh\config</code></p>
<p><strong>기본 구조:</strong></p>
<div class="sourceCode" id="cb26" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb26-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ~/.ssh/config</span></span>
<span id="cb26-2"></span>
<span id="cb26-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Azure VM</span></span>
<span id="cb26-4"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Host</span> azure-dev</span>
<span id="cb26-5">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">HostName</span> 20.196.144.16</span>
<span id="cb26-6">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">User</span> azureuser</span>
<span id="cb26-7">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">IdentityFile</span> ~/.ssh/azure-vm.pem</span>
<span id="cb26-8">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Port</span> 22</span>
<span id="cb26-9"></span>
<span id="cb26-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># AWS EC2</span></span>
<span id="cb26-11"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Host</span> aws-prod</span>
<span id="cb26-12">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">HostName</span> ec2-1-2-3-4.compute-1.amazonaws.com</span>
<span id="cb26-13">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">User</span> ec2-user</span>
<span id="cb26-14">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">IdentityFile</span> ~/.ssh/aws-key.pem</span>
<span id="cb26-15">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Port</span> 22</span>
<span id="cb26-16"></span>
<span id="cb26-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># On-Premise 서버</span></span>
<span id="cb26-18"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Host</span> office-server</span>
<span id="cb26-19">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">HostName</span> 192.168.10.50</span>
<span id="cb26-20">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">User</span> admin</span>
<span id="cb26-21">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">IdentityFile</span> ~/.ssh/office_key</span>
<span id="cb26-22">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Port</span> 2222</span>
<span id="cb26-23"></span>
<span id="cb26-24"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># GitHub</span></span>
<span id="cb26-25"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Host</span> github.com</span>
<span id="cb26-26">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">HostName</span> github.com</span>
<span id="cb26-27">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">User</span> git</span>
<span id="cb26-28">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">IdentityFile</span> ~/.ssh/github_personal</span>
<span id="cb26-29">    </span>
<span id="cb26-30"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># GitLab (회사)</span></span>
<span id="cb26-31"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Host</span> gitlab-work</span>
<span id="cb26-32">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">HostName</span> gitlab.company.com</span>
<span id="cb26-33">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">User</span> git</span>
<span id="cb26-34">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">IdentityFile</span> ~/.ssh/gitlab_work</span>
<span id="cb26-35">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Port</span> 2222</span>
<span id="cb26-36"></span>
<span id="cb26-37"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Jump Host (Bastion)를 통한 접속</span></span>
<span id="cb26-38"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Host</span> internal-server</span>
<span id="cb26-39">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">HostName</span> 10.0.1.100</span>
<span id="cb26-40">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">User</span> engineer</span>
<span id="cb26-41">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ProxyJump</span> jumpuser@jumphost.company.com</span>
<span id="cb26-42">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">IdentityFile</span> ~/.ssh/internal_key</span></code></pre></div>
</section>
<section id="config-파일-고급-옵션" class="level3" data-number="1.6.2">
<h3 data-number="1.6.2" class="anchored" data-anchor-id="config-파일-고급-옵션"><span class="header-section-number">1.6.2</span> Config 파일 고급 옵션</h3>
<div class="sourceCode" id="cb27" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb27-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 연결 유지 (Keep Alive)</span></span>
<span id="cb27-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Host</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span></span>
<span id="cb27-3">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ServerAliveInterval</span> 60</span>
<span id="cb27-4">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ServerAliveCountMax</span> 3</span>
<span id="cb27-5">    </span>
<span id="cb27-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 연결 재사용 (속도 향상)</span></span>
<span id="cb27-7"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Host</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span></span>
<span id="cb27-8">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ControlMaster</span> auto</span>
<span id="cb27-9">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ControlPath</span> ~/.ssh/sockets/%r@%h-%p</span>
<span id="cb27-10">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ControlPersist</span> 600</span>
<span id="cb27-11"></span>
<span id="cb27-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 특정 호스트만 설정</span></span>
<span id="cb27-13"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Host</span> dev-<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span></span>
<span id="cb27-14">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">User</span> developer</span>
<span id="cb27-15">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">IdentityFile</span> ~/.ssh/dev_key</span>
<span id="cb27-16">    </span>
<span id="cb27-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 와일드카드 매칭</span></span>
<span id="cb27-18"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Host</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span>.example.com</span>
<span id="cb27-19">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">User</span> admin</span>
<span id="cb27-20">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Port</span> 2222</span>
<span id="cb27-21"></span>
<span id="cb27-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 로컬 포트 포워딩 (고정)</span></span>
<span id="cb27-23"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Host</span> db-tunnel</span>
<span id="cb27-24">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">HostName</span> db-server.company.com</span>
<span id="cb27-25">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">User</span> dbadmin</span>
<span id="cb27-26">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">LocalForward</span> 3306 localhost:3306</span>
<span id="cb27-27">    </span>
<span id="cb27-28"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 다이나믹 포트 포워딩 (SOCKS 프록시)</span></span>
<span id="cb27-29"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Host</span> proxy-server</span>
<span id="cb27-30">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">HostName</span> proxy.company.com</span>
<span id="cb27-31">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">User</span> proxyuser</span>
<span id="cb27-32">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">DynamicForward</span> 1080</span></code></pre></div>
</section>
<section id="config-사용-예시" class="level3" data-number="1.6.3">
<h3 data-number="1.6.3" class="anchored" data-anchor-id="config-사용-예시"><span class="header-section-number">1.6.3</span> Config 사용 예시</h3>
<p><strong>설정 전:</strong></p>
<div class="sourceCode" id="cb28" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb28-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ssh</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-i</span> ~/.ssh/azure-vm.pem <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-p</span> 22 azureuser@20.196.144.16</span></code></pre></div>
<p><strong>설정 후:</strong></p>
<div class="sourceCode" id="cb29" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb29-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ssh</span> azure-dev</span></code></pre></div>
<p><strong>자동 완성 (Tab):</strong></p>
<div class="sourceCode" id="cb30" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb30-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ssh</span> az<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">Tab</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>  → ssh azure-dev</span></code></pre></div>
</section>
</section>
<section id="ssh-다양한-사용-시나리오" class="level2" data-number="1.7">
<h2 data-number="1.7" class="anchored" data-anchor-id="ssh-다양한-사용-시나리오"><span class="header-section-number">1.7</span> SSH 다양한 사용 시나리오</h2>
<section id="파일-전송-scp" class="level3" data-number="1.7.1">
<h3 data-number="1.7.1" class="anchored" data-anchor-id="파일-전송-scp"><span class="header-section-number">1.7.1</span> 파일 전송 (SCP)</h3>
<p><strong>기본 문법:</strong></p>
<div class="sourceCode" id="cb31" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb31-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scp</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">옵션</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> 출발지 목적지</span></code></pre></div>
<p><strong>로컬 → 서버:</strong></p>
<div class="sourceCode" id="cb32" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb32-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 파일 복사</span></span>
<span id="cb32-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scp</span> file.txt user@server:/home/user/</span>
<span id="cb32-3"></span>
<span id="cb32-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 디렉토리 복사 (-r recursive)</span></span>
<span id="cb32-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scp</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-r</span> folder/ user@server:/home/user/</span>
<span id="cb32-6"></span>
<span id="cb32-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 특정 Key 사용</span></span>
<span id="cb32-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scp</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-i</span> ~/.ssh/custom_key file.txt user@server:/path/</span>
<span id="cb32-9"></span>
<span id="cb32-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 특정 포트</span></span>
<span id="cb32-11"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scp</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-P</span> 2222 file.txt user@server:/path/</span>
<span id="cb32-12"></span>
<span id="cb32-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Config 사용</span></span>
<span id="cb32-14"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scp</span> file.txt azure-dev:/home/azureuser/</span></code></pre></div>
<p><strong>서버 → 로컬:</strong></p>
<div class="sourceCode" id="cb33" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb33-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 파일 다운로드</span></span>
<span id="cb33-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scp</span> user@server:/home/user/file.txt ./</span>
<span id="cb33-3"></span>
<span id="cb33-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 디렉토리 다운로드</span></span>
<span id="cb33-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scp</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-r</span> user@server:/home/user/folder/ ./</span>
<span id="cb33-6"></span>
<span id="cb33-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 여러 파일</span></span>
<span id="cb33-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scp</span> user@server:<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/path/*.txt"</span> ./</span></code></pre></div>
<p><strong>서버 → 서버 (직접):</strong></p>
<div class="sourceCode" id="cb34" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb34-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scp</span> user1@server1:/path/file.txt user2@server2:/path/</span></code></pre></div>
<p><strong>SCP 옵션:</strong></p>
<table class="table">
<thead>
<tr class="header">
<th>옵션</th>
<th>설명</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>-r</code></td>
<td>디렉토리 재귀 복사</td>
</tr>
<tr class="even">
<td><code>-P</code></td>
<td>포트 지정</td>
</tr>
<tr class="odd">
<td><code>-i</code></td>
<td>Private Key 파일 지정</td>
</tr>
<tr class="even">
<td><code>-C</code></td>
<td>압축 전송 (대용량 파일)</td>
</tr>
<tr class="odd">
<td><code>-p</code></td>
<td>원본 파일의 권한/시간 보존</td>
</tr>
<tr class="even">
<td><code>-q</code></td>
<td>진행 상황 숨김</td>
</tr>
<tr class="odd">
<td><code>-v</code></td>
<td>상세 모드 (디버깅)</td>
</tr>
</tbody>
</table>
</section>
<section id="sftp-ssh-file-transfer-protocol" class="level3" data-number="1.7.2">
<h3 data-number="1.7.2" class="anchored" data-anchor-id="sftp-ssh-file-transfer-protocol"><span class="header-section-number">1.7.2</span> SFTP (SSH File Transfer Protocol)</h3>
<p><strong>접속:</strong></p>
<div class="sourceCode" id="cb35" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb35-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">sftp</span> user@server</span>
<span id="cb35-2"></span>
<span id="cb35-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Config 사용</span></span>
<span id="cb35-4"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">sftp</span> azure-dev</span></code></pre></div>
<p><strong>SFTP 명령어:</strong></p>
<div class="sourceCode" id="cb36" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb36-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">sftp</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> ls                    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 원격 디렉토리 목록</span></span>
<span id="cb36-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">sftp</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> lls                   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 로컬 디렉토리 목록</span></span>
<span id="cb36-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">sftp</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> pwd                   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 원격 현재 경로</span></span>
<span id="cb36-4"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">sftp</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> lpwd                  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 로컬 현재 경로</span></span>
<span id="cb36-5"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">sftp</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> cd /path              <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 원격 경로 이동</span></span>
<span id="cb36-6"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">sftp</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> lcd /path             <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 로컬 경로 이동</span></span>
<span id="cb36-7"></span>
<span id="cb36-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 파일 다운로드</span></span>
<span id="cb36-9"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">sftp</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> get remote_file.txt</span>
<span id="cb36-10"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">sftp</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> get <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-r</span> remote_folder/</span>
<span id="cb36-11"></span>
<span id="cb36-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 파일 업로드</span></span>
<span id="cb36-13"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">sftp</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> put local_file.txt</span>
<span id="cb36-14"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">sftp</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> put <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-r</span> local_folder/</span>
<span id="cb36-15"></span>
<span id="cb36-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 파일 삭제</span></span>
<span id="cb36-17"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">sftp</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> rm remote_file.txt</span>
<span id="cb36-18"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">sftp</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> rmdir remote_folder/</span>
<span id="cb36-19"></span>
<span id="cb36-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 권한 변경</span></span>
<span id="cb36-21"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">sftp</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> chmod 644 file.txt</span>
<span id="cb36-22"></span>
<span id="cb36-23"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 종료</span></span>
<span id="cb36-24"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">sftp</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> exit</span></code></pre></div>
</section>
<section id="포트-포워딩-port-forwarding" class="level3" data-number="1.7.3">
<h3 data-number="1.7.3" class="anchored" data-anchor-id="포트-포워딩-port-forwarding"><span class="header-section-number">1.7.3</span> 포트 포워딩 (Port Forwarding)</h3>
<p><strong>로컬 포트 포워딩 (Local Forward):</strong></p>
<div class="sourceCode" id="cb37" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb37-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 기본 문법</span></span>
<span id="cb37-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ssh</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-L</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">로컬포트</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>:목적지:목적지포트 user@server</span>
<span id="cb37-3"></span>
<span id="cb37-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 예: 원격 MySQL 접속</span></span>
<span id="cb37-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ssh</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-L</span> 3306:localhost:3306 user@db-server</span>
<span id="cb37-6"></span>
<span id="cb37-7"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">→</span> localhost:3306 접속 시 db-server의 3306으로 터널링</span>
<span id="cb37-8"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">→</span> MySQL Workbench에서 localhost:3306으로 연결</span></code></pre></div>
<p><strong>실무 예시:</strong></p>
<div class="sourceCode" id="cb38" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb38-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 원격 데이터베이스 접속</span></span>
<span id="cb38-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ssh</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-L</span> 3306:localhost:3306 admin@db.company.com</span>
<span id="cb38-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mysql</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-h</span> localhost <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-P</span> 3306 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-u</span> dbuser <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-p</span></span>
<span id="cb38-4"></span>
<span id="cb38-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 원격 웹 서버 접속 (방화벽 우회)</span></span>
<span id="cb38-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ssh</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-L</span> 8080:localhost:80 user@web-server</span>
<span id="cb38-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 브라우저: http://localhost:8080</span></span>
<span id="cb38-8"></span>
<span id="cb38-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Jupyter Notebook 원격 접속</span></span>
<span id="cb38-10"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ssh</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-L</span> 8888:localhost:8888 user@ml-server</span>
<span id="cb38-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 브라우저: http://localhost:8888</span></span></code></pre></div>
<p><strong>리모트 포트 포워딩 (Remote Forward):</strong></p>
<div class="sourceCode" id="cb39" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb39-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 기본 문법</span></span>
<span id="cb39-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ssh</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-R</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">원격포트</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>:목적지:목적지포트 user@server</span>
<span id="cb39-3"></span>
<span id="cb39-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 예: 로컬 웹서버를 원격에서 접근 가능하게</span></span>
<span id="cb39-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ssh</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-R</span> 8080:localhost:80 user@public-server</span>
<span id="cb39-6"></span>
<span id="cb39-7"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">→</span> public-server의 8080 포트가 로컬 80 포트로 연결</span>
<span id="cb39-8"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">→</span> 로컬 개발 서버를 외부에 공개 <span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">데모/테스트</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<p><strong>다이나믹 포트 포워딩 (SOCKS 프록시):</strong></p>
<div class="sourceCode" id="cb40" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb40-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 기본 문법</span></span>
<span id="cb40-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ssh</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-D</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">로컬포트</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span> user@server</span>
<span id="cb40-3"></span>
<span id="cb40-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 예: SOCKS 프록시 생성</span></span>
<span id="cb40-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ssh</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-D</span> 1080 user@proxy-server</span>
<span id="cb40-6"></span>
<span id="cb40-7"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">→</span> 브라우저 SOCKS 프록시 설정: localhost:1080</span>
<span id="cb40-8"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">→</span> 모든 트래픽이 proxy-server를 경유</span>
<span id="cb40-9"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">→</span> 회사 내부망 접근, 지역 제한 우회</span></code></pre></div>
<p><strong>백그라운드 실행:</strong></p>
<div class="sourceCode" id="cb41" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb41-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># -f: 백그라운드</span></span>
<span id="cb41-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># -N: 명령 실행 안 함 (포워딩만)</span></span>
<span id="cb41-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ssh</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-f</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-N</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-L</span> 3306:localhost:3306 user@db-server</span></code></pre></div>
</section>
<section id="ssh-터널링-tunneling" class="level3" data-number="1.7.4">
<h3 data-number="1.7.4" class="anchored" data-anchor-id="ssh-터널링-tunneling"><span class="header-section-number">1.7.4</span> SSH 터널링 (Tunneling)</h3>
<p><strong>다중 홉 터널링:</strong></p>
<div class="sourceCode" id="cb42" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb42-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 점프 서버를 통한 접속</span></span>
<span id="cb42-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ssh</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-J</span> jumpuser@jumphost user@internal-server</span>
<span id="cb42-3"></span>
<span id="cb42-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 여러 점프 서버</span></span>
<span id="cb42-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ssh</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-J</span> jump1@host1,jump2@host2 user@final-server</span>
<span id="cb42-6"></span>
<span id="cb42-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ProxyCommand 사용 (Config)</span></span>
<span id="cb42-8"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Host</span> internal-server</span>
<span id="cb42-9">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">HostName</span> 10.0.1.100</span>
<span id="cb42-10">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">User</span> engineer</span>
<span id="cb42-11">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ProxyCommand</span> ssh <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-W</span> %h:%p jumphost</span></code></pre></div>
<p><strong>SSH VPN (Poor Man’s VPN):</strong></p>
<div class="sourceCode" id="cb43" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb43-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># tun 장치를 사용한 터널링</span></span>
<span id="cb43-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sudo</span> ssh <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-w</span> 0:0 user@server</span>
<span id="cb43-3"></span>
<span id="cb43-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 서버 측 설정 필요:</span></span>
<span id="cb43-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># /etc/ssh/sshd_config</span></span>
<span id="cb43-6"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">PermitTunnel</span> yes</span></code></pre></div>
</section>
<section id="원격-명령-실행" class="level3" data-number="1.7.5">
<h3 data-number="1.7.5" class="anchored" data-anchor-id="원격-명령-실행"><span class="header-section-number">1.7.5</span> 원격 명령 실행</h3>
<p><strong>단일 명령:</strong></p>
<div class="sourceCode" id="cb44" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb44-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 명령 실행 후 종료</span></span>
<span id="cb44-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ssh</span> user@server <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ls -la /var/log"</span></span>
<span id="cb44-3"></span>
<span id="cb44-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 여러 명령 (세미콜론)</span></span>
<span id="cb44-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ssh</span> user@server <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"cd /var/www; git pull; sudo systemctl restart nginx"</span></span>
<span id="cb44-6"></span>
<span id="cb44-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 환경 변수 포함</span></span>
<span id="cb44-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ssh</span> user@server <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"export PATH=/opt/bin:</span><span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\$</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">PATH; mycommand"</span></span></code></pre></div>
<p><strong>스크립트 실행:</strong></p>
<div class="sourceCode" id="cb45" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb45-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 로컬 스크립트를 원격에서 실행</span></span>
<span id="cb45-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ssh</span> user@server <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'bash -s'</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> local_script.sh</span>
<span id="cb45-3"></span>
<span id="cb45-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 파이프라인</span></span>
<span id="cb45-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span> local_file.txt <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ssh</span> user@server <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'cat &gt; remote_file.txt'</span></span></code></pre></div>
<p><strong>여러 서버 동시 실행:</strong></p>
<div class="sourceCode" id="cb46" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb46-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># parallel-ssh 사용</span></span>
<span id="cb46-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sudo</span> apt install pssh</span>
<span id="cb46-3"></span>
<span id="cb46-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 서버 목록 작성 (hosts.txt)</span></span>
<span id="cb46-5"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">user@server1</span></span>
<span id="cb46-6"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">user@server2</span></span>
<span id="cb46-7"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">user@server3</span></span>
<span id="cb46-8"></span>
<span id="cb46-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 동시 실행</span></span>
<span id="cb46-10"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">parallel-ssh</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-h</span> hosts.txt <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-l</span> user <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sudo apt update &amp;&amp; sudo apt upgrade -y"</span></span></code></pre></div>
</section>
<section id="x11-포워딩-gui-애플리케이션" class="level3" data-number="1.7.6">
<h3 data-number="1.7.6" class="anchored" data-anchor-id="x11-포워딩-gui-애플리케이션"><span class="header-section-number">1.7.6</span> X11 포워딩 (GUI 애플리케이션)</h3>
<p><strong>X11 포워딩 활성화:</strong></p>
<div class="sourceCode" id="cb47" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb47-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 접속 시 -X 옵션</span></span>
<span id="cb47-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ssh</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-X</span> user@server</span>
<span id="cb47-3"></span>
<span id="cb47-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># GUI 애플리케이션 실행</span></span>
<span id="cb47-5"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">firefox</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">&amp;</span></span>
<span id="cb47-6"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">gedit</span> myfile.txt <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">&amp;</span></span></code></pre></div>
<p><strong>서버 설정 필요:</strong></p>
<div class="sourceCode" id="cb48" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb48-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># /etc/ssh/sshd_config</span></span>
<span id="cb48-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">X11Forwarding</span> yes</span>
<span id="cb48-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">X11UseLocalhost</span> yes</span></code></pre></div>
</section>
<section id="ssh-에이전트-ssh-agent" class="level3" data-number="1.7.7">
<h3 data-number="1.7.7" class="anchored" data-anchor-id="ssh-에이전트-ssh-agent"><span class="header-section-number">1.7.7</span> SSH 에이전트 (ssh-agent)</h3>
<p><strong>에이전트 시작:</strong></p>
<div class="sourceCode" id="cb49" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb49-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 에이전트 시작</span></span>
<span id="cb49-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">eval</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ssh-agent</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-s</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb49-3"></span>
<span id="cb49-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Key 추가</span></span>
<span id="cb49-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ssh-add</span> ~/.ssh/id_ed25519</span>
<span id="cb49-6"></span>
<span id="cb49-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Passphrase 입력 (한 번만)</span></span>
<span id="cb49-8"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Enter</span> passphrase for /home/user/.ssh/id_ed25519:</span>
<span id="cb49-9"></span>
<span id="cb49-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 등록된 Key 확인</span></span>
<span id="cb49-11"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ssh-add</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-l</span></span></code></pre></div>
<p><strong>에이전트 포워딩:</strong></p>
<div class="sourceCode" id="cb50" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb50-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 로컬 Key를 원격에서도 사용</span></span>
<span id="cb50-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ssh</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-A</span> user@jumphost</span>
<span id="cb50-3"></span>
<span id="cb50-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># jumphost에서 다른 서버 접속 시 로컬 Key 사용</span></span>
<span id="cb50-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ssh</span> user@internal-server  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Key 재입력 불필요</span></span></code></pre></div>
<p><strong>Config에서 설정:</strong></p>
<div class="sourceCode" id="cb51" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb51-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Host</span> jumphost</span>
<span id="cb51-2">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">HostName</span> jumphost.company.com</span>
<span id="cb51-3">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ForwardAgent</span> yes</span></code></pre></div>
</section>
<section id="ssh를-활용한-백업" class="level3" data-number="1.7.8">
<h3 data-number="1.7.8" class="anchored" data-anchor-id="ssh를-활용한-백업"><span class="header-section-number">1.7.8</span> SSH를 활용한 백업</h3>
<p><strong>rsync over SSH:</strong></p>
<div class="sourceCode" id="cb52" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb52-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 기본 백업</span></span>
<span id="cb52-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rsync</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-avz</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-e</span> ssh /local/data/ user@backup-server:/remote/backup/</span>
<span id="cb52-3"></span>
<span id="cb52-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 진행 상황 표시</span></span>
<span id="cb52-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rsync</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-avzP</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-e</span> ssh /local/data/ user@backup-server:/remote/backup/</span>
<span id="cb52-6"></span>
<span id="cb52-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 삭제된 파일 동기화</span></span>
<span id="cb52-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rsync</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-avz</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--delete</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-e</span> ssh /local/data/ user@backup-server:/remote/backup/</span>
<span id="cb52-9"></span>
<span id="cb52-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 특정 파일 제외</span></span>
<span id="cb52-11"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rsync</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-avz</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--exclude</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'*.log'</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-e</span> ssh /local/data/ user@backup-server:/remote/backup/</span></code></pre></div>
<p><strong>rsync 옵션:</strong></p>
<table class="table">
<thead>
<tr class="header">
<th>옵션</th>
<th>설명</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>-a</code></td>
<td>아카이브 모드 (권한, 소유자, 시간 보존)</td>
</tr>
<tr class="even">
<td><code>-v</code></td>
<td>상세 출력</td>
</tr>
<tr class="odd">
<td><code>-z</code></td>
<td>압축 전송</td>
</tr>
<tr class="even">
<td><code>-P</code></td>
<td>진행 상황 표시 + 중단 시 이어받기</td>
</tr>
<tr class="odd">
<td><code>--delete</code></td>
<td>목적지에서 삭제된 파일 제거</td>
</tr>
<tr class="even">
<td><code>--exclude</code></td>
<td>특정 패턴 제외</td>
</tr>
</tbody>
</table>
</section>
<section id="ssh-bastion-host-jump-server" class="level3" data-number="1.7.9">
<h3 data-number="1.7.9" class="anchored" data-anchor-id="ssh-bastion-host-jump-server"><span class="header-section-number">1.7.9</span> SSH Bastion Host (Jump Server)</h3>
<p><strong>Bastion Host 아키텍처:</strong></p>
<pre><code>인터넷                    회사 방화벽              내부 네트워크
   │                          │                      │
   │                     ┌────────┐                  │
   │──────────────────&gt;  │ Bastion│                  │
   │   (SSH 22)          │ Host   │                  │
   │                     └────┬───┘                  │
   │                          │                      │
   │                          │   SSH                │
   │                          ├──────────&gt; Server 1  │
   │                          │            Server 2  │
   │                          └──────────&gt; Server 3  │
   
특징:
- 외부에서 직접 내부 서버 접속 불가
- Bastion Host만 외부 노출
- 모든 접속은 Bastion을 경유
- 접속 로그 중앙 관리</code></pre>
<p><strong>Bastion 통한 접속:</strong></p>
<div class="sourceCode" id="cb54" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb54-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ProxyJump 사용 (SSH 7.3+)</span></span>
<span id="cb54-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ssh</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-J</span> bastion-user@bastion.company.com internal-user@10.0.1.100</span>
<span id="cb54-3"></span>
<span id="cb54-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Config 설정</span></span>
<span id="cb54-5"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Host</span> bastion</span>
<span id="cb54-6">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">HostName</span> bastion.company.com</span>
<span id="cb54-7">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">User</span> bastion-user</span>
<span id="cb54-8">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">IdentityFile</span> ~/.ssh/bastion_key</span>
<span id="cb54-9"></span>
<span id="cb54-10"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Host</span> internal-<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span></span>
<span id="cb54-11">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">User</span> internal-user</span>
<span id="cb54-12">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ProxyJump</span> bastion</span>
<span id="cb54-13">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">IdentityFile</span> ~/.ssh/internal_key</span>
<span id="cb54-14"></span>
<span id="cb54-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 접속</span></span>
<span id="cb54-16"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ssh</span> internal-db-server</span></code></pre></div>
</section>
</section>
<section id="ssh-보안-강화" class="level2" data-number="1.8">
<h2 data-number="1.8" class="anchored" data-anchor-id="ssh-보안-강화"><span class="header-section-number">1.8</span> SSH 보안 강화</h2>
<section id="key-기반-인증-강제" class="level3" data-number="1.8.1">
<h3 data-number="1.8.1" class="anchored" data-anchor-id="key-기반-인증-강제"><span class="header-section-number">1.8.1</span> Key 기반 인증 강제</h3>
<div class="sourceCode" id="cb55" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb55-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># /etc/ssh/sshd_config</span></span>
<span id="cb55-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">PasswordAuthentication</span> no</span>
<span id="cb55-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">PubkeyAuthentication</span> yes</span></code></pre></div>
</section>
<section id="포트-변경" class="level3" data-number="1.8.2">
<h3 data-number="1.8.2" class="anchored" data-anchor-id="포트-변경"><span class="header-section-number">1.8.2</span> 포트 변경</h3>
<div class="sourceCode" id="cb56" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb56-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 기본 22 → 다른 포트 (예: 2222)</span></span>
<span id="cb56-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">Port</span> 2222</span>
<span id="cb56-3"></span>
<span id="cb56-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 재시작</span></span>
<span id="cb56-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sudo</span> systemctl restart sshd</span></code></pre></div>
</section>
<section id="root-로그인-금지" class="level3" data-number="1.8.3">
<h3 data-number="1.8.3" class="anchored" data-anchor-id="root-로그인-금지"><span class="header-section-number">1.8.3</span> Root 로그인 금지</h3>
<div class="sourceCode" id="cb57" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb57-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">PermitRootLogin</span> no</span></code></pre></div>
</section>
<section id="특정-사용자만-허용" class="level3" data-number="1.8.4">
<h3 data-number="1.8.4" class="anchored" data-anchor-id="특정-사용자만-허용"><span class="header-section-number">1.8.4</span> 특정 사용자만 허용</h3>
<div class="sourceCode" id="cb58" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb58-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">AllowUsers</span> alice bob charlie</span></code></pre></div>
</section>
<section id="fail2ban-설치-brute-force-방어" class="level3" data-number="1.8.5">
<h3 data-number="1.8.5" class="anchored" data-anchor-id="fail2ban-설치-brute-force-방어"><span class="header-section-number">1.8.5</span> Fail2Ban 설치 (Brute-force 방어)</h3>
<div class="sourceCode" id="cb59" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb59-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Ubuntu/Debian</span></span>
<span id="cb59-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sudo</span> apt install fail2ban <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-y</span></span>
<span id="cb59-3"></span>
<span id="cb59-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 설정</span></span>
<span id="cb59-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sudo</span> nano /etc/fail2ban/jail.local</span>
<span id="cb59-6"></span>
<span id="cb59-7"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">[sshd]</span></span>
<span id="cb59-8"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">enabled</span> = true</span>
<span id="cb59-9"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">port</span> = 22</span>
<span id="cb59-10"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">filter</span> = sshd</span>
<span id="cb59-11"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">logpath</span> = /var/log/auth.log</span>
<span id="cb59-12"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">maxretry</span> = 3</span>
<span id="cb59-13"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">bantime</span> = 3600</span>
<span id="cb59-14"></span>
<span id="cb59-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 재시작</span></span>
<span id="cb59-16"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sudo</span> systemctl restart fail2ban</span></code></pre></div>
</section>
<section id="fa-two-factor-authentication" class="level3" data-number="1.8.6">
<h3 data-number="1.8.6" class="anchored" data-anchor-id="fa-two-factor-authentication"><span class="header-section-number">1.8.6</span> 2FA (Two-Factor Authentication)</h3>
<div class="sourceCode" id="cb60" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb60-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Google Authenticator 설치</span></span>
<span id="cb60-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sudo</span> apt install libpam-google-authenticator <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-y</span></span>
<span id="cb60-3"></span>
<span id="cb60-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 사용자별 설정</span></span>
<span id="cb60-5"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">google-authenticator</span></span>
<span id="cb60-6"></span>
<span id="cb60-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># PAM 설정</span></span>
<span id="cb60-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sudo</span> nano /etc/pam.d/sshd</span>
<span id="cb60-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 추가:</span></span>
<span id="cb60-10"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">auth</span> required pam_google_authenticator.so</span>
<span id="cb60-11"></span>
<span id="cb60-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># SSH 설정</span></span>
<span id="cb60-13"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sudo</span> nano /etc/ssh/sshd_config</span>
<span id="cb60-14"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ChallengeResponseAuthentication</span> yes</span>
<span id="cb60-15"></span>
<span id="cb60-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 재시작</span></span>
<span id="cb60-17"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sudo</span> systemctl restart sshd</span></code></pre></div>
</section>
</section>
<section id="ssh-문제-해결" class="level2" data-number="1.9">
<h2 data-number="1.9" class="anchored" data-anchor-id="ssh-문제-해결"><span class="header-section-number">1.9</span> SSH 문제 해결</h2>
<section id="연결-문제-진단" class="level3" data-number="1.9.1">
<h3 data-number="1.9.1" class="anchored" data-anchor-id="연결-문제-진단"><span class="header-section-number">1.9.1</span> 연결 문제 진단</h3>
<p><strong>상세 모드 (-v):</strong></p>
<div class="sourceCode" id="cb61" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb61-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ssh</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-v</span> user@server      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Verbose</span></span>
<span id="cb61-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ssh</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-vv</span> user@server     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># More verbose</span></span>
<span id="cb61-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ssh</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-vvv</span> user@server    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Debug mode</span></span></code></pre></div>
<p><strong>일반적인 오류와 해결:</strong></p>
<p><strong>1. Permission denied (publickey)</strong></p>
<div class="sourceCode" id="cb62" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb62-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 원인: Public Key가 서버에 등록되지 않음</span></span>
<span id="cb62-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 해결:</span></span>
<span id="cb62-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ssh-copy-id</span> user@server</span>
<span id="cb62-4"></span>
<span id="cb62-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 또는 수동으로 ~/.ssh/authorized_keys에 추가</span></span></code></pre></div>
<p><strong>2. Connection refused</strong></p>
<div class="sourceCode" id="cb63" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb63-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 원인: SSH 서버 미실행 또는 방화벽 차단</span></span>
<span id="cb63-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 해결:</span></span>
<span id="cb63-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sudo</span> systemctl status sshd  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 서버 상태 확인</span></span>
<span id="cb63-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sudo</span> systemctl start sshd   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 서버 시작</span></span>
<span id="cb63-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sudo</span> ufw allow 22/tcp       <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 방화벽 허용</span></span></code></pre></div>
<p><strong>3. WARNING: REMOTE HOST IDENTIFICATION HAS CHANGED</strong></p>
<div class="sourceCode" id="cb64" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb64-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 원인: 서버 재설치 또는 중간자 공격</span></span>
<span id="cb64-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 해결 (서버 재설치 확실한 경우):</span></span>
<span id="cb64-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ssh-keygen</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-R</span> server-ip</span>
<span id="cb64-4"></span>
<span id="cb64-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># known_hosts에서 해당 호스트 제거</span></span></code></pre></div>
<p><strong>4. Permission denied for .ssh directory</strong></p>
<div class="sourceCode" id="cb65" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb65-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 원인: 권한 설정 오류</span></span>
<span id="cb65-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 해결:</span></span>
<span id="cb65-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">chmod</span> 700 ~/.ssh</span>
<span id="cb65-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">chmod</span> 600 ~/.ssh/authorized_keys</span>
<span id="cb65-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">chmod</span> 600 ~/.ssh/id_ed25519</span>
<span id="cb65-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">chmod</span> 644 ~/.ssh/id_ed25519.pub</span></code></pre></div>
<p><strong>5. Too many authentication failures</strong></p>
<div class="sourceCode" id="cb66" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb66-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 원인: 여러 Key 시도 후 제한 도달</span></span>
<span id="cb66-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 해결: 특정 Key만 지정</span></span>
<span id="cb66-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ssh</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-o</span> IdentitiesOnly=yes <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-i</span> ~/.ssh/specific_key user@server</span></code></pre></div>
</section>
</section>
<section id="ssh-활용-시나리오-요약" class="level2" data-number="1.10">
<h2 data-number="1.10" class="anchored" data-anchor-id="ssh-활용-시나리오-요약"><span class="header-section-number">1.10</span> SSH 활용 시나리오 요약</h2>
<table class="table">
<colgroup>
<col style="width: 41%">
<col style="width: 33%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header">
<th>시나리오</th>
<th>명령어</th>
<th>용도</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>기본 접속</strong></td>
<td><code>ssh user@server</code></td>
<td>원격 서버 로그인</td>
</tr>
<tr class="even">
<td><strong>Key 인증</strong></td>
<td><code>ssh -i ~/.ssh/key user@server</code></td>
<td>안전한 Key 기반 인증</td>
</tr>
<tr class="odd">
<td><strong>Config 사용</strong></td>
<td><code>ssh alias-name</code></td>
<td>접속 명령 간소화</td>
</tr>
<tr class="even">
<td><strong>파일 전송</strong></td>
<td><code>scp file user@server:/path</code></td>
<td>단순 파일 복사</td>
</tr>
<tr class="odd">
<td><strong>디렉토리 동기화</strong></td>
<td><code>rsync -avz dir/ user@server:/path</code></td>
<td>백업/동기화</td>
</tr>
<tr class="even">
<td><strong>DB 터널링</strong></td>
<td><code>ssh -L 3306:localhost:3306 user@db</code></td>
<td>원격 DB 로컬 접속</td>
</tr>
<tr class="odd">
<td><strong>SOCKS 프록시</strong></td>
<td><code>ssh -D 1080 user@server</code></td>
<td>전체 트래픽 프록시</td>
</tr>
<tr class="even">
<td><strong>점프 서버</strong></td>
<td><code>ssh -J jump user@internal</code></td>
<td>Bastion 경유 접속</td>
</tr>
<tr class="odd">
<td><strong>원격 명령</strong></td>
<td><code>ssh user@server "command"</code></td>
<td>명령 실행 후 종료</td>
</tr>
<tr class="even">
<td><strong>GUI 실행</strong></td>
<td><code>ssh -X user@server</code></td>
<td>X11 포워딩</td>
</tr>
</tbody>
</table>
</section>
<section id="마무리" class="level2" data-number="1.11">
<h2 data-number="1.11" class="anchored" data-anchor-id="마무리"><span class="header-section-number">1.11</span> 마무리</h2>
<p>SSH는 현대 인프라 관리의 핵심 도구다. 클라우드든 On-Premise든 관계없이 안전하고 효율적인 원격 접속을 제공한다. Key 기반 인증, Config 파일, 포트 포워딩, Bastion Host 등을 적절히 활용하면 보안과 생산성을 동시에 향상시킬 수 있다.</p>
<p><strong>핵심 원칙:</strong> 1. <strong>비밀번호 대신 Key 인증 사용</strong> 2. <strong>Config 파일로 관리 간소화</strong> 3. <strong>Private Key는 절대 공유/업로드 금지</strong> 4. <strong>서버 보안 설정 강화 (Root 금지, 포트 변경, Fail2Ban)</strong> 5. <strong>정기적인 Key 갱신 및 권한 검토</strong></p>


</section>
</section>

 ]]></description>
  <category>Engineering</category>
  <category>Infrastructure</category>
  <category>Security</category>
  <category>DevOps</category>
  <category>Cloud</category>
  <category>On-Premise</category>
  <guid>kk3225.netlify.app/docs/blog/posts/Engineering/Infra/Security/ssh.html</guid>
  <pubDate>Thu, 27 Nov 2025 15:00:00 GMT</pubDate>
</item>
<item>
  <title>Agent 개발을 위한 Poetry로 Python 가상환경 관리하기</title>
  <dc:creator>Kwangmin Kim</dc:creator>
  <link>kk3225.netlify.app/docs/blog/posts/Engineering/DevOps/2-vm_venv_setup.html</link>
  <description><![CDATA[ 





<section id="poetry를-활용한-dependency-관리" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="poetry를-활용한-dependency-관리"><span class="header-section-number">1</span> Poetry를 활용한 Dependency 관리</h2>
<p>Poetry는 Python 프로젝트의 <strong>의존성 관리</strong>와 <strong>패키징</strong>을 위한 현대적인 도구다.</p>
<section id="poetry의-장점" class="level3" data-number="1.1">
<h3 data-number="1.1" class="anchored" data-anchor-id="poetry의-장점"><span class="header-section-number">1.1</span> Poetry의 장점</h3>
<ul>
<li>의존성 관리: <code>pyproject.toml</code> 파일로 모든 패키지 버전 관리</li>
<li>가상환경 자동 생성: 프로젝트별로 독립된 Python 환경 자동 구축</li>
<li>Lock 파일: <code>poetry.lock</code>으로 정확한 버전 재현 가능</li>
<li>패키징: 배포용 패키지 빌드 자동화</li>
<li>개발/운영 분리: 개발용/프로덕션용 디펜던시 구분 관리</li>
</ul>
</section>
<section id="pip-vs-poetry" class="level3" data-number="1.2">
<h3 data-number="1.2" class="anchored" data-anchor-id="pip-vs-poetry"><span class="header-section-number">1.2</span> pip vs Poetry</h3>
<table class="table">
<colgroup>
<col style="width: 16%">
<col style="width: 61%">
<col style="width: 22%">
</colgroup>
<thead>
<tr class="header">
<th>항목</th>
<th>pip + requirements.txt</th>
<th>Poetry</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>설정 파일</td>
<td><code>requirements.txt</code> (수동 관리)</td>
<td><code>pyproject.toml</code> (자동 생성)</td>
</tr>
<tr class="even">
<td>버전 고정</td>
<td>수동으로 작성</td>
<td><code>poetry.lock</code> 자동 생성</td>
</tr>
<tr class="odd">
<td>가상환경</td>
<td>별도 도구 필요 (venv, virtualenv)</td>
<td>내장 기능</td>
</tr>
<tr class="even">
<td>의존성 해결</td>
<td>충돌 시 수동 해결</td>
<td>자동 해결</td>
</tr>
<tr class="odd">
<td>개발/운영 분리</td>
<td>별도 파일 필요</td>
<td>하나의 파일로 관리</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="프로젝트-생성-및-설정" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="프로젝트-생성-및-설정"><span class="header-section-number">2</span> 프로젝트 생성 및 설정</h2>
<ul>
<li><a href="https://python-poetry.org/docs/cli/">Poetry cli 명령어 공식 목록-https://python-poetry.org/docs/cli/</a></li>
</ul>
<section id="새-프로젝트-생성" class="level3" data-number="2.1">
<h3 data-number="2.1" class="anchored" data-anchor-id="새-프로젝트-생성"><span class="header-section-number">2.1</span> 새 프로젝트 생성</h3>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 수동 생성</span></span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mkdir</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-p</span> ~/projects/insilico</span>
<span id="cb1-3"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> ~/projects/insilico</span>
<span id="cb1-4"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">pyenv</span> local 3.11.10</span></code></pre></div>
<pre><code>#생성된 디렉토리 구조
insilico/
├── pyproject.toml
└── main.py          # ← 소스 코드는 루트에 (또는 직접 src/ 생성)</code></pre>
<ul>
<li>폴더 생성: 수동</li>
<li>프로젝트 구조: insilico/ (빈 폴더)</li>
<li>pyproject.toml: 대화형으로 생성</li>
<li>소스 폴더: 없음 (직접 생성 필요)</li>
<li>tests 폴더: 없음 (직접 생성 필요)</li>
<li>README.md: 없음 (직접 생성 필요)</li>
<li>Python 버전: pyenv local 3.11.10으로 명시</li>
</ul>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 자동생성</span></span>
<span id="cb3-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">poetry</span> new insilico</span>
<span id="cb3-3"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> insilico</span></code></pre></div>
<pre><code>#생성된 디렉토리 구조
insilico/
├── pyproject.toml
├── README.md
├── insilico/        # ← 소스 코드는 여기
│   └── __init__.py
└── tests/</code></pre>
<ul>
<li>폴더 생성: 자동 (중첩 구조)</li>
<li>프로젝트 구조: insilico/insilico/ (패키지 폴더 포함)</li>
<li>pyproject.toml: 자동 생성 (기본값)</li>
<li>소스 폴더: insilico/ 자동 생성</li>
<li>tests 폴더: 자동 생성</li>
<li>README.md: 자동 생성</li>
<li>Python 버전: 시스템 기본값</li>
</ul>
<p><strong>본인은 수동으로 다음과 같이 생성</strong></p>
<ul>
<li>본인은 poetry 어떻게 동작하는지 알고싶어서 수동으로 생성했지만 자동 생성도 괜찮음</li>
</ul>
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 1. 폴더 생성 및 Python 버전 고정</span></span>
<span id="cb5-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mkdir</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-p</span> ~/projects/insilico</span>
<span id="cb5-3"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> ~/projects/insilico</span>
<span id="cb5-4"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">pyenv</span> local 3.11.10</span>
<span id="cb5-5"></span>
<span id="cb5-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 2. Poetry 초기화</span></span>
<span id="cb5-7"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">poetry</span> init <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># pyproject.toml 파일을 생성</span></span></code></pre></div>
<ul>
<li>아래는 <code>poetry init</code> 실행으로 인해 <code>pyproject.toml</code> 파일을 생성하기 위해 나타나는 대화형 질문들이다.</li>
</ul>
<pre><code>Package name [insilico]: insilico
Version [0.1.0]: 0.1.0
Description []: AI Agent Development Using LangChain &amp; LangGraph
Author [kmkim, n to skip]: 
License []: MIT
Compatible Python versions [^3.11]: ^3.11 
Would you like to define your main dependencies interactively? (yes/no) [yes] no
Would you like to define your development dependencies interactively? (yes/no) [yes] no

Do you confirm generation? (yes/no) [yes] yes</code></pre>
<div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb7-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 3. 수동으로 구조 생성</span></span>
<span id="cb7-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mkdir</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-p</span> insilico tests</span>
<span id="cb7-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">touch</span> insilico/__init__.py tests/__init__.py</span>
<span id="cb7-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">touch</span> README.md</span></code></pre></div>
<pre><code>insilico/                      # 프로젝트 루트 폴더
├── pyproject.toml            # 자동 생성 (기본 설정 포함)
├── README.md                 # 수동 생성 
├── src/                 # 수동 생성
└── tests/                    # 수동 생성</code></pre>
<ul>
<li>수동으로 하든 자동으로 하든 후에 <code>pyproject.toml</code>만 잘 작성해주면 아무 문제 없음</li>
</ul>
</section>
<section id="poetry-가상-환경-생성" class="level3" data-number="2.2">
<h3 data-number="2.2" class="anchored" data-anchor-id="poetry-가상-환경-생성"><span class="header-section-number">2.2</span> Poetry 가상 환경 생성</h3>
<ul>
<li>기존 pyproject.toml이 있을때 가상환경 생성</li>
</ul>
<div class="sourceCode" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb9-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 기존 pyproject.toml이 있을때, 가상환경 생성 (자동으로 .venv 폴더에 생성)</span></span>
<span id="cb9-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">poetry</span> install </span></code></pre></div>
<ul>
<li><code>install</code>: The install command reads the pyproject.toml file from the current project, resolves the dependencies, and installs them.</li>
<li>이때 가상환경 생성됨</li>
<li><code>.venv/</code> 폴더 생성</li>
<li><code>poetry.lock</code> 생성</li>
<li><code>pyproject.toml</code>에 정의된 패키지 설치</li>
</ul>
<div class="sourceCode" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb10-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">poetry</span> env list</span></code></pre></div>
<pre><code>insilico-sFIBWfwq-py3.11 (Activated)</code></pre>
<ul>
<li>본인은 conda를 사용자라서 activation의 의미가 혼동이 왔었는데 conda의 가상환경 활성화 상태와 poetry의 활성화 상태의 정의가 다름을 깨달았다.
<ul>
<li>Conda 환경: <code>conda activate env_name</code> 로 실행하면 <strong>쉘 명령어(activate)</strong>를 사용하여 쉘 프롬프트를 변경하는 의미</li>
<li>Poetry 환경: <code>poetry env list</code>로 실행하면 현재 <code>poetry env list</code> 명령어를 실행 중인 곳이 해당 환경인지를 나타낸다. 즉, 위의 <code>(Activated)</code>의 의미는 <code>poetry env list</code> 명령어를 실행하고 있는 현재 프로세스가 해당 <code>insilico-sFIBWfwq-py3.11</code> 가상 환경 내부에 있음을 의미하는 것이다.</li>
</ul></li>
</ul>
</section>
<section id="가상환경-활성화-및-비활성화" class="level3" data-number="2.3">
<h3 data-number="2.3" class="anchored" data-anchor-id="가상환경-활성화-및-비활성화"><span class="header-section-number">2.3</span> 가상환경 활성화 및 비활성화</h3>
<ul>
<li>Poetry 환경에서 실제 가상환경을 활성화 시키려면?
<ul>
<li>poetry에서 가상환경의 활성화는 <code>poetry shell</code>로 가능했는데 <code>Poetry 2.0+</code>부터는 이 명령어가 코어 기능에서 제거(Removed)되었다 (deprecated)</li>
</ul></li>
</ul>
<section id="표준-활성화-방법" class="level4" data-number="2.3.1">
<h4 data-number="2.3.1" class="anchored" data-anchor-id="표준-활성화-방법"><span class="header-section-number">2.3.1</span> 표준 활성화 방법</h4>
<ul>
<li><code>eval $(poetry env activate)</code>: 공식 웹사이트에서 제 1 에시로 나옴</li>
</ul>
<div class="sourceCode" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb12-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">azureuser@test-agent:~/projects/insilico$</span> eval <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">poetry</span> env activate<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 가상환경 활성화 </span></span>
<span id="cb12-2"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">insilico-py3.11</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">)</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">azureuser@test-agent:~/projects/insilico$</span> deactivate <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 가상환경이 활성화되었음. 가상환경 비활성화 명령어 입력</span></span>
<span id="cb12-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">azureuser@test-agent:~/projects/insilico$</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 가상환경 비활성화됨</span></span></code></pre></div>
</section>
<section id="개별-명령어-실행" class="level4" data-number="2.3.2">
<h4 data-number="2.3.2" class="anchored" data-anchor-id="개별-명령어-실행"><span class="header-section-number">2.3.2</span> 개별 명령어 실행</h4>
<ul>
<li>poetry run 명령어는 가상환경을 수동으로 활성화하지 않아도 프로젝트의 가상환경을 찾고, 해당 가상환경 안에서 명령어를 실행해주는 역할을 한다.</li>
<li>poetry run은 뒤에 <strong>실행하고자 하는 명령(Command)</strong>을 인수로 받는다.
<ul>
<li>Poetry는 <code>insilico/.venv/bin/python</code>을 사용하도록 설정한 후, 이 Python으로 <code>test_setup.py</code> 스크립트를 실행</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb13-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">azureuser@test-agent:~/projects/insilico$</span> cat test_setup.py</span>
<span id="cb13-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> langchain import __version__ as lc_version</span>
<span id="cb13-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">from</span> langgraph import version</span>
<span id="cb13-4"></span>
<span id="cb13-5"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">print</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">f</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"LangChain: {lc_version}"</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb13-6"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">print</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"LangGraph: imported successfully"</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
<div class="sourceCode" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb14-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 가상환경 활성화 없이 Poetry로 명령어 실행</span></span>
<span id="cb14-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">poetry</span> run python test_setup.py</span></code></pre></div>
<div class="sourceCode" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb15-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">azureuser@test-agent:~/projects/insilico$</span> poetry run python test_setup.py</span>
<span id="cb15-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">LangChain:</span> 1.1.0</span>
<span id="cb15-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">LangGraph:</span> imported successfully</span></code></pre></div>
</section>
<section id="수동-활성화" class="level4" data-number="2.3.3">
<h4 data-number="2.3.3" class="anchored" data-anchor-id="수동-활성화"><span class="header-section-number">2.3.3</span> 수동 활성화</h4>
<ul>
<li>가장 직접적인 방법으로 path 를 읽어와서 활성화시킨다. poetry 가 비정상적으로 설치됐을 경우 가장 효과적으로 활성화 시킬 수 있다.</li>
</ul>
<div class="sourceCode" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb16-1"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">poetry</span> env info <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--path</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span>/bin/activate</span></code></pre></div>
</section>
</section>
<section id="poetry의-가상환경-위치-설정" class="level3" data-number="2.4">
<h3 data-number="2.4" class="anchored" data-anchor-id="poetry의-가상환경-위치-설정"><span class="header-section-number">2.4</span> Poetry의 가상환경 위치 설정</h3>
<ul>
<li><code>pyenv</code> vs <code>venv</code>
<ul>
<li><code>pyenv</code>: Python 버전 관리
<ul>
<li><code>pyenv local 3.11.10</code></li>
<li>역할: Python 인터프리터 버전 관리</li>
<li>설치 위치: ~/.pyenv/versions/3.11.10/</li>
<li>관리 대상: Python 실행 파일 자체</li>
<li>목적: 프로젝트마다 다른 Python 버전 사용</li>
</ul></li>
<li><code>Poetry .venv</code>: 패키지 격리
<ul>
<li><code>poetry config virtualenvs.in-project true</code>: 프로젝트 폴더 내에 .venv 생성하도록 설정</li>
<li><code>poetry install</code></li>
<li>설치 위치: 프로젝트 폴더 내 .venv/</li>
<li>관리 대상: 패키지(langchain, fastapi 등)</li>
<li>목적: 프로젝트마다 독립된 패키지 환경</li>
</ul></li>
</ul></li>
</ul>
<div class="sourceCode" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb17-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 프로젝트 폴더 내에 .venv 생성 (권장)</span></span>
<span id="cb17-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">azureuser@test-agent:~/projects/insilico$</span> poetry config virtualenvs.in-project true</span>
<span id="cb17-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">azureuser@test-agent:~/projects/insilico$</span> ls <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-la</span></span>
<span id="cb17-4"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">total</span> 316</span>
<span id="cb17-5"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">drwxrwxr-x</span> 4 azureuser azureuser   4096 Dec  3 04:18 .</span>
<span id="cb17-6"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">drwxrwxr-x</span> 3 azureuser azureuser   4096 Dec  1 07:45 ..</span>
<span id="cb17-7"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">-rw-rw-r--</span> 1 azureuser azureuser      8 Dec  1 07:45 .python-version</span>
<span id="cb17-8"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">-rw-rw-r--</span> 1 azureuser azureuser 293841 Dec  1 07:55 poetry.lock</span>
<span id="cb17-9"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">-rw-rw-r--</span> 1 azureuser azureuser    711 Dec  1 07:55 pyproject.toml</span>
<span id="cb17-10"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">drwxrwxr-x</span> 4 azureuser azureuser   4096 Dec  1 08:02 src</span>
<span id="cb17-11"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">-rw-rw-r--</span> 1 azureuser azureuser    155 Dec  1 08:02 test_setup.py</span>
<span id="cb17-12"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">drwxrwxr-x</span> 2 azureuser azureuser   4096 Dec  1 08:02 tests</span></code></pre></div>
<ul>
<li><code>poetry config virtualenvs.in-project true</code> 명령어를 실행했지만 <code>.venv</code> 폴더가 아직 생성되지 않았다.
<ul>
<li>시행착오 결과, 내가 poetry에서 가상환경 재설치를 위해 필요한 폴더 구조를 만들지 않아서 <code>.venv</code> 생성이 되지 않았던 것</li>
<li>필요한 폴더 구조: Python 패키지 규칙과 Poetry의 프로젝트 구조 요구사항을 의미</li>
<li>Python 패키지 = 폴더 + <code>__init__.py</code></li>
</ul>
<div class="sourceCode" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb18-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># __init__.py 있음 → Python 패키지  </span></span>
<span id="cb18-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">insilico/</span>                       <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 프로젝트 루트</span></span>
<span id="cb18-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">├──</span> README.md                   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 프로젝트 설명</span></span>
<span id="cb18-4"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">├──</span> pyproject.toml</span>
<span id="cb18-5"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">├──</span> poetry.lock</span>
<span id="cb18-6"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">├──</span> .venv/</span>
<span id="cb18-7"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">└──</span> src/</span>
<span id="cb18-8">    <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">└──</span> insilico/                   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 패키지 루트 (프로젝트명과 동일)</span></span>
<span id="cb18-9">        <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">├──</span> __init__.py            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 패키지 표시 (필수)</span></span>
<span id="cb18-10">        <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">├──</span> agents/</span>
<span id="cb18-11">        <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│</span>   ├── __init__.py        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 서브패키지 표시 (필수)</span></span>
<span id="cb18-12">        <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">│</span>   └── chat_agent.py</span>
<span id="cb18-13">        <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">└──</span> utils/</span>
<span id="cb18-14">            <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">├──</span> __init__.py        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 서브패키지 표시 (필수)</span></span>
<span id="cb18-15">            <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">└──</span> helpers.py</span>
<span id="cb18-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># import 성공</span></span>
<span id="cb18-17"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">python</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-c</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"import insilico.agents"</span></span>
<span id="cb18-18"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">python</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-c</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"from insilico import Agent"</span></span>
<span id="cb18-19"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 정상 작동</span></span></code></pre></div></li>
<li><code>poetry new insilico</code> 로 자동설치하면 이런 시행착오를 안겪고 가상환경으로 자동으로 만들 수 있음</li>
<li>수동 설치시 아래의 구조를 수동으로 만들어야함</li>
</ul>
<pre><code>#가능한 디렉토리 구조: Flat 레이아웃 사용 (덜 권장)
insilico/
├── pyproject.toml
├── README.md # 포에트리 구조 요구 사항: PyPI 등록 시 표시될 설명. 이 파일이 없어도 가상환경이 설치되지만 경고 메세지가 출력된다.
├── insilico/        # 소스 코드 폴더명은 프로젝트 폴더명과 일치시켜야함
│   └── __init__.py # 패키지 인식 스크립트 필요
└── tests/</code></pre>
<ul>
<li>소스 코드 폴더명과 프로젝트 폴더명의 일치
<ul>
<li>별도 설정 없이 패키지 자동 인식시키면 <code>pip install insilico</code> 후 <code>import insilico</code>로 자동 사용 가능</li>
</ul></li>
<li>만약 소스 코드 폴더명 과 폴더명이 불일치하면 <code>pyproject.toml</code>을 수정해야함
<ul>
<li>그래도 여전히, 패키지 이름과 일치하는 폴더는 필수적으로 만들어야한다.</li>
</ul></li>
</ul>
<pre><code>#가능한 디렉토리 구조: src 레이아웃 사용 (표준 권장)
insilico/ # 프로젝트 명 or 패키지 명
├── pyproject.toml
├── src/ # 소스 코드 폴더명: 프로젝트 명 or 패키지 명과 달라도 됨
│&nbsp; &nbsp; &nbsp; &nbsp;└── insilico/  # **패키지 이름과 일치하는 폴더 (필수)**
│&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;├── __init__.py
│&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;└── (모듈 파일들...)
└── tests/</code></pre>
<ul>
<li>pyproject.toml 변경: Poetry가 src/ 디렉토리 내에서 패키지 소스 코드를 찾도록 지정</li>
</ul>
<pre><code>&lt;중략&gt;
[tool.poetry]
name = "insilico"
packages = [{ include = "insilico", from = "src" } # src/insilico/를 패키지로 지정]
# ...
&lt;중략&gt;</code></pre>
<ul>
<li>개발만 하고 배포 안 할 경우: 패키지 모드 비활성화 (비권장)
<ul>
<li><code>poetry install --no-root</code>: # 폴더명, <strong>init</strong>.py 상관없이 설치 가능</li>
</ul></li>
</ul>
<pre><code>[tool.poetry]
package-mode = false  # ← 패키지 구조 무시
name = "insilico"</code></pre>
<ul>
<li>아예 깔끔하게 기존 가상환경 삭제 하고 재생성 시도</li>
</ul>
<div class="sourceCode" id="cb23" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb23-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Poetry가 캐시 폴더에 이미 만든 가상환경 확인</span></span>
<span id="cb23-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">poetry</span> env list</span>
<span id="cb23-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 출력: insilico-sFIBWfwq-py3.11 (Activated)</span></span>
<span id="cb23-4"></span>
<span id="cb23-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 기존 환경 삭제</span></span>
<span id="cb23-6"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">poetry</span> env remove python</span>
<span id="cb23-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 또는 전체 삭제</span></span>
<span id="cb23-8"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">poetry</span> env remove <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--all</span></span></code></pre></div>
<ul>
<li>가상환경 재설치</li>
</ul>
<div class="sourceCode" id="cb24" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb24-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># insilico 폴더에 __init__.py 생성</span></span>
<span id="cb24-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> ~/projects/insilico</span>
<span id="cb24-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">touch</span> __init__.py</span>
<span id="cb24-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">touch</span> README.md</span></code></pre></div>
<ul>
<li>pyproject.toml 수정</li>
</ul>
<pre><code>[tool.poetry]
name = "insilico"
version = "0.1.0"
description = "AI Agent Development Using LangChain &amp; LangGraph"
authors = ["kmkim &lt;kmkim@seegene.com&gt;"]
license = "MIT"
readme = "README.md"
packages = [{include = "insilico", from = "src"}]  # 가상환경 만들기전에 명시적으로 이 줄 추가

[tool.poetry.dependencies]
python = "^3.11"
langchain = "^1.1.0"
langchain-community = "^0.4.1"
langgraph = "^1.0.4"
python-dotenv = "^1.2.1"
pydantic = "^2.12.5"
fastapi = "^0.123.0"
uvicorn = "^0.38.0"
numpy = "^2.3.5"
pandas = "^2.3.3"
polars = "^1.35.2"

[build-system]
requires = ["poetry-core&gt;=2.0.0,&lt;3.0.0"]
build-backend = "poetry.core.masonry.api"</code></pre>
<div class="sourceCode" id="cb26" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb26-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 가상환경 재생성</span></span>
<span id="cb26-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">azureuser@test-agent:~/projects/insilico$</span> poetry install</span></code></pre></div>
<pre><code>azureuser@test-agent:~/projects/insilico$ cd ~/projects/insilico

# insilico 폴더에 __init__.py 생성
touch insilico/__init__.py

# agents 폴더에 __init__.py 생성
touch insilico/agents/__init__.py

# utils 폴더에 __init__.py 생성
touch insilico/utils/__init__.py
azureuser@test-agent:~/projects/insilico$ cd insilico/
azureuser@test-agent:~/projects/insilico/insilico$ ls
__init__.py  agents  utils
azureuser@test-agent:~/projects/insilico/insilico$ cd agents
azureuser@test-agent:~/projects/insilico/insilico/agents$ ls
__init__.py
azureuser@test-agent:~/projects/insilico/insilico/agents$ cd ../../
azureuser@test-agent:~/projects/insilico$ ls
README.md  insilico  poetry.lock  pyproject.toml  test_setup.py  tests
azureuser@test-agent:~/projects/insilico$ nano pyproject.toml
azureuser@test-agent:~/projects/insilico$ poetry install
Creating virtualenv insilico in /home/azureuser/projects/insilico/.venv
Installing dependencies from lock file

Package operations: 64 installs, 0 updates, 0 removals

  - Installing certifi (2025.11.12)
  - Installing charset-normalizer (3.4.4)
  - Installing h11 (0.16.0)
  - Installing idna (3.11)
  - Installing typing-extensions (4.15.0)
  - Installing urllib3 (2.5.0)
  - Installing annotated-types (0.7.0)
  - Installing anyio (4.12.0)
  - Installing httpcore (1.0.9)
  - Installing pydantic-core (2.41.5)
  - Installing requests (2.32.5)
  - Installing typing-inspection (0.4.2)
  - Installing httpx (0.28.1)
  - Installing jsonpointer (3.0.0)
  - Installing orjson (3.11.4)
  - Installing packaging (25.0)
  - Installing pydantic (2.12.5)
  - Installing requests-toolbelt (1.0.0)
  - Installing zstandard (0.25.0)
  - Installing jsonpatch (1.33)
  - Installing langsmith (0.4.49)
  - Installing pyyaml (6.0.3)
  - Installing tenacity (9.1.2)
  - Installing langchain-core (1.1.0)
  - Installing ormsgpack (1.12.0)
  - Installing frozenlist (1.8.0)
  - Installing greenlet (3.2.4)
  - Installing langgraph-checkpoint (3.0.1)
  - Installing multidict (6.7.0)
  - Installing mypy-extensions (1.1.0)
  - Installing propcache (0.4.1)
  - Installing aiohappyeyeballs (2.6.1)
  - Installing aiosignal (1.4.0)
  - Installing attrs (25.4.0)
  - Installing langchain-text-splitters (1.0.0)
  - Installing langgraph-prebuilt (1.0.5)
  - Installing langgraph-sdk (0.2.10)
  - Installing marshmallow (3.26.1)
  - Installing python-dotenv (1.2.1)
  - Installing six (1.17.0)
  - Installing sqlalchemy (2.0.44)
  - Installing typing-inspect (0.9.0)
  - Installing xxhash (3.6.0)
  - Installing yarl (1.22.0)
  - Installing aiohttp (3.13.2)
  - Installing annotated-doc (0.0.4)
  - Installing click (8.3.1)
  - Installing dataclasses-json (0.6.7)
  - Installing httpx-sse (0.4.3)
  - Installing langchain-classic (1.0.0)
  - Installing langgraph (1.0.4)
  - Installing numpy (2.3.5)
  - Installing polars-runtime-32 (1.35.2)
  - Installing pydantic-settings (2.12.0)
  - Installing python-dateutil (2.9.0.post0)
  - Installing pytz (2025.2)
  - Installing starlette (0.50.0)
  - Installing tzdata (2025.2)
  - Installing fastapi (0.123.0)
  - Installing langchain (1.1.0)
  - Installing langchain-community (0.4.1)
  - Installing pandas (2.3.3)
  - Installing polars (1.35.2)
  - Installing uvicorn (0.38.0)

Installing the current project: insilico (0.1.0)</code></pre>
<div class="sourceCode" id="cb28" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb28-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 설정 확인</span></span>
<span id="cb28-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">azureuser@test-agent:~/projects/insilico$</span> poetry config <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--list</span></span></code></pre></div>
<pre><code>cache-dir = "/home/azureuser/.cache/pypoetry"
data-dir = "/home/azureuser/.local/share/pypoetry"
installer.max-workers = null
installer.no-binary = null
installer.only-binary = null
installer.parallel = true
installer.re-resolve = true
keyring.enabled = true
python.installation-dir = "{data-dir}/python"  # /home/azureuser/.local/share/pypoetry/python
requests.max-retries = 0
solver.lazy-wheel = true
system-git-client = false
virtualenvs.create = true # Poetry가 poetry install 또는 poetry shell 실행 시 가상환경을 생성하도록 설정되어 있다.
virtualenvs.in-project = true # 가상환경을 프로젝트 루트 디렉토리 내부에 생성하도록 설정되어 있다. 
virtualenvs.options.always-copy = false
virtualenvs.options.no-pip = false
virtualenvs.options.system-site-packages = false
virtualenvs.path = "{cache-dir}/virtualenvs"  # /home/azureuser/.cache/pypoetry/virtualenvs
virtualenvs.prompt = "{project_name}-py{python_version}"
virtualenvs.use-poetry-python = false</code></pre>
</section>
<section id="현재-가상환경-정보" class="level3" data-number="2.5">
<h3 data-number="2.5" class="anchored" data-anchor-id="현재-가상환경-정보"><span class="header-section-number">2.5</span> 현재 가상환경 정보</h3>
<div class="sourceCode" id="cb30" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb30-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Poetry가 사용 중인 가상환경 경로</span></span>
<span id="cb30-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">azureuser@test-agent:~/projects/insilico$</span> poetry env info</span>
<span id="cb30-3"></span>
<span id="cb30-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Virtualenv</span></span>
<span id="cb30-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Python:         3.11.10</span></span>
<span id="cb30-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Implementation: CPython</span></span>
<span id="cb30-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Path:           /home/azureuser/projects/insilico/.venv</span></span>
<span id="cb30-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Executable:     /home/azureuser/projects/insilico/.venv/bin/python</span></span>
<span id="cb30-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Valid:          True</span></span>
<span id="cb30-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># </span></span>
<span id="cb30-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Base</span></span>
<span id="cb30-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Platform:   linux</span></span>
<span id="cb30-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># OS:         posix</span></span>
<span id="cb30-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Python:     3.11.10</span></span>
<span id="cb30-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Path:       /home/azureuser/.pyenv/versions/3.11.10</span></span>
<span id="cb30-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Executable: /home/azureuser/.pyenv/versions/3.11.10/bin/python3.11</span></span></code></pre></div>


</section>
</section>

 ]]></description>
  <category>Engineering</category>
  <category>DevOps</category>
  <category>Python</category>
  <category>Agent</category>
  <category>Cloud</category>
  <category>Azure</category>
  <guid>kk3225.netlify.app/docs/blog/posts/Engineering/DevOps/2-vm_venv_setup.html</guid>
  <pubDate>Tue, 25 Nov 2025 15:00:00 GMT</pubDate>
</item>
<item>
  <title>Azure VM에 Poetry로 Agent 프로젝트 디펜던시 관리하기</title>
  <dc:creator>Kwangmin Kim</dc:creator>
  <link>kk3225.netlify.app/docs/blog/posts/Engineering/DevOps/3-vm_dependency_setup.html</link>
  <description><![CDATA[ 





<section id="platform-architecture-overview" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Platform Architecture Overview</h1>
<p><a href="../System/Archi_Design/images/sw_physical_architecture.png">Agent Platform Architecture - Enterprise Level</a></p>


</section>

 ]]></description>
  <category>Engineering</category>
  <category>DevOps</category>
  <category>Python</category>
  <category>Poetry</category>
  <category>Agent</category>
  <category>Cloud</category>
  <category>Azure</category>
  <guid>kk3225.netlify.app/docs/blog/posts/Engineering/DevOps/3-vm_dependency_setup.html</guid>
  <pubDate>Tue, 25 Nov 2025 15:00:00 GMT</pubDate>
</item>
<item>
  <title>Azure VM에 개발 환경 구축하기</title>
  <dc:creator>Kwangmin Kim</dc:creator>
  <link>kk3225.netlify.app/docs/blog/posts/Engineering/DevOps/1-vm_dev_envs_settings.html</link>
  <description><![CDATA[ 





<section id="vm에-개발-환경-구축하기" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> VM에 개발 환경 구축하기</h1>
<ul>
<li>Project: Agent Platform PoC 환경 구축</li>
<li>조건: Azure VM(Ubuntu 24.04)에서의 개발환경</li>
<li>Azure Portal에서 Ubuntu 24.04 LTS VM을 생성한 후 git, conda, pyenv, poetry를 설치하는 과정에서 마주칠 수 있는 문제들과 해결 방법을 정리</li>
</ul>
<section id="구축할-개발환경-모식도" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="구축할-개발환경-모식도"><span class="header-section-number">1.1</span> 구축할 개발환경 모식도</h2>
<section id="작업-환경-구조" class="level3" data-number="1.1.1">
<h3 data-number="1.1.1" class="anchored" data-anchor-id="작업-환경-구조"><span class="header-section-number">1.1.1</span> 작업 환경 구조</h3>
<pre><code>┌─────────────────────────────────────┐
│  로컬 PC (Windows)                   │
│  PowerShell Terminal                │
└──────────────────┬──────────────────┘
                   │ SSH
                   ↓
┌─────────────────────────────────────┐
│  Azure VM (Ubuntu 24.04)            │
│  azureuser@test-agent               │
│  - git                              │
│  - conda                            |
│  - pyenv                            │
│  - poetry                           │
│  - 개발 작업 환경                     │
└─────────────────────────────────────┘</code></pre>
</section>
<section id="중요-개념" class="level3" data-number="1.1.2">
<h3 data-number="1.1.2" class="anchored" data-anchor-id="중요-개념"><span class="header-section-number">1.1.2</span> 중요 개념</h3>
<table class="table">
<thead>
<tr class="header">
<th>개념</th>
<th>설명</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>VM (Virtual Machine)</strong></td>
<td>클라우드에서 실행되는 가상 컴퓨터</td>
</tr>
<tr class="even">
<td><strong>Image</strong></td>
<td>VM의 운영체제 템플릿 (Docker와 다름)</td>
</tr>
<tr class="odd">
<td><strong>SSH</strong></td>
<td>원격 서버에 안전하게 접속하는 프로토콜</td>
</tr>
<tr class="even">
<td><strong>Private Key</strong></td>
<td>SSH 접속 인증용 파일</td>
</tr>
<tr class="odd">
<td><strong>웹 콘솔</strong></td>
<td>Azure Portal의 브라우저 기반 터미널 (제약이 있음)</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="초기-상황" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="초기-상황"><span class="header-section-number">1.2</span> 초기 상황</h2>
<section id="생성한-vm-스펙" class="level3" data-number="1.2.1">
<h3 data-number="1.2.1" class="anchored" data-anchor-id="생성한-vm-스펙"><span class="header-section-number">1.2.1</span> 생성한 VM 스펙</h3>
<ul>
<li><strong>VM명</strong>: test-agent</li>
<li><strong>OS</strong>: Ubuntu 24.04 LTS (Canonical official image)</li>
<li><strong>크기</strong>: Standard D8as v5 (8vCPUs, 32GB RAM)</li>
<li><strong>접속 방식</strong>:
<ul>
<li>웹 브라우저 콘솔 (Azure Portal 내 터미널) - sudo 제약 있음</li>
<li>SSH (원격 접속) - 권장 방식</li>
</ul></li>
</ul>
</section>
<section id="설치-목표" class="level3" data-number="1.2.2">
<h3 data-number="1.2.2" class="anchored" data-anchor-id="설치-목표"><span class="header-section-number">1.2.2</span> 설치 목표</h3>
<ul>
<li>git: source code 버전 관리</li>
<li>Miniconda (conda): DL/ML/Stat dependency 관리</li>
<li>pyenv: python interpreter 버전 관리</li>
<li>Poetry: Python 개발관련 dependency 관리</li>
</ul>
</section>
</section>
<section id="발생한-문제들과-해결-방법" class="level2" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="발생한-문제들과-해결-방법"><span class="header-section-number">1.3</span> 발생한 문제들과 해결 방법</h2>
<section id="웹-브라우저-콘솔에서-sudo-권한-제약" class="level3" data-number="1.3.1">
<h3 data-number="1.3.1" class="anchored" data-anchor-id="웹-브라우저-콘솔에서-sudo-권한-제약"><span class="header-section-number">1.3.1</span> 웹 브라우저 콘솔에서 sudo 권한 제약</h3>
<ul>
<li>증상</li>
</ul>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">kmkim</span> [ ~ ]$ sudo apt update</span>
<span id="cb2-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">sudo:</span> The <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"no new privileges"</span> flag is set, which prevents sudo from running as root.</span>
<span id="cb2-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">sudo:</span> If sudo is running in a container, you may need to adjust the container configuration to disable the flag.</span></code></pre></div>
<ul>
<li>원인
<ul>
<li><strong>웹 브라우저 콘솔</strong> = Azure Portal의 웹 화면 내에 내장된 터미널 창 (Cloud Shell이 아닌 경우)</li>
<li>Azure Portal의 웹 브라우저 콘솔은 보안상 <code>no-new-privileges</code> 플래그가 설정되어 있어서 sudo 권한 상승이 불가능</li>
<li>이는 컨테이너 환경의 제약이 아니라 웹 콘솔 자체의 보안 제한</li>
<li>왜 이런 제한이 필요한가?
<ul>
<li>웹 브라우저는 악성 JavaScript나 공격으로 조작될 수 있음</li>
<li>브라우저 콘솔을 통해 root 권한을 얻을 수 있다면, 전체 VM을 장악당할 위험 증가</li>
<li><code>no-new-privileges</code> 플래그는 이미 실행 중인 프로세스가 권한을 <strong>상승</strong>시키는 것을 막음 (기존 권한 유지는 가능)</li>
<li>따라서 웹 콘솔로 일반 사용자(azureuser) 작업은 가능하지만, sudo로 root 권한이 필요한 작업은 차단</li>
</ul></li>
</ul></li>
<li><strong>해결책</strong>
<ul>
<li>웹 브라우저 콘솔대신 local cmd prompt (power shell)에서 <strong>SSH로 직접 접속</strong></li>
</ul></li>
</ul>
</section>
<section id="local에서-ssh-접속-방법" class="level3" data-number="1.3.2">
<h3 data-number="1.3.2" class="anchored" data-anchor-id="local에서-ssh-접속-방법"><span class="header-section-number">1.3.2</span> Local에서 SSH 접속 방법</h3>
<ul>
<li>증상
<ul>
<li>웹 콘솔의 sudo 제약으로 인해 패키지 설치가 불가능한 상황</li>
</ul></li>
<li>SSH란?
<ul>
<li>SSH (Secure Shell) = 인터넷을 통해 원격 컴퓨터에 안전하게 접속하는 프로토콜</li>
<li>자세한 내용은 <a href="../../../../../docs/blog/posts/Engineering/Infra/Security/ssh.html">SSH 개요 블로그 참조</a><br>
</li>
</ul></li>
<li>장점
<ul>
<li>웹 콘솔의 제약이 없음</li>
<li>sudo 권한이 정상 작동</li>
<li>웹 콘솔보다 더 안정적이고 빠름</li>
<li>로컬에서 언제든 접속 가능<br>
</li>
</ul></li>
<li>웹 브라우저 콘솔 vs SSH의 차이:</li>
</ul>
<table class="table">
<colgroup>
<col style="width: 22%">
<col style="width: 59%">
<col style="width: 18%">
</colgroup>
<thead>
<tr class="header">
<th>항목</th>
<th>웹 브라우저 콘솔</th>
<th>SSH</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>접속 방식</strong></td>
<td>Azure Portal 웹 페이지 내</td>
<td>암호화된 네트워크 연결</td>
</tr>
<tr class="even">
<td><strong>보안</strong></td>
<td>웹 브라우저 보안 정책 적용 (제약 많음)</td>
<td>공개키 암호화 (매우 강력)</td>
</tr>
<tr class="odd">
<td><strong>권한</strong></td>
<td><code>no-new-privileges</code> 플래그로 sudo 차단</td>
<td>일반 사용자이지만 sudo 가능</td>
</tr>
<tr class="even">
<td><strong>통신</strong></td>
<td>평문 또는 약한 암호화</td>
<td>모든 데이터 암호화 (AES-256 등)</td>
</tr>
<tr class="odd">
<td><strong>인증</strong></td>
<td>Azure Portal 로그인</td>
<td>Private Key 파일 기반</td>
</tr>
<tr class="even">
<td><strong>안정성</strong></td>
<td>브라우저 다운시 연결 끊김</td>
<td>네트워크만 안정하면 지속 연결</td>
</tr>
</tbody>
</table>
<ul>
<li>SSH 접속 단계
<ul>
<li><p>1단계: Private Key 파일 준비</p>
<ul>
<li>VM 생성 시 Azure가 생성한 <code>test-agent_key.pem</code> 파일을 다운로드</li>
<li>보통 Downloads 폴더에 저장됨</li>
</ul></li>
<li><p>2단계: 로컬 PowerShell(Windows) 또는 Terminal(macOS/Linux)에서 접속</p>
<ul>
<li><code>ssh -i C:\Users\kmkim\Downloads\test-agent_key.pem azureuser@20.196.144.16</code></li>
<li><code>-i</code> 옵션은 Identity file(신원 확인 파일)을 지정하는 옵션</li>
</ul></li>
<li><p>3단계: 첫 접속 시 호스트 인증</p>
<pre><code>The authenticity of host '20.196.144.16' can't be established.
Are you sure you want to continue connecting (yes/no)?</code></pre>
<p>→ <code>yes</code> 입력</p></li>
<li><p>4단계: 접속 완료</p>
<pre><code>azureuser@test-agent:~$</code></pre></li>
</ul></li>
</ul>
</section>
<section id="conda-설치-시-권한-부족" class="level3" data-number="1.3.3">
<h3 data-number="1.3.3" class="anchored" data-anchor-id="conda-설치-시-권한-부족"><span class="header-section-number">1.3.3</span> Conda 설치 시 권한 부족</h3>
<ul>
<li>증상</li>
</ul>
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">azureuser@test-agent:~$</span> bash Miniconda3-latest-Linux-x86_64.sh <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-b</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-p</span> /opt/conda</span>
<span id="cb5-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">mkdir:</span> cannot create directory <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'/opt/conda'</span>: Permission denied</span>
<span id="cb5-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ERROR:</span> Could not create directory: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'/opt/conda'</span>.</span></code></pre></div>
<ul>
<li>원인
<ul>
<li><code>/opt</code> 디렉토리는 root 권한이 필요</li>
<li>azureuser는 일반 사용자이므로 직접 접근 불가.</li>
</ul></li>
<li>해결책</li>
</ul>
<div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb6-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sudo</span> bash Miniconda3-latest-Linux-x86_64.sh <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-b</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-p</span> /opt/conda</span></code></pre></div>
</section>
<section id="conda-초기화-실패" class="level3" data-number="1.3.4">
<h3 data-number="1.3.4" class="anchored" data-anchor-id="conda-초기화-실패"><span class="header-section-number">1.3.4</span> Conda 초기화 실패</h3>
<ul>
<li>증상</li>
</ul>
<div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb7-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">azureuser@test-agent:~$</span> sudo /opt/conda/bin/conda init bash</span>
<span id="cb7-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">no</span> change     /root/.bashrc</span>
<span id="cb7-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">No</span> action taken.</span></code></pre></div>
<ul>
<li>원인
<ul>
<li><code>sudo</code>로 실행하면 root의 <code>.bashrc</code>가 수정되지만, azureuser로 로그인하면 <code>/home/azureuser/.bashrc</code>를 사용</li>
</ul></li>
<li>해결책
<ul>
<li>sudo 없이 실행하거나, 수동으로 초기화 코드를 추가</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb8-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># sudo 없이 실행. conda가 자동으로 .bashrc를 수정</span></span>
<span id="cb8-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">/opt/conda/bin/conda</span> init bash</span>
<span id="cb8-3"></span>
<span id="cb8-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 실행 결과: .bashrc에 다음과 같은 긴 초기화 블록이 자동 추가됨</span></span>
<span id="cb8-5"></span>
<span id="cb8-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># &gt;&gt;&gt; conda initialize &gt;&gt;&gt;</span></span>
<span id="cb8-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># !! Contents within this block are managed by 'conda init' !!</span></span>
<span id="cb8-8"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">__conda_setup</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'/opt/conda/bin/conda'</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'shell.bash'</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'hook'</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> /dev/null<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb8-9"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$?</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">-eq</span> 0 <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">]</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">then</span></span>
<span id="cb8-10">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">eval</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$__conda_setup</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb8-11"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span></span>
<span id="cb8-12">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">[</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">-f</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/opt/conda/etc/profile.d/conda.sh"</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">]</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">;</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">then</span></span>
<span id="cb8-13">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">.</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/opt/conda/etc/profile.d/conda.sh"</span></span>
<span id="cb8-14">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span></span>
<span id="cb8-15">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">PATH</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/opt/conda/bin:</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$PATH</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb8-16">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">fi</span></span>
<span id="cb8-17"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">fi</span></span>
<span id="cb8-18"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">unset</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">__conda_setup</span></span>
<span id="cb8-19"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># &lt;&lt;&lt; conda initialize &lt;&lt;&lt;</span></span></code></pre></div>
<div class="sourceCode" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb9-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 수동으로 초기화: conda shell.bash hook를 실행하여 초기화에 필요한 최소한의 코드만 생성</span></span>
<span id="cb9-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># eval로 그 코드를 실행하도록 .bashrc에 추가</span></span>
<span id="cb9-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 자동 초기화와 동일한 효과</span></span>
<span id="cb9-4"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'eval "$(/opt/conda/bin/conda shell.bash hook)"'</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span> ~/.bashrc</span>
<span id="cb9-5"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> ~/.bashrc</span></code></pre></div>
<ul>
<li>Conda 설치 확인</li>
</ul>
<div class="sourceCode" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb10-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">conda</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--version</span></span></code></pre></div>
</section>
<section id="pyenv-설치" class="level3" data-number="1.3.5">
<h3 data-number="1.3.5" class="anchored" data-anchor-id="pyenv-설치"><span class="header-section-number">1.3.5</span> Pyenv 설치</h3>
<section id="python-개발-환경-구축" class="level4" data-number="1.3.5.1">
<h4 data-number="1.3.5.1" class="anchored" data-anchor-id="python-개발-환경-구축"><span class="header-section-number">1.3.5.1</span> Python 개발 환경 구축</h4>
<ul>
<li>conda와 pyenv는 python interpreter의 버전을 독립적으로 관리한다.
<ul>
<li>conda는 deep learning, machine learning, statistics 관련 패키지들과 더불어 java, c++과 같은 python외 개발 관련 가상환경을 관리한다.</li>
<li>pyenv는 오로지 python으로만 개발이 될 프로젝트용으로 사용되며 python version만 관리하고 후에 설치할 poetry와 맞물려 사용된다.</li>
</ul></li>
<li>사실, conda는 순서에 상관없이 나중에 설치해도 되지만 python개발환경 구축시엔 git이 편의성에 있어서 필요할 수 있다.</li>
<li>pyenv는 Python을 설치하고 버전을 관리하는 도구이다</li>
<li>Poetry는 Python 위에서 실행되므로, Python이 먼저 설치되어야 한다.</li>
<li>python 개발 환경 구축 순서는 다음의 단계를 따라야한다.
<ol type="1">
<li>pyenv 설치 (Python 버전 관리자)</li>
<li>Python 3.11 설치 (프로그래밍 언어로 pyenv로 설치해야함)</li>
<li>Poetry 설치 (Python 패키지 관리자, Python 3.11 기반으로 설치)</li>
</ol></li>
<li>Pyenv 설치</li>
</ul>
<div class="sourceCode" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb11-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 방법1</span></span>
<span id="cb11-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">curl</span> https://pyenv.io/install.sh <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">bash</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 회사 네트워크 방화벽때문에 pyenv.io 네트워크 접근 불가 → GitHub clone으로 해결</span></span>
<span id="cb11-3"></span>
<span id="cb11-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 방법2: GitHub에서 직접 clone (권장)</span></span>
<span id="cb11-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">git</span> clone https://github.com/pyenv/pyenv.git ~/.pyenv</span></code></pre></div>
<p><strong>설치 후 PATH 설정</strong><br>
- pyenv를 Shell 환경에 영구 등록 - heredoc(히어닥) 문법: 여러 줄의 텍스트를 파일에 추가하는 방식</p>
<pre><code>cat &gt;&gt; ~/.bashrc &lt;&lt; 'EOF'
[여기에 작성된 내용들]
EOF</code></pre>
<div class="sourceCode" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb13-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cat</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span> ~/.bashrc <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;&lt; 'EOF'</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;"> </span></span>
<span id="cb13-2"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">export PYENV_ROOT="$HOME/.pyenv" </span></span>
<span id="cb13-3"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">export PATH="$PYENV_ROOT/bin:$PATH"</span></span>
<span id="cb13-4"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">eval "$(pyenv init -)"</span></span>
<span id="cb13-5"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">eval "$(pyenv virtualenv-init -)"</span></span>
<span id="cb13-6"><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">EOF</span></span>
<span id="cb13-7"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> ~/.bashrc</span></code></pre></div>
<p>코드 설명<br>
1. cat &gt;&gt; ~/.bashrc<br>
* cat: 텍스트를 출력하는 명령어 * &gt;&gt;: 파일 끝에 추가(append)하라는 의미 (&gt; 하나만 쓰면 덮어쓰기) * ~/.bashrc: 현재 사용자의 홈 디렉토리(~)에 있는 .bashrc 파일 2. &lt;&lt; ‘EOF’<br>
* &lt;&lt;: heredoc 시작을 의미 (여러 줄 입력 시작) * ‘EOF’: 입력 종료 마커 (End Of File) * 작은따옴표(’)로 감싸면 → 변수 치환 안 함 (문자 그대로 저장) * 큰따옴표(“) 또는 따옴표 없으면 → 변수 치환 함 3. export PYENV_ROOT=”<img src="https://latex.codecogs.com/png.latex?HOME/.pyenv%22%0A%20%20*%20export:%20%ED%99%98%EA%B2%BD%20%EB%B3%80%EC%88%98%EB%A5%BC%20%EC%84%A4%EC%A0%95%ED%95%98%EA%B3%A0%20%EC%9E%90%EC%8B%9D%20%ED%94%84%EB%A1%9C%EC%84%B8%EC%8A%A4%EB%8F%84%20%EC%82%AC%EC%9A%A9%20%EA%B0%80%EB%8A%A5%ED%95%98%EA%B2%8C%20%EB%A7%8C%EB%93%A6%0A%20%20*%20PYENV_ROOT:%20pyenv%EA%B0%80%20%EC%84%A4%EC%B9%98%EB%90%9C%20%EC%9C%84%EC%B9%98%EB%A5%BC%20%EC%A0%80%EC%9E%A5%ED%95%98%EB%8A%94%20%EB%B3%80%EC%88%98%0A%20%20*%20%22">HOME/.pyenv”: /home/azureuser/.pyenv (사용자 홈 폴더의 .pyenv 디렉토리) 4. export PATH=“<img src="https://latex.codecogs.com/png.latex?PYENV_ROOT/bin:">PATH”<br>
* PATH: Shell이 명령어를 찾는 경로 목록 * <img src="https://latex.codecogs.com/png.latex?PYENV_ROOT/bin:%20pyenv%20%EC%8B%A4%ED%96%89%20%ED%8C%8C%EC%9D%BC%EC%9D%B4%20%EC%9E%88%EB%8A%94%20%ED%8F%B4%EB%8D%94%EB%A5%BC%20PATH%20%EB%A7%A8%20%EC%95%9E%EC%97%90%20%EC%B6%94%EA%B0%80%0A%20%20*%20:">PATH: 기존 PATH 내용은 뒤에 유지 * 왜 맨 앞에? → 같은 이름의 명령어가 있으면 pyenv 버전을 우선 실행 5. eval “$(pyenv init -)”<br>
* pyenv init -: pyenv 초기화 스크립트 생성 (실제로는 긴 Shell 코드 출력) * <img src="https://latex.codecogs.com/png.latex?():%20%EB%AA%85%EB%A0%B9%EC%96%B4%20%EC%B9%98%ED%99%98%20-%20%EA%B4%84%ED%98%B8%20%EC%95%88%20%EB%AA%85%EB%A0%B9%EC%96%B4%EB%A5%BC%20%EC%8B%A4%ED%96%89%ED%95%98%EA%B3%A0%20%EA%B2%B0%EA%B3%BC%EB%A5%BC%20%EB%B0%98%ED%99%98%0A%20%20*%20eval:%20%EB%AC%B8%EC%9E%90%EC%97%B4%EC%9D%84%20Shell%20%EB%AA%85%EB%A0%B9%EC%96%B4%EB%A1%9C%20%EC%8B%A4%ED%96%89%0A%20%20*%20%EC%8B%A4%EC%A0%9C%20%EB%8F%99%EC%9E%91:%20pyenv%EA%B0%80%20%EC%B6%9C%EB%A0%A5%ED%95%9C%20%EC%B4%88%EA%B8%B0%ED%99%94%20%EC%BD%94%EB%93%9C%EB%A5%BC%20%EC%A6%89%EC%8B%9C%20%EC%8B%A4%ED%96%89%0A6.%20eval%20%22">(pyenv virtualenv-init -)”<br>
* pyenv-virtualenv 플러그인 초기화 (가상 환경 관리 기능) * 위와 동일한 방식으로 초기화 코드 실행 7. EOF * heredoc 종료 마커 (여기까지가 추가할 내용) 8. source ~/.bashrc * .bashrc 파일을 즉시 재실행 → 현재 Shell에 바로 적용 * 안 하면? → 다음 로그인이나 새 터미널을 열어야 적용됨</p>
<ul>
<li>Pyenv 설치 확인: <code>pyenv --version</code></li>
</ul>
</section>
<section id="python-설치" class="level4" data-number="1.3.5.2">
<h4 data-number="1.3.5.2" class="anchored" data-anchor-id="python-설치"><span class="header-section-number">1.3.5.2</span> python 설치</h4>
<div class="sourceCode" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb14-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># python 설치</span></span>
<span id="cb14-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">azureuser@test-agent:~$</span> pyenv install 3.11.10</span>
<span id="cb14-3"></span>
<span id="cb14-4"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">azureuser@test-agent:~$</span> python <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--version</span></span></code></pre></div>
<p>ubuntu에 python이 설치되어 있지 않아 다음 메세지가 뜰 것.</p>
<div class="sourceCode" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb15-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">pyenv:</span> python: command not found</span>
<span id="cb15-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">The</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">`</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">python</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">' command exists in these Python versions:</span></span>
<span id="cb15-3"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">  3.11.10</span></span>
<span id="cb15-4"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Note: See '</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">pyenv</span> help global<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">' for tips on allowing both</span></span>
<span id="cb15-5"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">      python2 and python3 to be found.</span></span></code></pre></div>
<ul>
<li>시스템이 인식할 python버전을 설정</li>
</ul>
<div class="sourceCode" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb16-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 시스템 전체의 기본 Python 버전을 3.11.10으로 설정 (OS의 python 설치 유무와 버전을 신경쓸필요없어짐)</span></span>
<span id="cb16-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">azureuser@test-agent:~$</span> pyenv global 3.11.10</span>
<span id="cb16-3"></span>
<span id="cb16-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># global 설정하면 pyenv가 관리하는 경로로 고정 되게됨</span></span>
<span id="cb16-5"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">azureuser@test-agent:~$</span> which python</span>
<span id="cb16-6"></span>
<span id="cb16-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 또는 python의 특정 버전의 최신 버전을 찾으려면 다음의 명령어를 입력하여 확인하여 설치</span></span>
<span id="cb16-8"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">pyenv</span> install <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--list</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grep</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"3.11"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">|</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tail</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-1</span></span>
<span id="cb16-9"></span>
<span id="cb16-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># python 설치 확인</span></span>
<span id="cb16-11"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">azureuser@test-agent:~$</span> python <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--version</span></span></code></pre></div>
</section>
<section id="poetry-설치" class="level4" data-number="1.3.5.3">
<h4 data-number="1.3.5.3" class="anchored" data-anchor-id="poetry-설치"><span class="header-section-number">1.3.5.3</span> Poetry 설치</h4>
<ul>
<li>pip install poetry = 간편 설치
<ul>
<li>pip(Python 패키지 관리자)를 사용</li>
<li>가장 간단하고 빠름</li>
<li>pyenv로 설치한 Python 환경에 직접 설치</li>
<li>하지만 Poetry 공식 문서는 이 방법을 권장하지 않음</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb17-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 방법 1: pip를 이용한 간편 설치 (비권장)</span></span>
<span id="cb17-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">pip</span> install poetry</span>
<span id="cb17-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">poetry</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--version</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 확인</span></span></code></pre></div>
<ul>
<li>curl 방식 = 공식 권장 설치 (독립 설치)
<ul>
<li>Poetry 설치 스크립트를 다운받아 실행</li>
<li>Poetry를 시스템 Python과 분리하여 독립 환경에 설치</li>
<li><code>~/.local/bin</code>에 독립 설치</li>
<li>독립 환경이라 충돌 없음</li>
<li>더 깨끗하고 안전함</li>
<li>Poetry 공식 문서의 표준 방법</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb18-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 방법 2: 공식 설치 스크립트 (권장)</span></span>
<span id="cb18-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">curl</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-ssl</span> https://install.python-poetry.org <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">python3</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span></span>
<span id="cb18-3"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">export</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">PATH</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$HOME</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">/.local/bin:</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$PATH</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb18-4"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">echo</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'export PATH="$HOME/.local/bin:$PATH"'</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;&gt;</span> ~/.bashrc</span>
<span id="cb18-5"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> ~/.bashrc</span>
<span id="cb18-6"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">poetry</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--version</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 확인</span></span></code></pre></div>
<ul>
<li>발생 가능한 귀찮은 문제
<ul>
<li>pip 방식의 문제</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb19-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Python 3.11에서 poetry 설치</span></span>
<span id="cb19-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">pyenv</span> global 3.11.10</span>
<span id="cb19-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">pip</span> install poetry</span>
<span id="cb19-4"></span>
<span id="cb19-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 나중에 Python 3.12로 변경</span></span>
<span id="cb19-6"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">pyenv</span> global 3.12.5</span>
<span id="cb19-7"></span>
<span id="cb19-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># poetry가 사라짐!</span></span>
<span id="cb19-9"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">poetry</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--version</span></span>
<span id="cb19-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># bash: poetry: command not found</span></span></code></pre></div>
<ul>
<li>curl 방식은 안전</li>
</ul>
<div class="sourceCode" id="cb20" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb20-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 독립 설치</span></span>
<span id="cb20-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">curl</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-sSL</span> https://install.python-poetry.org <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">python3</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-</span></span>
<span id="cb20-3"></span>
<span id="cb20-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Python 버전 바꿔도 poetry는 유지됨</span></span>
<span id="cb20-5"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">pyenv</span> global 3.12.5</span>
<span id="cb20-6"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">poetry</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--version</span></span>
<span id="cb20-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Poetry (version 1.8.3) ✅</span></span></code></pre></div>
</section>
</section>
</section>
<section id="vm-종료-및-관리" class="level2" data-number="1.4">
<h2 data-number="1.4" class="anchored" data-anchor-id="vm-종료-및-관리"><span class="header-section-number">1.4</span> VM 종료 및 관리</h2>
<section id="vm-중지-비용-절감" class="level3" data-number="1.4.1">
<h3 data-number="1.4.1" class="anchored" data-anchor-id="vm-중지-비용-절감"><span class="header-section-number">1.4.1</span> VM 중지 (비용 절감)</h3>
<div class="sourceCode" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb21-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># SSH 연결 종료</span></span>
<span id="cb21-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">exit</span></span></code></pre></div>
<p>또는 Azure Portal에서 <code>Virtual Machines → test-agent → Stop</code> 클릭</p>
<ul>
<li><strong>Stop</strong>: 비용 청구 안 됨, 나중에 재시작 가능</li>
<li><strong>Delete</strong>: <strong>주의!</strong> VM 완전 삭제 (복구 불가)</li>
</ul>
</section>
<section id="vm-재시작" class="level3" data-number="1.4.2">
<h3 data-number="1.4.2" class="anchored" data-anchor-id="vm-재시작"><span class="header-section-number">1.4.2</span> VM 재시작</h3>
<div class="sourceCode" id="cb22" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb22-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ssh</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-i</span> C:<span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\U</span>sers<span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\k</span>mkim<span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\D</span>ownloads<span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\t</span>est-agent_key.pem azureuser@20.196.144.16</span></code></pre></div>
</section>
</section>
<section id="편의성-개선-선택사항" class="level2" data-number="1.5">
<h2 data-number="1.5" class="anchored" data-anchor-id="편의성-개선-선택사항"><span class="header-section-number">1.5</span> 편의성 개선 (선택사항)</h2>
<section id="powershell에-ssh-alias-설정" class="level3" data-number="1.5.1">
<h3 data-number="1.5.1" class="anchored" data-anchor-id="powershell에-ssh-alias-설정"><span class="header-section-number">1.5.1</span> PowerShell에 SSH Alias 설정</h3>
<p>PowerShell 프로필 편집:</p>
<div class="sourceCode" id="cb23" style="background: #f1f3f5;"><pre class="sourceCode numberSource powershell number-lines code-with-copy"><code class="sourceCode powershell"><span id="cb23-1">notepad <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$PROFILE</span></span></code></pre></div>
<p>다음 추가:</p>
<div class="sourceCode" id="cb24" style="background: #f1f3f5;"><pre class="sourceCode numberSource powershell number-lines code-with-copy"><code class="sourceCode powershell"><span id="cb24-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Set-Alias</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>Name ssh-vm <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>Value <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ssh -i C:\Users\kmkim\Downloads\test-agent_key.pem azureuser@20.196.144.16'</span></span></code></pre></div>
<p>이후 접속:</p>
<div class="sourceCode" id="cb25" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb25-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ssh-vm</span></span></code></pre></div>
</section>
</section>
<section id="ssh-key-관리-여러-vm서버-사용할-때" class="level2" data-number="1.6">
<h2 data-number="1.6" class="anchored" data-anchor-id="ssh-key-관리-여러-vm서버-사용할-때"><span class="header-section-number">1.6</span> SSH Key 관리 (여러 VM/서버 사용할 때)</h2>
<ul>
<li>Key가 여러 개일 때 관리 방법
<ul>
<li>Azure VM, AWS EC2, GitHub, GitLab 등 여러 서비스를 사용하면 SSH Key가 점점 많아진다.</li>
</ul></li>
<li>SSH Key 관리 전략
<ol type="1">
<li>Key 저장소 통일 (<code>.ssh</code> 폴더)</li>
</ol></li>
</ul>
<div class="sourceCode" id="cb26" style="background: #f1f3f5;"><pre class="sourceCode numberSource powershell number-lines code-with-copy"><code class="sourceCode powershell"><span id="cb26-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Windows의 .ssh 폴더 (자동 생성됨)</span></span>
<span id="cb26-2">C<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>\Users\kmkim\<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ssh</span>\</span>
<span id="cb26-3"></span>
<span id="cb26-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Key 파일들을 모두 여기에 정리</span></span>
<span id="cb26-5">C<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>\Users\kmkim\<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ssh</span>\</span>
<span id="cb26-6">├── azure-vm-test-agent<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pem</span>      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Azure VM용</span></span>
<span id="cb26-7">├── aws-ec2-dev<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pem</span>               <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># AWS EC2용</span></span>
<span id="cb26-8">├── github-personal                <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># GitHub용 (확장자 없음)</span></span>
<span id="cb26-9">├── gitlab-work                    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># GitLab용</span></span>
<span id="cb26-10">├── id_rsa                         <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 기본 key (old format)</span></span>
<span id="cb26-11">└── id_ed25519                     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 최신 key format</span></span></code></pre></div>
<ol start="2" type="1">
<li>SSH Config 파일로 Host 별칭 관리</li>
</ol>
<p>SSH config 파일 생성:</p>
<div class="sourceCode" id="cb27" style="background: #f1f3f5;"><pre class="sourceCode numberSource powershell number-lines code-with-copy"><code class="sourceCode powershell"><span id="cb27-1">notepad C<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>\Users\kmkim\<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ssh</span>\config</span></code></pre></div>
<p>다음 내용 추가:</p>
<pre><code># Azure VM - test-agent
Host azure-test
    HostName 20.196.144.16
    User azureuser
    IdentityFile C:\Users\kmkim\.ssh\azure-vm-test-agent.pem
    Port 22

# AWS EC2 - Development Server
Host aws-dev
    HostName ec2-1-2-3-4.compute-1.amazonaws.com
    User ec2-user
    IdentityFile C:\Users\kmkim\.ssh\aws-ec2-dev.pem
    Port 22

# GitHub
Host github.com
    HostName github.com
    User git
    IdentityFile C:\Users\kmkim\.ssh\github-personal

# GitLab
Host gitlab.com
    HostName gitlab.com
    User git
    IdentityFile C:\Users\kmkim\.ssh\gitlab-work</code></pre>
<ol start="3" type="1">
<li>간단한 접속 명령 * SSH config를 설정하면 긴 명령을 단축</li>
</ol>
<p><strong>Before (설정 전):</strong></p>
<div class="sourceCode" id="cb29" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb29-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ssh</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-i</span> C:<span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\U</span>sers<span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\k</span>mkim<span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\.</span>ssh<span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\a</span>zure-vm-test-agent.pem azureuser@20.196.144.16</span></code></pre></div>
<p><strong>After (설정 후):</strong></p>
<div class="sourceCode" id="cb30" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb30-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ssh</span> azure-test</span></code></pre></div>
<ol start="4" type="1">
<li>Key 권한 설정 (Windows) * SSH Key는 신중하게 보관 * Windows에서는:</li>
</ol>
<div class="sourceCode" id="cb31" style="background: #f1f3f5;"><pre class="sourceCode numberSource powershell number-lines code-with-copy"><code class="sourceCode powershell"><span id="cb31-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># .ssh 폴더 우클릭 → 속성 → 보안 → 고급</span></span>
<span id="cb31-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 현재 사용자만 읽기/쓰기 권한 허용</span></span>
<span id="cb31-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 다른 사용자는 접근 차단</span></span>
<span id="cb31-4"></span>
<span id="cb31-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 또는 PowerShell로:</span></span>
<span id="cb31-6">icacls <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"C:\Users\kmkim\.ssh"</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>inheritance<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>r <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>grant<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>r <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$env</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">USERNAME</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">`:</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">(F)"</span></span></code></pre></div>
<ul>
<li>SSH Key 명명 규칙 (권장)</li>
</ul>
<pre><code>&lt;서비스&gt;-&lt;용도&gt;-&lt;환경&gt;.pem

예:
- azure-vm-dev.pem
- aws-ec2-prod.pem
- github-personal
- gitlab-work-deploy</code></pre>
<section id="ssh-key-재생성-기존-key-분실탈취-시" class="level3" data-number="1.6.1">
<h3 data-number="1.6.1" class="anchored" data-anchor-id="ssh-key-재생성-기존-key-분실탈취-시"><span class="header-section-number">1.6.1</span> SSH Key 재생성 (기존 Key 분실/탈취 시)</h3>
<div class="sourceCode" id="cb33" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb33-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 1. 새로운 Key 생성</span></span>
<span id="cb33-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ssh-keygen</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-t</span> ed25519 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-C</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"azure-vm-replacement"</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-f</span> C:<span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\U</span>sers<span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\k</span>mkim<span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\.</span>ssh<span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\a</span>zure-vm-new.pem</span>
<span id="cb33-3"></span>
<span id="cb33-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 2. Azure Portal에서 기존 public key 삭제</span></span>
<span id="cb33-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 3. 새로운 public key 등록</span></span>
<span id="cb33-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 4. .ssh/config 파일 업데이트</span></span>
<span id="cb33-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 5. 기존 Key 파일 삭제 (또는 백업 폴더로 이동)</span></span></code></pre></div>


</section>
</section>
</section>

 ]]></description>
  <category>Engineering</category>
  <category>DevOps</category>
  <category>Infrastructure</category>
  <category>Azure</category>
  <category>Cloud</category>
  <guid>kk3225.netlify.app/docs/blog/posts/Engineering/DevOps/1-vm_dev_envs_settings.html</guid>
  <pubDate>Mon, 24 Nov 2025 15:00:00 GMT</pubDate>
</item>
<item>
  <title>Azure VM 생성부터 개발 환경 구축까지</title>
  <dc:creator>Kwangmin Kim</dc:creator>
  <link>kk3225.netlify.app/docs/blog/posts/Engineering/DevOps/0-vm_creation.html</link>
  <description><![CDATA[ 





<section id="azure-vm-생성-및-개발-환경-구축" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Azure VM 생성 및 개발 환경 구축</h1>
<p>Azure Portal에서 Ubuntu 24.04 LTS VM을 처음부터 생성하고, Git, Conda, Poetry를 설치하여 완전한 개발 환경을 구축하는 과정을 단계별로 정리한다.</p>
<section id="azure-vm이란" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="azure-vm이란"><span class="header-section-number">1.1</span> Azure VM이란?</h2>
<section id="vm-virtual-machine-개념" class="level3" data-number="1.1.1">
<h3 data-number="1.1.1" class="anchored" data-anchor-id="vm-virtual-machine-개념"><span class="header-section-number">1.1.1</span> VM (Virtual Machine) 개념</h3>
<p><strong>VM (가상 머신)</strong>은 클라우드에서 실행되는 가상 컴퓨터다. 물리적 서버 하나에서 여러 개의 독립적인 컴퓨터를 동시에 실행할 수 있다.</p>
<pre><code>물리 서버 (Azure 데이터센터)
├── VM 1 (Ubuntu 24.04) ← 우리가 생성할 VM
├── VM 2 (Windows Server)
├── VM 3 (Ubuntu 22.04)
└── VM 4 (CentOS)</code></pre>
</section>
<section id="azure-vm의-장점" class="level3" data-number="1.1.2">
<h3 data-number="1.1.2" class="anchored" data-anchor-id="azure-vm의-장점"><span class="header-section-number">1.1.2</span> Azure VM의 장점</h3>
<table class="table">
<thead>
<tr class="header">
<th>항목</th>
<th>물리 서버</th>
<th>Azure VM</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>구매 시간</strong></td>
<td>수일~수주</td>
<td>5분</td>
</tr>
<tr class="even">
<td><strong>초기 비용</strong></td>
<td>수백만~수천만원</td>
<td>Pay As You Go (사용한 만큼만)</td>
</tr>
<tr class="odd">
<td><strong>확장성</strong></td>
<td>하드웨어 추가 구매 필요</td>
<td>클릭 몇 번으로 즉시 확장</td>
</tr>
<tr class="even">
<td><strong>유지보수</strong></td>
<td>직접 관리</td>
<td>Azure가 관리</td>
</tr>
<tr class="odd">
<td><strong>위치</strong></td>
<td>한 곳 고정</td>
<td>전 세계 60+ 리전 선택 가능</td>
</tr>
</tbody>
</table>
</section>
<section id="주요-사용-사례" class="level3" data-number="1.1.3">
<h3 data-number="1.1.3" class="anchored" data-anchor-id="주요-사용-사례"><span class="header-section-number">1.1.3</span> 주요 사용 사례</h3>
<ul>
<li><strong>개발/테스트 환경</strong>: 로컬 PC 리소스 절약</li>
<li><strong>ML/DL 학습</strong>: GPU VM으로 모델 훈련</li>
<li><strong>웹 서버 호스팅</strong>: 24시간 서비스 운영</li>
<li><strong>데이터 분석</strong>: 대용량 메모리 사용</li>
<li><strong>CI/CD 파이프라인</strong>: 자동화된 빌드/배포</li>
</ul>
</section>
</section>
<section id="azure-vm-생성-과정" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="azure-vm-생성-과정"><span class="header-section-number">1.2</span> Azure VM 생성 과정</h2>
<section id="사전-준비" class="level3" data-number="1.2.1">
<h3 data-number="1.2.1" class="anchored" data-anchor-id="사전-준비"><span class="header-section-number">1.2.1</span> 사전 준비</h3>
<ol type="1">
<li><strong>Azure 계정</strong>
<ul>
<li><a href="https://portal.azure.com">Azure Portal</a> 접속</li>
<li>Microsoft 계정으로 로그인</li>
<li>무료 계정: 12개월 무료 서비스 + $200 크레딧 제공</li>
</ul></li>
<li><strong>구독 (Subscription) 확인</strong>
<ul>
<li>Azure Portal → 구독 메뉴에서 활성 구독 확인</li>
<li>무료 평가판 또는 종량제 구독 필요</li>
</ul></li>
</ol>
</section>
<section id="vm-생성-단계별-가이드" class="level3" data-number="1.2.2">
<h3 data-number="1.2.2" class="anchored" data-anchor-id="vm-생성-단계별-가이드"><span class="header-section-number">1.2.2</span> VM 생성 단계별 가이드</h3>
<section id="단계-vm-생성-시작" class="level4" data-number="1.2.2.1">
<h4 data-number="1.2.2.1" class="anchored" data-anchor-id="단계-vm-생성-시작"><span class="header-section-number">1.2.2.1</span> 1단계: VM 생성 시작</h4>
<pre><code>Azure Portal 
  → Virtual Machines 
  → Create 
  → Azure virtual machine</code></pre>
</section>
<section id="단계-기본-설정-basics" class="level4" data-number="1.2.2.2">
<h4 data-number="1.2.2.2" class="anchored" data-anchor-id="단계-기본-설정-basics"><span class="header-section-number">1.2.2.2</span> 2단계: 기본 설정 (Basics)</h4>
<p><strong>프로젝트 세부 정보</strong></p>
<table class="table">
<colgroup>
<col style="width: 28%">
<col style="width: 42%">
<col style="width: 28%">
</colgroup>
<thead>
<tr class="header">
<th>항목</th>
<th>설정 값</th>
<th>설명</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Subscription</strong></td>
<td>본인의 구독 선택</td>
<td>비용이 청구될 구독</td>
</tr>
<tr class="even">
<td><strong>Resource group</strong></td>
<td>신규 생성 또는 기존 선택</td>
<td>리소스 그룹명: <code>rg-dev-vm</code></td>
</tr>
</tbody>
</table>
<p><strong>인스턴스 세부 정보</strong></p>
<table class="table">
<colgroup>
<col style="width: 28%">
<col style="width: 42%">
<col style="width: 28%">
</colgroup>
<thead>
<tr class="header">
<th>항목</th>
<th>설정 값</th>
<th>설명</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Virtual machine name</strong></td>
<td><code>test-agent</code></td>
<td>VM 식별용 이름</td>
</tr>
<tr class="even">
<td><strong>Region</strong></td>
<td><code>Korea Central</code></td>
<td>서울 리전 (지연 시간 최소화)</td>
</tr>
<tr class="odd">
<td><strong>Availability options</strong></td>
<td>No infrastructure redundancy required</td>
<td>개발용은 단일 VM</td>
</tr>
<tr class="even">
<td><strong>Security type</strong></td>
<td>Standard</td>
<td>기본 보안</td>
</tr>
<tr class="odd">
<td><strong>Image</strong></td>
<td><strong>Ubuntu Server 24.04 LTS - x64 Gen2</strong></td>
<td>운영체제 선택</td>
</tr>
<tr class="even">
<td><strong>VM architecture</strong></td>
<td>x64</td>
<td>표준 아키텍처</td>
</tr>
</tbody>
</table>
<p><strong>크기 (Size)</strong></p>
<table class="table">
<thead>
<tr class="header">
<th>항목</th>
<th>설정 값</th>
<th>스펙</th>
<th>월 예상 비용</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Size</strong></td>
<td><code>Standard_D8as_v5</code></td>
<td>8 vCPUs, 32 GiB RAM</td>
<td>~$280</td>
</tr>
</tbody>
</table>
<p>크기 선택 팁: - <strong>B-series</strong>: 저렴, CPU 버스트 가능 (개발/테스트) - <strong>D-series</strong>: 범용, 균형잡힌 CPU/메모리 (일반 워크로드) - <strong>E-series</strong>: 메모리 집약적 (데이터베이스, 캐싱) - <strong>N-series</strong>: GPU 포함 (ML/DL, 렌더링)</p>
<p><strong>관리자 계정 (Administrator account)</strong></p>
<table class="table">
<colgroup>
<col style="width: 28%">
<col style="width: 42%">
<col style="width: 28%">
</colgroup>
<thead>
<tr class="header">
<th>항목</th>
<th>설정 값</th>
<th>설명</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Authentication type</strong></td>
<td><strong>SSH public key</strong></td>
<td>비밀번호보다 안전</td>
</tr>
<tr class="even">
<td><strong>Username</strong></td>
<td><code>azureuser</code></td>
<td>기본 사용자명 (변경 가능)</td>
</tr>
<tr class="odd">
<td><strong>SSH public key source</strong></td>
<td>Generate new key pair</td>
<td>Azure가 자동 생성</td>
</tr>
<tr class="even">
<td><strong>Key pair name</strong></td>
<td><code>test-agent_key</code></td>
<td>Private key 파일명</td>
</tr>
</tbody>
</table>
<blockquote class="blockquote">
<p><strong>중요</strong>: Private key (<code>.pem</code> 파일)는 VM 생성 완료 시 단 한 번만 다운로드 가능하다. 분실 시 VM 재생성 필요.</p>
</blockquote>
<p><strong>인바운드 포트 규칙 (Inbound port rules)</strong></p>
<table class="table">
<thead>
<tr class="header">
<th>항목</th>
<th>설정 값</th>
<th>설명</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Public inbound ports</strong></td>
<td>Allow selected ports</td>
<td>SSH 접속 허용</td>
</tr>
<tr class="even">
<td><strong>Select inbound ports</strong></td>
<td><strong>SSH (22)</strong></td>
<td>원격 접속용</td>
</tr>
</tbody>
</table>
<p>보안 강화 방법 (선택): - SSH 포트를 22에서 다른 포트로 변경 (예: 2222) - 특정 IP만 허용하도록 제한</p>
</section>
<section id="단계-디스크-설정-disks" class="level4" data-number="1.2.2.3">
<h4 data-number="1.2.2.3" class="anchored" data-anchor-id="단계-디스크-설정-disks"><span class="header-section-number">1.2.2.3</span> 3단계: 디스크 설정 (Disks)</h4>
<table class="table">
<colgroup>
<col style="width: 28%">
<col style="width: 42%">
<col style="width: 28%">
</colgroup>
<thead>
<tr class="header">
<th>항목</th>
<th>설정 값</th>
<th>설명</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>OS disk type</strong></td>
<td><strong>Standard SSD (locally-redundant storage)</strong></td>
<td>개발용은 Standard SSD 충분</td>
</tr>
<tr class="even">
<td><strong>Delete with VM</strong></td>
<td>체크</td>
<td>VM 삭제 시 디스크도 삭제</td>
</tr>
<tr class="odd">
<td><strong>Encryption type</strong></td>
<td>(Default) Encryption at rest with platform-managed key</td>
<td>기본 암호화</td>
</tr>
</tbody>
</table>
<p>디스크 타입 비교:</p>
<table class="table">
<thead>
<tr class="header">
<th>타입</th>
<th>IOPS</th>
<th>처리량</th>
<th>용도</th>
<th>비용</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Premium SSD</strong></td>
<td>최대 20,000</td>
<td>900 MB/s</td>
<td>프로덕션, DB</td>
<td>높음</td>
</tr>
<tr class="even">
<td><strong>Standard SSD</strong></td>
<td>최대 6,000</td>
<td>750 MB/s</td>
<td>개발, 테스트</td>
<td>중간</td>
</tr>
<tr class="odd">
<td><strong>Standard HDD</strong></td>
<td>최대 2,000</td>
<td>500 MB/s</td>
<td>백업, 아카이브</td>
<td>낮음</td>
</tr>
</tbody>
</table>
</section>
<section id="단계-네트워킹-networking" class="level4" data-number="1.2.2.4">
<h4 data-number="1.2.2.4" class="anchored" data-anchor-id="단계-네트워킹-networking"><span class="header-section-number">1.2.2.4</span> 4단계: 네트워킹 (Networking)</h4>
<p><strong>가상 네트워크 (Virtual network)</strong></p>
<table class="table">
<thead>
<tr class="header">
<th>항목</th>
<th>설정 값</th>
<th>설명</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Virtual network</strong></td>
<td>(new) test-agent-vnet</td>
<td>자동 생성</td>
</tr>
<tr class="even">
<td><strong>Subnet</strong></td>
<td>(new) default (10.0.0.0/24)</td>
<td>기본 서브넷</td>
</tr>
<tr class="odd">
<td><strong>Public IP</strong></td>
<td>(new) test-agent-ip</td>
<td>외부 접속용 공인 IP</td>
</tr>
<tr class="even">
<td><strong>NIC network security group</strong></td>
<td>Basic</td>
<td>기본 방화벽</td>
</tr>
<tr class="odd">
<td><strong>Public inbound ports</strong></td>
<td>Allow selected ports</td>
<td></td>
</tr>
<tr class="even">
<td><strong>Select inbound ports</strong></td>
<td>SSH (22)</td>
<td></td>
</tr>
</tbody>
</table>
<p><strong>고급 네트워킹 (선택)</strong> - Load balancing: 여러 VM에 트래픽 분산 (프로덕션) - Accelerated networking: 네트워크 성능 향상</p>
</section>
<section id="단계-관리-management" class="level4" data-number="1.2.2.5">
<h4 data-number="1.2.2.5" class="anchored" data-anchor-id="단계-관리-management"><span class="header-section-number">1.2.2.5</span> 5단계: 관리 (Management)</h4>
<p><strong>모니터링</strong></p>
<table class="table">
<colgroup>
<col style="width: 28%">
<col style="width: 42%">
<col style="width: 28%">
</colgroup>
<thead>
<tr class="header">
<th>항목</th>
<th>설정 값</th>
<th>설명</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Boot diagnostics</strong></td>
<td>Enable with managed storage account</td>
<td>부팅 문제 진단용</td>
</tr>
<tr class="even">
<td><strong>Enable OS guest diagnostics</strong></td>
<td>선택 해제</td>
<td>추가 비용 발생</td>
</tr>
</tbody>
</table>
<p><strong>자동 종료 (Auto-shutdown)</strong></p>
<table class="table">
<thead>
<tr class="header">
<th>항목</th>
<th>설정 값</th>
<th>설명</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Enable auto-shutdown</strong></td>
<td>체크 권장</td>
<td>비용 절감</td>
</tr>
<tr class="even">
<td><strong>Shutdown time</strong></td>
<td>19:00 (KST)</td>
<td>업무 종료 시간</td>
</tr>
<tr class="odd">
<td><strong>Time zone</strong></td>
<td>(UTC+09:00) Seoul</td>
<td></td>
</tr>
<tr class="even">
<td><strong>Notification before shutdown</strong></td>
<td>체크</td>
<td>종료 15분 전 알림</td>
</tr>
</tbody>
</table>
</section>
<section id="단계-고급-설정-advanced---기본값-유지" class="level4" data-number="1.2.2.6">
<h4 data-number="1.2.2.6" class="anchored" data-anchor-id="단계-고급-설정-advanced---기본값-유지"><span class="header-section-number">1.2.2.6</span> 6단계: 고급 설정 (Advanced) - 기본값 유지</h4>
<ul>
<li><strong>Extensions</strong>: VM 생성 후 설치 가능</li>
<li><strong>Cloud init</strong>: 초기화 스크립트 (선택)</li>
<li><strong>User data</strong>: 부팅 시 실행할 스크립트</li>
</ul>
</section>
<section id="단계-태그-tags---선택-사항" class="level4" data-number="1.2.2.7">
<h4 data-number="1.2.2.7" class="anchored" data-anchor-id="단계-태그-tags---선택-사항"><span class="header-section-number">1.2.2.7</span> 7단계: 태그 (Tags) - 선택 사항</h4>
<p>리소스 분류 및 비용 추적용:</p>
<table class="table">
<thead>
<tr class="header">
<th>Name</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Environment</td>
<td>Development</td>
</tr>
<tr class="even">
<td>Project</td>
<td>ML-Research</td>
</tr>
<tr class="odd">
<td>Owner</td>
<td>your-email@example.com</td>
</tr>
</tbody>
</table>
</section>
<section id="단계-검토-및-생성-review-create" class="level4" data-number="1.2.2.8">
<h4 data-number="1.2.2.8" class="anchored" data-anchor-id="단계-검토-및-생성-review-create"><span class="header-section-number">1.2.2.8</span> 8단계: 검토 및 생성 (Review + create)</h4>
<ol type="1">
<li><p><strong>비용 확인</strong></p>
<pre><code>Virtual machine: $280.00/month
Disks: $19.20/month (128 GiB Standard SSD)
Total estimated cost: ~$300/month</code></pre></li>
<li><p><strong>유효성 검증</strong></p>
<ul>
<li>“Validation passed” 확인</li>
</ul></li>
<li><p><strong>생성 클릭</strong></p>
<ul>
<li><strong>중요</strong>: Private key 다운로드 팝업이 나타남</li>
<li><code>test-agent_key.pem</code> 파일 다운로드 (필수!)</li>
<li>Downloads 폴더에 저장됨</li>
</ul></li>
<li><p><strong>배포 진행</strong></p>
<pre><code>Deployment is in progress...
├── Creating network interface...
├── Creating virtual machine...
├── Creating disk...
└── Starting virtual machine...

Deployment complete (약 2-3분 소요)</code></pre></li>
</ol>
</section>
<section id="단계-vm-생성-완료-확인" class="level4" data-number="1.2.2.9">
<h4 data-number="1.2.2.9" class="anchored" data-anchor-id="단계-vm-생성-완료-확인"><span class="header-section-number">1.2.2.9</span> 9단계: VM 생성 완료 확인</h4>
<p><strong>리소스 그룹에서 확인</strong></p>
<pre><code>Resource group: rg-dev-vm
├── test-agent (Virtual machine)
├── test-agent-ip (Public IP address)
├── test-agent-nsg (Network security group)
├── test-agent-vnet (Virtual network)
└── test-agent_disk_... (Disk)</code></pre>
<p><strong>Public IP 주소 확인</strong></p>
<pre><code>Virtual Machines → test-agent → Overview
Public IP address: 20.196.144.16 (예시)</code></pre>
</section>
</section>
</section>
<section id="ssh를-통한-vm-접속" class="level2" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="ssh를-통한-vm-접속"><span class="header-section-number">1.3</span> SSH를 통한 VM 접속</h2>
<section id="ssh란" class="level3" data-number="1.3.1">
<h3 data-number="1.3.1" class="anchored" data-anchor-id="ssh란"><span class="header-section-number">1.3.1</span> SSH란?</h3>
<p><strong>SSH (Secure Shell)</strong>는 인터넷을 통해 원격 컴퓨터에 안전하게 접속하는 프로토콜이다.</p>
</section>
<section id="웹-브라우저-콘솔-vs-ssh" class="level3" data-number="1.3.2">
<h3 data-number="1.3.2" class="anchored" data-anchor-id="웹-브라우저-콘솔-vs-ssh"><span class="header-section-number">1.3.2</span> 웹 브라우저 콘솔 vs SSH</h3>
<table class="table">
<colgroup>
<col style="width: 22%">
<col style="width: 59%">
<col style="width: 18%">
</colgroup>
<thead>
<tr class="header">
<th>항목</th>
<th>웹 브라우저 콘솔</th>
<th>SSH</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>접속 방식</strong></td>
<td>Azure Portal 웹 페이지 내</td>
<td>암호화된 네트워크 연결</td>
</tr>
<tr class="even">
<td><strong>보안</strong></td>
<td>웹 브라우저 보안 정책 적용 (제약 많음)</td>
<td>공개키 암호화 (매우 강력)</td>
</tr>
<tr class="odd">
<td><strong>권한</strong></td>
<td><code>no-new-privileges</code> 플래그로 sudo 차단</td>
<td>일반 사용자이지만 sudo 가능</td>
</tr>
<tr class="even">
<td><strong>통신</strong></td>
<td>평문 또는 약한 암호화</td>
<td>모든 데이터 암호화 (AES-256 등)</td>
</tr>
<tr class="odd">
<td><strong>인증</strong></td>
<td>Azure Portal 로그인</td>
<td>Private Key 파일 기반</td>
</tr>
<tr class="even">
<td><strong>안정성</strong></td>
<td>브라우저 다운시 연결 끊김</td>
<td>네트워크만 안정하면 지속 연결</td>
</tr>
</tbody>
</table>
</section>
<section id="ssh가-안전한-이유" class="level3" data-number="1.3.3">
<h3 data-number="1.3.3" class="anchored" data-anchor-id="ssh가-안전한-이유"><span class="header-section-number">1.3.3</span> SSH가 안전한 이유</h3>
<ol type="1">
<li><p><strong>공개키 암호화</strong> (Public Key Cryptography)</p>
<ul>
<li>클라이언트(PC)가 공개키를 가짐</li>
<li>서버(Azure VM)가 비공개키를 가짐</li>
<li>공개키로 암호화한 메시지는 비공개키로만 복호화 가능</li>
<li>통신 과정이 모두 암호화됨</li>
</ul></li>
<li><p><strong>Private Key 인증</strong></p>
<pre><code>클라이언트 (PC)           서버 (Azure VM)
test-agent_key.pem    ←→ 비공개키 저장
(Private Key)            (Private Key)

접속 요청 시:
1. 클라이언트가 Public Key로 challenge를 보냄
2. 서버가 비공개키로 검증
3. Private Key가 일치하면 접속 허용</code></pre></li>
<li><p><strong>중간자 공격 방지</strong></p>
<ul>
<li>SSH 키 교환 과정에서 호스트 키를 검증</li>
<li>첫 접속 시 호스트 지문(fingerprint)을 확인</li>
<li>같은 호스트면 이후 자동 인증</li>
</ul></li>
<li><p><strong>비밀번호 방식의 문제점</strong></p>
<ul>
<li>약한 비밀번호 → 브루트포스 공격에 취약</li>
<li>비밀번호 탈취 → 전체 VM 장악</li>
<li>SSH Key는 수천 자리의 암호화된 파일 → 거의 불가능</li>
</ul></li>
</ol>
</section>
<section id="ssh-접속-단계" class="level3" data-number="1.3.4">
<h3 data-number="1.3.4" class="anchored" data-anchor-id="ssh-접속-단계"><span class="header-section-number">1.3.4</span> SSH 접속 단계</h3>
<p><strong>1단계: Private Key 파일 준비</strong> - VM 생성 시 다운로드한 <code>test-agent_key.pem</code> 파일 위치 확인 - 보통 Downloads 폴더에 저장됨</p>
<p><strong>2단계: 로컬 PowerShell(Windows) 또는 Terminal(macOS/Linux)에서 접속</strong></p>
<div class="sourceCode" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb8-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ssh</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-i</span> C:<span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\U</span>sers<span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\k</span>mkim<span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\D</span>ownloads<span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\t</span>est-agent_key.pem azureuser@20.196.144.16</span></code></pre></div>
<p><strong>3단계: 첫 접속 시 호스트 인증</strong></p>
<pre><code>The authenticity of host '20.196.144.16' can't be established.
Are you sure you want to continue connecting (yes/no)?</code></pre>
<p>→ <code>yes</code> 입력</p>
<p><strong>4단계: 접속 완료</strong></p>
<pre><code>azureuser@test-agent:~$</code></pre>
<p><strong>SSH 접속의 장점:</strong> - 웹 콘솔의 제약이 없음 - sudo 권한이 정상 작동 - 더 안정적이고 빠름 - 로컬에서 언제든 접속 가능</p>
</section>
</section>
<section id="vm-종료-및-관리" class="level2" data-number="1.4">
<h2 data-number="1.4" class="anchored" data-anchor-id="vm-종료-및-관리"><span class="header-section-number">1.4</span> VM 종료 및 관리</h2>
<section id="vm-중지-비용-절감" class="level3" data-number="1.4.1">
<h3 data-number="1.4.1" class="anchored" data-anchor-id="vm-중지-비용-절감"><span class="header-section-number">1.4.1</span> VM 중지 (비용 절감)</h3>
<div class="sourceCode" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb11-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># SSH 연결 종료</span></span>
<span id="cb11-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">exit</span></span>
<span id="cb11-3"></span>
<span id="cb11-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Azure Portal에서:</span></span>
<span id="cb11-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Virtual Machines → test-agent → Stop 클릭</span></span></code></pre></div>
<ul>
<li><strong>Stop</strong>: 비용 청구 안 됨, 나중에 재시작 가능</li>
<li><strong>Delete</strong>: 완전 삭제 (복구 불가)</li>
</ul>
</section>
<section id="vm-재시작" class="level3" data-number="1.4.2">
<h3 data-number="1.4.2" class="anchored" data-anchor-id="vm-재시작"><span class="header-section-number">1.4.2</span> VM 재시작</h3>
<div class="sourceCode" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb12-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ssh</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-i</span> C:<span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\U</span>sers<span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\k</span>mkim<span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\D</span>ownloads<span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\t</span>est-agent_key.pem azureuser@20.196.144.16</span></code></pre></div>
</section>
</section>
<section id="편의성-개선-선택사항" class="level2" data-number="1.5">
<h2 data-number="1.5" class="anchored" data-anchor-id="편의성-개선-선택사항"><span class="header-section-number">1.5</span> 편의성 개선 (선택사항)</h2>
<section id="powershell에-ssh-alias-설정" class="level3" data-number="1.5.1">
<h3 data-number="1.5.1" class="anchored" data-anchor-id="powershell에-ssh-alias-설정"><span class="header-section-number">1.5.1</span> PowerShell에 SSH Alias 설정</h3>
<p>PowerShell 프로필 편집:</p>
<div class="sourceCode" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode numberSource powershell number-lines code-with-copy"><code class="sourceCode powershell"><span id="cb13-1">notepad <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$PROFILE</span></span></code></pre></div>
<p>다음 추가:</p>
<div class="sourceCode" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode numberSource powershell number-lines code-with-copy"><code class="sourceCode powershell"><span id="cb14-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Set-Alias</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>Name ssh-vm <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>Value <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ssh -i C:\Users\kmkim\Downloads\test-agent_key.pem azureuser@20.196.144.16'</span></span></code></pre></div>
<p>이후 접속:</p>
<div class="sourceCode" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb15-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">ssh-vm</span></span></code></pre></div>
</section>
</section>
<section id="ssh-key-관리-전략" class="level2" data-number="1.6">
<h2 data-number="1.6" class="anchored" data-anchor-id="ssh-key-관리-전략"><span class="header-section-number">1.6</span> SSH Key 관리 전략</h2>
<p>Azure VM, AWS EC2, GitHub, GitLab 등 여러 서비스를 사용하면 SSH Key가 점점 많아진다. 효율적인 관리 전략이 필요하다.</p>
<section id="key-저장소-통일-.ssh-폴더" class="level3" data-number="1.6.1">
<h3 data-number="1.6.1" class="anchored" data-anchor-id="key-저장소-통일-.ssh-폴더"><span class="header-section-number">1.6.1</span> 1. Key 저장소 통일 (.ssh 폴더)</h3>
<div class="sourceCode" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode numberSource powershell number-lines code-with-copy"><code class="sourceCode powershell"><span id="cb16-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Windows의 .ssh 폴더 (자동 생성됨)</span></span>
<span id="cb16-2">C<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>\Users\kmkim\<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ssh</span>\</span>
<span id="cb16-3"></span>
<span id="cb16-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Key 파일들을 모두 여기에 정리</span></span>
<span id="cb16-5">C<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>\Users\kmkim\<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ssh</span>\</span>
<span id="cb16-6">├── azure-vm-test-agent<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pem</span>      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Azure VM용</span></span>
<span id="cb16-7">├── aws-ec2-dev<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pem</span>               <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># AWS EC2용</span></span>
<span id="cb16-8">├── github-personal                <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># GitHub용 (확장자 없음)</span></span>
<span id="cb16-9">├── gitlab-work                    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># GitLab용</span></span>
<span id="cb16-10">├── id_rsa                         <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 기본 key (old format)</span></span>
<span id="cb16-11">└── id_ed25519                     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 최신 key format</span></span>
<span id="cb16-12">└── id_ed25519                     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 최신 key format</span></span></code></pre></div>
</section>
<section id="ssh-config-파일로-host-별칭-관리" class="level3" data-number="1.6.2">
<h3 data-number="1.6.2" class="anchored" data-anchor-id="ssh-config-파일로-host-별칭-관리"><span class="header-section-number">1.6.2</span> 2. SSH Config 파일로 Host 별칭 관리</h3>
<p>SSH config 파일 생성:</p>
<div class="sourceCode" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode numberSource powershell number-lines code-with-copy"><code class="sourceCode powershell"><span id="cb17-1">notepad C<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>\Users\kmkim\<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ssh</span>\config</span></code></pre></div>
<p>다음 내용 추가:</p>
<pre><code># Azure VM - test-agent
Host azure-test
    HostName 20.196.144.16
    User azureuser
    IdentityFile C:\Users\kmkim\.ssh\azure-vm-test-agent.pem
    Port 22

# AWS EC2 - Development Server
Host aws-dev
    HostName ec2-1-2-3-4.compute-1.amazonaws.com
    User ec2-user
    IdentityFile C:\Users\kmkim\.ssh\aws-ec2-dev.pem
    Port 22

# GitHub
Host github.com
    HostName github.com
    User git
    IdentityFile C:\Users\kmkim\.ssh\github-personal

# GitLab
Host gitlab.com
    HostName gitlab.com
    User git
    IdentityFile C:\Users\kmkim\.ssh\gitlab-work</code></pre>
</section>
<section id="간단한-접속-명령" class="level3" data-number="1.6.3">
<h3 data-number="1.6.3" class="anchored" data-anchor-id="간단한-접속-명령"><span class="header-section-number">1.6.3</span> 3. 간단한 접속 명령</h3>
<p>SSH config를 설정하면 긴 명령을 단축할 수 있다.</p>
<p><strong>Before (설정 전):</strong></p>
<div class="sourceCode" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb19-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ssh</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-i</span> C:<span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\U</span>sers<span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\k</span>mkim<span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\.</span>ssh<span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\a</span>zure-vm-test-agent.pem azureuser@20.196.144.16</span></code></pre></div>
<p><strong>After (설정 후):</strong></p>
<div class="sourceCode" id="cb20" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb20-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ssh</span> azure-test</span></code></pre></div>
</section>
<section id="key-권한-설정-windows" class="level3" data-number="1.6.4">
<h3 data-number="1.6.4" class="anchored" data-anchor-id="key-권한-설정-windows"><span class="header-section-number">1.6.4</span> 4. Key 권한 설정 (Windows)</h3>
<p>SSH Key는 신중하게 보관해야 한다.</p>
<div class="sourceCode" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode numberSource powershell number-lines code-with-copy"><code class="sourceCode powershell"><span id="cb21-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># .ssh 폴더 우클릭 → 속성 → 보안 → 고급</span></span>
<span id="cb21-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 현재 사용자만 읽기/쓰기 권한 허용</span></span>
<span id="cb21-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 다른 사용자는 접근 차단</span></span>
<span id="cb21-4"></span>
<span id="cb21-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 또는 PowerShell로:</span></span>
<span id="cb21-6">icacls <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"C:\Users\kmkim\.ssh"</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>inheritance<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>r <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>grant<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>r <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$env</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">USERNAME</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">`:</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">(F)"</span></span></code></pre></div>
</section>
<section id="ssh-key-명명-규칙-권장" class="level3" data-number="1.6.5">
<h3 data-number="1.6.5" class="anchored" data-anchor-id="ssh-key-명명-규칙-권장"><span class="header-section-number">1.6.5</span> 5. SSH Key 명명 규칙 (권장)</h3>
<pre><code>&lt;서비스&gt;-&lt;용도&gt;-&lt;환경&gt;.pem

예:
- azure-vm-dev.pem
- aws-ec2-prod.pem
- github-personal
- gitlab-work-deploy</code></pre>
</section>
</section>
<section id="ssh-key-보안" class="level2" data-number="1.7">
<h2 data-number="1.7" class="anchored" data-anchor-id="ssh-key-보안"><span class="header-section-number">1.7</span> SSH Key 보안</h2>
<section id="보안-체크리스트" class="level3" data-number="1.7.1">
<h3 data-number="1.7.1" class="anchored" data-anchor-id="보안-체크리스트"><span class="header-section-number">1.7.1</span> 보안 체크리스트</h3>
<p><strong>해야 할 것:</strong> - [ ] <code>.ssh</code> 폴더는 사용자만 접근 가능하도록 권한 설정 - [ ] Private Key는 절대 공유/업로드하지 않기 - [ ] <code>.ssh/config</code> 파일로 중앙 관리 - [ ] 각 Key마다 명확한 목적 주석 추가 - [ ] 정기적으로 사용하지 않는 Key 삭제</p>
<p><strong>하지 말아야 할 것:</strong> - [ ] Private Key를 GitHub에 커밋 - [ ] <code>.gitignore</code>에 <code>*.pem</code> 추가하지 않기 - [ ] 여러 서비스에 같은 Key 재사용 (한 곳 탈취 시 모두 위험) - [ ] Key 파일을 다운로드 폴더에 방치</p>
</section>
<section id="실무-key-관리" class="level3" data-number="1.7.2">
<h3 data-number="1.7.2" class="anchored" data-anchor-id="실무-key-관리"><span class="header-section-number">1.7.2</span> 실무 Key 관리</h3>
<p><strong>개인 PC:</strong></p>
<pre><code>Private Key (test-agent_key.pem)
    ↓
.ssh 폴더에만 저장
    ↓
접속 시만 사용</code></pre>
<p><strong>서버:</strong></p>
<pre><code>Public Key만 저장 (~/.ssh/authorized_keys)
    ↓
Private Key는 저장하지 않음
    ↓
누군가 서버를 해킹해도 다른 서버에 접속 불가</code></pre>
</section>
<section id="ssh-key-재생성-기존-key-분실탈취-시" class="level3" data-number="1.7.3">
<h3 data-number="1.7.3" class="anchored" data-anchor-id="ssh-key-재생성-기존-key-분실탈취-시"><span class="header-section-number">1.7.3</span> SSH Key 재생성 (기존 Key 분실/탈취 시)</h3>
<div class="sourceCode" id="cb25" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb25-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 1. 새로운 Key 생성</span></span>
<span id="cb25-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ssh-keygen</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-t</span> ed25519 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-C</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"azure-vm-replacement"</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-f</span> C:<span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\U</span>sers<span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\k</span>mkim<span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\.</span>ssh<span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\a</span>zure-vm-new.pem</span>
<span id="cb25-3"></span>
<span id="cb25-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 2. Azure Portal에서 기존 public key 삭제</span></span>
<span id="cb25-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 3. 새로운 public key 등록</span></span>
<span id="cb25-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 4. .ssh/config 파일 업데이트</span></span>
<span id="cb25-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 5. 기존 Key 파일 삭제 (또는 백업 폴더로 이동)</span></span></code></pre></div>
</section>
</section>
<section id="vm-관리" class="level2" data-number="1.8">
<h2 data-number="1.8" class="anchored" data-anchor-id="vm-관리"><span class="header-section-number">1.8</span> VM 관리</h2>
<section id="vm-중지-및-재시작" class="level3" data-number="1.8.1">
<h3 data-number="1.8.1" class="anchored" data-anchor-id="vm-중지-및-재시작"><span class="header-section-number">1.8.1</span> VM 중지 및 재시작</h3>
<p><strong>VM 중지 (비용 절감)</strong></p>
<div class="sourceCode" id="cb26" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb26-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># SSH 연결 종료</span></span>
<span id="cb26-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">exit</span></span>
<span id="cb26-3"></span>
<span id="cb26-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Azure Portal에서:</span></span>
<span id="cb26-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Virtual Machines → test-agent → Stop 클릭</span></span></code></pre></div>
<ul>
<li><strong>Stop</strong>: 비용 청구 안 됨, 나중에 재시작 가능</li>
<li><strong>Delete</strong>: 완전 삭제 (복구 불가)</li>
</ul>
<p><strong>VM 재시작</strong></p>
<div class="sourceCode" id="cb27" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb27-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ssh</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-i</span> C:<span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\U</span>sers<span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\k</span>mkim<span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\D</span>ownloads<span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\t</span>est-agent_key.pem azureuser@20.196.144.16</span></code></pre></div>
</section>
<section id="중요-개념-정리" class="level3" data-number="1.8.2">
<h3 data-number="1.8.2" class="anchored" data-anchor-id="중요-개념-정리"><span class="header-section-number">1.8.2</span> 중요 개념 정리</h3>
<table class="table">
<thead>
<tr class="header">
<th>개념</th>
<th>설명</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>VM (Virtual Machine)</strong></td>
<td>클라우드에서 실행되는 가상 컴퓨터</td>
</tr>
<tr class="even">
<td><strong>Image</strong></td>
<td>VM의 운영체제 템플릿</td>
</tr>
<tr class="odd">
<td><strong>SSH</strong></td>
<td>원격 서버에 안전하게 접속하는 프로토콜</td>
</tr>
<tr class="even">
<td><strong>Private Key</strong></td>
<td>SSH 접속 인증용 파일 (.pem)</td>
</tr>
<tr class="odd">
<td><strong>Public IP</strong></td>
<td>외부에서 VM에 접속하기 위한 공인 IP 주소</td>
</tr>
</tbody>
</table>


</section>
</section>
</section>

 ]]></description>
  <category>Engineering</category>
  <category>DevOps</category>
  <category>Infrastructure</category>
  <category>Azure</category>
  <category>Cloud</category>
  <guid>kk3225.netlify.app/docs/blog/posts/Engineering/DevOps/0-vm_creation.html</guid>
  <pubDate>Sun, 23 Nov 2025 15:00:00 GMT</pubDate>
</item>
<item>
  <title>Python 개발 &amp; 배포 생태계</title>
  <dc:creator>Kwangmin Kim</dc:creator>
  <link>kk3225.netlify.app/docs/blog/posts/Engineering/DevOps/dev_envs.html</link>
  <description><![CDATA[ 





<section id="python-개발-배포-생태계-개요" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Python 개발 &amp; 배포 생태계 개요</h1>
<section id="단계-라이프사이클" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="단계-라이프사이클"><span class="header-section-number">1.1</span> 3단계 라이프사이클</h2>
<p>Python 프로젝트는 <strong>개발 단계</strong> → <strong>배포 단계</strong> → <strong>운영 단계</strong>의 3단계를 거친다.</p>
<table class="table">
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header">
<th>단계</th>
<th>도구</th>
<th>목적</th>
<th>특징</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>개발</strong></td>
<td>venv / pyenv / Poetry / Conda</td>
<td>로컬에서 안전하게 코드 작성 &amp; 테스트</td>
<td>의존성 격리, 버전 관리</td>
</tr>
<tr class="even">
<td><strong>배포</strong></td>
<td>Docker</td>
<td>개발 환경 전체를 컨테이너로 패킹</td>
<td>재현성 100%, 어디서나 동일 실행</td>
</tr>
<tr class="odd">
<td><strong>운영</strong></td>
<td>Kubernetes (또는 Docker Compose/ECS)</td>
<td>수백/수천 개 컨테이너 자동 관리</td>
<td>자동 스케일링, 무중단 배포, 자가 치유</td>
</tr>
</tbody>
</table>
</section>
<section id="전체-생태계-계층" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="전체-생태계-계층"><span class="header-section-number">1.2</span> 전체 생태계 계층</h2>
<section id="단계-도구-스택" class="level3" data-number="1.2.1">
<h3 data-number="1.2.1" class="anchored" data-anchor-id="단계-도구-스택"><span class="header-section-number">1.2.1</span> 3단계 도구 스택</h3>
<section id="개발-단계-venv-pyenv-poetry-conda" class="level4" data-number="1.2.1.1">
<h4 data-number="1.2.1.1" class="anchored" data-anchor-id="개발-단계-venv-pyenv-poetry-conda"><span class="header-section-number">1.2.1.1</span> 개발 단계: venv → pyenv → Poetry → Conda</h4>
<p>로컬 머신에서 코드 작성 &amp; 테스트</p>
<section id="conda-가장-포괄적" class="level5" data-number="1.2.1.1.1">
<h5 data-number="1.2.1.1.1" class="anchored" data-anchor-id="conda-가장-포괄적"><span class="header-section-number">1.2.1.1.1</span> Conda (가장 포괄적)</h5>
<ul>
<li>언어 무관 + Python 버전 관리 + 이진 파일</li>
<li><strong>추천</strong>: Data Science / 과학 계산</li>
</ul>
</section>
<section id="pyenv-poetry-권장" class="level5" data-number="1.2.1.1.2">
<h5 data-number="1.2.1.1.2" class="anchored" data-anchor-id="pyenv-poetry-권장"><span class="header-section-number">1.2.1.1.2</span> pyenv + Poetry (권장)</h5>
<ul>
<li>Python 의존성 + 패키징 + 가상환경</li>
<li><strong>추천</strong>: 순수 Python 개발 / 팀 협업</li>
</ul>
</section>
<section id="pyenv-pip-비권장" class="level5" data-number="1.2.1.1.3">
<h5 data-number="1.2.1.1.3" class="anchored" data-anchor-id="pyenv-pip-비권장"><span class="header-section-number">1.2.1.1.3</span> pyenv + pip (비권장)</h5>
<ul>
<li>pyenv: Python 버전 관리</li>
<li>pip: 패키지 설치 (수동 관리)</li>
<li>권장하지 않음</li>
</ul>
</section>
<section id="venv-pip-기본-학습용" class="level5" data-number="1.2.1.1.4">
<h5 data-number="1.2.1.1.4" class="anchored" data-anchor-id="venv-pip-기본-학습용"><span class="header-section-number">1.2.1.1.4</span> venv + pip (기본 학습용)</h5>
<ul>
<li>가상환경 + 수동 패키지 설치</li>
<li><strong>추천</strong>: Python 학습 초기 단계만</li>
</ul>
</section>
<section id="venv-가장-기본" class="level5" data-number="1.2.1.1.5">
<h5 data-number="1.2.1.1.5" class="anchored" data-anchor-id="venv-가장-기본"><span class="header-section-number">1.2.1.1.5</span> venv (가장 기본)</h5>
<ul>
<li>가상환경 생성만</li>
<li>실무에서는 권장하지 않음</li>
</ul>
</section>
</section>
<section id="배포-단계-docker-환경-캡슐화" class="level4" data-number="1.2.1.2">
<h4 data-number="1.2.1.2" class="anchored" data-anchor-id="배포-단계-docker-환경-캡슐화"><span class="header-section-number">1.2.1.2</span> 배포 단계: Docker (환경 캡슐화)</h4>
<ul>
<li>개발 환경 전체를 컨테이너로 패킹</li>
<li>macOS/Linux/Windows 어디서나 동일 실행</li>
<li>OS 부터 Python, 라이브러리까지 모두 포함</li>
<li>재현성 100% (언제 어디서나 같은 결과)</li>
<li><strong>언제</strong>: 팀 협업, 클라우드 배포, CI/CD</li>
<li><strong>추천</strong>: 권장</li>
</ul>
</section>
<section id="운영-단계-kubernetes-대규모-자동화" class="level4" data-number="1.2.1.3">
<h4 data-number="1.2.1.3" class="anchored" data-anchor-id="운영-단계-kubernetes-대규모-자동화"><span class="header-section-number">1.2.1.3</span> 운영 단계: Kubernetes (대규모 자동화)</h4>
<ul>
<li>수백 개 컨테이너 동시 관리</li>
<li>자동 스케일링 (트래픽 많으면 자동 복사본 증가)</li>
<li>무중단 배포 (한두 개씩 교체하며 업데이트)</li>
<li>로드밸런싱 (여러 복사본 사이에 트래픽 분산)</li>
<li>자동 복구 (컨테이너 죽으면 자동 재시작)</li>
<li><strong>언제</strong>: 대규모 서비스 (마이크로서비스, 엔터프라이즈)</li>
<li>PoC/개인 프로젝트는 오버킬</li>
</ul>
</section>
</section>
</section>
<section id="개발-단계-도구별-상세-분석" class="level2" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="개발-단계-도구별-상세-분석"><span class="header-section-number">1.3</span> 개발 단계: 도구별 상세 분석</h2>
<section id="도구-비교표-기본-포괄적" class="level3" data-number="1.3.1">
<h3 data-number="1.3.1" class="anchored" data-anchor-id="도구-비교표-기본-포괄적"><span class="header-section-number">1.3.1</span> 도구 비교표 (기본 → 포괄적)</h3>
<table class="table">
<colgroup>
<col style="width: 12%">
<col style="width: 20%">
<col style="width: 22%">
<col style="width: 22%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th>항목</th>
<th><strong>venv</strong></th>
<th><strong>pyenv</strong></th>
<th><strong>Poetry</strong></th>
<th><strong>Conda</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>역할</strong></td>
<td>가상환경만</td>
<td>여러 Python 버전 병렬 관리</td>
<td>의존성 + 패키징 + 환경</td>
<td>언어 무관 패키지 관리</td>
</tr>
<tr class="even">
<td><strong>관리 대상</strong></td>
<td>패키지 격리</td>
<td>Python 인터프리터 버전</td>
<td>패키지 + Python 버전</td>
<td>모든 언어 패키지 + 이진 파일</td>
</tr>
<tr class="odd">
<td><strong>지원 언어</strong></td>
<td>Python만</td>
<td>Python만</td>
<td>Python만</td>
<td>Python, R, C++, Java 등</td>
</tr>
<tr class="even">
<td><strong>설정 파일</strong></td>
<td>없음 (수동)</td>
<td>버전 파일만 (<code>.python-version</code>)</td>
<td><code>pyproject.toml</code>, <code>poetry.lock</code></td>
<td><code>environment.yml</code>, <code>conda.lock</code></td>
</tr>
<tr class="odd">
<td><strong>저장소</strong></td>
<td>PyPI (pip)</td>
<td>없음 (Python.org)</td>
<td>PyPI</td>
<td>Conda-forge, Anaconda</td>
</tr>
<tr class="even">
<td><strong>설치 명령</strong></td>
<td><code>python -m venv</code></td>
<td><code>brew install pyenv</code> (또는 git clone)</td>
<td><code>pip install poetry</code></td>
<td><code>conda install</code></td>
</tr>
<tr class="odd">
<td><strong>가상환경</strong></td>
<td>✓ 생성</td>
<td>△ 조합 필요 (다른 도구와)</td>
<td>✓ 자동 생성</td>
<td>✓ 생성 (이름 지정)</td>
</tr>
<tr class="even">
<td><strong>의존성 관리</strong></td>
<td>✗ 수동 (pip)</td>
<td>✗ 없음</td>
<td>✓ 자동 + 잠금</td>
<td>✓ 자동 + 잠금</td>
</tr>
<tr class="odd">
<td><strong>버전 해석</strong></td>
<td>PEP 440 (pip)</td>
<td>N/A</td>
<td>PEP 440 + Semantic Versioning</td>
<td>Conda 규칙 (유연함)</td>
</tr>
<tr class="even">
<td><strong>패키징/배포</strong></td>
<td>✗ 불가능</td>
<td>✗ 불가능</td>
<td>✓ 자동화</td>
<td>△ 가능 (복잡)</td>
</tr>
<tr class="odd">
<td><strong>의존성 잠금</strong></td>
<td>✗ 수동</td>
<td>N/A</td>
<td>✓ <code>poetry.lock</code> 자동</td>
<td>✓ 자동 (<code>conda-lock</code> 포함)</td>
</tr>
<tr class="even">
<td><strong>재현성</strong></td>
<td>50% (수동 관리)</td>
<td>100% (버전 파일)</td>
<td>100%</td>
<td>100%</td>
</tr>
<tr class="odd">
<td><strong>학습곡선</strong></td>
<td>극저 (1~2줄)</td>
<td>낮음 (직관적)</td>
<td>낮음 (직관적)</td>
<td>중간~높음</td>
</tr>
<tr class="even">
<td><strong>엔터프라이즈</strong></td>
<td>최소 (레거시)</td>
<td>중간 (증가 중)</td>
<td>높음 (표준화 추세)</td>
<td>높음 (데이터 과학)</td>
</tr>
</tbody>
</table>
</section>
<section id="버전관리-도구-선택-기준" class="level3" data-number="1.3.2">
<h3 data-number="1.3.2" class="anchored" data-anchor-id="버전관리-도구-선택-기준"><span class="header-section-number">1.3.2</span> 버전관리 도구 선택 기준</h3>
<section id="단계-venv-가장-기본" class="level4" data-number="1.3.2.1">
<h4 data-number="1.3.2.1" class="anchored" data-anchor-id="단계-venv-가장-기본"><span class="header-section-number">1.3.2.1</span> 1단계: venv (가장 기본)</h4>
<ul>
<li>정의: Python 표준 라이브러리의 가상환경 도구</li>
<li>교육/단순한 스크립트</li>
<li>Python 학습 초기 단계</li>
<li>매우 간단한 일회성 스크립트</li>
<li>의존성 추적이 불필요한 경우</li>
<li>한계
<ul>
<li>패키지 버전 관리 수동</li>
<li>lock file 없음 (재현 불가)</li>
<li>배포 불가능</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">python</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-m</span> venv venv              <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 가상환경 생성 (빈 상자)</span></span>
<span id="cb1-2"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> venv/bin/activate         <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 활성화</span></span>
<span id="cb1-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">pip</span> install pandas               <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 수동으로 패키지 설치</span></span>
<span id="cb1-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 문제: 누가 어떤 버전 설치했는지 추적 불가능</span></span></code></pre></div>
<hr>
</section>
<section id="단계-pyenv-python-버전-관리-추가" class="level4" data-number="1.3.2.2">
<h4 data-number="1.3.2.2" class="anchored" data-anchor-id="단계-pyenv-python-버전-관리-추가"><span class="header-section-number">1.3.2.2</span> 2단계: pyenv (Python 버전 관리 추가)</h4>
<ul>
<li>정의: 시스템에 여러 Python 버전을 설치/관리하는 도구</li>
<li>언제 사용:
<ul>
<li>여러 프로젝트가 다른 Python 버전 필요</li>
<li>신 버전과 구 버전을 동시 테스트 필요</li>
<li>프로젝트별 Python 버전 격리 필요</li>
</ul></li>
<li>특징
<ul>
<li>Python 인터프리터 버전만 관리</li>
<li>패키지 관리는 별도 도구 필요</li>
<li>venv와 함께 사용 가능</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">pyenv</span> install 3.11          <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Python 3.11 설치</span></span>
<span id="cb2-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">pyenv</span> install 3.9           <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Python 3.9 설치</span></span>
<span id="cb2-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">pyenv</span> global 3.11           <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 기본 버전을 3.11로 설정</span></span>
<span id="cb2-4"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">pyenv</span> local 3.9             <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 프로젝트 폴더에서는 3.9 사용</span></span>
<span id="cb2-5"></span>
<span id="cb2-6"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">python</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--version</span>            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 자동으로 설정된 버전 사용</span></span></code></pre></div>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># pyenv + venv 조합</span></span>
<span id="cb3-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">pyenv</span> global 3.11              <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Python 3.11 선택</span></span>
<span id="cb3-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">python</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-m</span> venv project_env     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 가상환경 생성</span></span>
<span id="cb3-4"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> project_env/bin/activate</span>
<span id="cb3-5"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">pip</span> install pandas</span></code></pre></div>
</section>
<section id="단계-poetry-python-버전-의존성-패키징" class="level4" data-number="1.3.2.3">
<h4 data-number="1.3.2.3" class="anchored" data-anchor-id="단계-poetry-python-버전-의존성-패키징"><span class="header-section-number">1.3.2.3</span> 3단계: Poetry (Python 버전 + 의존성 + 패키징)</h4>
<ul>
<li>정의: Python 프로젝트의 의존성 관리, 가상환경, 패키징을 통합 관리</li>
<li>언제 사용:
<ul>
<li>최신 개발자/팀 협업</li>
<li>순수 Python 프로젝트</li>
<li>PyPI에 배포할 계획</li>
<li>팀 협업 (재현성이 중요할 때)</li>
<li>프로젝트 템플릿 필요</li>
</ul></li>
<li>장점:
<ul>
<li>선언적 문법 (직관적)</li>
<li>자동 하위 의존성 관리</li>
<li><code>poetry.lock</code>으로 100% 재현성</li>
<li>배포까지 통합 지원</li>
</ul></li>
<li>한계:
<ul>
<li>Python 언어만 지원</li>
<li>별도 설치 필요</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb4-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">poetry</span> new my_project           <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 완전한 프로젝트 생성</span></span>
<span id="cb4-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">poetry</span> add pandas numpy          <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 의존성 자동 관리</span></span>
<span id="cb4-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">poetry</span> run python main.py        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 격리된 환경에서 실행</span></span>
<span id="cb4-4"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">poetry</span> build                     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 배포 가능한 패키지 생성</span></span>
<span id="cb4-5"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">poetry</span> publish                   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># PyPI에 배포</span></span></code></pre></div>
</section>
<section id="단계-conda-가장-포괄적" class="level4" data-number="1.3.2.4">
<h4 data-number="1.3.2.4" class="anchored" data-anchor-id="단계-conda-가장-포괄적"><span class="header-section-number">1.3.2.4</span> 4단계: Conda (가장 포괄적)</h4>
<ul>
<li>정의: 모든 프로그래밍 언어의 패키지를 관리하는 생태계</li>
<li>언제 사용:
<ul>
<li>데이터 사이언스 (NumPy, Pandas, SciPy, Pytorch, sklearn, etc.)</li>
<li>다국어 환경 (Python + R + C++)</li>
<li>과학 계산 커뮤니티 (Anaconda 생태계)</li>
<li>복잡한 바이너리 의존성</li>
<li>회사에서 라이센스 지원</li>
<li>특수 라이브러리가 PyPI에 없을 때</li>
</ul></li>
<li>장점:
<ul>
<li>언어 무관 (Python, R, Julia, C++ 등)</li>
<li>바이너리 사전 컴파일 (과학 패키지 최적화)</li>
<li>거대한 커뮤니티 (특히 데이터 과학)</li>
<li>채널 시스템 (더 유연한 버전 관리)</li>
</ul></li>
<li>한계:
<ul>
<li>학습곡선이 높음 (옵션 많음)</li>
<li>디스크 용량 큼</li>
<li>배포 어려움</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">conda</span> create <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-n</span> my_env python=3.11 numpy pandas scipy  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 통합 설치</span></span>
<span id="cb5-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">conda</span> activate my_env                                  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 활성화</span></span>
<span id="cb5-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">conda</span> install scikit-learn                             <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 추가 설치</span></span></code></pre></div>
</section>
</section>
</section>
<section id="배포-단계-docker" class="level2" data-number="1.4">
<h2 data-number="1.4" class="anchored" data-anchor-id="배포-단계-docker"><span class="header-section-number">1.4</span> 배포 단계: Docker</h2>
<section id="docker란" class="level3" data-number="1.4.1">
<h3 data-number="1.4.1" class="anchored" data-anchor-id="docker란"><span class="header-section-number">1.4.1</span> Docker란?</h3>
<ul>
<li>정의: 시스템 포함 개발 환경 전체를 컨테이너(가상 상자)로 패킹하여 어디서나 동일하게 실행하는 도구</li>
<li>특징:
<ul>
<li>OS 부터 언어(Python, R), 라이브러리까지 모두 포함</li>
<li>macOS, Linux, Windows에서 <strong>100% 동일하게 실행</strong></li>
<li>“내 컴퓨터에선 되는데, 서버에선 왜 안 돼?” 문제 해결</li>
</ul></li>
<li>언제 사용:
<ul>
<li>팀 협업 (개발자마다 다른 환경)</li>
<li>클라우드 배포 (AWS, GCP, Azure)</li>
<li>CI/CD 파이프라인 (자동화 테스트)</li>
<li>마이크로서비스 아키텍처</li>
</ul></li>
<li>한계:
<ul>
<li>이미지 크기가 큼 (수백 MB ~ GB)</li>
<li>초기 학습곡선이 있음</li>
<li>오버헤드가 있음 (가상 OS 실행)</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode numberSource dockerfile number-lines code-with-copy"><code class="sourceCode dockerfile"><span id="cb6-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Dockerfile: 실행 환경 정의</span></span>
<span id="cb6-2"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">FROM</span> python:3.11                    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Python 3.11 설치</span></span>
<span id="cb6-3"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">WORKDIR</span> /app                        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 작업 폴더 설정</span></span>
<span id="cb6-4"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">COPY</span> requirements.txt .             <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 의존성 파일 복사</span></span>
<span id="cb6-5"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">RUN</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">pip</span> install <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-r</span> requirements.txt <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 패키지 설치</span></span>
<span id="cb6-6"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">COPY</span> . .                            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 코드 복사</span></span>
<span id="cb6-7"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">CMD</span> [<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"python"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"main.py"</span>]           <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 실행 명령</span></span></code></pre></div>
<p><strong>실행:</strong></p>
<div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb7-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">docker</span> build <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-t</span> my_app .            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 이미지 빌드</span></span>
<span id="cb7-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">docker</span> run my_app                   <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 컨테이너 실행</span></span></code></pre></div>
</section>
<section id="venvpoetry-vs-docker-선택-기준" class="level3" data-number="1.4.2">
<h3 data-number="1.4.2" class="anchored" data-anchor-id="venvpoetry-vs-docker-선택-기준"><span class="header-section-number">1.4.2</span> venv/Poetry vs Docker 선택 기준</h3>
<table class="table">
<thead>
<tr class="header">
<th>상황</th>
<th>도구</th>
<th>이유</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>혼자 개발, 로컬 테스트만</td>
<td>venv / Poetry</td>
<td>간단, 빠름</td>
</tr>
<tr class="even">
<td>팀 협업 (같은 환경 필요)</td>
<td><strong>Docker</strong></td>
<td>재현성 100%, 환경 일관성</td>
</tr>
<tr class="odd">
<td>클라우드 배포</td>
<td><strong>Docker</strong></td>
<td>필수 (서버 환경 캡슐화)</td>
</tr>
<tr class="even">
<td>프로토타입 PoC</td>
<td>pyenv / Poetry</td>
<td>빠른 개발</td>
</tr>
<tr class="odd">
<td>프로덕션 서비스</td>
<td><strong>Docker</strong></td>
<td>안정성, 버전 관리</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="운영-단계-kubernetes" class="level2" data-number="1.5">
<h2 data-number="1.5" class="anchored" data-anchor-id="운영-단계-kubernetes"><span class="header-section-number">1.5</span> 운영 단계: Kubernetes</h2>
<section id="kubernetes란" class="level3" data-number="1.5.1">
<h3 data-number="1.5.1" class="anchored" data-anchor-id="kubernetes란"><span class="header-section-number">1.5.1</span> Kubernetes란?</h3>
<ul>
<li><p>정의: 수백/수천 개의 Docker 컨테이너를 자동으로 관리, 배포, 스케일링하는 오케스트레이션 도구</p></li>
<li><p>기능:</p>
<ul>
<li>자동 스케일링: 트래픽 많으면 자동으로 복사본 증가</li>
<li>무중단 배포: 한두 개씩 교체하며 업데이트 (사용자 영향 0)</li>
<li>로드밸런싱: 여러 복사본 사이에 트래픽 분산</li>
<li>자동 복구: 컨테이너 죽으면 자동 재시작</li>
<li>버전 관리: 이전 버전으로 빠르게 롤백 가능</li>
</ul></li>
<li><p>예시:</p>
<pre><code>트래픽 100 req/s → 3개 복사본 (각 33 req/s)
트래픽 500 req/s → 자동으로 10개 복사본 (각 50 req/s)
배포 중 → 5개 → 8개 → 10개 순차적 교체 (무중단)
컨테이너 1개 죽음 → 자동 재시작 (사용자는 모름)</code></pre></li>
<li><p>언제 사용:</p>
<ul>
<li>대규모 서비스 (Netflix, Google 등)</li>
<li>마이크로서비스 아키텍처</li>
<li>트래픽이 불규칙한 서비스</li>
<li>엔터프라이즈 환경</li>
</ul></li>
<li><p>한계:</p>
<ul>
<li>⚠️ PoC/개인 프로젝트: 오버킬</li>
<li>학습곡선이 가파름</li>
<li>클러스터 운영 복잡도 높음</li>
<li>비용 증가</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode numberSource yaml number-lines code-with-copy"><code class="sourceCode yaml"><span id="cb9-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># kubernetes-deployment.yaml</span></span>
<span id="cb9-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">apiVersion</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> apps/v1</span></span>
<span id="cb9-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">kind</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> Deployment</span></span>
<span id="cb9-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">metadata</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb9-5"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">  </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">name</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> my-app</span></span>
<span id="cb9-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">spec</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb9-7"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">  </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">replicas</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">                    # 3개 복사본 실행</span></span>
<span id="cb9-8"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">  </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">selector</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb9-9"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">matchLabels</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb9-10"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">app</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> my-app</span></span>
<span id="cb9-11"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">  </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">template</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb9-12"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">metadata</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb9-13"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labels</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb9-14"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">        </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">app</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> my-app</span></span>
<span id="cb9-15"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">spec</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb9-16"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">containers</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb9-17"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">-</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">name</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> my-app</span></span>
<span id="cb9-18"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">        </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">image</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> my-app:latest</span></span>
<span id="cb9-19"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">        </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ports</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb9-20"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">        </span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">-</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">containerPort</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8000</span></span></code></pre></div>
</section>
<section id="배포-흐름-개발-배포-운영" class="level3" data-number="1.5.2">
<h3 data-number="1.5.2" class="anchored" data-anchor-id="배포-흐름-개발-배포-운영"><span class="header-section-number">1.5.2</span> 배포 흐름 (개발 → 배포 → 운영)</h3>
<pre><code>로컬 개발 (venv/Poetry/Conda)
        ↓
코드 작성 &amp; 테스트
        ↓
Git에 커밋
        ↓
Docker 빌드 (자동)
        ↓
Docker 이미지 생성
        ↓
Docker 레지스트리에 푸시 (Docker Hub, ECR)
        ↓
운영 서버 (AWS/GCP/Azure)
        ↓
Kubernetes 배포 (대규모만)
        또는
Docker Compose (소규모) / ECS (AWS 중규모)
        ↓
사용자 접근</code></pre>


</section>
</section>
</section>

 ]]></description>
  <category>Engineering</category>
  <category>DevOps</category>
  <category>Python</category>
  <category>Docker</category>
  <category>Kubernetes</category>
  <guid>kk3225.netlify.app/docs/blog/posts/Engineering/DevOps/dev_envs.html</guid>
  <pubDate>Sun, 23 Nov 2025 15:00:00 GMT</pubDate>
</item>
<item>
  <title>Multi-Agent 시스템</title>
  <dc:creator>Kwangmin Kim</dc:creator>
  <link>kk3225.netlify.app/docs/blog/posts/Agent/16-Agent/14-Multi-Agent.html</link>
  <description><![CDATA[ 





<section id="multi-agent-시스템이란" class="level2" data-number="0.1">
<h2 data-number="0.1" class="anchored" data-anchor-id="multi-agent-시스템이란"><span class="header-section-number">0.1</span> Multi-Agent 시스템이란?</h2>
<p>Multi-Agent 시스템은 <strong>각각의 전문성과 역할을 가진 여러 에이전트들이 협력하여 복잡한 문제를 해결하는 아키텍처</strong>이다.</p>
<section id="단일-에이전트의-한계" class="level3" data-number="0.1.1">
<h3 data-number="0.1.1" class="anchored" data-anchor-id="단일-에이전트의-한계"><span class="header-section-number">0.1.1</span> 단일 에이전트의 한계</h3>
<p><strong>ReAct/Plan-and-Execute의 문제점:</strong> - 하나의 모델이 모든 역할 수행 - 도메인 전문성 부족 - 확장성 제한 - 오류 누적</p>
<p><strong>Multi-Agent의 장점:</strong> - <strong>역할 분담</strong>: 각 에이전트가 특화된 역할 수행 - <strong>전문성</strong>: 도메인별 최적화된 모델 사용 - <strong>안정성</strong>: 특정 에이전트 실패 시 다른 에이전트가 보완 - <strong>확장성</strong>: 새로운 역할의 에이전트 추가 용이 - <strong>성능</strong>: 병렬 처리로 전체 실행 시간 단축</p>
</section>
<section id="multi-agent-작동-원리" class="level3" data-number="0.1.2">
<h3 data-number="0.1.2" class="anchored" data-anchor-id="multi-agent-작동-원리"><span class="header-section-number">0.1.2</span> Multi-Agent 작동 원리</h3>
<pre><code>User Request
    ↓
[Coordinator] (요청 분석 및 작업 분배)
    ↓
    ├─→ [Research Agent] (정보 수집)
    ├─→ [Analysis Agent] (데이터 분석)
    ├─→ [Writer Agent] (문서 작성)
    └─→ [Review Agent] (품질 검토)
    ↓
[Aggregator] (결과 통합)
    ↓
Final Output</code></pre>
</section>
<section id="에이전트의-역할-유형" class="level3" data-number="0.1.3">
<h3 data-number="0.1.3" class="anchored" data-anchor-id="에이전트의-역할-유형"><span class="header-section-number">0.1.3</span> 에이전트의 역할 유형</h3>
<p><strong>1. Coordinator Agent</strong> - 사용자 요청 분석 - 작업 분배 - 에이전트 간 통신 관리</p>
<p><strong>2. Specialist Agent</strong> - 특정 도메인 전문 수행 - Research, Analysis, Writing, Code Generation 등</p>
<p><strong>3. Validator Agent</strong> - 결과 검증 - 품질 확인 - 오류 감지 및 수정</p>
<p><strong>4. Aggregator Agent</strong> - 각 에이전트의 결과 통합 - 최종 응답 생성</p>
<div id="1bfe3060" class="cell" data-execution_count="1">
<details class="code-fold">
<summary>코드</summary>
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb2-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># API 키를 환경변수로 관리하기 위한 설정 파일</span></span>
<span id="cb2-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> dotenv <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> load_dotenv</span>
<span id="cb2-3"></span>
<span id="cb2-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># API 키 정보 로드</span></span>
<span id="cb2-5">load_dotenv()</span></code></pre></div>
</details>
</div>
<div id="3535872a" class="cell" data-execution_count="2">
<details class="code-fold">
<summary>코드</summary>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># LangSmith 추적을 설정한다. https://smith.langchain.com</span></span>
<span id="cb3-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># !pip install -qU langchain-teddynote</span></span>
<span id="cb3-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> langchain_teddynote <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> logging</span>
<span id="cb3-4"></span>
<span id="cb3-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 프로젝트 이름을 입력한다.</span></span>
<span id="cb3-6">logging.langsmith(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"CH17-Multi-Agent-System"</span>)</span></code></pre></div>
</details>
</div>
</section>
</section>
<section id="환경-설정" class="level2" data-number="0.2">
<h2 data-number="0.2" class="anchored" data-anchor-id="환경-설정"><span class="header-section-number">0.2</span> 환경 설정</h2>
<section id="기본-구성-요소" class="level3" data-number="0.2.1">
<h3 data-number="0.2.1" class="anchored" data-anchor-id="기본-구성-요소"><span class="header-section-number">0.2.1</span> 기본 구성 요소</h3>
<p>Multi-Agent 시스템은 다음 요소들로 구성된다:</p>
<ol type="1">
<li><strong>Coordinator</strong>: 요청 라우팅 및 작업 분배</li>
<li><strong>Specialist Agents</strong>: 각 도메인별 전문 에이전트</li>
<li><strong>Communication Layer</strong>: 에이전트 간 메시지 전달</li>
<li><strong>Result Aggregator</strong>: 결과 통합</li>
<li><strong>Memory System</strong>: 에이전트 간 상태 공유</li>
</ol>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="kk3225.netlify.app/docs/blog/posts/Agent/16-Agent/assets/multi_agent_architecture.png" class="img-fluid figure-img"></p>
<figcaption>Multi-Agent 시스템 아키텍처</figcaption>
</figure>
</div>
<div id="687831e4" class="cell" data-execution_count="3">
<details class="code-fold">
<summary>코드</summary>
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb4-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> langchain_openai <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> ChatOpenAI</span>
<span id="cb4-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> langchain_teddynote.tools.tavily <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> TavilySearch</span>
<span id="cb4-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> langchain_community.agent_toolkits <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> FileManagementToolkit</span>
<span id="cb4-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> langchain_core.tools.retriever <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> create_retriever_tool</span>
<span id="cb4-5"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> langgraph.checkpoint.memory <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> MemorySaver</span>
<span id="cb4-6"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> typing <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> List, Dict, Any</span>
<span id="cb4-7"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> pydantic <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> BaseModel, Field</span>
<span id="cb4-8"></span>
<span id="cb4-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 메모리 설정</span></span>
<span id="cb4-10">memory <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> MemorySaver()</span>
<span id="cb4-11"></span>
<span id="cb4-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 모델들 정의 (각 역할에 따라 다른 모델 사용 가능)</span></span>
<span id="cb4-13">coordinator_model <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ChatOpenAI(model_name<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gpt-4o"</span>, temperature<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb4-14">research_model <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ChatOpenAI(model_name<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gpt-4o-mini"</span>, temperature<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span>)</span>
<span id="cb4-15">analysis_model <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ChatOpenAI(model_name<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gpt-4o"</span>, temperature<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb4-16">writer_model <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ChatOpenAI(model_name<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gpt-4o-mini"</span>, temperature<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7</span>)</span>
<span id="cb4-17">reviewer_model <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ChatOpenAI(model_name<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gpt-4o"</span>, temperature<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span></code></pre></div>
</details>
</div>
<p><strong>모델 선택 전략:</strong> - <strong>Coordinator</strong>: 강력한 모델 (복잡한 분석 필요) - <strong>Specialist</strong>: 역할에 맞는 모델 (Research는 정확성, Writer는 창의성) - <strong>Reviewer</strong>: 강력한 모델 (품질 평가)</p>
</section>
</section>
<section id="도구-설정" class="level2" data-number="0.3">
<h2 data-number="0.3" class="anchored" data-anchor-id="도구-설정"><span class="header-section-number">0.3</span> 도구 설정</h2>
<section id="웹-검색-도구" class="level3" data-number="0.3.1">
<h3 data-number="0.3.1" class="anchored" data-anchor-id="웹-검색-도구"><span class="header-section-number">0.3.1</span> 웹 검색 도구</h3>
<div id="80978fc5" class="cell" data-execution_count="4">
<details class="code-fold">
<summary>코드</summary>
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb5-1">web_search <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> TavilySearch(</span>
<span id="cb5-2">    topic<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"general"</span>,</span>
<span id="cb5-3">    max_results<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,</span>
<span id="cb5-4">    include_answer<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>,</span>
<span id="cb5-5">)</span>
<span id="cb5-6"></span>
<span id="cb5-7">web_search.name <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"web_search"</span></span>
<span id="cb5-8">web_search.description <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"웹에서 최신 정보를 검색합니다."</span></span></code></pre></div>
</details>
</div>
</section>
<section id="파일-관리-도구" class="level3" data-number="0.3.2">
<h3 data-number="0.3.2" class="anchored" data-anchor-id="파일-관리-도구"><span class="header-section-number">0.3.2</span> 파일 관리 도구</h3>
<div id="34a31371" class="cell" data-execution_count="5">
<details class="code-fold">
<summary>코드</summary>
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb6-1">working_directory <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tmp"</span></span>
<span id="cb6-2">file_tools <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> FileManagementToolkit(</span>
<span id="cb6-3">    root_dir<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>(working_directory),</span>
<span id="cb6-4">).get_tools()</span>
<span id="cb6-5"></span>
<span id="cb6-6"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> tool <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> file_tools:</span>
<span id="cb6-7">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> tool.name <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"file_write"</span>:</span>
<span id="cb6-8">        tool.description <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"파일을 작성합니다."</span></span>
<span id="cb6-9">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">elif</span> tool.name <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"file_read"</span>:</span>
<span id="cb6-10">        tool.description <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"파일을 읽습니다."</span></span>
<span id="cb6-11">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">elif</span> tool.name <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"list_directory"</span>:</span>
<span id="cb6-12">        tool.description <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"디렉토리를 나열합니다."</span></span></code></pre></div>
</details>
</div>
</section>
<section id="pdf-검색-도구" class="level3" data-number="0.3.3">
<h3 data-number="0.3.3" class="anchored" data-anchor-id="pdf-검색-도구"><span class="header-section-number">0.3.3</span> PDF 검색 도구</h3>
<div id="00031b1f" class="cell" data-execution_count="6">
<details class="code-fold">
<summary>코드</summary>
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb7-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> langchain.text_splitter <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> RecursiveCharacterTextSplitter</span>
<span id="cb7-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> langchain_community.vectorstores <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> FAISS</span>
<span id="cb7-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> langchain_openai <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> OpenAIEmbeddings</span>
<span id="cb7-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> langchain.document_loaders <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> PDFPlumberLoader</span>
<span id="cb7-5"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> langchain_core.prompts <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> PromptTemplate</span>
<span id="cb7-6"></span>
<span id="cb7-7">loader <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> PDFPlumberLoader(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data/sample_document.pdf"</span>)</span>
<span id="cb7-8">text_splitter <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> RecursiveCharacterTextSplitter(chunk_size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>, chunk_overlap<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>)</span>
<span id="cb7-9">split_docs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> loader.load_and_split(text_splitter)</span>
<span id="cb7-10">vector <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> FAISS.from_documents(split_docs, OpenAIEmbeddings())</span>
<span id="cb7-11">pdf_retriever <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> vector.as_retriever()</span>
<span id="cb7-12"></span>
<span id="cb7-13">retriever_tool <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> create_retriever_tool(</span>
<span id="cb7-14">    pdf_retriever,</span>
<span id="cb7-15">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pdf_retriever"</span>,</span>
<span id="cb7-16">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"내부 문서에서 정보를 검색합니다."</span>,</span>
<span id="cb7-17">    document_prompt<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>PromptTemplate.from_template(</span>
<span id="cb7-18">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;document&gt;&lt;context&gt;</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{page_content}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">&lt;/context&gt;&lt;metadata&gt;&lt;source&gt;</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{source}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">&lt;/source&gt;&lt;page&gt;</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{page}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">&lt;/page&gt;&lt;/metadata&gt;&lt;/document&gt;"</span></span>
<span id="cb7-19">    ),</span>
<span id="cb7-20">)</span></code></pre></div>
</details>
</div>
</section>
</section>
<section id="에이전트-정의" class="level2" data-number="0.4">
<h2 data-number="0.4" class="anchored" data-anchor-id="에이전트-정의"><span class="header-section-number">0.4</span> 에이전트 정의</h2>
<section id="에이전트-기본-구조" class="level3" data-number="0.4.1">
<h3 data-number="0.4.1" class="anchored" data-anchor-id="에이전트-기본-구조"><span class="header-section-number">0.4.1</span> 에이전트 기본 구조</h3>
<div id="7902452e" class="cell" data-execution_count="7">
<details class="code-fold">
<summary>코드</summary>
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb8-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> enum <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Enum</span>
<span id="cb8-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> typing <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Optional</span>
<span id="cb8-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> datetime <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> datetime</span>
<span id="cb8-4"></span>
<span id="cb8-5"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">class</span> AgentRole(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>, Enum):</span>
<span id="cb8-6">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""에이전트 역할 정의"""</span></span>
<span id="cb8-7">    COORDINATOR <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"coordinator"</span></span>
<span id="cb8-8">    RESEARCHER <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"researcher"</span></span>
<span id="cb8-9">    ANALYST <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"analyst"</span></span>
<span id="cb8-10">    WRITER <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"writer"</span></span>
<span id="cb8-11">    REVIEWER <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"reviewer"</span></span>
<span id="cb8-12">    AGGREGATOR <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"aggregator"</span></span>
<span id="cb8-13"></span>
<span id="cb8-14"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">class</span> Agent(BaseModel):</span>
<span id="cb8-15">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""에이전트 정의"""</span></span>
<span id="cb8-16">    name: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Field(description<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"에이전트 이름"</span>)</span>
<span id="cb8-17">    role: AgentRole <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Field(description<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"에이전트 역할"</span>)</span>
<span id="cb8-18">    model: Any <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Field(description<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"LLM 모델"</span>)</span>
<span id="cb8-19">    tools: List[Any] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Field(default_factory<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">list</span>, description<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"사용 가능한 도구"</span>)</span>
<span id="cb8-20">    system_prompt: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Field(description<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"시스템 프롬프트"</span>)</span>
<span id="cb8-21">    </span>
<span id="cb8-22">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">class</span> Config:</span>
<span id="cb8-23">        arbitrary_types_allowed <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span></span>
<span id="cb8-24"></span>
<span id="cb8-25"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">class</span> AgentMessage(BaseModel):</span>
<span id="cb8-26">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""에이전트 메시지"""</span></span>
<span id="cb8-27">    agent_name: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Field(description<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"발신 에이전트"</span>)</span>
<span id="cb8-28">    timestamp: datetime <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Field(default_factory<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>datetime.now)</span>
<span id="cb8-29">    content: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Field(description<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"메시지 내용"</span>)</span>
<span id="cb8-30">    metadata: Dict[<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>, Any] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Field(default_factory<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dict</span>)</span>
<span id="cb8-31"></span>
<span id="cb8-32"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">class</span> MultiAgentState(BaseModel):</span>
<span id="cb8-33">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""멀티 에이전트 시스템 상태"""</span></span>
<span id="cb8-34">    user_input: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Field(description<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"사용자 입력"</span>)</span>
<span id="cb8-35">    coordinator_plan: Optional[Dict[<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>, Any]] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Field(default<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>, description<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"코디네이터 계획"</span>)</span>
<span id="cb8-36">    agent_results: Dict[<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>, <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Field(default_factory<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dict</span>, description<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"각 에이전트 결과"</span>)</span>
<span id="cb8-37">    messages: List[AgentMessage] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Field(default_factory<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">list</span>, description<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"에이전트 간 메시지"</span>)</span>
<span id="cb8-38">    final_output: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Field(default<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>, description<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"최종 출력"</span>)</span>
<span id="cb8-39">    </span>
<span id="cb8-40">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> add_message(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, agent_name: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>, content: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>, metadata: Dict <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>):</span>
<span id="cb8-41">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""메시지 추가"""</span></span>
<span id="cb8-42">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.messages.append(</span>
<span id="cb8-43">            AgentMessage(</span>
<span id="cb8-44">                agent_name<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>agent_name,</span>
<span id="cb8-45">                content<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>content,</span>
<span id="cb8-46">                metadata<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>metadata <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">or</span> {}</span>
<span id="cb8-47">            )</span>
<span id="cb8-48">        )</span></code></pre></div>
</details>
</div>
</section>
<section id="coordinator-agent" class="level3" data-number="0.4.2">
<h3 data-number="0.4.2" class="anchored" data-anchor-id="coordinator-agent"><span class="header-section-number">0.4.2</span> Coordinator Agent</h3>
<p>사용자 요청을 분석하고 작업을 분배한다.</p>
<div id="2197e6fd" class="cell" data-execution_count="8">
<details class="code-fold">
<summary>코드</summary>
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb9-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> langchain_core.prompts <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> ChatPromptTemplate</span>
<span id="cb9-2"></span>
<span id="cb9-3">coordinator_prompt <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ChatPromptTemplate.from_messages([</span>
<span id="cb9-4">    (</span>
<span id="cb9-5">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"system"</span>,</span>
<span id="cb9-6">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"""당신은 조직의 최고 코디네이터(Coordinator)입니다.</span></span>
<span id="cb9-7"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">        </span></span>
<span id="cb9-8"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">사용자의 요청을 분석하여 어떤 에이전트들이 필요한지, 각 에이전트의 역할이 무엇인지를 결정합니다.</span></span>
<span id="cb9-9"></span>
<span id="cb9-10"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">사용 가능한 에이전트:</span></span>
<span id="cb9-11"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">- researcher: 웹 검색을 통한 정보 수집</span></span>
<span id="cb9-12"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">- analyst: 수집된 정보의 분석 및 인사이트 도출</span></span>
<span id="cb9-13"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">- writer: 분석 결과를 바탕으로 문서 작성</span></span>
<span id="cb9-14"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">- reviewer: 최종 결과물의 품질 검증</span></span>
<span id="cb9-15"></span>
<span id="cb9-16"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">다음 JSON 형식으로 응답하세요:</span></span>
<span id="cb9-17"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">```json</span></span>
<span id="cb9-18"><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{{</span></span>
<span id="cb9-19"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    "required_agents": ["researcher", "analyst", "writer"],</span></span>
<span id="cb9-20"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    "task_flow": [</span></span>
<span id="cb9-21"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">        </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{{</span></span>
<span id="cb9-22"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">            "agent": "researcher",</span></span>
<span id="cb9-23"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">            "task": "구체적인 작업 설명",</span></span>
<span id="cb9-24"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">            "dependencies": []</span></span>
<span id="cb9-25"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">        </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb9-26"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">        </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{{</span></span>
<span id="cb9-27"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">            "agent": "analyst",</span></span>
<span id="cb9-28"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">            "task": "구체적인 작업 설명",</span></span>
<span id="cb9-29"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">            "dependencies": ["researcher"]</span></span>
<span id="cb9-30"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">        </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}}</span></span>
<span id="cb9-31"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    ],</span></span>
<span id="cb9-32"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    "success_criteria": "성공 기준 설명"</span></span>
<span id="cb9-33"><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}}</span></span>
<span id="cb9-34"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">```"""</span>,</span>
<span id="cb9-35">    ),</span>
<span id="cb9-36">    (<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"human"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"사용자 요청: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{input}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>),</span>
<span id="cb9-37">])</span>
<span id="cb9-38"></span>
<span id="cb9-39"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> coordinator_step(state: MultiAgentState) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span> Dict[<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>, Any]:</span>
<span id="cb9-40">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""코디네이터 실행"""</span></span>
<span id="cb9-41">    <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> json</span>
<span id="cb9-42">    </span>
<span id="cb9-43">    response <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> coordinator_model.invoke(</span>
<span id="cb9-44">        coordinator_prompt.format_prompt(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">input</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>state.user_input)</span>
<span id="cb9-45">    )</span>
<span id="cb9-46">    </span>
<span id="cb9-47">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># JSON 파싱</span></span>
<span id="cb9-48">    plan <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> json.loads(response.content)</span>
<span id="cb9-49">    state.add_message(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"coordinator"</span>, <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"계획 수립 완료: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(plan[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'required_agents'</span>])<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">개 에이전트 필요"</span>)</span>
<span id="cb9-50">    </span>
<span id="cb9-51">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"coordinator_plan"</span>: plan}</span></code></pre></div>
</details>
</div>
</section>
<section id="researcher-agent" class="level3" data-number="0.4.3">
<h3 data-number="0.4.3" class="anchored" data-anchor-id="researcher-agent"><span class="header-section-number">0.4.3</span> Researcher Agent</h3>
<p>웹 검색을 통해 정보를 수집한다.</p>
<div id="5cbd2ec3" class="cell" data-execution_count="9">
<details class="code-fold">
<summary>코드</summary>
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb10-1">researcher_prompt <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ChatPromptTemplate.from_messages([</span>
<span id="cb10-2">    (</span>
<span id="cb10-3">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"system"</span>,</span>
<span id="cb10-4">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"""당신은 데이터 조사 전문가(Research Agent)입니다.</span></span>
<span id="cb10-5"></span>
<span id="cb10-6"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">주어진 주제에 대해 웹 검색을 통해 신뢰할 수 있는 최신 정보를 수집합니다.</span></span>
<span id="cb10-7"></span>
<span id="cb10-8"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">다음을 고려하세요:</span></span>
<span id="cb10-9"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">1. 다양한 소스에서 정보 수집</span></span>
<span id="cb10-10"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">2. 정보의 신뢰도 평가</span></span>
<span id="cb10-11"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">3. 중요한 데이터와 통계 포함</span></span>
<span id="cb10-12"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">4. 출처 명시</span></span>
<span id="cb10-13"></span>
<span id="cb10-14"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">최종 결과는 다음 형식으로 제공하세요:</span></span></code></pre></div>
</details>
</div>
</section>
</section>
<section id="조사-결과" class="level2" data-number="0.5">
<h2 data-number="0.5" class="anchored" data-anchor-id="조사-결과"><span class="header-section-number">0.5</span> 조사 결과</h2>
<section id="핵심-발견사항" class="level3" data-number="0.5.1">
<h3 data-number="0.5.1" class="anchored" data-anchor-id="핵심-발견사항"><span class="header-section-number">0.5.1</span> 핵심 발견사항</h3>
<ul>
<li>발견사항 1</li>
<li>발견사항 2</li>
</ul>
</section>
<section id="참고-자료" class="level3" data-number="0.5.2">
<h3 data-number="0.5.2" class="anchored" data-anchor-id="참고-자료"><span class="header-section-number">0.5.2</span> 참고 자료</h3>
<ul>
<li><a href="URL">출처1</a></li>
<li><a href="URL">출처2</a></li>
</ul>
<pre><code>""",
    ),
    ("human", "조사 주제: {topic}"),
])

from langgraph.prebuilt import create_react_agent

researcher_agent = create_react_agent(
    research_model,
    [web_search],
)

def researcher_step(state: MultiAgentState, topic: str) -&gt; str:
    """리서처 에이전트 실행"""
    result = researcher_agent.invoke(
        {"messages": [("human", researcher_prompt.format_prompt(topic=topic).to_string())]},
        {"configurable": {"thread_id": "researcher"}}
    )
    
    content = result["messages"][-1].content
    state.add_message("researcher", content)
    
    return content</code></pre>
</section>
<section id="analyst-agent" class="level3" data-number="0.5.3">
<h3 data-number="0.5.3" class="anchored" data-anchor-id="analyst-agent"><span class="header-section-number">0.5.3</span> Analyst Agent</h3>
<p>수집된 정보를 분석한다.</p>
<div id="796d8dba" class="cell" data-execution_count="10">
<details class="code-fold">
<summary>코드</summary>
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb12-1">analyst_prompt <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ChatPromptTemplate.from_messages([</span>
<span id="cb12-2">    (</span>
<span id="cb12-3">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"system"</span>,</span>
<span id="cb12-4">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"""당신은 데이터 분석 전문가(Analysis Agent)입니다.</span></span>
<span id="cb12-5"></span>
<span id="cb12-6"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">리서처가 수집한 정보를 깊이 있게 분석합니다.</span></span>
<span id="cb12-7"></span>
<span id="cb12-8"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">분석 항목:</span></span>
<span id="cb12-9"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">1. **주요 트렌드**: 현재의 주요 변화</span></span>
<span id="cb12-10"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">2. **기회 요소**: 활용 가능한 기회</span></span>
<span id="cb12-11"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">3. **위험 요소**: 주의해야 할 위험</span></span>
<span id="cb12-12"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">4. **미래 전망**: 향후 발전 방향</span></span>
<span id="cb12-13"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">5. **통계 분석**: 수집된 데이터의 정량적 분석</span></span>
<span id="cb12-14"></span>
<span id="cb12-15"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">최종 분석은 다음 형식으로 제공하세요:</span></span></code></pre></div>
</details>
</div>
</section>
</section>
<section id="분석-결과" class="level2" data-number="0.6">
<h2 data-number="0.6" class="anchored" data-anchor-id="분석-결과"><span class="header-section-number">0.6</span> 분석 결과</h2>
<section id="swot-분석" class="level3" data-number="0.6.1">
<h3 data-number="0.6.1" class="anchored" data-anchor-id="swot-분석"><span class="header-section-number">0.6.1</span> SWOT 분석</h3>
<section id="강점strengths" class="level4" data-number="0.6.1.1">
<h4 data-number="0.6.1.1" class="anchored" data-anchor-id="강점strengths"><span class="header-section-number">0.6.1.1</span> 강점(Strengths)</h4>
<ul>
<li>강점1</li>
<li>강점2</li>
</ul>
</section>
<section id="약점weaknesses" class="level4" data-number="0.6.1.2">
<h4 data-number="0.6.1.2" class="anchored" data-anchor-id="약점weaknesses"><span class="header-section-number">0.6.1.2</span> 약점(Weaknesses)</h4>
<ul>
<li>약점1</li>
</ul>
</section>
<section id="기회opportunities" class="level4" data-number="0.6.1.3">
<h4 data-number="0.6.1.3" class="anchored" data-anchor-id="기회opportunities"><span class="header-section-number">0.6.1.3</span> 기회(Opportunities)</h4>
<ul>
<li>기회1</li>
</ul>
</section>
<section id="위협threats" class="level4" data-number="0.6.1.4">
<h4 data-number="0.6.1.4" class="anchored" data-anchor-id="위협threats"><span class="header-section-number">0.6.1.4</span> 위협(Threats)</h4>
<ul>
<li>위협1</li>
</ul>
</section>
</section>
<section id="인사이트" class="level3" data-number="0.6.2">
<h3 data-number="0.6.2" class="anchored" data-anchor-id="인사이트"><span class="header-section-number">0.6.2</span> 인사이트</h3>
<ul>
<li>인사이트1</li>
<li>인사이트2</li>
</ul>
<div class="sourceCode" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode numberSource &quot;&quot;&quot;, number-lines code-with-copy"><code class="sourceCode"><span id="cb13-1">    ),</span>
<span id="cb13-2">    ("human", "분석 대상:\n{research_data}"),</span>
<span id="cb13-3">])</span>
<span id="cb13-4"></span>
<span id="cb13-5">analyst_agent = create_react_agent(</span>
<span id="cb13-6">    analysis_model,</span>
<span id="cb13-7">    [pdf_retriever],</span>
<span id="cb13-8">)</span>
<span id="cb13-9"></span>
<span id="cb13-10">def analyst_step(state: MultiAgentState, research_data: str) -&gt; str:</span>
<span id="cb13-11">    """분석가 에이전트 실행"""</span>
<span id="cb13-12">    result = analyst_agent.invoke(</span>
<span id="cb13-13">        {"messages": [("human", analyst_prompt.format_prompt(research_data=research_data).to_string())]},</span>
<span id="cb13-14">        {"configurable": {"thread_id": "analyst"}}</span>
<span id="cb13-15">    )</span>
<span id="cb13-16">    </span>
<span id="cb13-17">    content = result["messages"][-1].content</span>
<span id="cb13-18">    state.add_message("analyst", content)</span>
<span id="cb13-19">    </span>
<span id="cb13-20">    return content</span></code></pre></div>
</section>
<section id="writer-agent" class="level3" data-number="0.6.3">
<h3 data-number="0.6.3" class="anchored" data-anchor-id="writer-agent"><span class="header-section-number">0.6.3</span> Writer Agent</h3>
<p>분석 결과를 문서로 작성한다.</p>
<div id="3987a3a5" class="cell" data-execution_count="11">
<details class="code-fold">
<summary>코드</summary>
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb14-1">writer_prompt <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ChatPromptTemplate.from_messages([</span>
<span id="cb14-2">    (</span>
<span id="cb14-3">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"system"</span>,</span>
<span id="cb14-4">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"""당신은 전문 작가(Writer Agent)입니다.</span></span>
<span id="cb14-5"></span>
<span id="cb14-6"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">분석된 정보를 바탕으로 높은 품질의 보고서를 작성합니다.</span></span>
<span id="cb14-7"></span>
<span id="cb14-8"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">작성 지침:</span></span>
<span id="cb14-9"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">1. **명확성**: 쉽고 명확한 표현</span></span>
<span id="cb14-10"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">2. **구조화**: 논리적인 흐름</span></span>
<span id="cb14-11"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">3. **시각화**: 테이블, 리스트 활용</span></span>
<span id="cb14-12"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">4. **설득력**: 데이터 기반의 주장</span></span>
<span id="cb14-13"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">5. **전문성**: 산업 용어 적절한 사용</span></span>
<span id="cb14-14"></span>
<span id="cb14-15"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">최종 보고서는 다음 구조를 따르세요:</span></span></code></pre></div>
</details>
</div>
</section>
</section>
<section id="제목" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> [제목]</h1>
<section id="개요" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="개요"><span class="header-section-number">1.1</span> 개요</h2>
<p>[간단한 요약]</p>
</section>
<section id="주요-내용" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="주요-내용"><span class="header-section-number">1.2</span> 주요 내용</h2>
<p>[상세한 내용]</p>
</section>
<section id="결론" class="level2" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="결론"><span class="header-section-number">1.3</span> 결론</h2>
<p>[핵심 결론 및 권장사항]</p>
<div class="sourceCode" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode numberSource &quot;&quot;&quot;, number-lines code-with-copy"><code class="sourceCode"><span id="cb15-1">    ),</span>
<span id="cb15-2">    ("human", "작성 자료:\n{analysis_data}"),</span>
<span id="cb15-3">])</span>
<span id="cb15-4"></span>
<span id="cb15-5">writer_agent = create_react_agent(</span>
<span id="cb15-6">    writer_model,</span>
<span id="cb15-7">    [*file_tools],</span>
<span id="cb15-8">)</span>
<span id="cb15-9"></span>
<span id="cb15-10">def writer_step(state: MultiAgentState, analysis_data: str) -&gt; str:</span>
<span id="cb15-11">    """작가 에이전트 실행"""</span>
<span id="cb15-12">    result = writer_agent.invoke(</span>
<span id="cb15-13">        {"messages": [("human", writer_prompt.format_prompt(analysis_data=analysis_data).to_string())]},</span>
<span id="cb15-14">        {"configurable": {"thread_id": "writer"}}</span>
<span id="cb15-15">    )</span>
<span id="cb15-16">    </span>
<span id="cb15-17">    content = result["messages"][-1].content</span>
<span id="cb15-18">    state.add_message("writer", content)</span>
<span id="cb15-19">    </span>
<span id="cb15-20">    return content</span></code></pre></div>
<section id="reviewer-agent" class="level3" data-number="1.3.1">
<h3 data-number="1.3.1" class="anchored" data-anchor-id="reviewer-agent"><span class="header-section-number">1.3.1</span> Reviewer Agent</h3>
<p>최종 결과를 검증한다.</p>
<div id="1d97fb9c" class="cell" data-execution_count="12">
<details class="code-fold">
<summary>코드</summary>
<div class="sourceCode cell-code" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb16-1">reviewer_prompt <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ChatPromptTemplate.from_messages([</span>
<span id="cb16-2">    (</span>
<span id="cb16-3">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"system"</span>,</span>
<span id="cb16-4">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"""당신은 품질 검토 전문가(Review Agent)입니다.</span></span>
<span id="cb16-5"></span>
<span id="cb16-6"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">최종 결과물의 품질을 검증합니다.</span></span>
<span id="cb16-7"></span>
<span id="cb16-8"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">검증 항목:</span></span>
<span id="cb16-9"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">1. **정확성**: 사실에 기반했는가</span></span>
<span id="cb16-10"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">2. **완성도**: 모든 필요한 요소를 포함했는가</span></span>
<span id="cb16-11"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">3. **일관성**: 논리적 오류는 없는가</span></span>
<span id="cb16-12"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">4. **가독성**: 읽기 쉬운가</span></span>
<span id="cb16-13"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">5. **전문성**: 전문적인 수준인가</span></span>
<span id="cb16-14"></span>
<span id="cb16-15"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">평가 결과를 다음 형식으로 제공하세요:</span></span></code></pre></div>
</details>
</div>
</section>
</section>
<section id="검토-결과" class="level2" data-number="1.4">
<h2 data-number="1.4" class="anchored" data-anchor-id="검토-결과"><span class="header-section-number">1.4</span> 검토 결과</h2>
<section id="종합-평가-passrevisereject" class="level3" data-number="1.4.1">
<h3 data-number="1.4.1" class="anchored" data-anchor-id="종합-평가-passrevisereject"><span class="header-section-number">1.4.1</span> 종합 평가: [Pass/Revise/Reject]</h3>
</section>
<section id="강점" class="level3" data-number="1.4.2">
<h3 data-number="1.4.2" class="anchored" data-anchor-id="강점"><span class="header-section-number">1.4.2</span> 강점</h3>
<ul>
<li>강점1</li>
<li>강점2</li>
</ul>
</section>
<section id="개선-필요-항목" class="level3" data-number="1.4.3">
<h3 data-number="1.4.3" class="anchored" data-anchor-id="개선-필요-항목"><span class="header-section-number">1.4.3</span> 개선 필요 항목</h3>
<ul>
<li>개선 사항1</li>
<li>개선 사항2</li>
</ul>
</section>
<section id="최종-의견" class="level3" data-number="1.4.4">
<h3 data-number="1.4.4" class="anchored" data-anchor-id="최종-의견"><span class="header-section-number">1.4.4</span> 최종 의견</h3>
<p>[종합 의견]</p>
<div class="sourceCode" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode numberSource &quot;&quot;&quot;, number-lines code-with-copy"><code class="sourceCode"><span id="cb17-1">    ),</span>
<span id="cb17-2">    ("human", "검토 대상:\n{document}"),</span>
<span id="cb17-3">])</span>
<span id="cb17-4"></span>
<span id="cb17-5">reviewer_agent = create_react_agent(</span>
<span id="cb17-6">    reviewer_model,</span>
<span id="cb17-7">    [pdf_retriever],</span>
<span id="cb17-8">)</span>
<span id="cb17-9"></span>
<span id="cb17-10">def reviewer_step(state: MultiAgentState, document: str) -&gt; str:</span>
<span id="cb17-11">    """검토자 에이전트 실행"""</span>
<span id="cb17-12">    result = reviewer_agent.invoke(</span>
<span id="cb17-13">        {"messages": [("human", reviewer_prompt.format_prompt(document=document).to_string())]},</span>
<span id="cb17-14">        {"configurable": {"thread_id": "reviewer"}}</span>
<span id="cb17-15">    )</span>
<span id="cb17-16">    </span>
<span id="cb17-17">    content = result["messages"][-1].content</span>
<span id="cb17-18">    state.add_message("reviewer", content)</span>
<span id="cb17-19">    </span>
<span id="cb17-20">    return content</span></code></pre></div>
</section>
</section>
<section id="multi-agent-시스템-그래프-구축" class="level2" data-number="1.5">
<h2 data-number="1.5" class="anchored" data-anchor-id="multi-agent-시스템-그래프-구축"><span class="header-section-number">1.5</span> Multi-Agent 시스템 그래프 구축</h2>
<section id="상태-관리-및-실행-흐름" class="level3" data-number="1.5.1">
<h3 data-number="1.5.1" class="anchored" data-anchor-id="상태-관리-및-실행-흐름"><span class="header-section-number">1.5.1</span> 상태 관리 및 실행 흐름</h3>
<div id="98ffa18c" class="cell" data-execution_count="13">
<details class="code-fold">
<summary>코드</summary>
<div class="sourceCode cell-code" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb18-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> langgraph.graph <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> StateGraph, START, END</span>
<span id="cb18-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> langgraph.graph.message <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> add_messages</span>
<span id="cb18-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> typing <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Annotated</span>
<span id="cb18-4"></span>
<span id="cb18-5"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">class</span> MultiAgentGraph:</span>
<span id="cb18-6">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""멀티 에이전트 시스템 그래프"""</span></span>
<span id="cb18-7">    </span>
<span id="cb18-8">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__init__</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>):</span>
<span id="cb18-9">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.state <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span></span>
<span id="cb18-10">        </span>
<span id="cb18-11">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> coordinator_node(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, state: MultiAgentState) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span> Dict[<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>, Any]:</span>
<span id="cb18-12">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""코디네이터 노드"""</span></span>
<span id="cb18-13">        plan <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> coordinator_step(state)</span>
<span id="cb18-14">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"coordinator_plan"</span>: plan}</span>
<span id="cb18-15">    </span>
<span id="cb18-16">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> researcher_node(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, state: MultiAgentState) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span> Dict[<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>, <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>]:</span>
<span id="cb18-17">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""리서처 노드"""</span></span>
<span id="cb18-18">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">not</span> state.coordinator_plan <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">or</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"researcher"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">not</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> state.coordinator_plan.get(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"required_agents"</span>, []):</span>
<span id="cb18-19">            <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"agent_results"</span>: state.agent_results}</span>
<span id="cb18-20">        </span>
<span id="cb18-21">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 리서처 태스크 찾기</span></span>
<span id="cb18-22">        task <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">next</span>(</span>
<span id="cb18-23">            (t <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> t <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> state.coordinator_plan[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"task_flow"</span>] <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> t[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"agent"</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"researcher"</span>),</span>
<span id="cb18-24">            <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span></span>
<span id="cb18-25">        )</span>
<span id="cb18-26">        </span>
<span id="cb18-27">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> task:</span>
<span id="cb18-28">            result <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> researcher_step(state, task[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"task"</span>])</span>
<span id="cb18-29">            state.agent_results[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"researcher"</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> result</span>
<span id="cb18-30">        </span>
<span id="cb18-31">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"agent_results"</span>: state.agent_results}</span>
<span id="cb18-32">    </span>
<span id="cb18-33">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> analyst_node(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, state: MultiAgentState) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span> Dict[<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>, <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>]:</span>
<span id="cb18-34">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""분석가 노드"""</span></span>
<span id="cb18-35">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"researcher"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">not</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> state.agent_results:</span>
<span id="cb18-36">            <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"agent_results"</span>: state.agent_results}</span>
<span id="cb18-37">        </span>
<span id="cb18-38">        result <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> analyst_step(state, state.agent_results[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"researcher"</span>])</span>
<span id="cb18-39">        state.agent_results[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"analyst"</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> result</span>
<span id="cb18-40">        </span>
<span id="cb18-41">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"agent_results"</span>: state.agent_results}</span>
<span id="cb18-42">    </span>
<span id="cb18-43">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> writer_node(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, state: MultiAgentState) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span> Dict[<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>, <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>]:</span>
<span id="cb18-44">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""작가 노드"""</span></span>
<span id="cb18-45">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"analyst"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">not</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> state.agent_results:</span>
<span id="cb18-46">            <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"agent_results"</span>: state.agent_results}</span>
<span id="cb18-47">        </span>
<span id="cb18-48">        result <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> writer_step(state, state.agent_results[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"analyst"</span>])</span>
<span id="cb18-49">        state.agent_results[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"writer"</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> result</span>
<span id="cb18-50">        </span>
<span id="cb18-51">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"agent_results"</span>: state.agent_results}</span>
<span id="cb18-52">    </span>
<span id="cb18-53">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> reviewer_node(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, state: MultiAgentState) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span> Dict[<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>, <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>]:</span>
<span id="cb18-54">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""검토자 노드"""</span></span>
<span id="cb18-55">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"writer"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">not</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> state.agent_results:</span>
<span id="cb18-56">            <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"agent_results"</span>: state.agent_results}</span>
<span id="cb18-57">        </span>
<span id="cb18-58">        result <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> reviewer_step(state, state.agent_results[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"writer"</span>])</span>
<span id="cb18-59">        state.agent_results[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"reviewer"</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> result</span>
<span id="cb18-60">        </span>
<span id="cb18-61">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"agent_results"</span>: state.agent_results}</span>
<span id="cb18-62">    </span>
<span id="cb18-63">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> aggregator_node(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, state: MultiAgentState) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span> Dict[<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>, <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>]:</span>
<span id="cb18-64">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""집계 노드"""</span></span>
<span id="cb18-65">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 최종 결과 통합</span></span>
<span id="cb18-66">        final_output <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"""</span></span>
<span id="cb18-67"><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"># 최종 보고서</span></span>
<span id="cb18-68"></span>
<span id="cb18-69"><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">## 프로세스 요약</span></span>
<span id="cb18-70"><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">- **조직**: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(state.messages)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">개의 에이전트 협력</span></span>
<span id="cb18-71"><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">- **단계**: Coordinator → Researcher → Analyst → Writer → Reviewer</span></span>
<span id="cb18-72"></span>
<span id="cb18-73"><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">## 최종 결과</span></span>
<span id="cb18-74"></span>
<span id="cb18-75"><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>state<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>agent_results<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>get(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'writer'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'결과 없음'</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb18-76"></span>
<span id="cb18-77"><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">## 검토 의견</span></span>
<span id="cb18-78"></span>
<span id="cb18-79"><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>state<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>agent_results<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>get(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'reviewer'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'검토 없음'</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb18-80"><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"""</span></span>
<span id="cb18-81">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"final_output"</span>: final_output}</span>
<span id="cb18-82">    </span>
<span id="cb18-83">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> build_graph(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>):</span>
<span id="cb18-84">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""그래프 구성"""</span></span>
<span id="cb18-85">        workflow <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> StateGraph(MultiAgentState)</span>
<span id="cb18-86">        </span>
<span id="cb18-87">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 노드 추가</span></span>
<span id="cb18-88">        workflow.add_node(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"coordinator"</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.coordinator_node)</span>
<span id="cb18-89">        workflow.add_node(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"researcher"</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.researcher_node)</span>
<span id="cb18-90">        workflow.add_node(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"analyst"</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.analyst_node)</span>
<span id="cb18-91">        workflow.add_node(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"writer"</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.writer_node)</span>
<span id="cb18-92">        workflow.add_node(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"reviewer"</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.reviewer_node)</span>
<span id="cb18-93">        workflow.add_node(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"aggregator"</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.aggregator_node)</span>
<span id="cb18-94">        </span>
<span id="cb18-95">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 엣지 구성</span></span>
<span id="cb18-96">        workflow.add_edge(START, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"coordinator"</span>)</span>
<span id="cb18-97">        workflow.add_edge(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"coordinator"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"researcher"</span>)</span>
<span id="cb18-98">        workflow.add_edge(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"researcher"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"analyst"</span>)</span>
<span id="cb18-99">        workflow.add_edge(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"analyst"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"writer"</span>)</span>
<span id="cb18-100">        workflow.add_edge(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"writer"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"reviewer"</span>)</span>
<span id="cb18-101">        workflow.add_edge(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"reviewer"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"aggregator"</span>)</span>
<span id="cb18-102">        workflow.add_edge(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"aggregator"</span>, END)</span>
<span id="cb18-103">        </span>
<span id="cb18-104">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> workflow.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">compile</span>(checkpointer<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>memory)</span>
<span id="cb18-105"></span>
<span id="cb18-106"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 그래프 생성</span></span>
<span id="cb18-107">multi_agent_graph <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> MultiAgentGraph()</span>
<span id="cb18-108">multi_agent_system <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> multi_agent_graph.build_graph()</span></code></pre></div>
</details>
</div>
<p><strong>그래프 구조:</strong></p>
<pre><code>START
  ↓
[Coordinator] - 작업 계획
  ↓
[Researcher] - 정보 수집
  ↓
[Analyst] - 데이터 분석
  ↓
[Writer] - 문서 작성
  ↓
[Reviewer] - 품질 검증
  ↓
[Aggregator] - 결과 통합
  ↓
END</code></pre>
</section>
</section>
<section id="실행-및-사용-예시" class="level2" data-number="1.6">
<h2 data-number="1.6" class="anchored" data-anchor-id="실행-및-사용-예시"><span class="header-section-number">1.6</span> 실행 및 사용 예시</h2>
<section id="실행-함수" class="level3" data-number="1.6.1">
<h3 data-number="1.6.1" class="anchored" data-anchor-id="실행-함수"><span class="header-section-number">1.6.1</span> 실행 함수</h3>
<div id="fce659af" class="cell" data-execution_count="14">
<details class="code-fold">
<summary>코드</summary>
<div class="sourceCode cell-code" id="cb20" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb20-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> run_multi_agent_system(user_input: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>, thread_id: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"main"</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>:</span>
<span id="cb20-2">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""멀티 에이전트 시스템 실행"""</span></span>
<span id="cb20-3">    <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> langchain_teddynote.messages <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> stream_graph</span>
<span id="cb20-4">    </span>
<span id="cb20-5">    config <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"configurable"</span>: {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"thread_id"</span>: thread_id}}</span>
<span id="cb20-6">    inputs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"user_input"</span>: user_input}</span>
<span id="cb20-7">    </span>
<span id="cb20-8">    result <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> multi_agent_system.invoke(inputs, config)</span>
<span id="cb20-9">    </span>
<span id="cb20-10">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> result[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"final_output"</span>]</span></code></pre></div>
</details>
</div>
</section>
<section id="예시-1-기술-트렌드-분석-보고서" class="level3" data-number="1.6.2">
<h3 data-number="1.6.2" class="anchored" data-anchor-id="예시-1-기술-트렌드-분석-보고서"><span class="header-section-number">1.6.2</span> 예시 1: 기술 트렌드 분석 보고서</h3>
<div id="264b4608" class="cell" data-execution_count="15">
<details class="code-fold">
<summary>코드</summary>
<div class="sourceCode cell-code" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb21-1">user_input <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"""</span></span>
<span id="cb21-2"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">2024년 AI 기술 트렌드에 대한 전문 보고서를 작성해주세요.</span></span>
<span id="cb21-3"></span>
<span id="cb21-4"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">보고서는 다음을 포함해야 합니다:</span></span>
<span id="cb21-5"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">1. 현재의 주요 AI 기술 트렌드</span></span>
<span id="cb21-6"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">2. 각 기술의 시장 영향도 분석</span></span>
<span id="cb21-7"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">3. 기업에 미치는 영향</span></span>
<span id="cb21-8"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">4. 향후 6개월 전망</span></span>
<span id="cb21-9"></span>
<span id="cb21-10"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">최종 보고서는 마크다운 형식으로, </span></span>
<span id="cb21-11"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">표, 핵심 포인트 정리 등을 포함해주세요.</span></span>
<span id="cb21-12"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"""</span></span>
<span id="cb21-13"></span>
<span id="cb21-14">output <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> run_multi_agent_system(user_input)</span>
<span id="cb21-15"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(output)</span></code></pre></div>
</details>
</div>
<p><strong>실행 흐름:</strong> 1. <strong>Coordinator</strong>: “AI 트렌드 분석 보고서” 계획 수립 2. <strong>Researcher</strong>: 최신 AI 기술 트렌드 웹 검색 3. <strong>Analyst</strong>: 수집된 정보 분석 및 SWOT 분석 4. <strong>Writer</strong>: 전문 보고서 작성 5. <strong>Reviewer</strong>: 최종 품질 검증 6. <strong>Aggregator</strong>: 최종 보고서 생성</p>
</section>
<section id="예시-2-경쟁사-분석-및-전략-수립" class="level3" data-number="1.6.3">
<h3 data-number="1.6.3" class="anchored" data-anchor-id="예시-2-경쟁사-분석-및-전략-수립"><span class="header-section-number">1.6.3</span> 예시 2: 경쟁사 분석 및 전략 수립</h3>
<div id="3e62d558" class="cell" data-execution_count="16">
<details class="code-fold">
<summary>코드</summary>
<div class="sourceCode cell-code" id="cb22" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb22-1">user_input <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"""</span></span>
<span id="cb22-2"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">우리 회사의 주요 경쟁사 3곳에 대한 심층 분석 보고서와 </span></span>
<span id="cb22-3"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">대응 전략을 수립해주세요.</span></span>
<span id="cb22-4"></span>
<span id="cb22-5"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">분석 범위:</span></span>
<span id="cb22-6"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">1. 경쟁사별 시장 점유율 및 최신 동향</span></span>
<span id="cb22-7"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">2. 제품/서비스 비교 분석</span></span>
<span id="cb22-8"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">3. 강점 및 약점 평가</span></span>
<span id="cb22-9"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">4. 우리 회사의 차별화 전략</span></span>
<span id="cb22-10"></span>
<span id="cb22-11"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">최종 결과물:</span></span>
<span id="cb22-12"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">- 경쟁사 분석 보고서 (competitor_analysis.md)</span></span>
<span id="cb22-13"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">- 대응 전략 가이드 (strategy_guide.md)</span></span>
<span id="cb22-14"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"""</span></span>
<span id="cb22-15"></span>
<span id="cb22-16">output <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> run_multi_agent_system(user_input)</span>
<span id="cb22-17"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(output)</span></code></pre></div>
</details>
</div>
</section>
<section id="예시-3-시장-진출-타당성-검토" class="level3" data-number="1.6.4">
<h3 data-number="1.6.4" class="anchored" data-anchor-id="예시-3-시장-진출-타당성-검토"><span class="header-section-number">1.6.4</span> 예시 3: 시장 진출 타당성 검토</h3>
<div id="1437fc81" class="cell" data-execution_count="17">
<details class="code-fold">
<summary>코드</summary>
<div class="sourceCode cell-code" id="cb23" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb23-1">user_input <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"""</span></span>
<span id="cb23-2"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">신시장 진출의 타당성을 검토하는 종합 보고서를 작성해주세요.</span></span>
<span id="cb23-3"></span>
<span id="cb23-4"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">검토 대상: [구체적인 시장/지역/제품]</span></span>
<span id="cb23-5"></span>
<span id="cb23-6"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">포함 항목:</span></span>
<span id="cb23-7"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">1. 시장 규모 및 성장률 조사</span></span>
<span id="cb23-8"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">2. 경쟁 환경 분석</span></span>
<span id="cb23-9"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">3. 규제 및 정책 환경</span></span>
<span id="cb23-10"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">4. 진출 시 기회 및 위험</span></span>
<span id="cb23-11"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">5. 예상 수익성 분석</span></span>
<span id="cb23-12"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">6. 최종 권장사항</span></span>
<span id="cb23-13"></span>
<span id="cb23-14"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">최종 결과는 경영진 보고 형식으로 작성해주세요.</span></span>
<span id="cb23-15"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"""</span></span>
<span id="cb23-16"></span>
<span id="cb23-17">output <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> run_multi_agent_system(user_input)</span>
<span id="cb23-18"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(output)</span></code></pre></div>
</details>
</div>
</section>
</section>
<section id="고급-패턴" class="level2" data-number="1.7">
<h2 data-number="1.7" class="anchored" data-anchor-id="고급-패턴"><span class="header-section-number">1.7</span> 고급 패턴</h2>
<section id="패턴-1-병렬-처리" class="level3" data-number="1.7.1">
<h3 data-number="1.7.1" class="anchored" data-anchor-id="패턴-1-병렬-처리"><span class="header-section-number">1.7.1</span> 패턴 1: 병렬 처리</h3>
<p>여러 에이전트가 동시에 작업을 수행한다.</p>
<div id="1ba783c2" class="cell" data-execution_count="18">
<details class="code-fold">
<summary>코드</summary>
<div class="sourceCode cell-code" id="cb24" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb24-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> concurrent.futures <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> ThreadPoolExecutor, as_completed</span>
<span id="cb24-2"></span>
<span id="cb24-3"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> parallel_agent_execution(tasks: Dict[<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>, <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>]) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span> Dict[<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>, <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>]:</span>
<span id="cb24-4">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""여러 에이전트 병렬 실행"""</span></span>
<span id="cb24-5">    </span>
<span id="cb24-6">    results <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {}</span>
<span id="cb24-7">    </span>
<span id="cb24-8">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">with</span> ThreadPoolExecutor(max_workers<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>) <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> executor:</span>
<span id="cb24-9">        futures <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {}</span>
<span id="cb24-10">        </span>
<span id="cb24-11">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 리서처 병렬 실행 (여러 주제)</span></span>
<span id="cb24-12">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> topic, instruction <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> tasks.items():</span>
<span id="cb24-13">            future <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> executor.submit(researcher_step, instruction)</span>
<span id="cb24-14">            futures[topic] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> future</span>
<span id="cb24-15">        </span>
<span id="cb24-16">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 결과 수집</span></span>
<span id="cb24-17">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> topic, future <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> futures.items():</span>
<span id="cb24-18">            results[topic] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> future.result()</span>
<span id="cb24-19">    </span>
<span id="cb24-20">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> results</span>
<span id="cb24-21"></span>
<span id="cb24-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 사용 예시</span></span>
<span id="cb24-23">parallel_tasks <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {</span>
<span id="cb24-24">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"AI trends"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"AI 기술 트렌드 조사"</span>,</span>
<span id="cb24-25">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Market data"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"시장 데이터 조사"</span>,</span>
<span id="cb24-26">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Competitor info"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"경쟁사 정보 조사"</span></span>
<span id="cb24-27">}</span>
<span id="cb24-28"></span>
<span id="cb24-29">results <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> parallel_agent_execution(parallel_tasks)</span></code></pre></div>
</details>
</div>
<p><strong>장점:</strong> - 실행 시간 단축 - 자원 효율적 활용</p>
</section>
<section id="패턴-2-조건부-에이전트-실행" class="level3" data-number="1.7.2">
<h3 data-number="1.7.2" class="anchored" data-anchor-id="패턴-2-조건부-에이전트-실행"><span class="header-section-number">1.7.2</span> 패턴 2: 조건부 에이전트 실행</h3>
<p>조건에 따라 특정 에이전트를 활성화한다.</p>
<div id="e5308c85" class="cell" data-execution_count="19">
<details class="code-fold">
<summary>코드</summary>
<div class="sourceCode cell-code" id="cb25" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb25-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> conditional_agent_routing(state: MultiAgentState) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>:</span>
<span id="cb25-2">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""조건부 에이전트 라우팅"""</span></span>
<span id="cb25-3">    </span>
<span id="cb25-4">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 사용자 입력의 복잡도에 따라 결정</span></span>
<span id="cb25-5">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(state.user_input.split()) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>:</span>
<span id="cb25-6">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 복잡한 요청: 전체 파이프라인 실행</span></span>
<span id="cb25-7">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"full_pipeline"</span></span>
<span id="cb25-8">    </span>
<span id="cb25-9">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">elif</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"분석"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> state.user_input:</span>
<span id="cb25-10">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 분석만 필요</span></span>
<span id="cb25-11">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"analyst_only"</span></span>
<span id="cb25-12">    </span>
<span id="cb25-13">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">elif</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"최신 정보"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> state.user_input:</span>
<span id="cb25-14">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 리서치만 필요</span></span>
<span id="cb25-15">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"researcher_only"</span></span>
<span id="cb25-16">    </span>
<span id="cb25-17">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span>:</span>
<span id="cb25-18">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 기본 파이프라인</span></span>
<span id="cb25-19">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"default_pipeline"</span></span></code></pre></div>
</details>
</div>
</section>
<section id="패턴-3-에이전트-간-피드백-루프" class="level3" data-number="1.7.3">
<h3 data-number="1.7.3" class="anchored" data-anchor-id="패턴-3-에이전트-간-피드백-루프"><span class="header-section-number">1.7.3</span> 패턴 3: 에이전트 간 피드백 루프</h3>
<p>에이전트의 결과에 대해 다른 에이전트가 피드백을 제공한다.</p>
<div id="36915d36" class="cell" data-execution_count="20">
<details class="code-fold">
<summary>코드</summary>
<div class="sourceCode cell-code" id="cb26" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb26-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> feedback_loop(</span>
<span id="cb26-2">    initial_result: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>,</span>
<span id="cb26-3">    feedback_provider: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span></span>
<span id="cb26-4">) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>:</span>
<span id="cb26-5">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""피드백 루프"""</span></span>
<span id="cb26-6">    </span>
<span id="cb26-7">    feedback <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> reviewer_agent.invoke({</span>
<span id="cb26-8">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"messages"</span>: [</span>
<span id="cb26-9">            (<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"human"</span>, <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"다음 결과를 검토하고 개선 사항을 제시하세요:</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>initial_result<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb26-10">        ]</span>
<span id="cb26-11">    })</span>
<span id="cb26-12">    </span>
<span id="cb26-13">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 개선된 버전 생성</span></span>
<span id="cb26-14">    improved_result <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> writer_agent.invoke({</span>
<span id="cb26-15">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"messages"</span>: [</span>
<span id="cb26-16">            (<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"human"</span>, <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"다음 피드백을 바탕으로 문서를 개선하세요:</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>feedback[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'messages'</span>][<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>content<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb26-17">        ]</span>
<span id="cb26-18">    })</span>
<span id="cb26-19">    </span>
<span id="cb26-20">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> improved_result[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"messages"</span>][<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>].content</span></code></pre></div>
</details>
</div>
</section>
</section>
<section id="성능-최적화" class="level2" data-number="1.8">
<h2 data-number="1.8" class="anchored" data-anchor-id="성능-최적화"><span class="header-section-number">1.8</span> 성능 최적화</h2>
<section id="캐싱-전략" class="level3" data-number="1.8.1">
<h3 data-number="1.8.1" class="anchored" data-anchor-id="캐싱-전략"><span class="header-section-number">1.8.1</span> 1. 캐싱 전략</h3>
<div id="75f70658" class="cell" data-execution_count="21">
<details class="code-fold">
<summary>코드</summary>
<div class="sourceCode cell-code" id="cb27" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb27-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> functools <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> lru_cache</span>
<span id="cb27-2"></span>
<span id="cb27-3"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">@lru_cache</span>(maxsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">128</span>)</span>
<span id="cb27-4"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> cached_research(topic: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>:</span>
<span id="cb27-5">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""연구 결과 캐싱"""</span></span>
<span id="cb27-6">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> researcher_step(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>, topic)</span>
<span id="cb27-7"></span>
<span id="cb27-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 사용</span></span>
<span id="cb27-9">result1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> cached_research(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"AI trends"</span>)</span>
<span id="cb27-10">result2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> cached_research(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"AI trends"</span>)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 캐시에서 반환</span></span></code></pre></div>
</details>
</div>
</section>
<section id="토큰-최적화" class="level3" data-number="1.8.2">
<h3 data-number="1.8.2" class="anchored" data-anchor-id="토큰-최적화"><span class="header-section-number">1.8.2</span> 2. 토큰 최적화</h3>
<div id="cf84990c" class="cell" data-execution_count="22">
<details class="code-fold">
<summary>코드</summary>
<div class="sourceCode cell-code" id="cb28" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb28-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> optimize_token_usage(result: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>, max_tokens: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1500</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>:</span>
<span id="cb28-2">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""토큰 사용량 최적화"""</span></span>
<span id="cb28-3">    </span>
<span id="cb28-4">    <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> langchain.text_splitter <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> RecursiveCharacterTextSplitter</span>
<span id="cb28-5">    </span>
<span id="cb28-6">    splitter <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> RecursiveCharacterTextSplitter(</span>
<span id="cb28-7">        chunk_size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>max_tokens,</span>
<span id="cb28-8">        chunk_overlap<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb28-9">    )</span>
<span id="cb28-10">    </span>
<span id="cb28-11">    chunks <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> splitter.split_text(result)</span>
<span id="cb28-12">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> chunks[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 가장 관련성 높은 청크만 사용</span></span></code></pre></div>
</details>
</div>
</section>
<section id="비용-절감-전략" class="level3" data-number="1.8.3">
<h3 data-number="1.8.3" class="anchored" data-anchor-id="비용-절감-전략"><span class="header-section-number">1.8.3</span> 3. 비용 절감 전략</h3>
<div id="1132a1a0" class="cell" data-execution_count="23">
<details class="code-fold">
<summary>코드</summary>
<div class="sourceCode cell-code" id="cb29" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb29-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> cost_optimized_model_selection(task_complexity: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span> ChatOpenAI:</span>
<span id="cb29-2">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""작업 복잡도에 따른 모델 선택"""</span></span>
<span id="cb29-3">    </span>
<span id="cb29-4">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> task_complexity <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"simple"</span>:</span>
<span id="cb29-5">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> ChatOpenAI(model_name<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gpt-4o-mini"</span>)</span>
<span id="cb29-6">    </span>
<span id="cb29-7">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">elif</span> task_complexity <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"medium"</span>:</span>
<span id="cb29-8">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> ChatOpenAI(model_name<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gpt-4o-mini"</span>)</span>
<span id="cb29-9">    </span>
<span id="cb29-10">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span>:  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># complex</span></span>
<span id="cb29-11">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> ChatOpenAI(model_name<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gpt-4o"</span>)</span></code></pre></div>
</details>
</div>
</section>
</section>
<section id="에러-처리-및-복구" class="level2" data-number="1.9">
<h2 data-number="1.9" class="anchored" data-anchor-id="에러-처리-및-복구"><span class="header-section-number">1.9</span> 에러 처리 및 복구</h2>
<section id="에이전트-실패-처리" class="level3" data-number="1.9.1">
<h3 data-number="1.9.1" class="anchored" data-anchor-id="에이전트-실패-처리"><span class="header-section-number">1.9.1</span> 에이전트 실패 처리</h3>
<div id="68d134b4" class="cell" data-execution_count="24">
<details class="code-fold">
<summary>코드</summary>
<div class="sourceCode cell-code" id="cb30" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb30-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> handle_agent_failure(failed_agent: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>, state: MultiAgentState) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>:</span>
<span id="cb30-2">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""에이전트 실패 시 대응"""</span></span>
<span id="cb30-3">    </span>
<span id="cb30-4">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> failed_agent <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"researcher"</span>:</span>
<span id="cb30-5">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 대체: PDF 문서에서 정보 검색</span></span>
<span id="cb30-6">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> pdf_retriever.invoke(state.user_input)</span>
<span id="cb30-7">    </span>
<span id="cb30-8">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">elif</span> failed_agent <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"analyst"</span>:</span>
<span id="cb30-9">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 대체: 원본 데이터 직접 사용</span></span>
<span id="cb30-10">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> state.agent_results.get(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"researcher"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>)</span>
<span id="cb30-11">    </span>
<span id="cb30-12">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">elif</span> failed_agent <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"writer"</span>:</span>
<span id="cb30-13">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 대체: 간단한 텍스트 형식으로 작성</span></span>
<span id="cb30-14">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"## 분석 결과</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>state<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>agent_results[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'analyst'</span>]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb30-15">    </span>
<span id="cb30-16">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span>:</span>
<span id="cb30-17">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">raise</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">Exception</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Unknown agent: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>failed_agent<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
</details>
</div>
</section>
<section id="재시도-메커니즘" class="level3" data-number="1.9.2">
<h3 data-number="1.9.2" class="anchored" data-anchor-id="재시도-메커니즘"><span class="header-section-number">1.9.2</span> 재시도 메커니즘</h3>
<div id="b53c849f" class="cell" data-execution_count="25">
<details class="code-fold">
<summary>코드</summary>
<div class="sourceCode cell-code" id="cb31" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb31-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> tenacity <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> retry, stop_after_attempt, wait_exponential</span>
<span id="cb31-2"></span>
<span id="cb31-3"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">@retry</span>(</span>
<span id="cb31-4">    stop<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>stop_after_attempt(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>),</span>
<span id="cb31-5">    wait<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>wait_exponential(multiplier<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">min</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">max</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>)</span>
<span id="cb31-6">)</span>
<span id="cb31-7"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> resilient_agent_call(agent_func, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>args, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span>kwargs):</span>
<span id="cb31-8">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""재시도 가능한 에이전트 호출"""</span></span>
<span id="cb31-9">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> agent_func(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>args, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span>kwargs)</span></code></pre></div>
</details>
</div>
</section>
</section>
<section id="다양한-아키텍처-패턴" class="level2" data-number="1.10">
<h2 data-number="1.10" class="anchored" data-anchor-id="다양한-아키텍처-패턴"><span class="header-section-number">1.10</span> 다양한 아키텍처 패턴</h2>
<section id="패턴-1-순차적-파이프라인-sequential" class="level3" data-number="1.10.1">
<h3 data-number="1.10.1" class="anchored" data-anchor-id="패턴-1-순차적-파이프라인-sequential"><span class="header-section-number">1.10.1</span> 패턴 1: 순차적 파이프라인 (Sequential)</h3>
<pre><code>Agent1 → Agent2 → Agent3 → Output</code></pre>
<p><strong>사용 사례:</strong> 정보 수집 → 분석 → 작성</p>
</section>
<section id="패턴-2-병렬-처리-parallel" class="level3" data-number="1.10.2">
<h3 data-number="1.10.2" class="anchored" data-anchor-id="패턴-2-병렬-처리-parallel"><span class="header-section-number">1.10.2</span> 패턴 2: 병렬 처리 (Parallel)</h3>
<pre><code>      ├→ Agent1 ─┐
Input ┤           ├→ Aggregator → Output
      └→ Agent2 ─┘</code></pre>
<p><strong>사용 사례:</strong> 여러 시각에서의 분석 수행</p>
</section>
<section id="패턴-3-위임-구조-hierarchical" class="level3" data-number="1.10.3">
<h3 data-number="1.10.3" class="anchored" data-anchor-id="패턴-3-위임-구조-hierarchical"><span class="header-section-number">1.10.3</span> 패턴 3: 위임 구조 (Hierarchical)</h3>
<pre><code>Master Agent
    ├→ Team A
    │   ├→ Member 1
    │   └→ Member 2
    └→ Team B
        ├→ Member 3
        └→ Member 4</code></pre>
<p><strong>사용 사례:</strong> 대규모 조직 구조</p>
</section>
<section id="패턴-4-피드백-루프-feedback-loop" class="level3" data-number="1.10.4">
<h3 data-number="1.10.4" class="anchored" data-anchor-id="패턴-4-피드백-루프-feedback-loop"><span class="header-section-number">1.10.4</span> 패턴 4: 피드백 루프 (Feedback Loop)</h3>
<pre><code>Agent1 → Agent2 → Reviewer ─┐
         ↑                   ↓
         └────── Feedback ───┘</code></pre>
<p><strong>사용 사례:</strong> 반복적 개선 및 품질 보증</p>
</section>
</section>
<section id="multi-agent-vs-single-agent" class="level2" data-number="1.11">
<h2 data-number="1.11" class="anchored" data-anchor-id="multi-agent-vs-single-agent"><span class="header-section-number">1.11</span> Multi-Agent vs Single-Agent</h2>
<table class="table">
<thead>
<tr class="header">
<th>특성</th>
<th>Multi-Agent</th>
<th>Single-Agent</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>전문성</strong></td>
<td>✅ 높음 (도메인별 최적화)</td>
<td>❌ 낮음 (일반화 필요)</td>
</tr>
<tr class="even">
<td><strong>복잡성</strong></td>
<td>높음 (시스템 관리)</td>
<td>✅ 낮음 (단순함)</td>
</tr>
<tr class="odd">
<td><strong>확장성</strong></td>
<td>✅ 높음 (에이전트 추가)</td>
<td>제한적</td>
</tr>
<tr class="even">
<td><strong>비용</strong></td>
<td>중간 (병렬 처리로 단축)</td>
<td>✅ 낮음</td>
</tr>
<tr class="odd">
<td><strong>안정성</strong></td>
<td>✅ 높음 (중복성)</td>
<td>낮음 (단일 실패점)</td>
</tr>
<tr class="even">
<td><strong>성능</strong></td>
<td>✅ 빠름 (병렬 처리)</td>
<td>느림 (순차 처리)</td>
</tr>
</tbody>
</table>
</section>
<section id="베스트-프랙티스" class="level2" data-number="1.12">
<h2 data-number="1.12" class="anchored" data-anchor-id="베스트-프랙티스"><span class="header-section-number">1.12</span> 베스트 프랙티스</h2>
<section id="명확한-역할-정의" class="level3" data-number="1.12.1">
<h3 data-number="1.12.1" class="anchored" data-anchor-id="명확한-역할-정의"><span class="header-section-number">1.12.1</span> 1. 명확한 역할 정의</h3>
<div class="sourceCode" id="cb36" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb36-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ❌ 나쁜 예</span></span>
<span id="cb36-2">Agent(name<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Agent1"</span>, role<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"모든 작업 수행"</span>)</span>
<span id="cb36-3"></span>
<span id="cb36-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ✅ 좋은 예</span></span>
<span id="cb36-5">Agent(</span>
<span id="cb36-6">    name<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Research Agent"</span>,</span>
<span id="cb36-7">    role<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>AgentRole.RESEARCHER,</span>
<span id="cb36-8">    system_prompt<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"웹 검색을 통한 정보 수집 전문가"</span></span>
<span id="cb36-9">)</span></code></pre></div>
</section>
<section id="적절한-에이전트-수" class="level3" data-number="1.12.2">
<h3 data-number="1.12.2" class="anchored" data-anchor-id="적절한-에이전트-수"><span class="header-section-number">1.12.2</span> 2. 적절한 에이전트 수</h3>
<div class="sourceCode" id="cb37" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb37-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ❌ 너무 많은 에이전트 (관리 복잡도 증가)</span></span>
<span id="cb37-2">agents <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [Agent() <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> _ <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>)]</span>
<span id="cb37-3"></span>
<span id="cb37-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ✅ 적절한 수 (5-7개)</span></span>
<span id="cb37-5">agents <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [</span>
<span id="cb37-6">    coordinator, researcher, analyst, writer, reviewer</span>
<span id="cb37-7">]</span></code></pre></div>
</section>
<section id="명확한-의사소통-프로토콜" class="level3" data-number="1.12.3">
<h3 data-number="1.12.3" class="anchored" data-anchor-id="명확한-의사소통-프로토콜"><span class="header-section-number">1.12.3</span> 3. 명확한 의사소통 프로토콜</h3>
<div class="sourceCode" id="cb38" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb38-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 에이전트 간 메시지 규격화</span></span>
<span id="cb38-2"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">class</span> AgentMessage(BaseModel):</span>
<span id="cb38-3">    sender: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span></span>
<span id="cb38-4">    recipient: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span></span>
<span id="cb38-5">    content: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span></span>
<span id="cb38-6">    metadata: Dict[<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>, Any]</span></code></pre></div>
</section>
<section id="상태-관리" class="level3" data-number="1.12.4">
<h3 data-number="1.12.4" class="anchored" data-anchor-id="상태-관리"><span class="header-section-number">1.12.4</span> 4. 상태 관리</h3>
<div class="sourceCode" id="cb39" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb39-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 공유 상태 정의</span></span>
<span id="cb39-2"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">class</span> SharedState(BaseModel):</span>
<span id="cb39-3">    user_input: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span></span>
<span id="cb39-4">    intermediate_results: Dict[<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>, <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>]</span>
<span id="cb39-5">    metadata: Dict[<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>, Any]</span></code></pre></div>
</section>
</section>
<section id="참고-자료-1" class="level2" data-number="1.13">
<h2 data-number="1.13" class="anchored" data-anchor-id="참고-자료-1"><span class="header-section-number">1.13</span> 참고 자료</h2>
<ul>
<li><a href="https://arxiv.org/abs/2308.00352">Multi-Agent Systems Paper</a></li>
<li><a href="https://langchain-ai.github.io/langgraph/">LangGraph Documentation</a></li>
<li><a href="https://langchain-ai.github.io/langgraph/tutorials/">Agent Design Patterns</a></li>
<li><a href="https://arxiv.org/abs/2402.18658">Distributed AI Systems</a></li>
</ul>
</section>
<section id="다음-단계" class="level2" data-number="1.14">
<h2 data-number="1.14" class="anchored" data-anchor-id="다음-단계"><span class="header-section-number">1.14</span> 다음 단계</h2>
<p>Multi-Agent 시스템의 기본을 익혔다면, 다음 주제들을 살펴보자:</p>
<ul>
<li><strong>Agent Orchestration</strong>: 복잡한 워크플로우 관리</li>
<li><strong>Knowledge Sharing</strong>: 에이전트 간 지식 공유 메커니즘</li>
<li><strong>Performance Monitoring</strong>: 멀티 에이전트 시스템의 모니터링 및 최적화</li>
<li><strong>Scalability</strong>: 대규모 멀티 에이전트 시스템 구축</li>
</ul>


</section>
</section>

 ]]></description>
  <category>AI</category>
  <category>Agent</category>
  <category>LangChain</category>
  <guid>kk3225.netlify.app/docs/blog/posts/Agent/16-Agent/14-Multi-Agent.html</guid>
  <pubDate>Tue, 18 Nov 2025 15:00:00 GMT</pubDate>
</item>
<item>
  <title>Plan-and-Execute Agent</title>
  <dc:creator>Kwangmin Kim</dc:creator>
  <link>kk3225.netlify.app/docs/blog/posts/Agent/16-Agent/13-Plan-Execute-Agent.html</link>
  <description><![CDATA[ 





<section id="plan-and-execute-agent란" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="plan-and-execute-agent란"><span class="header-section-number">1</span> Plan-and-Execute Agent란?</h2>
<p>Plan-and-Execute는 대규모 언어 모델(LLM)이 <strong>계획(Planning)</strong>과 <strong>실행(Execution)</strong> 단계를 분리하여 복잡한 문제를 체계적으로 해결하는 패턴이다.</p>
<section id="react와의-차이" class="level3" data-number="1.1">
<h3 data-number="1.1" class="anchored" data-anchor-id="react와의-차이"><span class="header-section-number">1.1</span> ReAct와의 차이</h3>
<p><strong>ReAct 패턴의 한계:</strong> - 각 단계마다 즉시 행동 결정 - 복잡한 작업의 경우 비효율적인 단계 반복 - 전체 계획이 없어 방향 혼란 가능</p>
<p><strong>Plan-and-Execute의 장점:</strong> - <strong>2단계 분리</strong>: 먼저 전체 계획 수립, 후에 실행 - <strong>효율성</strong>: 불필요한 반복 작업 최소화 - <strong>재현성</strong>: 같은 계획으로 다른 입력에 적용 가능 - <strong>추적성</strong>: 계획 단계를 명시적으로 추적</p>
</section>
<section id="plan-and-execute-작동-원리" class="level3" data-number="1.2">
<h3 data-number="1.2" class="anchored" data-anchor-id="plan-and-execute-작동-원리"><span class="header-section-number">1.2</span> Plan-and-Execute 작동 원리</h3>
<pre><code>Phase 1: Planning
├─ 1. Task: "목표 분석"
├─ 2. Task: "필요 리소스 식별"
└─ 3. Task: "실행 순서 결정"

Phase 2: Execution
├─ Task 1 실행 (웹 검색)
├─ Task 2 실행 (파일 읽기)
├─ Task 3 실행 (데이터 분석)
└─ 최종 결과 생성</code></pre>
</section>
<section id="langgraph의-plan-and-execute-구현" class="level3" data-number="1.3">
<h3 data-number="1.3" class="anchored" data-anchor-id="langgraph의-plan-and-execute-구현"><span class="header-section-number">1.3</span> LangGraph의 Plan-and-Execute 구현</h3>
<p>LangGraph의 <code>create_planning_agent</code>를 사용하여 효과적으로 구현할 수 있다.</p>
<p><strong>핵심 특징:</strong> - <strong>계획 최적화</strong>: LLM이 한 번에 전체 계획 수립 - <strong>상태 관리</strong>: 각 태스크의 진행 상황 추적 - <strong>에러 복구</strong>: 특정 태스크 실패 시 재시도 또는 대체 방안 - <strong>결과 통합</strong>: 각 태스크의 결과를 최종 답변으로 통합</p>
<div id="ab2b67fe" class="cell" data-execution_count="1">
<details class="code-fold">
<summary>코드</summary>
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb2-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># API 키를 환경변수로 관리하기 위한 설정 파일</span></span>
<span id="cb2-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> dotenv <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> load_dotenv</span>
<span id="cb2-3"></span>
<span id="cb2-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># API 키 정보 로드</span></span>
<span id="cb2-5">load_dotenv()</span></code></pre></div>
</details>
</div>
<div id="4e744933" class="cell" data-execution_count="2">
<details class="code-fold">
<summary>코드</summary>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># LangSmith 추적을 설정한다. https://smith.langchain.com</span></span>
<span id="cb3-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># !pip install -qU langchain-teddynote</span></span>
<span id="cb3-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> langchain_teddynote <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> logging</span>
<span id="cb3-4"></span>
<span id="cb3-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 프로젝트 이름을 입력한다.</span></span>
<span id="cb3-6">logging.langsmith(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"CH16-Plan-Execute-Agent"</span>)</span></code></pre></div>
</details>
</div>
</section>
</section>
<section id="환경-설정" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="환경-설정"><span class="header-section-number">2</span> 환경 설정</h2>
<section id="기본-구성-요소" class="level3" data-number="2.1">
<h3 data-number="2.1" class="anchored" data-anchor-id="기본-구성-요소"><span class="header-section-number">2.1</span> 기본 구성 요소</h3>
<p>Plan-and-Execute Agent는 네 가지 핵심 요소로 구성된다:</p>
<ol type="1">
<li><strong>Planner LLM</strong>: 계획 수립 담당</li>
<li><strong>Executor LLM</strong>: 실제 작업 수행</li>
<li><strong>도구(Tools)</strong>: 외부 작업 수행</li>
<li><strong>메모리(Memory)</strong>: 계획 및 실행 이력 저장</li>
</ol>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="kk3225.netlify.app/docs/blog/posts/Agent/16-Agent/assets/plan_execute_agent.png" class="img-fluid figure-img"></p>
<figcaption>Plan-and-Execute Agent 아키텍처</figcaption>
</figure>
</div>
<div id="8db0de12" class="cell" data-execution_count="3">
<details class="code-fold">
<summary>코드</summary>
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb4-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> langchain_openai <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> ChatOpenAI</span>
<span id="cb4-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> langchain_teddynote.tools.tavily <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> TavilySearch</span>
<span id="cb4-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> langchain_core.messages <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> HumanMessage</span>
<span id="cb4-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> langgraph.checkpoint.memory <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> MemorySaver</span>
<span id="cb4-5"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> langgraph.prebuilt <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> create_react_agent</span>
<span id="cb4-6"></span>
<span id="cb4-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 메모리 설정 (계획 및 실행 이력 저장)</span></span>
<span id="cb4-8">memory <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> MemorySaver()</span>
<span id="cb4-9"></span>
<span id="cb4-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 모델 설정</span></span>
<span id="cb4-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Planner: 복잡한 추론이 필요하므로 GPT-4o 사용</span></span>
<span id="cb4-12">planner_model <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ChatOpenAI(model_name<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gpt-4o"</span>, temperature<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb4-13"></span>
<span id="cb4-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Executor: 비용 절감을 위해 GPT-4o-mini 사용</span></span>
<span id="cb4-15">executor_model <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ChatOpenAI(model_name<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gpt-4o-mini"</span>)</span></code></pre></div>
</details>
</div>
<p><strong>모델 선택 전략:</strong> - <strong>Planner</strong>: 더 강력한 모델 (복잡한 계획 수립) - <strong>Executor</strong>: 더 빠르고 저렴한 모델 (계획된 작업 수행)</p>
</section>
</section>
<section id="계획-작성-시스템" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="계획-작성-시스템"><span class="header-section-number">3</span> 계획 작성 시스템</h2>
<section id="계획-구조-정의" class="level3" data-number="3.1">
<h3 data-number="3.1" class="anchored" data-anchor-id="계획-구조-정의"><span class="header-section-number">3.1</span> 계획 구조 정의</h3>
<div id="72d4cb74" class="cell" data-execution_count="4">
<details class="code-fold">
<summary>코드</summary>
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb5-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> typing <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> List</span>
<span id="cb5-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> pydantic <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> BaseModel, Field</span>
<span id="cb5-3"></span>
<span id="cb5-4"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">class</span> Task(BaseModel):</span>
<span id="cb5-5">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""수행할 작업의 단위"""</span></span>
<span id="cb5-6">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">id</span>: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Field(description<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"작업 ID (1부터 시작)"</span>)</span>
<span id="cb5-7">    title: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Field(description<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"작업 제목"</span>)</span>
<span id="cb5-8">    description: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Field(description<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"작업 상세 설명"</span>)</span>
<span id="cb5-9">    required_tools: List[<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Field(description<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"필요한 도구 목록"</span>)</span>
<span id="cb5-10">    dependencies: List[<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Field(</span>
<span id="cb5-11">        default_factory<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">list</span>, </span>
<span id="cb5-12">        description<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"선행 작업 ID 목록"</span></span>
<span id="cb5-13">    )</span>
<span id="cb5-14">    </span>
<span id="cb5-15">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__str__</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>:</span>
<span id="cb5-16">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Task </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">id</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>title<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb5-17"></span>
<span id="cb5-18"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">class</span> Plan(BaseModel):</span>
<span id="cb5-19">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""전체 작업 계획"""</span></span>
<span id="cb5-20">    objective: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Field(description<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"최종 목표"</span>)</span>
<span id="cb5-21">    tasks: List[Task] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Field(description<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"수행할 작업 리스트"</span>)</span>
<span id="cb5-22">    </span>
<span id="cb5-23">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__str__</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>:</span>
<span id="cb5-24">        task_str <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.join(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"  </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>task<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> task <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.tasks)</span>
<span id="cb5-25">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Goal: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>objective<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n\n</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">Tasks:</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>task_str<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span></code></pre></div>
</details>
</div>
<p><strong>Plan 구조의 장점:</strong> - 명확한 작업 구조 - 의존성 추적으로 순서 관리 - 필요한 도구 사전 식별</p>
</section>
<section id="planner-prompt-작성" class="level3" data-number="3.2">
<h3 data-number="3.2" class="anchored" data-anchor-id="planner-prompt-작성"><span class="header-section-number">3.2</span> Planner Prompt 작성</h3>
<div id="048f39e1" class="cell" data-execution_count="5">
<details class="code-fold">
<summary>코드</summary>
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb6-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> langchain_core.prompts <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> ChatPromptTemplate</span>
<span id="cb6-2"></span>
<span id="cb6-3">planner_prompt <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ChatPromptTemplate.from_messages([</span>
<span id="cb6-4">    (</span>
<span id="cb6-5">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"system"</span>,</span>
<span id="cb6-6">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"""당신은 전문적인 작업 계획가(Project Manager)입니다.</span></span>
<span id="cb6-7"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">        </span></span>
<span id="cb6-8"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">사용자의 요청을 분석하여 다음 규칙에 따라 상세한 작업 계획을 수립하세요:</span></span>
<span id="cb6-9"></span>
<span id="cb6-10"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">1. **작업 분해**: 복잡한 요청을 논리적인 소 작업들로 분해</span></span>
<span id="cb6-11"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">2. **순차성**: 선행 작업이 필요한 경우 dependencies에 명시</span></span>
<span id="cb6-12"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">3. **도구 식별**: 각 작업에 필요한 도구 명시 (web_search, file_management, pdf_retriever 등)</span></span>
<span id="cb6-13"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">4. **명확성**: 각 작업의 목표가 명확하고 측정 가능하도록 작성</span></span>
<span id="cb6-14"></span>
<span id="cb6-15"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">사용 가능한 도구:</span></span>
<span id="cb6-16"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">- web_search: 웹 검색 (최신 정보 필요시)</span></span>
<span id="cb6-17"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">- file_write: 파일 작성</span></span>
<span id="cb6-18"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">- file_read: 파일 읽기</span></span>
<span id="cb6-19"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">- pdf_retriever: PDF 문서 검색</span></span>
<span id="cb6-20"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">- data_analysis: 데이터 분석</span></span>
<span id="cb6-21"></span>
<span id="cb6-22"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">응답 형식은 다음 JSON 스키마를 따르세요:</span></span>
<span id="cb6-23"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">```json</span></span>
<span id="cb6-24"><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{{</span></span>
<span id="cb6-25"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    "objective": "최종 목표",</span></span>
<span id="cb6-26"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    "tasks": [</span></span>
<span id="cb6-27"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">        </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{{</span></span>
<span id="cb6-28"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">            "id": 1,</span></span>
<span id="cb6-29"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">            "title": "작업 제목",</span></span>
<span id="cb6-30"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">            "description": "작업 상세 설명",</span></span>
<span id="cb6-31"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">            "required_tools": ["tool1", "tool2"],</span></span>
<span id="cb6-32"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">            "dependencies": []</span></span>
<span id="cb6-33"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">        </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}}</span></span>
<span id="cb6-34"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    ]</span></span>
<span id="cb6-35"><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}}</span></span>
<span id="cb6-36"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">```"""</span>,</span>
<span id="cb6-37">    ),</span>
<span id="cb6-38">    (<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"human"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{input}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>),</span>
<span id="cb6-39">])</span></code></pre></div>
</details>
</div>
<p><strong>Prompt 설계 팁:</strong> - 구조화된 출력 형식 명시 - 사용 가능한 도구 목록 제공 - 작업 분해의 기준 설명</p>
</section>
</section>
<section id="도구-설정" class="level2" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="도구-설정"><span class="header-section-number">4</span> 도구 설정</h2>
<section id="웹-검색-도구" class="level3" data-number="4.1">
<h3 data-number="4.1" class="anchored" data-anchor-id="웹-검색-도구"><span class="header-section-number">4.1</span> 웹 검색 도구</h3>
<div id="fcbb019f" class="cell" data-execution_count="6">
<details class="code-fold">
<summary>코드</summary>
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb7-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> langchain_teddynote.tools.tavily <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> TavilySearch</span>
<span id="cb7-2"></span>
<span id="cb7-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 웹 검색 도구 생성</span></span>
<span id="cb7-4">web_search <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> TavilySearch(</span>
<span id="cb7-5">    topic<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"general"</span>,</span>
<span id="cb7-6">    max_results<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,</span>
<span id="cb7-7">    include_answer<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>,</span>
<span id="cb7-8">    include_raw_content<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>,</span>
<span id="cb7-9">)</span>
<span id="cb7-10"></span>
<span id="cb7-11">web_search.name <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"web_search"</span></span>
<span id="cb7-12">web_search.description <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (</span>
<span id="cb7-13">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"웹에서 정보를 검색합니다. 최신 정보, 뉴스, 통계 등이 필요할 때 사용합니다."</span></span>
<span id="cb7-14">)</span></code></pre></div>
</details>
</div>
</section>
<section id="파일-관리-도구" class="level3" data-number="4.2">
<h3 data-number="4.2" class="anchored" data-anchor-id="파일-관리-도구"><span class="header-section-number">4.2</span> 파일 관리 도구</h3>
<div id="4f92615e" class="cell" data-execution_count="7">
<details class="code-fold">
<summary>코드</summary>
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb8-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> langchain_community.agent_toolkits <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> FileManagementToolkit</span>
<span id="cb8-2"></span>
<span id="cb8-3">working_directory <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tmp"</span></span>
<span id="cb8-4"></span>
<span id="cb8-5">file_management_tools <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> FileManagementToolkit(</span>
<span id="cb8-6">    root_dir<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>(working_directory),</span>
<span id="cb8-7">).get_tools()</span>
<span id="cb8-8"></span>
<span id="cb8-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 도구 이름과 설명 업데이트</span></span>
<span id="cb8-10"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> tool <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> file_management_tools:</span>
<span id="cb8-11">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> tool.name <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"file_write"</span>:</span>
<span id="cb8-12">        tool.description <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"파일을 작성하거나 수정합니다."</span></span>
<span id="cb8-13">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">elif</span> tool.name <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"file_read"</span>:</span>
<span id="cb8-14">        tool.description <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"파일의 내용을 읽습니다."</span></span>
<span id="cb8-15">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">elif</span> tool.name <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"list_directory"</span>:</span>
<span id="cb8-16">        tool.description <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"디렉토리의 파일 목록을 조회합니다."</span></span></code></pre></div>
</details>
</div>
</section>
<section id="pdf-검색-도구" class="level3" data-number="4.3">
<h3 data-number="4.3" class="anchored" data-anchor-id="pdf-검색-도구"><span class="header-section-number">4.3</span> PDF 검색 도구</h3>
<div id="e6fa96cd" class="cell" data-execution_count="8">
<details class="code-fold">
<summary>코드</summary>
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb9-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> langchain.text_splitter <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> RecursiveCharacterTextSplitter</span>
<span id="cb9-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> langchain_community.vectorstores <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> FAISS</span>
<span id="cb9-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> langchain_openai <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> OpenAIEmbeddings</span>
<span id="cb9-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> langchain.document_loaders <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> PDFPlumberLoader</span>
<span id="cb9-5"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> langchain_core.tools.retriever <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> create_retriever_tool</span>
<span id="cb9-6"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> langchain_core.prompts <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> PromptTemplate</span>
<span id="cb9-7"></span>
<span id="cb9-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># PDF 로드 및 벡터화</span></span>
<span id="cb9-9">loader <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> PDFPlumberLoader(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data/sample_document.pdf"</span>)</span>
<span id="cb9-10">text_splitter <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> RecursiveCharacterTextSplitter(chunk_size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>, chunk_overlap<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>)</span>
<span id="cb9-11">split_docs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> loader.load_and_split(text_splitter)</span>
<span id="cb9-12">vector <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> FAISS.from_documents(split_docs, OpenAIEmbeddings())</span>
<span id="cb9-13">pdf_retriever <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> vector.as_retriever()</span>
<span id="cb9-14"></span>
<span id="cb9-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Retriever 도구 생성</span></span>
<span id="cb9-16">retriever_tool <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> create_retriever_tool(</span>
<span id="cb9-17">    pdf_retriever,</span>
<span id="cb9-18">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"pdf_retriever"</span>,</span>
<span id="cb9-19">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"내부 문서에서 정보를 검색합니다. 회사 정책, 보고서, 기술 문서 등을 조회할 수 있습니다."</span>,</span>
<span id="cb9-20">    document_prompt<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>PromptTemplate.from_template(</span>
<span id="cb9-21">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"&lt;document&gt;&lt;context&gt;</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{page_content}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">&lt;/context&gt;&lt;metadata&gt;&lt;source&gt;</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{source}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">&lt;/source&gt;&lt;page&gt;</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{page}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">&lt;/page&gt;&lt;/metadata&gt;&lt;/document&gt;"</span></span>
<span id="cb9-22">    ),</span>
<span id="cb9-23">)</span></code></pre></div>
</details>
</div>
</section>
<section id="전체-도구-목록" class="level3" data-number="4.4">
<h3 data-number="4.4" class="anchored" data-anchor-id="전체-도구-목록"><span class="header-section-number">4.4</span> 전체 도구 목록</h3>
<div id="e8234620" class="cell" data-execution_count="9">
<details class="code-fold">
<summary>코드</summary>
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb10-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 도구 목록 구성</span></span>
<span id="cb10-2">tools <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [web_search, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>file_management_tools, retriever_tool]</span></code></pre></div>
</details>
</div>
</section>
</section>
<section id="plan-and-execute-에이전트-구현" class="level2" data-number="5">
<h2 data-number="5" class="anchored" data-anchor-id="plan-and-execute-에이전트-구현"><span class="header-section-number">5</span> Plan-and-Execute 에이전트 구현</h2>
<section id="executor-에이전트-생성" class="level3" data-number="5.1">
<h3 data-number="5.1" class="anchored" data-anchor-id="executor-에이전트-생성"><span class="header-section-number">5.1</span> Executor 에이전트 생성</h3>
<p>계획된 작업을 실행할 ReAct 에이전트를 생성한다.</p>
<div id="a1f7c755" class="cell" data-execution_count="10">
<details class="code-fold">
<summary>코드</summary>
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb11-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> langgraph.prebuilt <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> create_react_agent</span>
<span id="cb11-2"></span>
<span id="cb11-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Executor 에이전트: 개별 작업 수행</span></span>
<span id="cb11-4">executor <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> create_react_agent(</span>
<span id="cb11-5">    executor_model,</span>
<span id="cb11-6">    tools,</span>
<span id="cb11-7">    checkpointer<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>memory,</span>
<span id="cb11-8">)</span></code></pre></div>
</details>
</div>
</section>
<section id="plan-and-execute-그래프-구축" class="level3" data-number="5.2">
<h3 data-number="5.2" class="anchored" data-anchor-id="plan-and-execute-그래프-구축"><span class="header-section-number">5.2</span> Plan-and-Execute 그래프 구축</h3>
<div id="f8b40f90" class="cell" data-execution_count="11">
<details class="code-fold">
<summary>코드</summary>
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb12-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> langgraph.graph <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> StateGraph, START, END</span>
<span id="cb12-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> langchain_core.messages <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> BaseMessage</span>
<span id="cb12-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> typing <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Annotated</span>
<span id="cb12-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> langgraph.graph.message <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> add_messages</span>
<span id="cb12-5"></span>
<span id="cb12-6"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">class</span> PlanExecuteState(BaseModel):</span>
<span id="cb12-7">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""계획 및 실행 상태"""</span></span>
<span id="cb12-8">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">input</span>: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Field(description<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"사용자 입력"</span>)</span>
<span id="cb12-9">    plan: Plan <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Field(default<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>, description<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"수립된 계획"</span>)</span>
<span id="cb12-10">    past_steps: Annotated[List[<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">tuple</span>], add_messages] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Field(</span>
<span id="cb12-11">        default_factory<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">list</span>,</span>
<span id="cb12-12">        description<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"완료된 작업과 결과"</span></span>
<span id="cb12-13">    )</span>
<span id="cb12-14">    response: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Field(default<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>, description<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"최종 응답"</span>)</span>
<span id="cb12-15"></span>
<span id="cb12-16"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> plan_step(state: PlanExecuteState) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span> PlanExecuteState:</span>
<span id="cb12-17">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""계획 수립 단계"""</span></span>
<span id="cb12-18">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Planner가 계획 수립</span></span>
<span id="cb12-19">    planner_chain <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> planner_prompt <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> planner_model.with_structured_output(Plan)</span>
<span id="cb12-20">    plan <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> planner_chain.invoke({<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"input"</span>: state.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">input</span>})</span>
<span id="cb12-21">    </span>
<span id="cb12-22">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> {<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span>state, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"plan"</span>: plan}</span>
<span id="cb12-23"></span>
<span id="cb12-24"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> execute_step(state: PlanExecuteState) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span> PlanExecuteState:</span>
<span id="cb12-25">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""작업 실행 단계"""</span></span>
<span id="cb12-26">    plan <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> state.plan</span>
<span id="cb12-27">    past_steps <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> state.past_steps</span>
<span id="cb12-28">    </span>
<span id="cb12-29">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 완료되지 않은 작업 찾기</span></span>
<span id="cb12-30">    completed_task_ids <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {step[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> step <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> past_steps}</span>
<span id="cb12-31">    next_task <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span></span>
<span id="cb12-32">    </span>
<span id="cb12-33">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> task <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> plan.tasks:</span>
<span id="cb12-34">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 의존성이 모두 완료되었고, 아직 수행되지 않은 작업</span></span>
<span id="cb12-35">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> (task.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">id</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">not</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> completed_task_ids <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">and</span> </span>
<span id="cb12-36">            <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">all</span>(dep_id <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> completed_task_ids <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> dep_id <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> task.dependencies)):</span>
<span id="cb12-37">            next_task <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> task</span>
<span id="cb12-38">            <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">break</span></span>
<span id="cb12-39">    </span>
<span id="cb12-40">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> next_task <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">is</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>:</span>
<span id="cb12-41">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 모든 작업 완료</span></span>
<span id="cb12-42">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> state</span>
<span id="cb12-43">    </span>
<span id="cb12-44">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 작업 실행</span></span>
<span id="cb12-45">    task_instruction <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"""</span></span>
<span id="cb12-46"><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">    다음 작업을 수행하세요:</span></span>
<span id="cb12-47"><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">    </span></span>
<span id="cb12-48"><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">    제목: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>next_task<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>title<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb12-49"><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">    설명: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>next_task<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>description<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb12-50"><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">    필요 도구: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">', '</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>join(next_task.required_tools)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb12-51"><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">    </span></span>
<span id="cb12-52"><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">    이전 작업 결과:</span></span>
<span id="cb12-53"><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">    </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">chr</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>join(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Task </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>task_id<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>result<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> task_id, result <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> past_steps)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb12-54"><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">    """</span></span>
<span id="cb12-55">    </span>
<span id="cb12-56">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Executor가 작업 수행</span></span>
<span id="cb12-57">    result <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> executor.invoke(</span>
<span id="cb12-58">        {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"messages"</span>: [(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"human"</span>, task_instruction)]},</span>
<span id="cb12-59">        {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"configurable"</span>: {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"thread_id"</span>: <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"task_</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>next_task<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">id</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>}}</span>
<span id="cb12-60">    )</span>
<span id="cb12-61">    </span>
<span id="cb12-62">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 결과 저장</span></span>
<span id="cb12-63">    past_steps.append((next_task.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">id</span>, result[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"messages"</span>][<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>].content))</span>
<span id="cb12-64">    </span>
<span id="cb12-65">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> {<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span>state, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"past_steps"</span>: past_steps}</span>
<span id="cb12-66"></span>
<span id="cb12-67"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> generate_response_step(state: PlanExecuteState) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span> PlanExecuteState:</span>
<span id="cb12-68">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""최종 응답 생성 단계"""</span></span>
<span id="cb12-69">    plan <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> state.plan</span>
<span id="cb12-70">    past_steps <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> state.past_steps</span>
<span id="cb12-71">    </span>
<span id="cb12-72">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 모든 작업이 완료되었는지 확인</span></span>
<span id="cb12-73">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(past_steps) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(plan.tasks):</span>
<span id="cb12-74">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> state</span>
<span id="cb12-75">    </span>
<span id="cb12-76">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 결과 통합</span></span>
<span id="cb12-77">    summary <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"""</span></span>
<span id="cb12-78"><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">    ## 작업 완료 보고서</span></span>
<span id="cb12-79"><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">    </span></span>
<span id="cb12-80"><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">    **목표**: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>plan<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>objective<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb12-81"><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">    </span></span>
<span id="cb12-82"><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">    ### 수행 작업</span></span>
<span id="cb12-83"><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">    """</span></span>
<span id="cb12-84">    </span>
<span id="cb12-85">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> task_id, result <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> past_steps:</span>
<span id="cb12-86">        task <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">next</span>(t <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> t <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> plan.tasks <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> t.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">id</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> task_id)</span>
<span id="cb12-87">        summary <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n\n</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">**Task </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>task_id<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>task<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>title<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">**</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>result<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb12-88">    </span>
<span id="cb12-89">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> {<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span>state, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"response"</span>: summary}</span>
<span id="cb12-90"></span>
<span id="cb12-91"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 그래프 구성</span></span>
<span id="cb12-92">workflow <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> StateGraph(PlanExecuteState)</span>
<span id="cb12-93"></span>
<span id="cb12-94">workflow.add_node(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"plan"</span>, plan_step)</span>
<span id="cb12-95">workflow.add_node(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"execute"</span>, execute_step)</span>
<span id="cb12-96">workflow.add_node(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"respond"</span>, generate_response_step)</span>
<span id="cb12-97"></span>
<span id="cb12-98">workflow.add_edge(START, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"plan"</span>)</span>
<span id="cb12-99">workflow.add_edge(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"plan"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"execute"</span>)</span>
<span id="cb12-100">workflow.add_edge(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"execute"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"execute"</span>)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 모든 작업 완료까지 반복</span></span>
<span id="cb12-101">workflow.add_edge(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"execute"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"respond"</span>)</span>
<span id="cb12-102">workflow.add_edge(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"respond"</span>, END)</span>
<span id="cb12-103"></span>
<span id="cb12-104"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 컴파일</span></span>
<span id="cb12-105">plan_execute_agent <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> workflow.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">compile</span>(checkpointer<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>memory)</span></code></pre></div>
</details>
</div>
<p><strong>그래프 구조:</strong> - <strong>plan 노드</strong>: LLM이 전체 작업 계획 수립 - <strong>execute 노드</strong>: 각 작업을 순차적으로 실행 (반복) - <strong>respond 노드</strong>: 최종 응답 생성</p>
</section>
</section>
<section id="실행-함수-정의" class="level2" data-number="6">
<h2 data-number="6" class="anchored" data-anchor-id="실행-함수-정의"><span class="header-section-number">6</span> 실행 함수 정의</h2>
<section id="스트리밍-출력" class="level3" data-number="6.1">
<h3 data-number="6.1" class="anchored" data-anchor-id="스트리밍-출력"><span class="header-section-number">6.1</span> 스트리밍 출력</h3>
<div id="e6f35fea" class="cell" data-execution_count="12">
<details class="code-fold">
<summary>코드</summary>
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb13-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> langchain_teddynote.messages <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> stream_graph</span>
<span id="cb13-2"></span>
<span id="cb13-3"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> run_plan_execute_agent(instruction: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>, thread_id: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"main"</span>):</span>
<span id="cb13-4">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""계획 및 실행 에이전트 실행"""</span></span>
<span id="cb13-5">    config <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"configurable"</span>: {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"thread_id"</span>: thread_id}}</span>
<span id="cb13-6">    inputs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"messages"</span>: [(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"human"</span>, instruction)]}</span>
<span id="cb13-7">    </span>
<span id="cb13-8">    stream_graph(plan_execute_agent, inputs, config)</span></code></pre></div>
</details>
</div>
</section>
</section>
<section id="사용-예시" class="level2" data-number="7">
<h2 data-number="7" class="anchored" data-anchor-id="사용-예시"><span class="header-section-number">7</span> 사용 예시</h2>
<section id="예시-1-시장-조사-보고서-작성" class="level3" data-number="7.1">
<h3 data-number="7.1" class="anchored" data-anchor-id="예시-1-시장-조사-보고서-작성"><span class="header-section-number">7.1</span> 예시 1: 시장 조사 보고서 작성</h3>
<div id="bee4643e" class="cell" data-execution_count="13">
<details class="code-fold">
<summary>코드</summary>
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb14-1">instruction <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"""</span></span>
<span id="cb14-2"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">AI 에이전트 시장에 대한 종합 조사 보고서를 작성해주세요.</span></span>
<span id="cb14-3"></span>
<span id="cb14-4"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">다음 내용이 포함되어야 합니다:</span></span>
<span id="cb14-5"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">1. 현재 AI 에이전트 시장 규모 및 성장률</span></span>
<span id="cb14-6"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">2. 주요 플레이어 및 기술 트렌드</span></span>
<span id="cb14-7"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">3. 시장 기회 및 위험 요소 분석</span></span>
<span id="cb14-8"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">4. 향후 6개월 전망</span></span>
<span id="cb14-9"></span>
<span id="cb14-10"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">보고서는 마크다운 형식으로 작성하고 파일로 저장해주세요.</span></span>
<span id="cb14-11"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"""</span></span>
<span id="cb14-12"></span>
<span id="cb14-13">run_plan_execute_agent(instruction)</span></code></pre></div>
</details>
</div>
<p><strong>실행 흐름:</strong></p>
<ol type="1">
<li><strong>Plan 단계</strong>:
<ul>
<li>Task 1: 시장 규모 및 성장률 조사 (web_search)</li>
<li>Task 2: 주요 플레이어 분석 (web_search)</li>
<li>Task 3: 기술 트렌드 조사 (web_search + pdf_retriever)</li>
<li>Task 4: 보고서 작성 (Task 1-3 결과 필요)</li>
<li>Task 5: 파일 저장 (Task 4 결과 필요)</li>
</ul></li>
<li><strong>Execute 단계</strong>:
<ul>
<li>Task 1 실행 → 결과 저장</li>
<li>Task 2 실행 → 결과 저장</li>
<li>Task 3 실행 → 결과 저장</li>
<li>Task 4 실행 → 결과 저장</li>
<li>Task 5 실행 → 결과 저장</li>
</ul></li>
<li><strong>Respond 단계</strong>: 최종 보고서 생성</li>
</ol>
</section>
<section id="예시-2-데이터-분석-및-시각화" class="level3" data-number="7.2">
<h3 data-number="7.2" class="anchored" data-anchor-id="예시-2-데이터-분석-및-시각화"><span class="header-section-number">7.2</span> 예시 2: 데이터 분석 및 시각화</h3>
<div id="b1b3b54a" class="cell" data-execution_count="14">
<details class="code-fold">
<summary>코드</summary>
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb15-1">instruction <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"""</span></span>
<span id="cb15-2"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">회사의 분기별 판매 데이터를 분석하고 시각화하는 프로젝트를 진행해주세요.</span></span>
<span id="cb15-3"></span>
<span id="cb15-4"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">다음을 순서대로 수행하세요:</span></span>
<span id="cb15-5"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">1. sales_data.csv 파일 읽기</span></span>
<span id="cb15-6"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">2. 분기별 판매액, 증감율, 주요 제품 분석</span></span>
<span id="cb15-7"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">3. 분석 결과를 정리한 요약 테이블 작성</span></span>
<span id="cb15-8"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">4. 주요 통찰력을 markdown 형식으로 정리</span></span>
<span id="cb15-9"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">5. 최종 분석 보고서를 analysis_report.md로 저장</span></span>
<span id="cb15-10"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"""</span></span>
<span id="cb15-11"></span>
<span id="cb15-12">run_plan_execute_agent(instruction)</span></code></pre></div>
</details>
</div>
<p><strong>실행 특징:</strong> - Task 간 의존성 자동 관리 - 각 Task의 결과가 다음 Task의 입력으로 사용 - 순서 위반 불가능 (의존성으로 보호)</p>
</section>
<section id="예시-3-경쟁사-분석" class="level3" data-number="7.3">
<h3 data-number="7.3" class="anchored" data-anchor-id="예시-3-경쟁사-분석"><span class="header-section-number">7.3</span> 예시 3: 경쟁사 분석</h3>
<div id="de6165e8" class="cell" data-execution_count="15">
<details class="code-fold">
<summary>코드</summary>
<div class="sourceCode cell-code" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb16-1">instruction <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"""</span></span>
<span id="cb16-2"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">주요 경쟁사 3곳에 대한 경쟁 분석 리포트를 작성해주세요.</span></span>
<span id="cb16-3"></span>
<span id="cb16-4"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">1. 경쟁사1, 경쟁사2, 경쟁사3의 최신 뉴스와 제품 정보 수집</span></span>
<span id="cb16-5"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">2. 각 경쟁사의 강점, 약점, 기회, 위협(SWOT) 분석</span></span>
<span id="cb16-6"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">3. 우리 회사와의 차별화 전략 도출</span></span>
<span id="cb16-7"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">4. 비교 테이블 작성</span></span>
<span id="cb16-8"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">5. 최종 보고서를 competitor_analysis.md로 저장</span></span>
<span id="cb16-9"></span>
<span id="cb16-10"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">각 경쟁사별 분석은 병렬로 수행 가능합니다.</span></span>
<span id="cb16-11"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"""</span></span>
<span id="cb16-12"></span>
<span id="cb16-13">run_plan_execute_agent(instruction)</span></code></pre></div>
</details>
</div>
</section>
</section>
<section id="고급-기법" class="level2" data-number="8">
<h2 data-number="8" class="anchored" data-anchor-id="고급-기법"><span class="header-section-number">8</span> 고급 기법</h2>
<section id="조건부-task-실행" class="level3" data-number="8.1">
<h3 data-number="8.1" class="anchored" data-anchor-id="조건부-task-실행"><span class="header-section-number">8.1</span> 조건부 Task 실행</h3>
<div id="95a6560a" class="cell" data-execution_count="16">
<details class="code-fold">
<summary>코드</summary>
<div class="sourceCode cell-code" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb17-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> should_execute_task(task: Task, previous_results: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dict</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">bool</span>:</span>
<span id="cb17-2">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""특정 조건에서만 Task 실행"""</span></span>
<span id="cb17-3">    </span>
<span id="cb17-4">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 예: 검색 결과가 충분하면 분석 Task 스킵</span></span>
<span id="cb17-5">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> task.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">id</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">and</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(previous_results.get(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"search_results"</span>, [])) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>:</span>
<span id="cb17-6">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span></span>
<span id="cb17-7">    </span>
<span id="cb17-8">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 예: 파일이 존재하면 생성 Task 스킵</span></span>
<span id="cb17-9">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> task.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">id</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">and</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"file_exists"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> previous_results:</span>
<span id="cb17-10">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span></span>
<span id="cb17-11">    </span>
<span id="cb17-12">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span></span></code></pre></div>
</details>
</div>
</section>
<section id="task-결과-캐싱" class="level3" data-number="8.2">
<h3 data-number="8.2" class="anchored" data-anchor-id="task-결과-캐싱"><span class="header-section-number">8.2</span> Task 결과 캐싱</h3>
<div id="8f4f1701" class="cell" data-execution_count="17">
<details class="code-fold">
<summary>코드</summary>
<div class="sourceCode cell-code" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb18-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> functools <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> lru_cache</span>
<span id="cb18-2"></span>
<span id="cb18-3"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">@lru_cache</span>(maxsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">128</span>)</span>
<span id="cb18-4"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> execute_task_cached(task_id: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span>, instruction: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>:</span>
<span id="cb18-5">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""동일한 Task는 캐시된 결과 사용"""</span></span>
<span id="cb18-6">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 실행 로직</span></span>
<span id="cb18-7">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">pass</span></span></code></pre></div>
</details>
</div>
</section>
<section id="에러-처리-및-재시도" class="level3" data-number="8.3">
<h3 data-number="8.3" class="anchored" data-anchor-id="에러-처리-및-재시도"><span class="header-section-number">8.3</span> 에러 처리 및 재시도</h3>
<div id="f3fd1684" class="cell" data-execution_count="18">
<details class="code-fold">
<summary>코드</summary>
<div class="sourceCode cell-code" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb19-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> tenacity <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> retry, stop_after_attempt, wait_exponential</span>
<span id="cb19-2"></span>
<span id="cb19-3"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">@retry</span>(</span>
<span id="cb19-4">    stop<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>stop_after_attempt(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>),</span>
<span id="cb19-5">    wait<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>wait_exponential(multiplier<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">min</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">max</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>)</span>
<span id="cb19-6">)</span>
<span id="cb19-7"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> execute_task_with_retry(task: Task) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>:</span>
<span id="cb19-8">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""실패 시 지수 백오프로 재시도"""</span></span>
<span id="cb19-9">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 실행 로직</span></span>
<span id="cb19-10">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">pass</span></span></code></pre></div>
</details>
</div>
</section>
</section>
<section id="plan-and-execute-vs-react" class="level2" data-number="9">
<h2 data-number="9" class="anchored" data-anchor-id="plan-and-execute-vs-react"><span class="header-section-number">9</span> Plan-and-Execute vs ReAct</h2>
<table class="table">
<thead>
<tr class="header">
<th>특성</th>
<th>Plan-and-Execute</th>
<th>ReAct</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>계획 수립</strong></td>
<td>✅ 사전 계획 수립</td>
<td>❌ 즉흥적 행동</td>
</tr>
<tr class="even">
<td><strong>복잡도</strong></td>
<td>높음 (다단계 작업)</td>
<td>중간 (단일 목표)</td>
</tr>
<tr class="odd">
<td><strong>효율성</strong></td>
<td>✅ 불필요한 반복 최소</td>
<td>❌ 반복 가능성 높음</td>
</tr>
<tr class="even">
<td><strong>유연성</strong></td>
<td>제한적 (계획 변경 어려움)</td>
<td>✅ 높음 (동적 대응)</td>
</tr>
<tr class="odd">
<td><strong>예측성</strong></td>
<td>✅ 높음 (계획이 명시적)</td>
<td>낮음 (동적 결정)</td>
</tr>
<tr class="even">
<td><strong>토큰 소비</strong></td>
<td>중간 (계획 + 실행)</td>
<td>높음 (반복으로 인한 증가)</td>
</tr>
</tbody>
</table>
<p><strong>선택 기준:</strong> - <strong>Plan-and-Execute</strong>: 복잡하고 구조화된 작업, 예측 가능한 프로세스 - <strong>ReAct</strong>: 단순하고 반복적인 작업, 높은 유연성 필요</p>
</section>
<section id="베스트-프랙티스" class="level2" data-number="10">
<h2 data-number="10" class="anchored" data-anchor-id="베스트-프랙티스"><span class="header-section-number">10</span> 베스트 프랙티스</h2>
<section id="명확한-task-정의" class="level3" data-number="10.1">
<h3 data-number="10.1" class="anchored" data-anchor-id="명확한-task-정의"><span class="header-section-number">10.1</span> 1. 명확한 Task 정의</h3>
<div class="sourceCode" id="cb20" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb20-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ❌ 나쁜 예</span></span>
<span id="cb20-2">Task(</span>
<span id="cb20-3">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">id</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb20-4">    title<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"조사"</span>,</span>
<span id="cb20-5">    description<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"뭔가 조사하기"</span></span>
<span id="cb20-6">)</span>
<span id="cb20-7"></span>
<span id="cb20-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ✅ 좋은 예</span></span>
<span id="cb20-9">Task(</span>
<span id="cb20-10">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">id</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb20-11">    title<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"AI 에이전트 시장 규모 조사"</span>,</span>
<span id="cb20-12">    description<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"2024년 AI 에이전트 시장 규모, 성장률, 주요 플레이어를 웹 검색으로 조사"</span>,</span>
<span id="cb20-13">    required_tools<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"web_search"</span>],</span>
<span id="cb20-14">    dependencies<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[]</span>
<span id="cb20-15">)</span></code></pre></div>
</section>
<section id="적절한-task-분해" class="level3" data-number="10.2">
<h3 data-number="10.2" class="anchored" data-anchor-id="적절한-task-분해"><span class="header-section-number">10.2</span> 2. 적절한 Task 분해</h3>
<div class="sourceCode" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb21-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ❌ 너무 많은 Task</span></span>
<span id="cb21-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 100개 이상의 세분화된 Task → 관리 복잡도 증가</span></span>
<span id="cb21-3"></span>
<span id="cb21-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ✅ 적절한 수준</span></span>
<span id="cb21-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 5-10개의 의미 있는 Task → 명확한 진행 추적</span></span></code></pre></div>
</section>
<section id="의존성-명시" class="level3" data-number="10.3">
<h3 data-number="10.3" class="anchored" data-anchor-id="의존성-명시"><span class="header-section-number">10.3</span> 3. 의존성 명시</h3>
<div class="sourceCode" id="cb22" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb22-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ❌ 순환 의존성 주의</span></span>
<span id="cb22-2">Task(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">id</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, dependencies<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>])</span>
<span id="cb22-3">Task(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">id</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, dependencies<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 순환 참조 발생!</span></span>
<span id="cb22-4"></span>
<span id="cb22-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ✅ 단방향 의존성</span></span>
<span id="cb22-6">Task(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">id</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, dependencies<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[])</span>
<span id="cb22-7">Task(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">id</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, dependencies<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])</span>
<span id="cb22-8">Task(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">id</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, dependencies<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>])</span></code></pre></div>
</section>
</section>
<section id="트러블슈팅" class="level2" data-number="11">
<h2 data-number="11" class="anchored" data-anchor-id="트러블슈팅"><span class="header-section-number">11</span> 트러블슈팅</h2>
<section id="문제-1-task-순서-오류" class="level3" data-number="11.1">
<h3 data-number="11.1" class="anchored" data-anchor-id="문제-1-task-순서-오류"><span class="header-section-number">11.1</span> 문제 1: Task 순서 오류</h3>
<div class="sourceCode" id="cb23" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb23-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 의존성 검증</span></span>
<span id="cb23-2"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> validate_plan(plan: Plan) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">bool</span>:</span>
<span id="cb23-3">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""계획의 의존성이 올바른지 검증"""</span></span>
<span id="cb23-4">    task_ids <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {task.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">id</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> task <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> plan.tasks}</span>
<span id="cb23-5">    </span>
<span id="cb23-6">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> task <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> plan.tasks:</span>
<span id="cb23-7">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 존재하지 않는 Task에 의존</span></span>
<span id="cb23-8">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">not</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">all</span>(dep_id <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> task_ids <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> dep_id <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> task.dependencies):</span>
<span id="cb23-9">            <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">raise</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">ValueError</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Task </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>task<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">id</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">: 존재하지 않는 의존성"</span>)</span>
<span id="cb23-10">        </span>
<span id="cb23-11">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 순환 의존성 감지</span></span>
<span id="cb23-12">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> task.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">id</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> task.dependencies:</span>
<span id="cb23-13">            <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">raise</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">ValueError</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"Task </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>task<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">id</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">: 자기 자신에 의존"</span>)</span>
<span id="cb23-14">    </span>
<span id="cb23-15">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span></span></code></pre></div>
</section>
<section id="문제-2-task-실패-처리" class="level3" data-number="11.2">
<h3 data-number="11.2" class="anchored" data-anchor-id="문제-2-task-실패-처리"><span class="header-section-number">11.2</span> 문제 2: Task 실패 처리</h3>
<div class="sourceCode" id="cb24" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb24-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> handle_task_failure(task: Task, error: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>, previous_results: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dict</span>):</span>
<span id="cb24-2">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""Task 실패 시 대응"""</span></span>
<span id="cb24-3">    </span>
<span id="cb24-4">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 1. 재시도</span></span>
<span id="cb24-5">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> task.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">id</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>]:  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 중요한 Task만 재시도</span></span>
<span id="cb24-6">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"retry"</span></span>
<span id="cb24-7">    </span>
<span id="cb24-8">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 2. 대체 Task 실행</span></span>
<span id="cb24-9">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> task.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">id</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>:  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 웹 검색 실패</span></span>
<span id="cb24-10">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"use_pdf_retriever"</span></span>
<span id="cb24-11">    </span>
<span id="cb24-12">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 3. 사용자 개입</span></span>
<span id="cb24-13">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"manual_intervention_required"</span></span></code></pre></div>
</section>
<section id="문제-3-토큰-오버플로우" class="level3" data-number="11.3">
<h3 data-number="11.3" class="anchored" data-anchor-id="문제-3-토큰-오버플로우"><span class="header-section-number">11.3</span> 문제 3: 토큰 오버플로우</h3>
<div class="sourceCode" id="cb25" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb25-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> truncate_results(results: List[<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>], max_tokens: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2000</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span> List[<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>]:</span>
<span id="cb25-2">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""이전 결과 길이 제한"""</span></span>
<span id="cb25-3">    truncated <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb25-4">    total_tokens <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb25-5">    </span>
<span id="cb25-6">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> result <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> results:</span>
<span id="cb25-7">        result_tokens <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(result.split())</span>
<span id="cb25-8">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> total_tokens <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> result_tokens <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> max_tokens:</span>
<span id="cb25-9">            truncated.append(result[:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">500</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"..."</span>)</span>
<span id="cb25-10">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span>:</span>
<span id="cb25-11">            truncated.append(result)</span>
<span id="cb25-12">        total_tokens <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> result_tokens</span>
<span id="cb25-13">    </span>
<span id="cb25-14">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> truncated</span></code></pre></div>
</section>
</section>
<section id="참고-자료" class="level2" data-number="12">
<h2 data-number="12" class="anchored" data-anchor-id="참고-자료"><span class="header-section-number">12</span> 참고 자료</h2>
<ul>
<li><a href="https://arxiv.org/abs/2305.04091">Plan-and-Execute Agent 논문</a></li>
<li><a href="https://langchain-ai.github.io/langgraph/concepts/low_level_concepts/">LangGraph State Management</a></li>
<li><a href="https://langchain-ai.github.io/langgraph/tutorials/">Agent Architecture Best Practices</a></li>
</ul>
</section>
<section id="다음-단계" class="level2" data-number="13">
<h2 data-number="13" class="anchored" data-anchor-id="다음-단계"><span class="header-section-number">13</span> 다음 단계</h2>
<p>Plan-and-Execute Agent의 기본을 익혔다면, 다음 주제들을 살펴보자:</p>
<ul>
<li><strong>Multi-Agent 시스템</strong>: 여러 에이전트의 협업</li>
<li><strong>동적 Task 생성</strong>: 런타임에 Task 추가/제거</li>
<li><strong>Agent Orchestration</strong>: 복잡한 워크플로우 관리</li>
</ul>


</section>

 ]]></description>
  <category>AI</category>
  <category>RAG</category>
  <category>LangChain</category>
  <guid>kk3225.netlify.app/docs/blog/posts/Agent/16-Agent/13-Plan-Execute-Agent.html</guid>
  <pubDate>Mon, 17 Nov 2025 15:00:00 GMT</pubDate>
</item>
<item>
  <title>Multi-Agent 시스템</title>
  <dc:creator>Kwangmin Kim</dc:creator>
  <link>kk3225.netlify.app/docs/blog/posts/Agent/16-Agent/14-Multi-Agent-System.html</link>
  <description><![CDATA[ 





<section id="multi-agent-시스템이란" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="multi-agent-시스템이란"><span class="header-section-number">1</span> Multi-Agent 시스템이란?</h2>
<p>Multi-Agent 시스템은 여러 개의 특화된 에이전트가 <strong>협업(Collaboration)</strong>하여 복잡한 문제를 해결하는 아키텍처다.</p>
<section id="단일-vs-멀티-에이전트" class="level3" data-number="1.1">
<h3 data-number="1.1" class="anchored" data-anchor-id="단일-vs-멀티-에이전트"><span class="header-section-number">1.1</span> 단일 vs 멀티 에이전트</h3>
<p><strong>단일 에이전트의 한계:</strong> - 모든 작업을 하나의 에이전트가 처리 - 전문성 부족 (일반화된 도구만 사용) - 복잡도가 증가하면 성능 저하 - 컨텍스트 길이 제한</p>
<p><strong>Multi-Agent의 장점:</strong> - <strong>전문화</strong>: 각 에이전트가 특정 도메인에 전문화 - <strong>병렬 처리</strong>: 독립적인 작업을 동시에 수행 - <strong>확장성</strong>: 새로운 에이전트 추가 용이 - <strong>결합력</strong>: 각 에이전트의 강점을 결합 - <strong>컨텍스트 분리</strong>: 각 에이전트가 독립적인 컨텍스트 관리</p>
</section>
<section id="multi-agent-시스템-아키텍처-패턴" class="level3" data-number="1.2">
<h3 data-number="1.2" class="anchored" data-anchor-id="multi-agent-시스템-아키텍처-패턴"><span class="header-section-number">1.2</span> Multi-Agent 시스템 아키텍처 패턴</h3>
<section id="패턴-1-supervisor-감독자" class="level4" data-number="1.2.1">
<h4 data-number="1.2.1" class="anchored" data-anchor-id="패턴-1-supervisor-감독자"><span class="header-section-number">1.2.1</span> 패턴 1: Supervisor (감독자)</h4>
<pre><code>           ┌─────────────┐
           │  Supervisor │
           │   (조율자)   │
           └──────┬──────┘
                  │
      ┌───────────┼───────────┐
      │           │           │
┌─────▼────┐ ┌───▼────┐ ┌───▼────┐
│ Agent 1  │ │Agent 2 │ │Agent 3 │
│(검색 전문)│ │(분석 전문)│ │(작성 전문)│
└──────────┘ └────────┘ └────────┘</code></pre>
<p><strong>특징:</strong> - 중앙 Supervisor가 작업 분배 - 각 Agent는 독립적으로 작업 수행 - Supervisor가 결과 통합</p>
</section>
<section id="패턴-2-hierarchical-계층적" class="level4" data-number="1.2.2">
<h4 data-number="1.2.2" class="anchored" data-anchor-id="패턴-2-hierarchical-계층적"><span class="header-section-number">1.2.2</span> 패턴 2: Hierarchical (계층적)</h4>
<pre><code>        ┌──────────────┐
        │ Manager Agent│
        └──────┬───────┘
               │
    ┌──────────┼──────────┐
    │          │          │
┌───▼───┐  ┌──▼───┐  ┌──▼───┐
│Team A │  │Team B│  │Team C│
│Lead   │  │Lead  │  │Lead  │
└───┬───┘  └──┬───┘  └──┬───┘
    │         │         │
┌───┴──┐  ┌──┴──┐  ┌──┴──┐
│Worker│  │Worker│  │Worker│
└──────┘  └─────┘  └─────┘</code></pre>
<p><strong>특징:</strong> - 여러 계층의 에이전트 - 각 계층이 하위 계층 관리 - 복잡한 조직 구조 모델링</p>
</section>
<section id="패턴-3-peer-to-peer-동등" class="level4" data-number="1.2.3">
<h4 data-number="1.2.3" class="anchored" data-anchor-id="패턴-3-peer-to-peer-동등"><span class="header-section-number">1.2.3</span> 패턴 3: Peer-to-Peer (동등)</h4>
<pre><code>┌─────────┐     ┌─────────┐
│ Agent 1 │◄───►│ Agent 2 │
└────┬────┘     └────┬────┘
     │               │
     │    ┌─────────┐│
     └───►│ Agent 3 │◄┘
          └─────────┘</code></pre>
<p><strong>특징:</strong> - 에이전트 간 직접 통신 - 중앙 조율자 없음 - 분산 의사결정</p>
<div id="f2b88d21" class="cell" data-execution_count="1">
<details class="code-fold">
<summary>코드</summary>
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb4-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># API 키를 환경변수로 관리하기 위한 설정 파일</span></span>
<span id="cb4-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> dotenv <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> load_dotenv</span>
<span id="cb4-3"></span>
<span id="cb4-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># API 키 정보 로드</span></span>
<span id="cb4-5">load_dotenv()</span></code></pre></div>
</details>
</div>
<div id="15a0b594" class="cell" data-execution_count="2">
<details class="code-fold">
<summary>코드</summary>
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># LangSmith 추적을 설정한다. https://smith.langchain.com</span></span>
<span id="cb5-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># !pip install -qU langchain-teddynote</span></span>
<span id="cb5-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> langchain_teddynote <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> logging</span>
<span id="cb5-4"></span>
<span id="cb5-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 프로젝트 이름을 입력한다.</span></span>
<span id="cb5-6">logging.langsmith(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"CH17-Multi-Agent-System"</span>)</span></code></pre></div>
</details>
</div>
</section>
</section>
</section>
<section id="환경-설정" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="환경-설정"><span class="header-section-number">2</span> 환경 설정</h2>
<section id="기본-구성-요소" class="level3" data-number="2.1">
<h3 data-number="2.1" class="anchored" data-anchor-id="기본-구성-요소"><span class="header-section-number">2.1</span> 기본 구성 요소</h3>
<p>Multi-Agent 시스템은 다음 요소로 구성된다:</p>
<ol type="1">
<li><strong>특화된 Agent들</strong>: 각자 전문 분야가 있는 에이전트</li>
<li><strong>Supervisor/Router</strong>: 작업 분배 및 조율</li>
<li><strong>공유 메모리</strong>: 에이전트 간 정보 공유</li>
<li><strong>통신 프로토콜</strong>: 에이전트 간 메시지 전달</li>
</ol>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="kk3225.netlify.app/docs/blog/posts/Agent/16-Agent/assets/multi_agent_system.png" class="img-fluid figure-img"></p>
<figcaption>Multi-Agent 시스템 아키텍처</figcaption>
</figure>
</div>
<div id="c0177cd8" class="cell" data-execution_count="3">
<details class="code-fold">
<summary>코드</summary>
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb6-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> langchain_openai <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> ChatOpenAI</span>
<span id="cb6-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> langchain_teddynote.tools.tavily <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> TavilySearch</span>
<span id="cb6-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> langchain_core.messages <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> HumanMessage, SystemMessage</span>
<span id="cb6-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> langgraph.checkpoint.memory <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> MemorySaver</span>
<span id="cb6-5"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> langgraph.prebuilt <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> create_react_agent</span>
<span id="cb6-6"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> typing <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Annotated, Literal</span>
<span id="cb6-7"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> pydantic <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> BaseModel</span>
<span id="cb6-8"></span>
<span id="cb6-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 메모리 설정 (공유 메모리)</span></span>
<span id="cb6-10">memory <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> MemorySaver()</span>
<span id="cb6-11"></span>
<span id="cb6-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 모델 설정</span></span>
<span id="cb6-13">model <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ChatOpenAI(model_name<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gpt-4o-mini"</span>)</span>
<span id="cb6-14">supervisor_model <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ChatOpenAI(model_name<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gpt-4o"</span>)</span></code></pre></div>
</details>
</div>
</section>
</section>
<section id="특화-에이전트-정의" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="특화-에이전트-정의"><span class="header-section-number">3</span> 특화 에이전트 정의</h2>
<section id="연구-에이전트-researcher" class="level3" data-number="3.1">
<h3 data-number="3.1" class="anchored" data-anchor-id="연구-에이전트-researcher"><span class="header-section-number">3.1</span> 연구 에이전트 (Researcher)</h3>
<div id="be7fbcfe" class="cell" data-execution_count="4">
<details class="code-fold">
<summary>코드</summary>
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb7-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> langchain_teddynote.tools.tavily <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> TavilySearch</span>
<span id="cb7-2"></span>
<span id="cb7-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 웹 검색 도구</span></span>
<span id="cb7-4">web_search <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> TavilySearch(</span>
<span id="cb7-5">    topic<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"general"</span>,</span>
<span id="cb7-6">    max_results<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,</span>
<span id="cb7-7">    include_answer<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>,</span>
<span id="cb7-8">)</span>
<span id="cb7-9"></span>
<span id="cb7-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 연구 에이전트 시스템 프롬프트</span></span>
<span id="cb7-11">researcher_prompt <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"""당신은 전문 연구원(Researcher)입니다.</span></span>
<span id="cb7-12"></span>
<span id="cb7-13"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">**역할:**</span></span>
<span id="cb7-14"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">- 웹에서 최신 정보, 통계, 뉴스를 검색</span></span>
<span id="cb7-15"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">- 다양한 소스에서 정보 수집</span></span>
<span id="cb7-16"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">- 팩트 체크 및 검증</span></span>
<span id="cb7-17"></span>
<span id="cb7-18"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">**작업 지침:**</span></span>
<span id="cb7-19"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">1. 검색 키워드를 신중하게 선택</span></span>
<span id="cb7-20"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">2. 여러 소스 교차 검증</span></span>
<span id="cb7-21"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">3. 출처를 명확히 기록</span></span>
<span id="cb7-22"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">4. 요약은 간결하고 정확하게</span></span>
<span id="cb7-23"></span>
<span id="cb7-24"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">**출력 형식:**</span></span>
<span id="cb7-25"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">- 검색 결과: [소스] 내용</span></span>
<span id="cb7-26"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">- 주요 발견: 핵심 정보 요약</span></span>
<span id="cb7-27"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">- 출처 링크: URL 목록"""</span></span>
<span id="cb7-28"></span>
<span id="cb7-29"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 연구 에이전트 생성</span></span>
<span id="cb7-30">researcher <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> create_react_agent(</span>
<span id="cb7-31">    model,</span>
<span id="cb7-32">    [web_search],</span>
<span id="cb7-33">    state_modifier<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>SystemMessage(content<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>researcher_prompt)</span>
<span id="cb7-34">)</span></code></pre></div>
</details>
</div>
</section>
<section id="분석-에이전트-analyst" class="level3" data-number="3.2">
<h3 data-number="3.2" class="anchored" data-anchor-id="분석-에이전트-analyst"><span class="header-section-number">3.2</span> 분석 에이전트 (Analyst)</h3>
<div id="1352e8c6" class="cell" data-execution_count="5">
<details class="code-fold">
<summary>코드</summary>
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb8-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> langchain_community.agent_toolkits <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> FileManagementToolkit</span>
<span id="cb8-2"></span>
<span id="cb8-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 파일 관리 도구</span></span>
<span id="cb8-4">file_tools <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> FileManagementToolkit(root_dir<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"tmp"</span>).get_tools()</span>
<span id="cb8-5"></span>
<span id="cb8-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 분석 에이전트 시스템 프롬프트</span></span>
<span id="cb8-7">analyst_prompt <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"""당신은 전문 데이터 분석가(Analyst)입니다.</span></span>
<span id="cb8-8"></span>
<span id="cb8-9"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">**역할:**</span></span>
<span id="cb8-10"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">- 수집된 데이터 분석 및 해석</span></span>
<span id="cb8-11"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">- 트렌드, 패턴, 인사이트 도출</span></span>
<span id="cb8-12"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">- 통계적 분석 및 시각화</span></span>
<span id="cb8-13"></span>
<span id="cb8-14"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">**작업 지침:**</span></span>
<span id="cb8-15"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">1. 데이터의 신뢰성 평가</span></span>
<span id="cb8-16"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">2. 정량적/정성적 분석 병행</span></span>
<span id="cb8-17"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">3. 비교 분석 및 벤치마킹</span></span>
<span id="cb8-18"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">4. 실행 가능한 인사이트 도출</span></span>
<span id="cb8-19"></span>
<span id="cb8-20"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">**출력 형식:**</span></span>
<span id="cb8-21"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">- 주요 발견사항</span></span>
<span id="cb8-22"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">- 데이터 기반 인사이트</span></span>
<span id="cb8-23"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">- 시사점 및 권장사항</span></span>
<span id="cb8-24"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">- 분석 근거"""</span></span>
<span id="cb8-25"></span>
<span id="cb8-26"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 분석 에이전트 생성</span></span>
<span id="cb8-27">analyst <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> create_react_agent(</span>
<span id="cb8-28">    model,</span>
<span id="cb8-29">    file_tools,</span>
<span id="cb8-30">    state_modifier<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>SystemMessage(content<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>analyst_prompt)</span>
<span id="cb8-31">)</span></code></pre></div>
</details>
</div>
</section>
<section id="작성-에이전트-writer" class="level3" data-number="3.3">
<h3 data-number="3.3" class="anchored" data-anchor-id="작성-에이전트-writer"><span class="header-section-number">3.3</span> 작성 에이전트 (Writer)</h3>
<div id="33367b2c" class="cell" data-execution_count="6">
<details class="code-fold">
<summary>코드</summary>
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb9-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 작성 에이전트 시스템 프롬프트</span></span>
<span id="cb9-2">writer_prompt <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"""당신은 전문 작가(Writer)입니다.</span></span>
<span id="cb9-3"></span>
<span id="cb9-4"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">**역할:**</span></span>
<span id="cb9-5"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">- 연구 및 분석 결과를 보고서로 작성</span></span>
<span id="cb9-6"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">- 명확하고 설득력 있는 문서 작성</span></span>
<span id="cb9-7"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">- 대상 독자에 맞는 톤앤매너 조절</span></span>
<span id="cb9-8"></span>
<span id="cb9-9"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">**작업 지침:**</span></span>
<span id="cb9-10"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">1. 논리적 구조로 문서 구성</span></span>
<span id="cb9-11"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">2. 전문 용어 적절히 사용</span></span>
<span id="cb9-12"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">3. 시각 자료(표, 차트) 활용</span></span>
<span id="cb9-13"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">4. 요약 및 결론 명확히 제시</span></span>
<span id="cb9-14"></span>
<span id="cb9-15"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">**출력 형식:**</span></span>
<span id="cb9-16"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">- Markdown 형식</span></span>
<span id="cb9-17"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">- 섹션별 헤딩 구조</span></span>
<span id="cb9-18"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">- 요점 정리 테이블</span></span>
<span id="cb9-19"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">- 참고 자료 링크"""</span></span>
<span id="cb9-20"></span>
<span id="cb9-21"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 작성 에이전트 생성</span></span>
<span id="cb9-22">writer <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> create_react_agent(</span>
<span id="cb9-23">    model,</span>
<span id="cb9-24">    file_tools,</span>
<span id="cb9-25">    state_modifier<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>SystemMessage(content<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>writer_prompt)</span>
<span id="cb9-26">)</span></code></pre></div>
</details>
</div>
</section>
<section id="코드-에이전트-coder" class="level3" data-number="3.4">
<h3 data-number="3.4" class="anchored" data-anchor-id="코드-에이전트-coder"><span class="header-section-number">3.4</span> 코드 에이전트 (Coder)</h3>
<div id="63d4af05" class="cell" data-execution_count="7">
<details class="code-fold">
<summary>코드</summary>
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb10-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 코드 에이전트 시스템 프롬프트</span></span>
<span id="cb10-2">coder_prompt <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"""당신은 전문 개발자(Coder)입니다.</span></span>
<span id="cb10-3"></span>
<span id="cb10-4"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">**역할:**</span></span>
<span id="cb10-5"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">- 데이터 처리 스크립트 작성</span></span>
<span id="cb10-6"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">- 분석 코드 구현</span></span>
<span id="cb10-7"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">- 자동화 도구 개발</span></span>
<span id="cb10-8"></span>
<span id="cb10-9"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">**작업 지침:**</span></span>
<span id="cb10-10"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">1. 깨끗하고 유지보수 가능한 코드</span></span>
<span id="cb10-11"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">2. 적절한 주석 및 문서화</span></span>
<span id="cb10-12"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">3. 에러 처리 및 검증</span></span>
<span id="cb10-13"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">4. 재사용 가능한 함수 작성</span></span>
<span id="cb10-14"></span>
<span id="cb10-15"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">**출력 형식:**</span></span>
<span id="cb10-16"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">- Python 코드 블록</span></span>
<span id="cb10-17"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">- 실행 방법 설명</span></span>
<span id="cb10-18"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">- 입출력 예시</span></span>
<span id="cb10-19"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">- 의존성 목록"""</span></span>
<span id="cb10-20"></span>
<span id="cb10-21"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 코드 에이전트 생성</span></span>
<span id="cb10-22">coder <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> create_react_agent(</span>
<span id="cb10-23">    model,</span>
<span id="cb10-24">    file_tools,</span>
<span id="cb10-25">    state_modifier<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>SystemMessage(content<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>coder_prompt)</span>
<span id="cb10-26">)</span></code></pre></div>
</details>
</div>
</section>
</section>
<section id="supervisor-구현" class="level2" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="supervisor-구현"><span class="header-section-number">4</span> Supervisor 구현</h2>
<section id="supervisor-라우팅-로직" class="level3" data-number="4.1">
<h3 data-number="4.1" class="anchored" data-anchor-id="supervisor-라우팅-로직"><span class="header-section-number">4.1</span> Supervisor 라우팅 로직</h3>
<div id="f1025fad" class="cell" data-execution_count="8">
<details class="code-fold">
<summary>코드</summary>
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb11-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> typing <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Literal</span>
<span id="cb11-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> pydantic <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> BaseModel</span>
<span id="cb11-3"></span>
<span id="cb11-4"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">class</span> RouteDecision(BaseModel):</span>
<span id="cb11-5">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""작업 라우팅 결정"""</span></span>
<span id="cb11-6">    next_agent: Literal[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"researcher"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"analyst"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"writer"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"coder"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"FINISH"</span>]</span>
<span id="cb11-7">    reasoning: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span></span>
<span id="cb11-8"></span>
<span id="cb11-9">supervisor_prompt <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"""당신은 프로젝트 매니저(Supervisor)입니다.</span></span>
<span id="cb11-10"></span>
<span id="cb11-11"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">팀원:</span></span>
<span id="cb11-12"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">- **researcher**: 웹 검색 및 정보 수집 전문</span></span>
<span id="cb11-13"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">- **analyst**: 데이터 분석 및 인사이트 도출 전문</span></span>
<span id="cb11-14"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">- **writer**: 문서 작성 및 보고서 작성 전문</span></span>
<span id="cb11-15"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">- **coder**: 코드 작성 및 자동화 전문</span></span>
<span id="cb11-16"></span>
<span id="cb11-17"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">**작업 분배 원칙:**</span></span>
<span id="cb11-18"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">1. 최신 정보 필요 → researcher</span></span>
<span id="cb11-19"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">2. 데이터 분석 필요 → analyst</span></span>
<span id="cb11-20"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">3. 문서 작성 필요 → writer</span></span>
<span id="cb11-21"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">4. 코드 구현 필요 → coder</span></span>
<span id="cb11-22"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">5. 모든 작업 완료 → FINISH</span></span>
<span id="cb11-23"></span>
<span id="cb11-24"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">**현재 상황:**</span></span>
<span id="cb11-25"><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{context}</span></span>
<span id="cb11-26"></span>
<span id="cb11-27"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">**다음 작업을 담당할 팀원을 선택하고 이유를 설명하세요.**"""</span></span>
<span id="cb11-28"></span>
<span id="cb11-29"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> create_supervisor_chain():</span>
<span id="cb11-30">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""Supervisor 체인 생성"""</span></span>
<span id="cb11-31">    <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> langchain_core.prompts <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> ChatPromptTemplate</span>
<span id="cb11-32">    </span>
<span id="cb11-33">    prompt <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ChatPromptTemplate.from_messages([</span>
<span id="cb11-34">        (<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"system"</span>, supervisor_prompt),</span>
<span id="cb11-35">        (<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"human"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{input}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>),</span>
<span id="cb11-36">    ])</span>
<span id="cb11-37">    </span>
<span id="cb11-38">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> prompt <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> supervisor_model.with_structured_output(RouteDecision)</span></code></pre></div>
</details>
</div>
</section>
</section>
<section id="multi-agent-그래프-구축" class="level2" data-number="5">
<h2 data-number="5" class="anchored" data-anchor-id="multi-agent-그래프-구축"><span class="header-section-number">5</span> Multi-Agent 그래프 구축</h2>
<section id="상태-정의" class="level3" data-number="5.1">
<h3 data-number="5.1" class="anchored" data-anchor-id="상태-정의"><span class="header-section-number">5.1</span> 상태 정의</h3>
<div id="3cc2293c" class="cell" data-execution_count="9">
<details class="code-fold">
<summary>코드</summary>
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb12-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> typing <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Annotated, TypedDict</span>
<span id="cb12-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> langgraph.graph.message <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> add_messages</span>
<span id="cb12-3"></span>
<span id="cb12-4"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">class</span> MultiAgentState(TypedDict):</span>
<span id="cb12-5">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""Multi-Agent 시스템 상태"""</span></span>
<span id="cb12-6">    messages: Annotated[<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">list</span>, add_messages]</span>
<span id="cb12-7">    next_agent: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span></span>
<span id="cb12-8">    research_results: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span></span>
<span id="cb12-9">    analysis_results: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span></span>
<span id="cb12-10">    code_results: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span></span>
<span id="cb12-11">    final_report: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span></span></code></pre></div>
</details>
</div>
</section>
<section id="에이전트-노드-정의" class="level3" data-number="5.2">
<h3 data-number="5.2" class="anchored" data-anchor-id="에이전트-노드-정의"><span class="header-section-number">5.2</span> 에이전트 노드 정의</h3>
<div id="d27f2f7b" class="cell" data-execution_count="10">
<details class="code-fold">
<summary>코드</summary>
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb13-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> researcher_node(state: MultiAgentState) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span> MultiAgentState:</span>
<span id="cb13-2">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""연구 에이전트 노드"""</span></span>
<span id="cb13-3">    result <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> researcher.invoke(state)</span>
<span id="cb13-4">    </span>
<span id="cb13-5">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> {</span>
<span id="cb13-6">        <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span>state,</span>
<span id="cb13-7">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"messages"</span>: result[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"messages"</span>],</span>
<span id="cb13-8">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"research_results"</span>: result[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"messages"</span>][<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>].content,</span>
<span id="cb13-9">    }</span>
<span id="cb13-10"></span>
<span id="cb13-11"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> analyst_node(state: MultiAgentState) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span> MultiAgentState:</span>
<span id="cb13-12">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""분석 에이전트 노드"""</span></span>
<span id="cb13-13">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 연구 결과를 컨텍스트로 추가</span></span>
<span id="cb13-14">    context <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"연구 결과:</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>state<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>get(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'research_results'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">''</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb13-15">    </span>
<span id="cb13-16">    messages <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> state[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"messages"</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> [</span>
<span id="cb13-17">        HumanMessage(content<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>context<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n\n</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">위 정보를 분석해주세요."</span>)</span>
<span id="cb13-18">    ]</span>
<span id="cb13-19">    </span>
<span id="cb13-20">    result <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> analyst.invoke({<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"messages"</span>: messages})</span>
<span id="cb13-21">    </span>
<span id="cb13-22">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> {</span>
<span id="cb13-23">        <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span>state,</span>
<span id="cb13-24">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"messages"</span>: result[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"messages"</span>],</span>
<span id="cb13-25">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"analysis_results"</span>: result[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"messages"</span>][<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>].content,</span>
<span id="cb13-26">    }</span>
<span id="cb13-27"></span>
<span id="cb13-28"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> writer_node(state: MultiAgentState) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span> MultiAgentState:</span>
<span id="cb13-29">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""작성 에이전트 노드"""</span></span>
<span id="cb13-30">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 연구 및 분석 결과를 컨텍스트로 추가</span></span>
<span id="cb13-31">    context <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"""</span></span>
<span id="cb13-32"><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">    연구 결과:</span></span>
<span id="cb13-33"><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">    </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>state<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>get(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'research_results'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">''</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb13-34"><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">    </span></span>
<span id="cb13-35"><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">    분석 결과:</span></span>
<span id="cb13-36"><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">    </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>state<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>get(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'analysis_results'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">''</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb13-37"><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">    """</span></span>
<span id="cb13-38">    </span>
<span id="cb13-39">    messages <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> state[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"messages"</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> [</span>
<span id="cb13-40">        HumanMessage(content<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>context<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n\n</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">위 내용을 바탕으로 보고서를 작성해주세요."</span>)</span>
<span id="cb13-41">    ]</span>
<span id="cb13-42">    </span>
<span id="cb13-43">    result <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> writer.invoke({<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"messages"</span>: messages})</span>
<span id="cb13-44">    </span>
<span id="cb13-45">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> {</span>
<span id="cb13-46">        <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span>state,</span>
<span id="cb13-47">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"messages"</span>: result[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"messages"</span>],</span>
<span id="cb13-48">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"final_report"</span>: result[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"messages"</span>][<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>].content,</span>
<span id="cb13-49">    }</span>
<span id="cb13-50"></span>
<span id="cb13-51"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> coder_node(state: MultiAgentState) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span> MultiAgentState:</span>
<span id="cb13-52">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""코드 에이전트 노드"""</span></span>
<span id="cb13-53">    result <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> coder.invoke(state)</span>
<span id="cb13-54">    </span>
<span id="cb13-55">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> {</span>
<span id="cb13-56">        <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span>state,</span>
<span id="cb13-57">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"messages"</span>: result[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"messages"</span>],</span>
<span id="cb13-58">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"code_results"</span>: result[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"messages"</span>][<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>].content,</span>
<span id="cb13-59">    }</span></code></pre></div>
</details>
</div>
</section>
<section id="supervisor-노드" class="level3" data-number="5.3">
<h3 data-number="5.3" class="anchored" data-anchor-id="supervisor-노드"><span class="header-section-number">5.3</span> Supervisor 노드</h3>
<div id="fbcca19d" class="cell" data-execution_count="11">
<details class="code-fold">
<summary>코드</summary>
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb14-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> supervisor_node(state: MultiAgentState) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span> MultiAgentState:</span>
<span id="cb14-2">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""Supervisor 노드 - 다음 에이전트 결정"""</span></span>
<span id="cb14-3">    supervisor_chain <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> create_supervisor_chain()</span>
<span id="cb14-4">    </span>
<span id="cb14-5">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 현재 상황 컨텍스트</span></span>
<span id="cb14-6">    context <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"""</span></span>
<span id="cb14-7"><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">    이미 완료된 작업:</span></span>
<span id="cb14-8"><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">    - 연구: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'✅'</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> state<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>get(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'research_results'</span>) <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'❌'</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb14-9"><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">    - 분석: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'✅'</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> state<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>get(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'analysis_results'</span>) <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'❌'</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb14-10"><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">    - 코드: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'✅'</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> state<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>get(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'code_results'</span>) <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'❌'</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb14-11"><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">    - 보고서: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'✅'</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> state<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>get(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'final_report'</span>) <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'❌'</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb14-12"><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">    </span></span>
<span id="cb14-13"><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">    최근 메시지:</span></span>
<span id="cb14-14"><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">    </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>state[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'messages'</span>][<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>content <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> state[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'messages'</span>] <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'없음'</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb14-15"><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">    """</span></span>
<span id="cb14-16">    </span>
<span id="cb14-17">    decision <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> supervisor_chain.invoke({</span>
<span id="cb14-18">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"context"</span>: context,</span>
<span id="cb14-19">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"input"</span>: state[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"messages"</span>][<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>].content <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> state[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"messages"</span>] <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb14-20">    })</span>
<span id="cb14-21">    </span>
<span id="cb14-22">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> {</span>
<span id="cb14-23">        <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span>state,</span>
<span id="cb14-24">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"next_agent"</span>: decision.next_agent,</span>
<span id="cb14-25">    }</span></code></pre></div>
</details>
</div>
</section>
<section id="그래프-구성" class="level3" data-number="5.4">
<h3 data-number="5.4" class="anchored" data-anchor-id="그래프-구성"><span class="header-section-number">5.4</span> 그래프 구성</h3>
<div id="ff334e10" class="cell" data-execution_count="12">
<details class="code-fold">
<summary>코드</summary>
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb15-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> langgraph.graph <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> StateGraph, START, END</span>
<span id="cb15-2"></span>
<span id="cb15-3"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> route_to_agent(state: MultiAgentState) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>:</span>
<span id="cb15-4">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""다음 에이전트로 라우팅"""</span></span>
<span id="cb15-5">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> state.get(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"next_agent"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"FINISH"</span>)</span>
<span id="cb15-6"></span>
<span id="cb15-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 그래프 생성</span></span>
<span id="cb15-8">workflow <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> StateGraph(MultiAgentState)</span>
<span id="cb15-9"></span>
<span id="cb15-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 노드 추가</span></span>
<span id="cb15-11">workflow.add_node(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"supervisor"</span>, supervisor_node)</span>
<span id="cb15-12">workflow.add_node(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"researcher"</span>, researcher_node)</span>
<span id="cb15-13">workflow.add_node(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"analyst"</span>, analyst_node)</span>
<span id="cb15-14">workflow.add_node(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"writer"</span>, writer_node)</span>
<span id="cb15-15">workflow.add_node(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"coder"</span>, coder_node)</span>
<span id="cb15-16"></span>
<span id="cb15-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 엣지 추가</span></span>
<span id="cb15-18">workflow.add_edge(START, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"supervisor"</span>)</span>
<span id="cb15-19">workflow.add_conditional_edges(</span>
<span id="cb15-20">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"supervisor"</span>,</span>
<span id="cb15-21">    route_to_agent,</span>
<span id="cb15-22">    {</span>
<span id="cb15-23">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"researcher"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"researcher"</span>,</span>
<span id="cb15-24">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"analyst"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"analyst"</span>,</span>
<span id="cb15-25">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"writer"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"writer"</span>,</span>
<span id="cb15-26">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"coder"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"coder"</span>,</span>
<span id="cb15-27">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"FINISH"</span>: END,</span>
<span id="cb15-28">    }</span>
<span id="cb15-29">)</span>
<span id="cb15-30"></span>
<span id="cb15-31"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 각 에이전트에서 Supervisor로 돌아가기</span></span>
<span id="cb15-32">workflow.add_edge(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"researcher"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"supervisor"</span>)</span>
<span id="cb15-33">workflow.add_edge(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"analyst"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"supervisor"</span>)</span>
<span id="cb15-34">workflow.add_edge(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"writer"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"supervisor"</span>)</span>
<span id="cb15-35">workflow.add_edge(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"coder"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"supervisor"</span>)</span>
<span id="cb15-36"></span>
<span id="cb15-37"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 컴파일</span></span>
<span id="cb15-38">multi_agent_system <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> workflow.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">compile</span>(checkpointer<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>memory)</span></code></pre></div>
</details>
</div>
<p><strong>그래프 구조:</strong> - <strong>supervisor</strong>: 작업 분배 및 조율 - <strong>researcher → analyst → writer</strong>: 일반적인 흐름 - <strong>coder</strong>: 필요 시 병렬 실행 - <strong>순환 구조</strong>: 각 에이전트 → supervisor → 다음 에이전트</p>
</section>
</section>
<section id="실행-함수-정의" class="level2" data-number="6">
<h2 data-number="6" class="anchored" data-anchor-id="실행-함수-정의"><span class="header-section-number">6</span> 실행 함수 정의</h2>
<section id="스트리밍-출력" class="level3" data-number="6.1">
<h3 data-number="6.1" class="anchored" data-anchor-id="스트리밍-출력"><span class="header-section-number">6.1</span> 스트리밍 출력</h3>
<div id="2364b08f" class="cell" data-execution_count="13">
<details class="code-fold">
<summary>코드</summary>
<div class="sourceCode cell-code" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb16-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> langchain_teddynote.messages <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> stream_graph</span>
<span id="cb16-2"></span>
<span id="cb16-3"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> run_multi_agent_system(instruction: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>, thread_id: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"main"</span>):</span>
<span id="cb16-4">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""Multi-Agent 시스템 실행"""</span></span>
<span id="cb16-5">    config <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"configurable"</span>: {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"thread_id"</span>: thread_id}}</span>
<span id="cb16-6">    inputs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {</span>
<span id="cb16-7">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"messages"</span>: [HumanMessage(content<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>instruction)],</span>
<span id="cb16-8">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"next_agent"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"supervisor"</span></span>
<span id="cb16-9">    }</span>
<span id="cb16-10">    </span>
<span id="cb16-11">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> step <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> multi_agent_system.stream(inputs, config):</span>
<span id="cb16-12">        node_name <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">list</span>(step.keys())[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]</span>
<span id="cb16-13">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'='</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb16-14">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"📍 Current Agent: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>node_name<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb16-15">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'='</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb16-16">        </span>
<span id="cb16-17">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> node_name <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"supervisor"</span>:</span>
<span id="cb16-18">            next_agent <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> step[node_name].get(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"next_agent"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>)</span>
<span id="cb16-19">            <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"➡️ Next Agent: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>next_agent<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb16-20">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span>:</span>
<span id="cb16-21">            messages <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> step[node_name].get(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"messages"</span>, [])</span>
<span id="cb16-22">            <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> messages:</span>
<span id="cb16-23">                <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(messages[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>].content[:<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">500</span>])</span></code></pre></div>
</details>
</div>
</section>
</section>
<section id="사용-예시" class="level2" data-number="7">
<h2 data-number="7" class="anchored" data-anchor-id="사용-예시"><span class="header-section-number">7</span> 사용 예시</h2>
<section id="예시-1-종합-시장-조사" class="level3" data-number="7.1">
<h3 data-number="7.1" class="anchored" data-anchor-id="예시-1-종합-시장-조사"><span class="header-section-number">7.1</span> 예시 1: 종합 시장 조사</h3>
<div id="096d26da" class="cell" data-execution_count="14">
<details class="code-fold">
<summary>코드</summary>
<div class="sourceCode cell-code" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb17-1">instruction <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"""</span></span>
<span id="cb17-2"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">AI 에이전트 시장에 대한 종합 조사 보고서를 작성해주세요.</span></span>
<span id="cb17-3"></span>
<span id="cb17-4"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">다음 단계를 수행하세요:</span></span>
<span id="cb17-5"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">1. 최신 시장 동향 및 통계 조사 (웹 검색)</span></span>
<span id="cb17-6"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">2. 수집된 데이터 분석 (트렌드, 기회, 위협)</span></span>
<span id="cb17-7"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">3. Python으로 간단한 시각화 코드 작성</span></span>
<span id="cb17-8"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">4. 최종 보고서 작성 (마크다운 형식)</span></span>
<span id="cb17-9"></span>
<span id="cb17-10"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">보고서는 executive summary, 시장 분석, 기술 트렌드, 결론 섹션으로 구성하세요.</span></span>
<span id="cb17-11"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"""</span></span>
<span id="cb17-12"></span>
<span id="cb17-13">run_multi_agent_system(instruction)</span></code></pre></div>
</details>
</div>
<p><strong>실행 흐름:</strong></p>
<pre><code>1. Supervisor → "먼저 최신 정보가 필요하므로 researcher"
2. Researcher → 웹 검색 수행, 시장 데이터 수집
3. Supervisor → "데이터 분석이 필요하므로 analyst"
4. Analyst → 연구 결과 분석, 인사이트 도출
5. Supervisor → "시각화 코드가 필요하므로 coder"
6. Coder → Python 시각화 코드 작성
7. Supervisor → "보고서 작성이 필요하므로 writer"
8. Writer → 최종 보고서 작성
9. Supervisor → "모든 작업 완료" → FINISH</code></pre>
</section>
<section id="예시-2-경쟁사-분석-프로젝트" class="level3" data-number="7.2">
<h3 data-number="7.2" class="anchored" data-anchor-id="예시-2-경쟁사-분석-프로젝트"><span class="header-section-number">7.2</span> 예시 2: 경쟁사 분석 프로젝트</h3>
<div id="0c4f982f" class="cell" data-execution_count="15">
<details class="code-fold">
<summary>코드</summary>
<div class="sourceCode cell-code" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb19-1">instruction <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"""</span></span>
<span id="cb19-2"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">주요 경쟁사 3곳(OpenAI, Anthropic, Google)의 AI 에이전트 제품을 비교 분석하는 프로젝트를 진행하세요.</span></span>
<span id="cb19-3"></span>
<span id="cb19-4"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">단계:</span></span>
<span id="cb19-5"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">1. 각 경쟁사의 최신 제품 정보 수집</span></span>
<span id="cb19-6"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">2. 기능, 가격, 성능 비교 분석</span></span>
<span id="cb19-7"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">3. 비교 표 생성 Python 스크립트 작성</span></span>
<span id="cb19-8"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">4. 경쟁 분석 보고서 작성 (강점/약점/기회/위협)</span></span>
<span id="cb19-9"></span>
<span id="cb19-10"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">최종 결과물은 마크다운 보고서와 Python 스크립트입니다.</span></span>
<span id="cb19-11"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"""</span></span>
<span id="cb19-12"></span>
<span id="cb19-13">run_multi_agent_system(instruction)</span></code></pre></div>
</details>
</div>
<p><strong>병렬 처리 예시:</strong> - Researcher: 3개 경쟁사 정보를 병렬로 수집 가능 - Coder: 분석과 독립적으로 스크립트 작성</p>
</section>
<section id="예시-3-자동화된-뉴스레터-생성" class="level3" data-number="7.3">
<h3 data-number="7.3" class="anchored" data-anchor-id="예시-3-자동화된-뉴스레터-생성"><span class="header-section-number">7.3</span> 예시 3: 자동화된 뉴스레터 생성</h3>
<div id="452ffd0f" class="cell" data-execution_count="16">
<details class="code-fold">
<summary>코드</summary>
<div class="sourceCode cell-code" id="cb20" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb20-1">instruction <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"""</span></span>
<span id="cb20-2"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">주간 AI 뉴스레터를 자동으로 생성하세요.</span></span>
<span id="cb20-3"></span>
<span id="cb20-4"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">요구사항:</span></span>
<span id="cb20-5"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">1. 이번 주 AI 관련 주요 뉴스 5개 수집</span></span>
<span id="cb20-6"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">2. 각 뉴스의 요약 및 시사점 분석</span></span>
<span id="cb20-7"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">3. 뉴스레터 HTML 템플릿 생성 코드 작성</span></span>
<span id="cb20-8"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">4. 최종 뉴스레터 작성 (제목, 본문, 링크)</span></span>
<span id="cb20-9"></span>
<span id="cb20-10"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">출력: newsletter.html 파일</span></span>
<span id="cb20-11"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"""</span></span>
<span id="cb20-12"></span>
<span id="cb20-13">run_multi_agent_system(instruction)</span></code></pre></div>
</details>
</div>
</section>
</section>
<section id="고급-기법" class="level2" data-number="8">
<h2 data-number="8" class="anchored" data-anchor-id="고급-기법"><span class="header-section-number">8</span> 고급 기법</h2>
<section id="에이전트-간-직접-통신" class="level3" data-number="8.1">
<h3 data-number="8.1" class="anchored" data-anchor-id="에이전트-간-직접-통신"><span class="header-section-number">8.1</span> 에이전트 간 직접 통신</h3>
<div id="b14a260c" class="cell" data-execution_count="17">
<details class="code-fold">
<summary>코드</summary>
<div class="sourceCode cell-code" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb21-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">class</span> AgentMessage(BaseModel):</span>
<span id="cb21-2">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""에이전트 간 메시지"""</span></span>
<span id="cb21-3">    from_agent: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span></span>
<span id="cb21-4">    to_agent: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span></span>
<span id="cb21-5">    content: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span></span>
<span id="cb21-6">    priority: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb21-7"></span>
<span id="cb21-8"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> send_message(from_agent: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>, to_agent: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>, content: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>, state: MultiAgentState):</span>
<span id="cb21-9">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""에이전트 간 직접 메시지 전송"""</span></span>
<span id="cb21-10">    message <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> AgentMessage(</span>
<span id="cb21-11">        from_agent<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>from_agent,</span>
<span id="cb21-12">        to_agent<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>to_agent,</span>
<span id="cb21-13">        content<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>content</span>
<span id="cb21-14">    )</span>
<span id="cb21-15">    </span>
<span id="cb21-16">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 메시지 큐에 추가</span></span>
<span id="cb21-17">    state.setdefault(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"message_queue"</span>, []).append(message)</span>
<span id="cb21-18">    </span>
<span id="cb21-19">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> state</span></code></pre></div>
</details>
</div>
</section>
<section id="동적-에이전트-생성" class="level3" data-number="8.2">
<h3 data-number="8.2" class="anchored" data-anchor-id="동적-에이전트-생성"><span class="header-section-number">8.2</span> 동적 에이전트 생성</h3>
<div id="987bbf3c" class="cell" data-execution_count="18">
<details class="code-fold">
<summary>코드</summary>
<div class="sourceCode cell-code" id="cb22" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb22-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> create_specialized_agent(domain: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>, tools: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">list</span>):</span>
<span id="cb22-2">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""도메인별 특화 에이전트 동적 생성"""</span></span>
<span id="cb22-3">    </span>
<span id="cb22-4">    prompt <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"""당신은 </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>domain<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> 전문가입니다.</span></span>
<span id="cb22-5"><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">    </span></span>
<span id="cb22-6"><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">    전문 분야에 대한 깊은 지식을 활용하여 작업을 수행하세요.</span></span>
<span id="cb22-7"><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">    """</span></span>
<span id="cb22-8">    </span>
<span id="cb22-9">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> create_react_agent(</span>
<span id="cb22-10">        model,</span>
<span id="cb22-11">        tools,</span>
<span id="cb22-12">        state_modifier<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>SystemMessage(content<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>prompt)</span>
<span id="cb22-13">    )</span>
<span id="cb22-14"></span>
<span id="cb22-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 실행 중 새 에이전트 추가</span></span>
<span id="cb22-16"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"법률 자문이 필요함"</span>:</span>
<span id="cb22-17">    legal_agent <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> create_specialized_agent(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"법률"</span>, legal_tools)</span>
<span id="cb22-18">    workflow.add_node(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"legal_expert"</span>, legal_agent)</span></code></pre></div>
</details>
</div>
</section>
<section id="에이전트-성능-모니터링" class="level3" data-number="8.3">
<h3 data-number="8.3" class="anchored" data-anchor-id="에이전트-성능-모니터링"><span class="header-section-number">8.3</span> 에이전트 성능 모니터링</h3>
<div id="8560cbd2" class="cell" data-execution_count="19">
<details class="code-fold">
<summary>코드</summary>
<div class="sourceCode cell-code" id="cb23" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb23-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> datetime <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> datetime</span>
<span id="cb23-2"></span>
<span id="cb23-3"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">class</span> AgentMetrics(BaseModel):</span>
<span id="cb23-4">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""에이전트 성능 메트릭"""</span></span>
<span id="cb23-5">    agent_name: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span></span>
<span id="cb23-6">    task_count: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb23-7">    success_count: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb23-8">    avg_time: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">float</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.0</span></span>
<span id="cb23-9">    last_execution: datetime <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span></span>
<span id="cb23-10"></span>
<span id="cb23-11"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> track_agent_performance(agent_name: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>, execution_time: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">float</span>, success: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">bool</span>):</span>
<span id="cb23-12">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""에이전트 성능 추적"""</span></span>
<span id="cb23-13">    metrics <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> AgentMetrics(agent_name<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>agent_name)</span>
<span id="cb23-14">    </span>
<span id="cb23-15">    metrics.task_count <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb23-16">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> success:</span>
<span id="cb23-17">        metrics.success_count <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb23-18">    </span>
<span id="cb23-19">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 평균 시간 업데이트</span></span>
<span id="cb23-20">    metrics.avg_time <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (metrics.avg_time <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (metrics.task_count <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> execution_time) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> metrics.task_count</span>
<span id="cb23-21">    metrics.last_execution <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> datetime.now()</span>
<span id="cb23-22">    </span>
<span id="cb23-23">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> metrics</span></code></pre></div>
</details>
</div>
</section>
<section id="에이전트-우선순위-큐" class="level3" data-number="8.4">
<h3 data-number="8.4" class="anchored" data-anchor-id="에이전트-우선순위-큐"><span class="header-section-number">8.4</span> 에이전트 우선순위 큐</h3>
<div id="cef0fe0a" class="cell" data-execution_count="20">
<details class="code-fold">
<summary>코드</summary>
<div class="sourceCode cell-code" id="cb24" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb24-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> heapq</span>
<span id="cb24-2"></span>
<span id="cb24-3"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">class</span> TaskQueue:</span>
<span id="cb24-4">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""우선순위 기반 작업 큐"""</span></span>
<span id="cb24-5">    </span>
<span id="cb24-6">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__init__</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>):</span>
<span id="cb24-7">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.queue <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb24-8">    </span>
<span id="cb24-9">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> add_task(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, priority: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span>, agent_name: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>, task: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dict</span>):</span>
<span id="cb24-10">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""작업 추가 (우선순위 높을수록 먼저 실행)"""</span></span>
<span id="cb24-11">        heapq.heappush(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.queue, (<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>priority, agent_name, task))</span>
<span id="cb24-12">    </span>
<span id="cb24-13">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> get_next_task(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>):</span>
<span id="cb24-14">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""다음 작업 가져오기"""</span></span>
<span id="cb24-15">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.queue:</span>
<span id="cb24-16">            priority, agent_name, task <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> heapq.heappop(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.queue)</span>
<span id="cb24-17">            <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> agent_name, task</span>
<span id="cb24-18">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span></span></code></pre></div>
</details>
</div>
</section>
</section>
<section id="multi-agent-패턴-비교" class="level2" data-number="9">
<h2 data-number="9" class="anchored" data-anchor-id="multi-agent-패턴-비교"><span class="header-section-number">9</span> Multi-Agent 패턴 비교</h2>
<table class="table">
<colgroup>
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 40%">
</colgroup>
<thead>
<tr class="header">
<th>패턴</th>
<th>장점</th>
<th>단점</th>
<th>사용 케이스</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Supervisor</strong></td>
<td>명확한 조율, 추적 용이</td>
<td>병목 가능, 중앙 의존성</td>
<td>순차적 작업, 복잡한 워크플로우</td>
</tr>
<tr class="even">
<td><strong>Hierarchical</strong></td>
<td>확장성, 명확한 역할</td>
<td>구현 복잡, 오버헤드</td>
<td>대규모 조직, 계층적 작업</td>
</tr>
<tr class="odd">
<td><strong>Peer-to-Peer</strong></td>
<td>유연성, 분산 처리</td>
<td>조율 어려움, 충돌 가능</td>
<td>독립적 작업, 동적 협업</td>
</tr>
</tbody>
</table>
</section>
<section id="베스트-프랙티스" class="level2" data-number="10">
<h2 data-number="10" class="anchored" data-anchor-id="베스트-프랙티스"><span class="header-section-number">10</span> 베스트 프랙티스</h2>
<section id="에이전트-역할-명확화" class="level3" data-number="10.1">
<h3 data-number="10.1" class="anchored" data-anchor-id="에이전트-역할-명확화"><span class="header-section-number">10.1</span> 에이전트 역할 명확화</h3>
<div class="sourceCode" id="cb25" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb25-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ❌ 나쁜 예</span></span>
<span id="cb25-2">agent <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> create_react_agent(model, all_tools)</span>
<span id="cb25-3"></span>
<span id="cb25-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ✅ 좋은 예</span></span>
<span id="cb25-5">researcher <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> create_react_agent(</span>
<span id="cb25-6">    model,</span>
<span id="cb25-7">    [web_search],  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 특화된 도구만</span></span>
<span id="cb25-8">    state_modifier<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>SystemMessage(content<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>researcher_prompt)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 명확한 역할</span></span>
<span id="cb25-9">)</span></code></pre></div>
</section>
<section id="에이전트-수-최적화" class="level3" data-number="10.2">
<h3 data-number="10.2" class="anchored" data-anchor-id="에이전트-수-최적화"><span class="header-section-number">10.2</span> 에이전트 수 최적화</h3>
<div class="sourceCode" id="cb26" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb26-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ❌ 너무 많은 에이전트</span></span>
<span id="cb26-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 10개 이상 → 조율 복잡도 증가</span></span>
<span id="cb26-3"></span>
<span id="cb26-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ✅ 적절한 수</span></span>
<span id="cb26-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 3-5개 → 명확한 협업 구조</span></span></code></pre></div>
</section>
<section id="통신-프로토콜-정의" class="level3" data-number="10.3">
<h3 data-number="10.3" class="anchored" data-anchor-id="통신-프로토콜-정의"><span class="header-section-number">10.3</span> 통신 프로토콜 정의</h3>
<div class="sourceCode" id="cb27" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb27-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ✅ 표준화된 메시지 형식</span></span>
<span id="cb27-2"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">class</span> StandardMessage(BaseModel):</span>
<span id="cb27-3">    sender: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span></span>
<span id="cb27-4">    receiver: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span></span>
<span id="cb27-5">    message_type: Literal[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"request"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"response"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"notification"</span>]</span>
<span id="cb27-6">    content: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span></span>
<span id="cb27-7">    metadata: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dict</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {}</span></code></pre></div>
</section>
</section>
<section id="트러블슈팅" class="level2" data-number="11">
<h2 data-number="11" class="anchored" data-anchor-id="트러블슈팅"><span class="header-section-number">11</span> 트러블슈팅</h2>
<section id="문제-1-에이전트-간-무한-루프" class="level3" data-number="11.1">
<h3 data-number="11.1" class="anchored" data-anchor-id="문제-1-에이전트-간-무한-루프"><span class="header-section-number">11.1</span> 문제 1: 에이전트 간 무한 루프</h3>
<div class="sourceCode" id="cb28" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb28-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> detect_loop(state: MultiAgentState, max_iterations: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>):</span>
<span id="cb28-2">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""무한 루프 감지"""</span></span>
<span id="cb28-3">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(state.get(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"messages"</span>, [])) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> max_iterations:</span>
<span id="cb28-4">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">raise</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">ValueError</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"무한 루프 감지: 최대 반복 횟수 초과"</span>)</span></code></pre></div>
</section>
<section id="문제-2-에이전트-충돌" class="level3" data-number="11.2">
<h3 data-number="11.2" class="anchored" data-anchor-id="문제-2-에이전트-충돌"><span class="header-section-number">11.2</span> 문제 2: 에이전트 충돌</h3>
<div class="sourceCode" id="cb29" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb29-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> resolve_conflict(agent1_result, agent2_result):</span>
<span id="cb29-2">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""충돌 해결: 투표 또는 Supervisor 결정"""</span></span>
<span id="cb29-3">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 투표 방식</span></span>
<span id="cb29-4">    votes <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {</span>
<span id="cb29-5">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"agent1"</span>: <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb29-6">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"agent2"</span>: <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb29-7">    }</span>
<span id="cb29-8">    </span>
<span id="cb29-9">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Supervisor가 최종 결정</span></span>
<span id="cb29-10">    supervisor_decision <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> supervisor_model.invoke(</span>
<span id="cb29-11">        <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"다음 두 결과 중 더 적합한 것을 선택하세요:</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">1. </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>agent1_result<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">2. </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>agent2_result<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb29-12">    )</span>
<span id="cb29-13">    </span>
<span id="cb29-14">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> supervisor_decision</span></code></pre></div>
</section>
<section id="문제-3-메모리-오버플로우" class="level3" data-number="11.3">
<h3 data-number="11.3" class="anchored" data-anchor-id="문제-3-메모리-오버플로우"><span class="header-section-number">11.3</span> 문제 3: 메모리 오버플로우</h3>
<div class="sourceCode" id="cb30" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb30-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> cleanup_memory(state: MultiAgentState, keep_last_n: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>):</span>
<span id="cb30-2">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""메모리 정리: 최근 N개 메시지만 유지"""</span></span>
<span id="cb30-3">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(state[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"messages"</span>]) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> keep_last_n:</span>
<span id="cb30-4">        state[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"messages"</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> state[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"messages"</span>][<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>keep_last_n:]</span>
<span id="cb30-5">    </span>
<span id="cb30-6">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> state</span></code></pre></div>
</section>
</section>
<section id="참고-자료" class="level2" data-number="12">
<h2 data-number="12" class="anchored" data-anchor-id="참고-자료"><span class="header-section-number">12</span> 참고 자료</h2>
<ul>
<li><a href="https://arxiv.org/abs/2308.08155">Multi-Agent Systems 논문</a></li>
<li><a href="https://langchain-ai.github.io/langgraph/tutorials/multi_agent/">LangGraph Multi-Agent Tutorial</a></li>
<li><a href="https://www.fipa.org/repository/aclspecs.html">Agent Communication Protocols</a></li>
</ul>
</section>
<section id="다음-단계" class="level2" data-number="13">
<h2 data-number="13" class="anchored" data-anchor-id="다음-단계"><span class="header-section-number">13</span> 다음 단계</h2>
<p>Multi-Agent 시스템의 기본을 익혔다면, 다음 주제들을 살펴보자:</p>
<ul>
<li><strong>Agent Orchestration</strong>: 복잡한 워크플로우 오케스트레이션</li>
<li><strong>Distributed Agent Systems</strong>: 분산 환경에서의 에이전트 실행</li>
<li><strong>Agent Learning</strong>: 에이전트가 협업을 통해 학습하는 시스템</li>
<li><strong>Human-in-the-Loop Multi-Agent</strong>: 사람과 에이전트의 협업</li>
</ul>


</section>

 ]]></description>
  <category>AI</category>
  <category>RAG</category>
  <category>LangChain</category>
  <guid>kk3225.netlify.app/docs/blog/posts/Agent/16-Agent/14-Multi-Agent-System.html</guid>
  <pubDate>Mon, 17 Nov 2025 15:00:00 GMT</pubDate>
</item>
<item>
  <title>Physical Architecture 설계하는 방법</title>
  <dc:creator>Kwangmin Kim</dc:creator>
  <link>kk3225.netlify.app/docs/blog/posts/Engineering/System/Archi_Design/physical_design.html</link>
  <description><![CDATA[ 





<section id="physical-architecture의-정의" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="physical-architecture의-정의"><span class="header-section-number">1</span> Physical Architecture의 정의</h2>
<p>Physical Architecture는 Logical Architecture를 구체적인 기술 스택과 인프라로 구현하는 설계 계층이다. 실제 배포, 운영, 모니터링이 가능한 형태로 정의된다.</p>
<p><strong>핵심 특징:</strong></p>
<ul>
<li><strong>기술 명시</strong>: 프로그래밍 언어, 프레임워크, 데이터베이스, 클라우드 서비스 구체화</li>
<li><strong>인프라 정의</strong>: 서버, 네트워크, 스토리지 구조 명시</li>
<li><strong>배포 단위</strong>: 컨테이너, 마이크로서비스, 서버리스 등 배포 형태</li>
<li><strong>운영 고려</strong>: 모니터링, 로깅, 스케일링, 재해 복구 전략</li>
<li><strong>비용 및 성능</strong>: 실제 리소스 할당, 예상 비용</li>
<li><strong>개발팀 지향</strong>: 구현 팀이 직접 따를 수 있는 명확한 지침</li>
</ul>
<section id="세-계층의-최종-비교" class="level3" data-number="1.1">
<h3 data-number="1.1" class="anchored" data-anchor-id="세-계층의-최종-비교"><span class="header-section-number">1.1</span> 세 계층의 최종 비교</h3>
<table class="table">
<colgroup>
<col style="width: 16%">
<col style="width: 30%">
<col style="width: 25%">
<col style="width: 27%">
</colgroup>
<thead>
<tr class="header">
<th>측면</th>
<th>Conceptual</th>
<th>Logical</th>
<th>Physical</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>대상</strong></td>
<td>모든 이해관계자</td>
<td>개발팀, 아키텍트</td>
<td>개발팀, DevOps팀</td>
</tr>
<tr class="even">
<td><strong>추상화</strong></td>
<td>매우 높음</td>
<td>중간</td>
<td>낮음 (구체적)</td>
</tr>
<tr class="odd">
<td><strong>기술</strong></td>
<td>없음</td>
<td>독립적</td>
<td>명시적</td>
</tr>
<tr class="even">
<td><strong>예: 저장소</strong></td>
<td>“저장소”</td>
<td>“Relational DB + Cache Layer”</td>
<td>“PostgreSQL 14 + Redis 7”</td>
</tr>
<tr class="odd">
<td><strong>예: 통신</strong></td>
<td>“데이터 전달”</td>
<td>“REST API”</td>
<td>“FastAPI + gRPC”</td>
</tr>
<tr class="even">
<td><strong>초점</strong></td>
<td>무엇을</td>
<td>어떻게 (기술 중립)</td>
<td>무엇으로</td>
</tr>
<tr class="odd">
<td><strong>산출물</strong></td>
<td>개념도</td>
<td>모듈 명세서</td>
<td>배포 가이드</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="physical-architecture-설계-단계" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="physical-architecture-설계-단계"><span class="header-section-number">2</span> Physical Architecture 설계 단계</h2>
<section id="기술-스택-선택-전-고려사항" class="level3" data-number="2.1">
<h3 data-number="2.1" class="anchored" data-anchor-id="기술-스택-선택-전-고려사항"><span class="header-section-number">2.1</span> 기술 스택 선택 전 고려사항</h3>
<p>Physical 설계를 시작하기 전에 다음을 검토해야 한다:</p>
<ul>
<li><strong>조직의 기술 역량</strong>: 팀이 보유한 기술 경험과 학습 곡선</li>
<li><strong>프로젝트 특성</strong>: 시스템의 복잡도, 규모, 기간</li>
<li><strong>성능 요구사항</strong>: 응답시간, 처리량, 동시성 목표</li>
<li><strong>운영 환경</strong>: 온프레미스 vs 클라우드, 멀티클라우드 전략</li>
<li><strong>비용 제약</strong>: 초기 투자, 운영 비용</li>
<li><strong>지속 가능성</strong>: 커뮤니티 지원, 장기 유지보수성</li>
</ul>
</section>
<section id="기술-스택-선택-프레임워크" class="level3" data-number="2.2">
<h3 data-number="2.2" class="anchored" data-anchor-id="기술-스택-선택-프레임워크"><span class="header-section-number">2.2</span> 기술 스택 선택 프레임워크</h3>
<p>각 Logical 모듈에 대해 기술을 선택할 때는 다음 기준으로 평가한다:</p>
<p><strong>평가 기준:</strong></p>
<ol type="1">
<li><strong>기능성 (Functionality)</strong>: 요구사항을 충족하는가?</li>
<li><strong>성능 (Performance)</strong>: 성능 목표를 달성할 수 있는가?</li>
<li><strong>확장성 (Scalability)</strong>: 수평/수직 확장이 가능한가?</li>
<li><strong>운영성 (Operability)</strong>: 배포, 모니터링, 유지보수가 쉬운가?</li>
<li><strong>비용 (Cost)</strong>: 라이선스, 인프라, 인력 비용이 적절한가?</li>
<li><strong>에코시스템 (Ecosystem)</strong>: 라이브러리, 도구, 커뮤니티가 활발한가?</li>
<li><strong>보안 (Security)</strong>: 보안 기능과 업데이트 지원이 충분한가?</li>
<li><strong>학습곡선 (Learning Curve)</strong>: 팀이 얼마나 빨리 습득할 수 있는가?</li>
</ol>
<p><strong>선택 매트릭스 예시:</strong></p>
<table class="table">
<thead>
<tr class="header">
<th>기술</th>
<th>기능</th>
<th>성능</th>
<th>확장</th>
<th>운영</th>
<th>비용</th>
<th>에코</th>
<th>보안</th>
<th>학습</th>
<th>총점</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>PostgreSQL</td>
<td>9</td>
<td>8</td>
<td>8</td>
<td>9</td>
<td>10</td>
<td>10</td>
<td>9</td>
<td>8</td>
<td>8.6</td>
</tr>
<tr class="even">
<td>MongoDB</td>
<td>8</td>
<td>7</td>
<td>9</td>
<td>7</td>
<td>8</td>
<td>9</td>
<td>7</td>
<td>8</td>
<td>7.9</td>
</tr>
<tr class="odd">
<td>Elasticsearch</td>
<td>9</td>
<td>9</td>
<td>9</td>
<td>8</td>
<td>6</td>
<td>9</td>
<td>8</td>
<td>7</td>
<td>8.1</td>
</tr>
</tbody>
</table>
</section>
<section id="계층별-기술-선택" class="level3" data-number="2.3">
<h3 data-number="2.3" class="anchored" data-anchor-id="계층별-기술-선택"><span class="header-section-number">2.3</span> 계층별 기술 선택</h3>
<section id="프레젠테이션-계층-presentation-layer" class="level4" data-number="2.3.1">
<h4 data-number="2.3.1" class="anchored" data-anchor-id="프레젠테이션-계층-presentation-layer"><span class="header-section-number">2.3.1</span> 프레젠테이션 계층 (Presentation Layer)</h4>
<pre><code>Logical Module: ChatInterface, APIGateway, Dashboard

선택 가능 기술:
- Frontend: React, Vue, Angular, Svelte
- Backend Framework: FastAPI, Flask, Django (Python)
                     Spring Boot (Java)
                     Express, NestJS (Node.js)
- API Gateway: Kong, AWS API Gateway, Nginx
- WebSocket: Socket.io, WebSocket (native)</code></pre>
<p><strong>선택 예시: Python 기반 빠른 개발</strong></p>
<pre><code>Chat Interface: 
  - Frontend: React + TypeScript
  - Backend: FastAPI
  - WebSocket: WebSocket (native) or Socket.io
  
API Gateway:
  - Nginx (경량) or Kong (기능 풍부)

Dashboard:
  - Frontend: Streamlit (프로토타입) or React
  - Backend: FastAPI</code></pre>
<p><strong>선택 예시: Java 엔터프라이즈 환경</strong></p>
<pre><code>Chat Interface:
  - Frontend: React or Angular
  - Backend: Spring Boot
  - WebSocket: Spring WebSocket
  
API Gateway:
  - Spring Cloud Gateway or Kong
  
Dashboard:
  - Frontend: Angular
  - Backend: Spring Boot</code></pre>
</section>
<section id="애플리케이션-계층-application-layer" class="level4" data-number="2.3.2">
<h4 data-number="2.3.2" class="anchored" data-anchor-id="애플리케이션-계층-application-layer"><span class="header-section-number">2.3.2</span> 애플리케이션 계층 (Application Layer)</h4>
<pre><code>Logical Module: RequestHandler, Orchestration, QueryProcessor, ReasoningEngine

선택 가능 기술:
- 오케스트레이션: 커스텀 로직, Celery (Python), Akka (Java)
- 비동기 처리: AsyncIO (Python), CompletableFuture (Java)
- 워크플로우 엔진: Apache Airflow, Temporal, AWS Step Functions
- 메시지 큐: RabbitMQ, Apache Kafka, AWS SQS</code></pre>
<p><strong>선택 예시: Python + LangChain RAG</strong></p>
<pre><code>QueryProcessor:
  - LangChain (파이썬 라이브러리)
  - Custom Python 클래스
  
ReasoningEngine:
  - LangChain Agent
  - LLM 호출 (OpenAI API, Anthropic API)
  
Orchestration:
  - 커스텀 Python 로직 or Celery (분산 작업)</code></pre>
<p><strong>선택 예시: Java 엔터프라이즈 오케스트레이션</strong></p>
<pre><code>RequestHandler:
  - Spring Controller
  
Orchestration:
  - Spring Cloud Task
  - Temporal (복잡한 워크플로우)
  
MessagingQueue:
  - RabbitMQ or Apache Kafka</code></pre>
</section>
<section id="데이터-계층-data-layer" class="level4" data-number="2.3.3">
<h4 data-number="2.3.3" class="anchored" data-anchor-id="데이터-계층-data-layer"><span class="header-section-number">2.3.3</span> 데이터 계층 (Data Layer)</h4>
<pre><code>Logical Module: VectorStore, TextRepository, MetadataRepository, CacheLayer

선택 가능 기술:

벡터 저장소:
  - FAISS (로컬, 인메모리)
  - Chroma (오픈소스, 경량)
  - Weaviate (프로덕션용)
  - Milvus (고성능)
  - Pinecone (클라우드 SaaS)
  - Azure Cognitive Search (클라우드)

텍스트 저장소:
  - PostgreSQL + pgvector (벡터 지원)
  - Elasticsearch (검색 최적화)
  - MongoDB (유연한 스키마)
  - Azure Cosmos DB

메타데이터 저장소:
  - PostgreSQL
  - Redis (빠른 접근)
  - DynamoDB (AWS)

캐시 계층:
  - Redis
  - Memcached
  - Local In-Memory Cache</code></pre>
<p><strong>선택 예시: 빠른 프로토타입</strong></p>
<pre><code>Vector Store:
  - FAISS (로컬) or Chroma (간단한 배포)
  
Text Repository:
  - PostgreSQL with full-text search
  
Metadata Repository:
  - PostgreSQL의 같은 인스턴스
  
Cache Layer:
  - Redis (선택사항, 필요시)</code></pre>
<p><strong>선택 예시: 프로덕션 고성능 시스템</strong></p>
<pre><code>Vector Store:
  - Milvus (클러스터 구성)
  or Pinecone (완전 관리형)
  
Text Repository:
  - Elasticsearch (검색 성능)
  + PostgreSQL (트랜잭션)
  
Metadata Repository:
  - PostgreSQL
  
Cache Layer:
  - Redis Cluster (고가용성)</code></pre>
</section>
</section>
</section>
<section id="physical-architecture-다이어그램" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="physical-architecture-다이어그램"><span class="header-section-number">3</span> Physical Architecture 다이어그램</h2>
<section id="배포-아키텍처-다이어그램" class="level3" data-number="3.1">
<h3 data-number="3.1" class="anchored" data-anchor-id="배포-아키텍처-다이어그램"><span class="header-section-number">3.1</span> 배포 아키텍처 다이어그램</h3>
<pre><code>┌─────────────────────────────────────────────────────────────┐
│                         인터넷                               │
└────────────────┬────────────────────────────────────────────┘
                 │
        ┌────────▼────────┐
        │  Load Balancer  │ (Nginx / AWS ALB)
        │  (포트 443)     │
        └────────┬────────┘
                 │
        ┌────────▼────────────────────────┐
        │   Kubernetes Cluster            │
        │   (또는 EC2 / App Service)      │
        │                                 │
        │  ┌─────────────────────────┐   │
        │  │  Frontend Pods          │   │
        │  │  (React + Nginx)        │   │
        │  │  - 2 replicas           │   │
        │  └────────┬────────────────┘   │
        │           │                    │
        │  ┌────────▼────────────────┐   │
        │  │  API Service Pods       │   │
        │  │  (FastAPI)              │   │
        │  │  - 3 replicas           │   │
        │  └────────┬────────────────┘   │
        │           │                    │
        │  ┌────────▼────────────────┐   │
        │  │  Worker Pods            │   │
        │  │  (RAG Processing)       │   │
        │  │  - 2 replicas           │   │
        │  └────────┬────────────────┘   │
        │           │                    │
        └───────────┼────────────────────┘
                    │
        ┌───────────┴───────────┬──────────────┬─────────────┐
        │                       │              │             │
    ┌───▼──────┐       ┌───────▼─────┐  ┌───▼────┐  ┌──────▼─────┐
    │PostgreSQL│       │   Milvus    │  │ Redis  │  │ S3 Storage │
    │  + PgVec │       │  (Vector DB)│  │ Cache  │  │ (Raw Data) │
    └──────────┘       └─────────────┘  └────────┘  └────────────┘
        (Metadata)</code></pre>
</section>
<section id="컨테이너-구성-예시" class="level3" data-number="3.2">
<h3 data-number="3.2" class="anchored" data-anchor-id="컨테이너-구성-예시"><span class="header-section-number">3.2</span> 컨테이너 구성 예시</h3>
<pre><code>Docker Image 1: frontend
  - Base: node:18-alpine
  - Content: React App + Nginx
  - Size: ~150MB
  - Registry: ECR / Docker Hub

Docker Image 2: api-service
  - Base: python:3.11-slim
  - Content: FastAPI application
  - Dependencies: LangChain, openai, pydantic
  - Size: ~800MB
  - Registry: ECR / Docker Hub

Docker Image 3: worker
  - Base: python:3.11-slim
  - Content: RAG worker process
  - Dependencies: LangChain, Celery, milvus-sdk
  - Size: ~900MB
  - Registry: ECR / Docker Hub

Docker Image 4: vector-db
  - Base: milvusdb/milvus:latest
  - Content: Milvus vector database
  - Ports: 19530 (gRPC), 9091 (HTTP)
  - Volumes: /var/lib/milvus (persistent)

Docker Image 5: postgres
  - Base: postgres:15-alpine
  - Extensions: pgvector
  - Ports: 5432
  - Volumes: /var/lib/postgresql/data

Docker Image 6: redis
  - Base: redis:7-alpine
  - Ports: 6379
  - Volumes: /data (persistence)</code></pre>
</section>
<section id="네트워크-토폴로지" class="level3" data-number="3.3">
<h3 data-number="3.3" class="anchored" data-anchor-id="네트워크-토폴로지"><span class="header-section-number">3.3</span> 네트워크 토폴로지</h3>
<pre><code>외부 트래픽
    │
    ▼
┌─────────────────┐
│  CDN / CloudFront│ (정적 콘텐츠)
└────────┬────────┘
         │
         ▼
    ┌─────────────┐
    │Load Balancer│
    └─────┬───────┘
          │
     ┌────┴────────────────────┐
     │                         │
     ▼                         ▼
 ┌────────┐              ┌────────────┐
 │ Public │              │Private Network
 │Subnets │              │(DB, Cache) │
 │        │              │            │
 │Frontend│              │ PostgreSQL │
 │Pods    │◄────────────▶│ Milvus    │
 │        │              │ Redis     │
 └────────┘              └────────────┘
     │                         │
     │     External Storage   │
     │     (S3/Blob Storage)   │
     └─────────────┬───────────┘
                   │
               ┌───▼────┐
               │ Backup │
               └────────┘</code></pre>
</section>
<section id="프로젝트-예시" class="level3" data-number="3.4">
<h3 data-number="3.4" class="anchored" data-anchor-id="프로젝트-예시"><span class="header-section-number">3.4</span> 프로젝트 예시</h3>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="kk3225.netlify.app/docs/blog/posts/Engineering/System/Archi_Design/images/sw_physical_architecture.png" class="img-fluid figure-img"></p>
<figcaption>SW Architecture 예시</figcaption>
</figure>
</div>
</section>
</section>
<section id="배포-옵션-선택" class="level2" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="배포-옵션-선택"><span class="header-section-number">4</span> 배포 옵션 선택</h2>
<section id="옵션-1-로컬-개발-환경" class="level3" data-number="4.1">
<h3 data-number="4.1" class="anchored" data-anchor-id="옵션-1-로컬-개발-환경"><span class="header-section-number">4.1</span> 옵션 1: 로컬 개발 환경</h3>
<div class="sourceCode" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode numberSource yaml number-lines code-with-copy"><code class="sourceCode yaml"><span id="cb13-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># docker-compose.yml</span></span>
<span id="cb13-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">version</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'3.8'</span></span>
<span id="cb13-3"></span>
<span id="cb13-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">services</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb13-5"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">  </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">frontend</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb13-6"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">build</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> ./frontend</span></span>
<span id="cb13-7"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ports</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb13-8"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">-</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"3000:3000"</span></span>
<span id="cb13-9"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">environment</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb13-10"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">REACT_APP_API_URL</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> http://localhost:8000</span></span>
<span id="cb13-11"></span>
<span id="cb13-12"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">  </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">api</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb13-13"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">build</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> ./backend</span></span>
<span id="cb13-14"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ports</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb13-15"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">-</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"8000:8000"</span></span>
<span id="cb13-16"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">environment</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb13-17"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">DATABASE_URL</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> postgresql://user:password@postgres:5432/rag_db</span></span>
<span id="cb13-18"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">REDIS_URL</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> redis://redis:6379</span></span>
<span id="cb13-19"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">MILVUS_HOST</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> milvus</span></span>
<span id="cb13-20"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">OPENAI_API_KEY</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> ${OPENAI_API_KEY}</span></span>
<span id="cb13-21"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">depends_on</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb13-22"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">-</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> postgres</span></span>
<span id="cb13-23"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">-</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> redis</span></span>
<span id="cb13-24"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">-</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> milvus</span></span>
<span id="cb13-25"></span>
<span id="cb13-26"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">  </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">postgres</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb13-27"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">image</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> postgres:15-alpine</span></span>
<span id="cb13-28"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">environment</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb13-29"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">POSTGRES_PASSWORD</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> password</span></span>
<span id="cb13-30"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">POSTGRES_DB</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> rag_db</span></span>
<span id="cb13-31"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">volumes</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb13-32"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">-</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> postgres_data:/var/lib/postgresql/data</span></span>
<span id="cb13-33"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ports</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb13-34"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">-</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"5432:5432"</span></span>
<span id="cb13-35"></span>
<span id="cb13-36"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">  </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">redis</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb13-37"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">image</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> redis:7-alpine</span></span>
<span id="cb13-38"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ports</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb13-39"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">-</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"6379:6379"</span></span>
<span id="cb13-40"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">volumes</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb13-41"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">-</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> redis_data:/data</span></span>
<span id="cb13-42"></span>
<span id="cb13-43"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">  </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">milvus</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb13-44"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">image</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> milvusdb/milvus:latest</span></span>
<span id="cb13-45"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">environment</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb13-46"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">COMMON_STORAGETYPE</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> local</span></span>
<span id="cb13-47"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ports</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb13-48"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">-</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"19530:19530"</span></span>
<span id="cb13-49"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">-</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"9091:9091"</span></span>
<span id="cb13-50"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">volumes</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb13-51"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">-</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> milvus_data:/var/lib/milvus</span></span>
<span id="cb13-52"></span>
<span id="cb13-53"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">volumes</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb13-54"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">  </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">postgres_data</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb13-55"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">  </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">redis_data</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb13-56"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">  </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">milvus_data</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span></span></code></pre></div>
</section>
<section id="옵션-2-kubernetes-클러스터-프로덕션" class="level3" data-number="4.2">
<h3 data-number="4.2" class="anchored" data-anchor-id="옵션-2-kubernetes-클러스터-프로덕션"><span class="header-section-number">4.2</span> 옵션 2: Kubernetes 클러스터 (프로덕션)</h3>
<div class="sourceCode" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode numberSource yaml number-lines code-with-copy"><code class="sourceCode yaml"><span id="cb14-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># kubernetes deployment</span></span>
<span id="cb14-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">apiVersion</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> apps/v1</span></span>
<span id="cb14-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">kind</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> Deployment</span></span>
<span id="cb14-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">metadata</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb14-5"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">  </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">name</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> api-service</span></span>
<span id="cb14-6"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">  </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">namespace</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> rag-system</span></span>
<span id="cb14-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">spec</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb14-8"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">  </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">replicas</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span></span>
<span id="cb14-9"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">  </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">selector</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb14-10"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">matchLabels</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb14-11"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">app</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> api-service</span></span>
<span id="cb14-12"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">  </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">template</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb14-13"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">metadata</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb14-14"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labels</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb14-15"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">        </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">app</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> api-service</span></span>
<span id="cb14-16"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">spec</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb14-17"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">containers</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb14-18"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">-</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">name</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> api</span></span>
<span id="cb14-19"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">        </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">image</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> my-registry.azurecr.io/api-service:1.0.0</span></span>
<span id="cb14-20"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">        </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ports</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb14-21"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">        </span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">-</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">containerPort</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8000</span></span>
<span id="cb14-22"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">        </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">resources</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb14-23"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">          </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">requests</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb14-24"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">            </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">memory</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"512Mi"</span></span>
<span id="cb14-25"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">            </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cpu</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"500m"</span></span>
<span id="cb14-26"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">          </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">limits</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb14-27"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">            </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">memory</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"1Gi"</span></span>
<span id="cb14-28"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">            </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cpu</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"1000m"</span></span>
<span id="cb14-29"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">        </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">env</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb14-30"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">        </span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">-</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">name</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> DATABASE_URL</span></span>
<span id="cb14-31"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">          </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">valueFrom</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb14-32"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">            </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">secretKeyRef</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb14-33"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">              </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">name</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> db-credentials</span></span>
<span id="cb14-34"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">              </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">key</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> url</span></span>
<span id="cb14-35"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">        </span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">-</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">name</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> OPENAI_API_KEY</span></span>
<span id="cb14-36"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">          </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">valueFrom</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb14-37"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">            </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">secretKeyRef</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb14-38"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">              </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">name</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> openai-key</span></span>
<span id="cb14-39"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">              </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">key</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> key</span></span>
<span id="cb14-40"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">        </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">livenessProbe</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb14-41"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">          </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">httpGet</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb14-42"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">            </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">path</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> /health</span></span>
<span id="cb14-43"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">            </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">port</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8000</span></span>
<span id="cb14-44"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">          </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">initialDelaySeconds</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span></span>
<span id="cb14-45"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">          </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">periodSeconds</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span></span>
<span id="cb14-46"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">        </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">readinessProbe</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb14-47"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">          </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">httpGet</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb14-48"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">            </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">path</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> /ready</span></span>
<span id="cb14-49"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">            </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">port</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8000</span></span>
<span id="cb14-50"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">          </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">initialDelaySeconds</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span></span>
<span id="cb14-51"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">          </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">periodSeconds</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span></span>
<span id="cb14-52"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">affinity</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb14-53"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">        </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">podAntiAffinity</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb14-54"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">          </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">preferredDuringSchedulingIgnoredDuringExecution</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb14-55"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">          </span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">-</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">weight</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span></span>
<span id="cb14-56"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">            </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">podAffinityTerm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb14-57"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">              </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labelSelector</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb14-58"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">                </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">matchExpressions</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb14-59"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">                </span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">-</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">key</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> app</span></span>
<span id="cb14-60"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">                  </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">operator</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> In</span></span>
<span id="cb14-61"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">                  </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">values</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb14-62"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">                  </span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">-</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> api-service</span></span>
<span id="cb14-63"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">              </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">topologyKey</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> kubernetes.io/hostname</span></span>
<span id="cb14-64"></span>
<span id="cb14-65"><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">---</span></span>
<span id="cb14-66"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">apiVersion</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> v1</span></span>
<span id="cb14-67"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">kind</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> Service</span></span>
<span id="cb14-68"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">metadata</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb14-69"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">  </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">name</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> api-service</span></span>
<span id="cb14-70"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">  </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">namespace</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> rag-system</span></span>
<span id="cb14-71"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">spec</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb14-72"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">  </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">type</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> LoadBalancer</span></span>
<span id="cb14-73"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">  </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">selector</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb14-74"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">app</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> api-service</span></span>
<span id="cb14-75"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">  </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ports</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb14-76"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">  </span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">-</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">protocol</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> TCP</span></span>
<span id="cb14-77"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">port</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">80</span></span>
<span id="cb14-78"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">targetPort</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8000</span></span></code></pre></div>
</section>
<section id="옵션-3-클라우드-관리형-서비스" class="level3" data-number="4.3">
<h3 data-number="4.3" class="anchored" data-anchor-id="옵션-3-클라우드-관리형-서비스"><span class="header-section-number">4.3</span> 옵션 3: 클라우드 관리형 서비스</h3>
<p><strong>AWS 기반:</strong></p>
<pre><code>- Frontend: CloudFront + S3 + Lambda@Edge
- API: ECS/Fargate with Application Load Balancer
- Vector DB: Pinecone (관리형) 또는 SageMaker Vector Store
- Text DB: RDS PostgreSQL
- Cache: ElastiCache Redis
- Monitoring: CloudWatch + X-Ray
- Storage: S3</code></pre>
<p><strong>Azure 기반:</strong></p>
<pre><code>- Frontend: Azure Static Web Apps
- API: App Service 또는 Container Instances
- Vector DB: Azure Cognitive Search
- Text DB: Azure Database for PostgreSQL
- Cache: Azure Cache for Redis
- Monitoring: Application Insights
- Storage: Blob Storage</code></pre>
<p><strong>GCP 기반:</strong></p>
<pre><code>- Frontend: Cloud Storage + CDN
- API: Cloud Run 또는 App Engine
- Vector DB: Vertex AI Vector Search
- Text DB: Cloud SQL (PostgreSQL)
- Cache: Memorystore (Redis)
- Monitoring: Cloud Logging + Cloud Trace
- Storage: Cloud Storage</code></pre>
</section>
</section>
<section id="physical-architecture-명세서" class="level2" data-number="5">
<h2 data-number="5" class="anchored" data-anchor-id="physical-architecture-명세서"><span class="header-section-number">5</span> Physical Architecture 명세서</h2>
<section id="서버-요구사항" class="level3" data-number="5.1">
<h3 data-number="5.1" class="anchored" data-anchor-id="서버-요구사항"><span class="header-section-number">5.1</span> 서버 요구사항</h3>
<pre><code>API Service Pod:
  CPU: 1000m (1 vCPU)
  Memory: 1Gi
  Disk: 20Gi (ephemeral)
  Network: 1 Gbps
  
Worker Pod:
  CPU: 2000m (2 vCPU)
  Memory: 2Gi
  Disk: 50Gi (ephemeral)
  Network: 1 Gbps

PostgreSQL:
  CPU: 2000m (2 vCPU)
  Memory: 4Gi
  Disk: 500Gi (persistent, SSD)
  Network: 1 Gbps
  High Availability: 2 replicas + 1 standby

Milvus Vector DB:
  CPU: 4000m (4 vCPU)
  Memory: 8Gi
  Disk: 1Ti (persistent, SSD)
  Network: 10 Gbps (권장)
  Replication: 3

Redis Cache:
  CPU: 1000m (1 vCPU)
  Memory: 8Gi
  Disk: 100Gi (persistent)
  Network: 1 Gbps
  Cluster: 3 nodes</code></pre>
</section>
<section id="네트워크-구성" class="level3" data-number="5.2">
<h3 data-number="5.2" class="anchored" data-anchor-id="네트워크-구성"><span class="header-section-number">5.2</span> 네트워크 구성</h3>
<pre><code>방화벽 규칙:

Ingress:
  - 443 (HTTPS): 외부 → Load Balancer (모든 트래픽)
  - 80 (HTTP): 외부 → Load Balancer (HTTPS 리다이렉트)

Internal (VPC/VNet 내부):
  - 8000: API Service pods
  - 5432: PostgreSQL
  - 19530: Milvus gRPC
  - 9091: Milvus HTTP
  - 6379: Redis
  - 9090: Prometheus (모니터링)

Egress:
  - 443: OpenAI API (외부 인터넷)
  - 25, 587: Email 서비스 (알림용)</code></pre>
</section>
<section id="보안-구성" class="level3" data-number="5.3">
<h3 data-number="5.3" class="anchored" data-anchor-id="보안-구성"><span class="header-section-number">5.3</span> 보안 구성</h3>
<pre><code>SSL/TLS:
  - 인증서: Let's Encrypt (자동 갱신)
  - TLS 버전: 1.2 이상
  - 암호화 알고리즘: TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384
  
데이터 암호화:
  - 전송 중: TLS 1.2+
  - 저장: Database encryption (모든 DB)
  - API Keys: AWS Secrets Manager / Azure Key Vault

접근 제어:
  - 인증: OAuth 2.0 / JWT
  - 인가: RBAC (Role-Based Access Control)
  - 감사: 모든 API 호출 로깅
  
DDoS 방어:
  - AWS Shield / Azure DDoS Protection
  - Rate limiting: 100 req/sec per IP</code></pre>
</section>
<section id="모니터링-및-로깅" class="level3" data-number="5.4">
<h3 data-number="5.4" class="anchored" data-anchor-id="모니터링-및-로깅"><span class="header-section-number">5.4</span> 모니터링 및 로깅</h3>
<pre><code>메트릭 수집:
  - 도구: Prometheus + Grafana
  - 수집 대상:
    - API 응답시간 (p50, p95, p99)
    - 데이터베이스 쿼리 시간
    - 벡터 검색 지연시간
    - 캐시 히트율
    - CPU, 메모리, 디스크 사용률
    - 네트워크 대역폭

로그 수집:
  - 도구: ELK Stack (Elasticsearch + Logstash + Kibana) 또는 Azure Monitor
  - 수집 대상:
    - 애플리케이션 로그 (DEBUG, INFO, WARNING, ERROR)
    - 접근 로그 (HTTP 요청)
    - 데이터베이스 쿼리 로그
    - 에러 추적 (Sentry)

알림:
  - 임계값 초과 시 Slack/Email 알림
  - 에러율 &gt; 1% → 즉시 알림
  - 응답시간 p95 &gt; 2초 → 경고
  - 디스크 사용량 &gt; 80% → 경고</code></pre>
</section>
<section id="재해-복구-dr-계획" class="level3" data-number="5.5">
<h3 data-number="5.5" class="anchored" data-anchor-id="재해-복구-dr-계획"><span class="header-section-number">5.5</span> 재해 복구 (DR) 계획</h3>
<pre><code>Backup 전략:
  - 데이터베이스: 1시간마다 스냅샷
  - 벡터 DB: 4시간마다 스냅샷
  - 백업 저장소: 다른 리전 (지역 중복)
  - 보관 기간: 30일

복구 목표 (RTO/RPO):
  - RTO (복구시간): 1시간
  - RPO (데이터손실범위): 1시간

페일오버:
  - Active-Standby 구성 (자동 페일오버)
  - Health check: 30초마다
  - 페일오버 시간: &lt; 2분

테스트:
  - 월 1회 DR 드릴 실시
  - 복구 절차 문서화 및 검증</code></pre>
</section>
</section>
<section id="physical-architecture-체크리스트" class="level2" data-number="6">
<h2 data-number="6" class="anchored" data-anchor-id="physical-architecture-체크리스트"><span class="header-section-number">6</span> Physical Architecture 체크리스트</h2>
<section id="기술-스택" class="level3" data-number="6.1">
<h3 data-number="6.1" class="anchored" data-anchor-id="기술-스택"><span class="header-section-number">6.1</span> 기술 스택</h3>
<ul class="task-list">
<li><label><input type="checkbox">모든 Logical 모듈에 구체적인 기술이 할당되었는가?</label></li>
<li><label><input type="checkbox">기술 선택이 성능 요구사항을 만족하는가?</label></li>
<li><label><input type="checkbox">기술 선택이 확장성 요구사항을 만족하는가?</label></li>
<li><label><input type="checkbox">팀이 선택한 기술을 지원할 역량이 있는가?</label></li>
<li><label><input type="checkbox">기술 간 호환성이 검증되었는가?</label></li>
</ul>
</section>
<section id="인프라-설계" class="level3" data-number="6.2">
<h3 data-number="6.2" class="anchored" data-anchor-id="인프라-설계"><span class="header-section-number">6.2</span> 인프라 설계</h3>
<ul class="task-list">
<li><label><input type="checkbox">배포 환경이 명확하게 정의되었는가? (K8s, 클라우드, 온프레미스)</label></li>
<li><label><input type="checkbox">리소스 요구사항이 정량화되었는가? (CPU, 메모리, 디스크)</label></li>
<li><label><input type="checkbox">스케일링 전략이 정의되었는가? (수평/수직)</label></li>
<li><label><input type="checkbox">네트워크 토폴로지가 설계되었는가?</label></li>
<li><label><input type="checkbox">방화벽 규칙이 정의되었는가?</label></li>
</ul>
</section>
<section id="배포-및-운영" class="level3" data-number="6.3">
<h3 data-number="6.3" class="anchored" data-anchor-id="배포-및-운영"><span class="header-section-number">6.3</span> 배포 및 운영</h3>
<ul class="task-list">
<li><label><input type="checkbox">CI/CD 파이프라인이 정의되었는가?</label></li>
<li><label><input type="checkbox">컨테이너/이미지 전략이 정의되었는가?</label></li>
<li><label><input type="checkbox">버전 관리 전략이 있는가?</label></li>
<li><label><input type="checkbox">배포 절차가 문서화되었는가?</label></li>
<li><label><input type="checkbox">롤백 절차가 준비되었는가?</label></li>
</ul>
</section>
<section id="모니터링-및-로깅-1" class="level3" data-number="6.4">
<h3 data-number="6.4" class="anchored" data-anchor-id="모니터링-및-로깅-1"><span class="header-section-number">6.4</span> 모니터링 및 로깅</h3>
<ul class="task-list">
<li><label><input type="checkbox">모니터링 대상 메트릭이 정의되었는가?</label></li>
<li><label><input type="checkbox">로깅 전략이 정의되었는가? (레벨, 보관, 검색)</label></li>
<li><label><input type="checkbox">알림 규칙이 설정되었는가?</label></li>
<li><label><input type="checkbox">대시보드가 준비되었는가?</label></li>
<li><label><input type="checkbox">로그 보관 기간이 정해졌는가?</label></li>
</ul>
</section>
<section id="보안" class="level3" data-number="6.5">
<h3 data-number="6.5" class="anchored" data-anchor-id="보안"><span class="header-section-number">6.5</span> 보안</h3>
<ul class="task-list">
<li><label><input type="checkbox">SSL/TLS 인증서 전략이 있는가?</label></li>
<li><label><input type="checkbox">데이터 암호화 전략이 정의되었는가?</label></li>
<li><label><input type="checkbox">접근 제어 메커니즘이 설계되었는가?</label></li>
<li><label><input type="checkbox">감사 로깅이 활성화되었는가?</label></li>
<li><label><input type="checkbox">보안 검토가 수행되었는가?</label></li>
</ul>
</section>
<section id="재해-복구" class="level3" data-number="6.6">
<h3 data-number="6.6" class="anchored" data-anchor-id="재해-복구"><span class="header-section-number">6.6</span> 재해 복구</h3>
<ul class="task-list">
<li><label><input type="checkbox">Backup 전략이 수립되었는가?</label></li>
<li><label><input type="checkbox">RTO/RPO가 정의되었는가?</label></li>
<li><label><input type="checkbox">페일오버 절차가 준비되었는가?</label></li>
<li><label><input type="checkbox">DR 테스트 계획이 있는가?</label></li>
<li><label><input type="checkbox">복구 절차가 문서화되었는가?</label></li>
</ul>
</section>
<section id="비용-최적화" class="level3" data-number="6.7">
<h3 data-number="6.7" class="anchored" data-anchor-id="비용-최적화"><span class="header-section-number">6.7</span> 비용 최적화</h3>
<ul class="task-list">
<li><label><input type="checkbox">리소스 요청/제한이 최적화되었는가?</label></li>
<li><label><input type="checkbox">자동 스케일링이 설정되었는가?</label></li>
<li><label><input type="checkbox">예상 월 비용이 계산되었는가?</label></li>
<li><label><input type="checkbox">비용 절감 기회가 검토되었는가?</label></li>
</ul>
</section>
</section>
<section id="실제-예시-rag-시스템-physical-architecture" class="level2" data-number="7">
<h2 data-number="7" class="anchored" data-anchor-id="실제-예시-rag-시스템-physical-architecture"><span class="header-section-number">7</span> 실제 예시: RAG 시스템 Physical Architecture</h2>
<section id="프로토타입-로컬-개발" class="level3" data-number="7.1">
<h3 data-number="7.1" class="anchored" data-anchor-id="프로토타입-로컬-개발"><span class="header-section-number">7.1</span> 프로토타입 (로컬 개발)</h3>
<pre><code>기술 스택:
  - Frontend: React 18 + TypeScript
  - Backend: FastAPI (Python 3.11)
  - Vector DB: Chroma (로컬, 인메모리)
  - Text DB: SQLite (프로토타입)
  - Cache: Python 딕셔너리 (인메모리)
  
배포: docker-compose (로컬)
  - 3개 컨테이너 (Frontend, API, Vector DB)
  - 통신: localhost:8000
  
리소스:
  - CPU: 4 cores
  - RAM: 8GB
  - Storage: 50GB
  
성능 목표:
  - 응답시간: &lt; 500ms
  - 동시 사용자: 1-5명</code></pre>
</section>
<section id="mvp-초기-프로덕션" class="level3" data-number="7.2">
<h3 data-number="7.2" class="anchored" data-anchor-id="mvp-초기-프로덕션"><span class="header-section-number">7.2</span> MVP (초기 프로덕션)</h3>
<pre><code>기술 스택:
  - Frontend: React 18 + Vercel 배포
  - Backend: FastAPI (Python 3.11) on AWS ECS
  - Vector DB: Chroma (Persistent)
  - Text DB: RDS PostgreSQL (db.t3.micro)
  - Cache: ElastiCache Redis (cache.t3.micro)
  
배포: AWS
  - ECS Fargate (1 vCPU, 2GB RAM, 2 tasks)
  - Application Load Balancer
  - RDS Single-AZ
  
리소스 (월 비용 예상):
  - Frontend 호스팅: $0 (Vercel Free)
  - ECS Fargate: $50 (compute)
  - RDS PostgreSQL: $20 (db.t3.micro)
  - ElastiCache Redis: $15 (cache.t3.micro)
  - Data Transfer: $10
  - 총 약 $95/월
  
성능 목표:
  - 응답시간: &lt; 1초 (p95)
  - 동시 사용자: 10-50명
  - 처리량: 100 req/sec</code></pre>
</section>
<section id="엔터프라이즈-프로덕션" class="level3" data-number="7.3">
<h3 data-number="7.3" class="anchored" data-anchor-id="엔터프라이즈-프로덕션"><span class="header-section-number">7.3</span> 엔터프라이즈 프로덕션</h3>
<pre><code>기술 스택:
  - Frontend: React 18 + Azure Static Web Apps
  - Backend: Spring Boot on Azure Container Instances
  - Vector DB: Milvus (3-node cluster)
  - Text DB: Azure Database for PostgreSQL (Flexible Server)
  - Cache: Azure Cache for Redis (Standard C1)
  - Orchestration: Azure Container Registry + GitHub Actions
  
배포: Azure Kubernetes Service (AKS)
  - 3 node cluster (VM 크기: Standard_D4s_v3)
  - API replicas: 3 (1 vCPU, 2GB each)
  - Worker replicas: 2 (2 vCPU, 4GB each)
  - Ingress: Application Gateway
  
리소스 (월 비용 예상):
  - AKS cluster: $200 (노드)
  - Managed disks: $100
  - PostgreSQL: $150 (Flexible Server)
  - Redis: $100 (Standard)
  - Milvus: $300 (managed)
  - Monitoring/Logging: $50
  - 총 약 $900/월
  
성능 목표:
  - 응답시간: &lt; 200ms (p95)
  - 동시 사용자: 1000+명
  - 처리량: 1000 req/sec
  - 가용성: 99.9%
  - RTO: 1 hour
  - RPO: 1 hour</code></pre>
</section>
</section>
<section id="physical-배포-체크리스트" class="level2" data-number="8">
<h2 data-number="8" class="anchored" data-anchor-id="physical-배포-체크리스트"><span class="header-section-number">8</span> Physical 배포 체크리스트</h2>
<p>배포 전 최종 확인:</p>
<section id="프리플라이트-체크" class="level3" data-number="8.1">
<h3 data-number="8.1" class="anchored" data-anchor-id="프리플라이트-체크"><span class="header-section-number">8.1</span> 프리플라이트 체크</h3>
<ul class="task-list">
<li><label><input type="checkbox">모든 환경 변수가 설정되었는가?</label></li>
<li><label><input type="checkbox">데이터베이스 마이그레이션이 적용되었는가?</label></li>
<li><label><input type="checkbox">SSL 인증서가 유효한가?</label></li>
<li><label><input type="checkbox">방화벽 규칙이 적용되었는가?</label></li>
<li><label><input type="checkbox">백업이 활성화되었는가?</label></li>
</ul>
</section>
<section id="배포-검증" class="level3" data-number="8.2">
<h3 data-number="8.2" class="anchored" data-anchor-id="배포-검증"><span class="header-section-number">8.2</span> 배포 검증</h3>
<ul class="task-list">
<li><label><input type="checkbox">Health check 엔드포인트가 정상 응답하는가?</label></li>
<li><label><input type="checkbox">데이터베이스 연결이 정상인가?</label></li>
<li><label><input type="checkbox">외부 API (OpenAI 등)가 접근 가능한가?</label></li>
<li><label><input type="checkbox">모니터링 에이전트가 정상 작동하는가?</label></li>
</ul>
</section>
<section id="운영-준비" class="level3" data-number="8.3">
<h3 data-number="8.3" class="anchored" data-anchor-id="운영-준비"><span class="header-section-number">8.3</span> 운영 준비</h3>
<ul class="task-list">
<li><label><input type="checkbox">모니터링 대시보드가 준비되었는가?</label></li>
<li><label><input type="checkbox">알림 채널이 정상 작동하는가?</label></li>
<li><label><input type="checkbox">문서가 최신화되었는가?</label></li>
<li><label><input type="checkbox">온콜(On-call) 로테이션이 설정되었는가?</label></li>
<li><label><input type="checkbox">Runbook이 준비되었는가?</label></li>
</ul>
</section>
</section>
<section id="정리" class="level2" data-number="9">
<h2 data-number="9" class="anchored" data-anchor-id="정리"><span class="header-section-number">9</span> 정리</h2>
<p>Physical Architecture는:</p>
<ol type="1">
<li><strong>기술 구체화</strong>: Logical을 실제 구현 가능한 형태로 변환</li>
<li><strong>배포 가능</strong>: 개발팀이 직접 배포하고 운영 가능</li>
<li><strong>비용 최적화</strong>: 리소스와 비용을 명확하게 정량화</li>
<li><strong>운영성</strong>: 모니터링, 로깅, 확장 전략 포함</li>
<li><strong>문서화</strong>: 개발팀이 따를 수 있는 명확한 가이드</li>
</ol>
<p>Conceptual → Logical → Physical 세 계층을 거쳐 설계하면, 최상위 비즈니스 요구사항부터 최하위 구현 세부사항까지 일관되고 체계적인 아키텍처를 구축할 수 있다.</p>


</section>

 ]]></description>
  <category>Engineering</category>
  <category>Architecture</category>
  <guid>kk3225.netlify.app/docs/blog/posts/Engineering/System/Archi_Design/physical_design.html</guid>
  <pubDate>Sun, 16 Nov 2025 15:00:00 GMT</pubDate>
</item>
<item>
  <title>Logical Architecture 설계하는 방법</title>
  <dc:creator>Kwangmin Kim</dc:creator>
  <link>kk3225.netlify.app/docs/blog/posts/Engineering/System/Archi_Design/logical_design.html</link>
  <description><![CDATA[ 





<section id="logical-architecture의-정의" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="logical-architecture의-정의"><span class="header-section-number">1</span> Logical Architecture의 정의</h2>
<p>Logical Architecture는 Conceptual Architecture를 <strong>구체화한 설계 계층</strong>으로, 여전히 <strong>기술 스택 독립적</strong>이지만 구현 수준의 세부사항을 포함한다.</p>
<p><strong>핵심 특징:</strong></p>
<ul>
<li><strong>기술 중립적</strong>: 특정 도구나 프로그래밍 언어를 명시하지 않음</li>
<li><strong>구현 지향적</strong>: 실제 개발에 필요한 모듈, 인터페이스, 데이터 구조 정의</li>
<li><strong>상세한 데이터 흐름</strong>: 각 단계에서의 입출력 데이터 명시</li>
<li><strong>모듈 간 계약</strong>: API 계약, 데이터 형식, 상태 관리 정의</li>
<li><strong>확장성과 유지보수성</strong>: 향후 기술 변경 시 영향을 최소화</li>
</ul>
<section id="conceptual-vs-logical-vs-physical-비교" class="level3" data-number="1.1">
<h3 data-number="1.1" class="anchored" data-anchor-id="conceptual-vs-logical-vs-physical-비교"><span class="header-section-number">1.1</span> Conceptual vs Logical vs Physical 비교</h3>
<table class="table">
<colgroup>
<col style="width: 16%">
<col style="width: 30%">
<col style="width: 25%">
<col style="width: 27%">
</colgroup>
<thead>
<tr class="header">
<th>측면</th>
<th>Conceptual</th>
<th>Logical</th>
<th>Physical</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>추상화 수준</strong></td>
<td>매우 높음</td>
<td>중간</td>
<td>낮음</td>
</tr>
<tr class="even">
<td><strong>기술 명시</strong></td>
<td>없음</td>
<td>없음 (독립적)</td>
<td>구체적</td>
</tr>
<tr class="odd">
<td><strong>대상 청중</strong></td>
<td>모든 이해관계자</td>
<td>개발팀, 아키텍트</td>
<td>개발팀</td>
</tr>
<tr class="even">
<td><strong>초점</strong></td>
<td>“무엇을”</td>
<td>“어떻게” (기술 중립)</td>
<td>“무엇으로”</td>
</tr>
<tr class="odd">
<td><strong>예시: 데이터 저장</strong></td>
<td>“저장소”</td>
<td>“Relational DB + Cache Layer”</td>
<td>“PostgreSQL + Redis”</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="logical-architecture-설계-단계" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="logical-architecture-설계-단계"><span class="header-section-number">2</span> Logical Architecture 설계 단계</h2>
<section id="conceptual-architecture-재검토" class="level3" data-number="2.1">
<h3 data-number="2.1" class="anchored" data-anchor-id="conceptual-architecture-재검토"><span class="header-section-number">2.1</span> Conceptual Architecture 재검토</h3>
<p>Logical 설계를 시작하기 전에:</p>
<ul>
<li><strong>각 컴포넌트의 책임</strong> 명확화</li>
<li><strong>데이터 입출력</strong> 재확인</li>
<li><strong>성능 요구사항</strong> 파악 (처리량, 지연시간)</li>
<li><strong>확장성 요구사항</strong> 정의 (수평/수직 확장 가능성)</li>
</ul>
</section>
<section id="모듈-분해-module-decomposition" class="level3" data-number="2.2">
<h3 data-number="2.2" class="anchored" data-anchor-id="모듈-분해-module-decomposition"><span class="header-section-number">2.2</span> 모듈 분해 (Module Decomposition)</h3>
<p>각 Conceptual 컴포넌트를 <strong>논리적 모듈</strong>로 세분화한다.</p>
<p><strong>원칙:</strong></p>
<ul>
<li><strong>단일 책임</strong>: 각 모듈은 하나의 명확한 역할</li>
<li><strong>높은 응집도</strong>: 관련 기능을 한 모듈에 그룹화</li>
<li><strong>낮은 결합도</strong>: 모듈 간 의존성 최소화</li>
</ul>
<p><strong>예시: 데이터 Ingestion 컴포넌트 분해</strong></p>
<pre><code>Conceptual: "Data Ingestion"
     ↓
Logical Modules:
  ├── Source Connector (다양한 소스 연결)
  ├── Data Validator (데이터 검증)
  ├── Data Transformer (형식 변환)
  └── Error Handler (오류 처리 및 재시도)</code></pre>
</section>
<section id="데이터-구조-정의" class="level3" data-number="2.3">
<h3 data-number="2.3" class="anchored" data-anchor-id="데이터-구조-정의"><span class="header-section-number">2.3</span> 데이터 구조 정의</h3>
<p>각 모듈 간에 주고받는 <strong>데이터 형식</strong>을 정의한다.</p>
<p><strong>정의 내용:</strong></p>
<ul>
<li><strong>데이터 엔티티</strong>: 주요 데이터 객체의 구조</li>
<li><strong>메타데이터</strong>: 데이터 출처, 생성 시간, 버전 등</li>
<li><strong>상태 정보</strong>: 처리 상태, 에러 정보</li>
</ul>
<p><strong>예시 데이터 구조:</strong></p>
<pre><code>Raw Data Input:
{
  source_id: string,
  content: bytes,
  mime_type: string,
  timestamp: datetime,
  metadata: object
}

Validated Data:
{
  validated_content: string,
  validation_status: "SUCCESS" | "WARNING" | "FAILED",
  issues: list[ValidationIssue],
  processed_timestamp: datetime
}

Transformed Data:
{
  standardized_format: object,
  schema_version: string,
  transformation_rules: list[string],
  data_quality_score: float
}</code></pre>
</section>
<section id="모듈-간-인터페이스-정의" class="level3" data-number="2.4">
<h3 data-number="2.4" class="anchored" data-anchor-id="모듈-간-인터페이스-정의"><span class="header-section-number">2.4</span> 모듈 간 인터페이스 정의</h3>
<p><strong>API 계약</strong> 정의: 각 모듈이 받고 내보내는 데이터와 동작</p>
<pre><code>Module: SourceConnector
Input: ConnectionConfig
Output: RawDataStream
Operations:
  - connect(config) -&gt; Connection
  - fetch(query) -&gt; RawData[]
  - disconnect() -&gt; void
  - on_error(handler) -&gt; void

Module: DataValidator
Input: RawData
Output: ValidationResult
Operations:
  - validate(raw_data) -&gt; ValidationResult
  - get_schema() -&gt; DataSchema
  - register_validator(validator_func) -&gt; void</code></pre>
</section>
<section id="상태-관리-및-흐름-제어" class="level3" data-number="2.5">
<h3 data-number="2.5" class="anchored" data-anchor-id="상태-관리-및-흐름-제어"><span class="header-section-number">2.5</span> 상태 관리 및 흐름 제어</h3>
<p>각 단계에서의 <strong>상태 전이</strong>를 정의한다.</p>
<pre><code>Processing Pipeline States:

INITIATED → INGESTING → VALIDATING → TRANSFORMING → STORING → COMPLETED
              ↓            ↓            ↓             ↓
            FAILED (any stage)
              ↓
            ERROR_HANDLING
              ↓
            RETRY or ABANDONED</code></pre>
</section>
</section>
<section id="logical-architecture-표현-방법" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="logical-architecture-표현-방법"><span class="header-section-number">3</span> Logical Architecture 표현 방법</h2>
<section id="계층-아키텍처-다이어그램" class="level3" data-number="3.1">
<h3 data-number="3.1" class="anchored" data-anchor-id="계층-아키텍처-다이어그램"><span class="header-section-number">3.1</span> 계층 아키텍처 다이어그램</h3>
<pre><code>┌─────────────────────────────────────────────────────────────┐
│                      Presentation Layer                     │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐      │
│  │Chat Interface│  │    API       │  │  Dashboard   │      │
│  └──────┬───────┘  └──────┬───────┘  └──────┬───────┘      │
└─────────┼─────────────────┼─────────────────┼──────────────┘
          │                 │                 │
┌─────────┴─────────────────┴─────────────────┴──────────────┐
│                    Application Layer                       │
│  ┌──────────────────────────────────────────────────────┐  │
│  │         Request Handler / Orchestration Layer        │  │
│  └────────┬────────────────────────────────────────┬────┘  │
└───────────┼────────────────────────────────────────┼────────┘
            │                                        │
┌───────────┴────────────────────────────────────────┴────────┐
│                   Business Logic Layer                      │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐     │
│  │Query Engine  │  │Retrieval Mgr │  │Response Gen  │     │
│  └──────┬───────┘  └──────┬───────┘  └──────┬───────┘     │
└─────────┼─────────────────┼─────────────────┼──────────────┘
          │                 │                 │
┌─────────┴─────────────────┴─────────────────┴──────────────┐
│                   Data Layer                               │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐     │
│  │Vector Store  │  │Data Cache    │  │Metadata DB   │     │
│  │Repository    │  │Layer         │  │Repository    │     │
│  └──────────────┘  └──────────────┘  └──────────────┘     │
└─────────────────────────────────────────────────────────────┘</code></pre>
</section>
<section id="모듈-상호작용-다이어그램" class="level3" data-number="3.2">
<h3 data-number="3.2" class="anchored" data-anchor-id="모듈-상호작용-다이어그램"><span class="header-section-number">3.2</span> 모듈 상호작용 다이어그램</h3>
<pre><code>┌─────────────────────────────────────────────────────────────┐
│              Logical Module Interaction                      │
└─────────────────────────────────────────────────────────────┘

User Query
    │
    ▼
┌──────────────────────┐
│ Request Dispatcher   │ ◄── Routes request to appropriate handler
└──────────┬───────────┘
           │
    ┌──────┴──────┐
    │             │
    ▼             ▼
┌─────────────┐ ┌─────────────────────┐
│Query Parser │ │Intent Classifier    │
└──────┬──────┘ └──────────┬──────────┘
       │                   │
       └───────┬───────────┘
               ▼
        ┌──────────────┐
        │Query Encoder │ ◄── Convert to vector representation
        └──────┬───────┘
               │
               ▼
        ┌──────────────────────┐
        │Vector Search Engine  │ ◄── Query against vector store
        └──────┬───────────────┘
               │
        ┌──────┴──────────────────┐
        │                         │
        ▼                         ▼
    ┌─────────────┐        ┌──────────────┐
    │Vector Store │        │Metadata Repo │ ◄── Fetch context
    └─────────────┘        └──────────────┘
        │                         │
        └──────┬──────────────────┘
               ▼
        ┌──────────────────────┐
        │Context Aggregator    │ ◄── Combine retrieved info
        └──────┬───────────────┘
               │
               ▼
        ┌──────────────────────┐
        │Reasoning Engine      │ ◄── Apply business logic
        └──────┬───────────────┘
               │
               ▼
        ┌──────────────────────┐
        │Response Composer     │ ◄── Format response
        └──────┬───────────────┘
               │
               ▼
        ┌──────────────────────┐
        │Output Formatter      │ ◄── Prepare for delivery
        └──────┬───────────────┘
               │
               ▼
            Response</code></pre>
</section>
<section id="데이터-흐름-및-상태-다이어그램" class="level3" data-number="3.3">
<h3 data-number="3.3" class="anchored" data-anchor-id="데이터-흐름-및-상태-다이어그램"><span class="header-section-number">3.3</span> 데이터 흐름 및 상태 다이어그램</h3>
<pre><code>Data Processing Pipeline - Logical View

Source Data
    │
    ▼
┌──────────────────────────────────┐
│ Source Connector                 │
│ (Read from various sources)      │
│ Status: CONNECTING → READING     │
└──────────┬───────────────────────┘
           │ RawDataStream
           ▼
┌──────────────────────────────────┐
│ Data Validator                   │
│ (Schema check, completeness)     │
│ Status: VALIDATING               │
└──────────┬───────────────────────┘
           │
      ┌────┴────┐
      │          │
      ▼ PASS     ▼ FAIL
   ┌────┐    ┌──────────────┐
   │    │    │Error Handler │
   │    │    └──────────────┘
   │    │
   ▼    │ (retry or skip)
┌──────────────────────────────────┐
│ Data Transformer                 │
│ (Normalize, enrich, clean)       │
│ Status: TRANSFORMING             │
└──────────┬───────────────────────┘
           │ TransformedData
           ▼
┌──────────────────────────────────┐
│ Embedding Generator              │
│ (Create vector representations)  │
│ Status: EMBEDDING                │
└──────────┬───────────────────────┘
           │ (Data + Embeddings)
           ▼
┌──────────────────────────────────┐
│ Storage Coordinator              │
│ (Write to appropriate stores)    │
│ Status: STORING                  │
└──────────┬───────────────────────┘
           │
        ┌──┴──┬────────┐
        ▼     ▼        ▼
   ┌─────┐ ┌────┐ ┌────────┐
   │Vector│ │Text│ │Metadata│
   │Store │ │ DB │ │  DB    │
   └─────┘ └────┘ └────────┘

Status: COMPLETED</code></pre>
</section>
<section id="시퀀스-다이어그램-특정-시나리오" class="level3" data-number="3.4">
<h3 data-number="3.4" class="anchored" data-anchor-id="시퀀스-다이어그램-특정-시나리오"><span class="header-section-number">3.4</span> 시퀀스 다이어그램 (특정 시나리오)</h3>
<pre><code>User        Request      Query        Vector      Storage
            Dispatcher   Processor    Search      Layer
 │              │            │          │           │
 │─query──────▶│             │          │           │
 │              │─parse─────▶│          │           │
 │              │            │─encode──▶│           │
 │              │            │          │─search──▶│
 │              │            │          │◀─results─│
 │              │◀───────────┼──────────┤          │
 │◀────response─│            │          │          │
 │              │            │          │          │</code></pre>
</section>
</section>
<section id="실제-예시-rag-시스템의-logical-architecture" class="level2" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="실제-예시-rag-시스템의-logical-architecture"><span class="header-section-number">4</span> 실제 예시: RAG 시스템의 Logical Architecture</h2>
<section id="conceptual에서-logical로의-전환" class="level3" data-number="4.1">
<h3 data-number="4.1" class="anchored" data-anchor-id="conceptual에서-logical로의-전환"><span class="header-section-number">4.1</span> Conceptual에서 Logical로의 전환</h3>
<pre><code>Conceptual Components → Logical Modules

1. Data Ingestion
   └─ Logical Modules:
      ├── SourceConnector
      ├── DocumentParser
      ├── ImageAnalyzer
      └── DataValidator

2. Storage Repository
   └─ Logical Modules:
      ├── TextRepository
      ├── VectorRepository
      ├── MetadataRepository
      └── CacheLayer

3. Retrieval Engine
   └─ Logical Modules:
      ├── QueryEncoder
      ├── VectorSearcher
      ├── TextSearcher
      ├── ResultRanker
      └── ContextAggregator

4. Response Generation
   └─ Logical Modules:
      ├── ReasoningEngine
      ├── ResponseComposer
      └── OutputFormatter

5. User Interface
   └─ Logical Modules:
      ├── APIGateway
      ├── ChatInterface
      └── DashboardService</code></pre>
</section>
<section id="프로젝트-예시" class="level3" data-number="4.2">
<h3 data-number="4.2" class="anchored" data-anchor-id="프로젝트-예시"><span class="header-section-number">4.2</span> 프로젝트 예시</h3>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="kk3225.netlify.app/docs/blog/posts/Engineering/System/Archi_Design/images/sw_logical_architecture.png" class="img-fluid figure-img"></p>
<figcaption>SW Architecture 예시</figcaption>
</figure>
</div>
</section>
<section id="핵심-모듈-정의" class="level3" data-number="4.3">
<h3 data-number="4.3" class="anchored" data-anchor-id="핵심-모듈-정의"><span class="header-section-number">4.3</span> 핵심 모듈 정의</h3>
<p><strong>Module: SourceConnector</strong></p>
<pre><code>Responsibility: 다양한 소스에서 원본 데이터 수집

Input Configuration:
{
  source_type: "github" | "local_files" | "api",
  source_path: string,
  filter_rules: list[FilterRule],
  batch_size: integer
}

Output Stream:
RawDataItem {
  id: string (unique identifier),
  content: bytes,
  source: string,
  mime_type: string,
  timestamp: datetime,
  metadata: object
}

Key Operations:
  - open_connection(config) → Connection
  - read_batch() → RawDataItem[]
  - close_connection() → void
  
Error Handling:
  - Connection failures → Retry with backoff
  - Incomplete reads → Queue for retry
  - Invalid data → Log and continue</code></pre>
<p><strong>Module: VectorSearcher</strong></p>
<pre><code>Responsibility: 의미 기반 벡터 검색

Input Query:
{
  query_vector: float[],    // embedding representation
  top_k: integer,           // number of results
  filters: object,          // optional metadata filters
  similarity_threshold: float
}

Output Results:
SearchResult {
  id: string,
  content: string,
  similarity_score: float,  // 0.0 to 1.0
  metadata: object,
  rank: integer
}

Key Operations:
  - index_vectors(vectors: Vector[]) → void
  - search(query_vector, top_k) → SearchResult[]
  - filter_results(results, filters) → SearchResult[]
  
Performance Requirements:
  - Latency: &lt; 100ms per query
  - Throughput: 1000 queries/sec</code></pre>
<p><strong>Module: ResponseComposer</strong></p>
<pre><code>Responsibility: 관련 정보를 바탕으로 자연어 응답 생성

Input Context:
{
  user_query: string,
  retrieved_contexts: list[Context],  // Retrieved from search
  reasoning_result: object,
  response_style: "summary" | "detailed" | "structured"
}

Output Response:
{
  response_text: string,
  confidence_score: float,
  sources_cited: list[Source],
  follow_up_questions: list[string]
}

Key Operations:
  - compose_response(context, style) → Response
  - rank_context_by_relevance(contexts) → Context[]
  - generate_citations(contexts) → Citation[]
  
Quality Metrics:
  - Response coherence
  - Source relevance
  - Citation accuracy</code></pre>
</section>
<section id="모듈-간-인터페이스" class="level3" data-number="4.4">
<h3 data-number="4.4" class="anchored" data-anchor-id="모듈-간-인터페이스"><span class="header-section-number">4.4</span> 모듈 간 인터페이스</h3>
<p><strong>Interface: DataStream</strong></p>
<pre><code>from Module: SourceConnector
to Module: DataValidator

Protocol: Streaming (async pull-based)

Message Format:
{
  id: string,
  data: bytes,
  metadata: {
    source: string,
    timestamp: datetime,
    chunk_size: integer
  }
}

Error Handling:
- On validation failure → Send to ErrorHandler
- On timeout → Retry or abandon</code></pre>
<p><strong>Interface: SearchQuery</strong></p>
<pre><code>from Module: QueryEncoder
to Module: VectorSearcher

Protocol: Request-Response (sync)

Request:
{
  query_embedding: float[],
  top_k: integer = 10,
  filters: object = {}
}

Response:
{
  status: "success" | "error",
  results: SearchResult[],
  query_time_ms: integer,
  result_count: integer
}</code></pre>
</section>
</section>
<section id="logical-architecture-설계-체크리스트" class="level2" data-number="5">
<h2 data-number="5" class="anchored" data-anchor-id="logical-architecture-설계-체크리스트"><span class="header-section-number">5</span> Logical Architecture 설계 체크리스트</h2>
<p>설계 완료 전에 확인할 사항:</p>
<section id="모듈-설계" class="level3" data-number="5.1">
<h3 data-number="5.1" class="anchored" data-anchor-id="모듈-설계"><span class="header-section-number">5.1</span> 모듈 설계</h3>
<ul class="task-list">
<li><label><input type="checkbox">모든 Conceptual 컴포넌트가 Logical 모듈로 분해되었는가?</label></li>
<li><label><input type="checkbox">각 모듈의 책임이 명확하고 단일한가?</label></li>
<li><label><input type="checkbox">모듈 간 응집도가 높고 결합도가 낮은가?</label></li>
<li><label><input type="checkbox">각 모듈의 경계(boundary)가 명확하게 정의되었는가?</label></li>
</ul>
</section>
<section id="데이터-구조" class="level3" data-number="5.2">
<h3 data-number="5.2" class="anchored" data-anchor-id="데이터-구조"><span class="header-section-number">5.2</span> 데이터 구조</h3>
<ul class="task-list">
<li><label><input type="checkbox">각 모듈이 주고받는 데이터 형식이 정의되었는가?</label></li>
<li><label><input type="checkbox">데이터 구조가 확장 가능한가 (필드 추가 등)?</label></li>
<li><label><input type="checkbox">메타데이터가 충분히 포함되어 있는가?</label></li>
<li><label><input type="checkbox">버전 관리 전략이 있는가?</label></li>
</ul>
</section>
<section id="인터페이스-및-계약" class="level3" data-number="5.3">
<h3 data-number="5.3" class="anchored" data-anchor-id="인터페이스-및-계약"><span class="header-section-number">5.3</span> 인터페이스 및 계약</h3>
<ul class="task-list">
<li><label><input type="checkbox">모든 모듈 간 인터페이스가 정의되었는가?</label></li>
<li><label><input type="checkbox">API 계약이 명확하고 일관성 있는가?</label></li>
<li><label><input type="checkbox">에러 처리 메커니즘이 정의되었는가?</label></li>
<li><label><input type="checkbox">타임아웃, 재시도 정책이 정의되었는가?</label></li>
</ul>
</section>
<section id="성능-및-확장성" class="level3" data-number="5.4">
<h3 data-number="5.4" class="anchored" data-anchor-id="성능-및-확장성"><span class="header-section-number">5.4</span> 성능 및 확장성</h3>
<ul class="task-list">
<li><label><input type="checkbox">각 모듈의 성능 요구사항이 정의되었는가?</label></li>
<li><label><input type="checkbox">병목 가능성이 식별되었는가?</label></li>
<li><label><input type="checkbox">수평/수직 확장 전략이 있는가?</label></li>
<li><label><input type="checkbox">캐싱 전략이 정의되었는가?</label></li>
</ul>
</section>
<section id="신뢰성-및-복구력" class="level3" data-number="5.5">
<h3 data-number="5.5" class="anchored" data-anchor-id="신뢰성-및-복구력"><span class="header-section-number">5.5</span> 신뢰성 및 복구력</h3>
<ul class="task-list">
<li><label><input type="checkbox">장애 모드(failure modes)가 식별되었는가?</label></li>
<li><label><input type="checkbox">에러 처리 흐름이 모든 모듈에서 정의되었는가?</label></li>
<li><label><input type="checkbox">재시도 정책과 보상 트랜잭션이 있는가?</label></li>
<li><label><input type="checkbox">로깅 및 모니터링 포인트가 정의되었는가?</label></li>
</ul>
</section>
<section id="보안" class="level3" data-number="5.6">
<h3 data-number="5.6" class="anchored" data-anchor-id="보안"><span class="header-section-number">5.6</span> 보안</h3>
<ul class="task-list">
<li><label><input type="checkbox">모듈 간 데이터 전달 시 보안 고려사항이 있는가?</label></li>
<li><label><input type="checkbox">인증/인가가 필요한 모듈이 식별되었는가?</label></li>
<li><label><input type="checkbox">민감한 데이터 처리 방식이 정의되었는가?</label></li>
</ul>
</section>
</section>
<section id="logical-architecture-문서화" class="level2" data-number="6">
<h2 data-number="6" class="anchored" data-anchor-id="logical-architecture-문서화"><span class="header-section-number">6</span> Logical Architecture 문서화</h2>
<section id="필수-문서-요소" class="level3" data-number="6.1">
<h3 data-number="6.1" class="anchored" data-anchor-id="필수-문서-요소"><span class="header-section-number">6.1</span> 필수 문서 요소</h3>
<pre><code>1. Architecture Overview Diagram
   - 모든 모듈 시각화
   - 모듈 간 관계

2. Module Specification
   - 각 모듈의 책임
   - 입출력 데이터 정의
   - 주요 알고리즘/로직

3. Interface Definition
   - 모듈 간 API 계약
   - 데이터 형식 스키마
   - 통신 프로토콜

4. Data Flow Diagrams
   - 주요 시나리오별 흐름
   - 상태 전이
   - 에러 흐름

5. Non-Functional Requirements
   - 성능: 지연시간, 처리량
   - 확장성: 동시성, 데이터 크기
   - 신뢰성: 가용성, 복구 시간
   - 보안: 암호화, 접근 제어

6. Deployment Considerations
   - 모듈 배포 단위
   - 의존성 관리
   - 버전 호환성</code></pre>
</section>
<section id="문서-템플릿" class="level3" data-number="6.2">
<h3 data-number="6.2" class="anchored" data-anchor-id="문서-템플릿"><span class="header-section-number">6.2</span> 문서 템플릿</h3>
<div class="sourceCode" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb16-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;"># Module: [ModuleName]</span></span>
<span id="cb16-2"></span>
<span id="cb16-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">## Purpose</span></span>
<span id="cb16-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">[</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">모듈의 목적과 책임</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb16-5"></span>
<span id="cb16-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">## Input</span></span></code></pre></div>
<p>[입력 데이터 구조]</p>
<pre><code>
## Output</code></pre>
<p>[출력 데이터 구조]</p>
<pre><code>
## Key Operations
- [Operation 1]: [설명]
- [Operation 2]: [설명]

## Dependencies
- [Dependency 1]
- [Dependency 2]

## Error Handling
- [Error Scenario 1]: [대응 방식]
- [Error Scenario 2]: [대응 방식]

## Performance Requirements
- Latency: [목표값]
- Throughput: [목표값]

## Scalability
- Horizontal: [가능 여부]
- Vertical: [가능 여부]

## Testing Strategy
- Unit tests: [테스트 항목]
- Integration tests: [테스트 항목]</code></pre>
</section>
</section>
<section id="logical에서-physical로의-전환" class="level2" data-number="7">
<h2 data-number="7" class="anchored" data-anchor-id="logical에서-physical로의-전환"><span class="header-section-number">7</span> Logical에서 Physical로의 전환</h2>
<p>Logical Architecture가 완성되면 다음 단계:</p>
<p><strong>구체화되는 항목:</strong></p>
<pre><code>Logical                          Physical
─────────────────────────────────────────────

VectorSearcher          →    Elasticsearch / FAISS / Milvus
MetadataRepository      →    PostgreSQL / MongoDB
CacheLayer              →    Redis / Memcached
ResponseComposer        →    Python FastAPI + Jinja2
APIGateway              →    Kong / AWS API Gateway</code></pre>
<p><strong>변화:</strong></p>
<ul>
<li>구체적 기술 스택 선택</li>
<li>인프라 배포 구조 정의</li>
<li>네트워킹, 리소스 할당</li>
<li>CI/CD 파이프라인 설계</li>
</ul>
</section>
<section id="정리" class="level2" data-number="8">
<h2 data-number="8" class="anchored" data-anchor-id="정리"><span class="header-section-number">8</span> 정리</h2>
<p>Logical Architecture는:</p>
<ol type="1">
<li><strong>기술 중립성</strong> 유지하면서도 <strong>구현 수준</strong>의 세부사항 정의</li>
<li><strong>모듈화된 설계</strong>로 확장성과 유지보수성 확보</li>
<li><strong>명확한 인터페이스</strong> 정의로 팀 간 커뮤니케이션 효율화</li>
<li><strong>성능, 확장성, 신뢰성</strong> 요구사항을 구체적으로 반영</li>
<li><strong>Physical 설계</strong>를 위한 견고한 기반 제공</li>
</ol>
<p>Conceptual → Logical → Physical 순서로 설계하면, 각 단계에서 기술적 결정의 이유를 명확히 할 수 있으며, 변경사항에 유연하게 대응할 수 있다.</p>


</section>

 ]]></description>
  <category>Engineering</category>
  <category>Architecture</category>
  <guid>kk3225.netlify.app/docs/blog/posts/Engineering/System/Archi_Design/logical_design.html</guid>
  <pubDate>Sat, 15 Nov 2025 15:00:00 GMT</pubDate>
</item>
<item>
  <title>Conceptual Architecture 그리는 방법</title>
  <dc:creator>Kwangmin Kim</dc:creator>
  <link>kk3225.netlify.app/docs/blog/posts/Engineering/System/Archi_Design/conceptual_dsign.html</link>
  <description><![CDATA[ 





<section id="conceptual-architecture의-정의" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="conceptual-architecture의-정의"><span class="header-section-number">1</span> Conceptual Architecture의 정의</h2>
<p>Conceptual Architecture는 시스템 설계의 첫 번째 추상화 계층으로, <strong>비즈니스 요구사항</strong>을 기술 구현 없이 고수준의 개념으로 표현</p>
<p><strong>핵심 특징:</strong></p>
<ul>
<li>기술 스택 미포함: 어떤 도구를 사용할지 정하지 않음</li>
<li>비즈니스 로직 중심: “무엇을 해야 하는가”에 집중</li>
<li>이해관계자 소통: 기술팀과 비즈니스팀 모두 이해 가능</li>
<li>추상적 컴포넌트: “데이터 소스”, “처리 엔진”, “저장소” 등 범용 용어 사용</li>
</ul>
</section>
<section id="conceptual-architecture-작성-단계" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="conceptual-architecture-작성-단계"><span class="header-section-number">2</span> Conceptual Architecture 작성 단계</h2>
<section id="요구사항-정의" class="level3" data-number="2.1">
<h3 data-number="2.1" class="anchored" data-anchor-id="요구사항-정의"><span class="header-section-number">2.1</span> 요구사항 정의</h3>
<ul>
<li><strong>목표</strong>: 시스템이 해결할 비즈니스 문제가 무엇인가?</li>
<li><strong>입력</strong>: 어떤 데이터가 들어오는가?</li>
<li><strong>출력</strong>: 어떤 결과가 나가야 하는가?</li>
<li><strong>주요 기능</strong>: 시스템이 수행해야 할 핵심 작업은 무엇인가?</li>
</ul>
<p><strong>예시: RAG 기반 코드 분석 시스템</strong></p>
<ul>
<li><strong>목표</strong>: 비기술 이해관계자가 GitHub 저장소의 코드와 알고리즘을 이해하도록 지원</li>
<li><strong>입력</strong>: 소스 코드, 문서, 플로우차트 이미지</li>
<li><strong>출력</strong>: 자연어 설명, 요약, 답변</li>
<li><strong>핵심 기능</strong>: 문서화, 의미 검색, 자동 요약, 질문 응답</li>
</ul>
</section>
<section id="주요-컴포넌트-식별" class="level3" data-number="2.2">
<h3 data-number="2.2" class="anchored" data-anchor-id="주요-컴포넌트-식별"><span class="header-section-number">2.2</span> 주요 컴포넌트 식별</h3>
<ul>
<li>시스템을 구성하는 <strong>논리적 단위</strong>를 식별</li>
<li>구체적 기술이 아닌 기능 기반으로 명명</li>
</ul>
<p><strong>일반적인 패턴:</strong></p>
<table class="table">
<colgroup>
<col style="width: 33%">
<col style="width: 33%">
<col style="width: 33%">
</colgroup>
<thead>
<tr class="header">
<th>컴포넌트 역할</th>
<th>설명</th>
<th>예시</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Source/Input</strong></td>
<td>데이터 입력 지점</td>
<td>GitHub Repository, Document Files</td>
</tr>
<tr class="even">
<td><strong>Processing</strong></td>
<td>핵심 처리 로직</td>
<td>Data Parsing, Embedding Generation</td>
</tr>
<tr class="odd">
<td><strong>Storage</strong></td>
<td>데이터 저장소</td>
<td>Knowledge Base, Metadata Repository</td>
</tr>
<tr class="even">
<td><strong>Retrieval</strong></td>
<td>정보 검색</td>
<td>Search Engine, Query Processor</td>
</tr>
<tr class="odd">
<td><strong>Output/Service</strong></td>
<td>사용자 인터페이스</td>
<td>API, Chat Interface, Dashboard</td>
</tr>
</tbody>
</table>
</section>
<section id="데이터-흐름-정의" class="level3" data-number="2.3">
<h3 data-number="2.3" class="anchored" data-anchor-id="데이터-흐름-정의"><span class="header-section-number">2.3</span> 데이터 흐름 정의</h3>
<p>컴포넌트 간의 <strong>데이터 이동</strong> 경로를 단계별로 표현</p>
<pre><code>Source → Ingestion → Processing → Storage → Retrieval → Response Generation → Output</code></pre>
<p>각 단계에서:</p>
<ul>
<li>어떤 데이터가 입력되는가?</li>
<li>어떤 변환이 일어나는가?</li>
<li>어떤 데이터가 출력되는가?</li>
</ul>
</section>
<section id="상호작용-패턴-정의" class="level3" data-number="2.4">
<h3 data-number="2.4" class="anchored" data-anchor-id="상호작용-패턴-정의"><span class="header-section-number">2.4</span> 상호작용 패턴 정의</h3>
<p>컴포넌트 간의 <strong>통신 방식</strong>을 정의합니다:</p>
<ul>
<li><strong>동기식</strong>: 요청-응답 (Synchronous)</li>
<li><strong>비동기식</strong>: 이벤트 기반 (Asynchronous)</li>
<li><strong>배치</strong>: 주기적 처리 (Batch Processing)</li>
</ul>
</section>
</section>
<section id="conceptual-architecture-시각화-방법" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="conceptual-architecture-시각화-방법"><span class="header-section-number">3</span> Conceptual Architecture 시각화 방법</h2>
<section id="블록-다이어그램-가장-기본적" class="level3" data-number="3.1">
<h3 data-number="3.1" class="anchored" data-anchor-id="블록-다이어그램-가장-기본적"><span class="header-section-number">3.1</span> 블록 다이어그램 (가장 기본적)</h3>
<pre><code>┌─────────────────────────────────────────────────────────┐
│                  Conceptual Architecture                │
└─────────────────────────────────────────────────────────┘

   ┌──────────┐         ┌──────────┐         ┌──────────┐
   │  Source  │────────▶│Processing│────────▶│ Storage  │
   │   Data   │         │  Engine  │         │Repository│
   └──────────┘         └──────────┘         └──────────┘
                              ▲                    │
                              │                    │
                              │                    ▼
                        ┌──────────┐         ┌──────────┐
                        │  Query   │◀────────│Retrieval │
                        │Processor │         │  Engine  │
                        └──────────┘         └──────────┘
                              │
                              ▼
                        ┌──────────────┐
                        │    Output    │
                        │ (API/Chat UI)│
                        └──────────────┘</code></pre>
</section>
<section id="데이터-흐름-다이어그램-swimlane" class="level3" data-number="3.2">
<h3 data-number="3.2" class="anchored" data-anchor-id="데이터-흐름-다이어그램-swimlane"><span class="header-section-number">3.2</span> 데이터 흐름 다이어그램 (Swimlane)</h3>
<pre><code>User/System    │    System Core         │    External
               │                        │
Request ──────▶│ ┌──────────────────┐  │
               │ │  Request Handler │  │
               │ └────────┬─────────┘  │
               │          ▼            │
               │ ┌──────────────────┐  │
               │ │  Data Processor  │  │
               │ └────────┬─────────┘  │
               │          ▼            │
               │ ┌──────────────────┐  │  ┌──────────┐
               │ │ Search/Retrieve  │──▶│ Knowledge│
               │ └────────┬─────────┘  │  │   Base   │
               │          ▼            │  └──────────┘
               │ ┌──────────────────┐  │
               │ │Generate Response │  │
               │ └────────┬─────────┘  │
               │          ▼            │
Response ◀─────│ ┌──────────────────┐  │
               │ │Output Formatter  │  │
               │ └──────────────────┘  │</code></pre>
</section>
<section id="컴포넌트-상호작용-테이블" class="level3" data-number="3.3">
<h3 data-number="3.3" class="anchored" data-anchor-id="컴포넌트-상호작용-테이블"><span class="header-section-number">3.3</span> 컴포넌트 상호작용 테이블</h3>
<table class="table">
<colgroup>
<col style="width: 25%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header">
<th>컴포넌트</th>
<th>입력</th>
<th>처리</th>
<th>출력</th>
<th>상호작용</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Data Ingestion</td>
<td>Raw Files</td>
<td>Parse &amp; Validate</td>
<td>Standardized Data</td>
<td>→ Processing</td>
</tr>
<tr class="even">
<td>Processing</td>
<td>Standardized Data</td>
<td>Transform &amp; Enrich</td>
<td>Processed Data</td>
<td>→ Storage</td>
</tr>
<tr class="odd">
<td>Storage</td>
<td>Processed Data</td>
<td>Index &amp; Organize</td>
<td>Indexed Data</td>
<td>← Retrieval</td>
</tr>
<tr class="even">
<td>Retrieval</td>
<td>Query</td>
<td>Search &amp; Rank</td>
<td>Relevant Data</td>
<td>→ Response Gen</td>
</tr>
<tr class="odd">
<td>Response Gen</td>
<td>Relevant Data</td>
<td>Format &amp; Compose</td>
<td>Natural Language</td>
<td>→ Output</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="실제-예시-rag-시스템의-conceptual-architecture" class="level2" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="실제-예시-rag-시스템의-conceptual-architecture"><span class="header-section-number">4</span> 실제 예시: RAG 시스템의 Conceptual Architecture</h2>
<section id="시스템-목표" class="level3" data-number="4.1">
<h3 data-number="4.1" class="anchored" data-anchor-id="시스템-목표"><span class="header-section-number">4.1</span> 시스템 목표</h3>
<p>비기술 이해관계자가 복잡한 소스 코드와 알고리즘 문서를 자연어로 이해할 수 있도록 지원하는 AI 기반 질문응답 시스템.</p>
</section>
<section id="주요-컴포넌트" class="level3" data-number="4.2">
<h3 data-number="4.2" class="anchored" data-anchor-id="주요-컴포넌트"><span class="header-section-number">4.2</span> 주요 컴포넌트</h3>
<pre><code>1. 소스 수집 (Source Collection)
   - GitHub 코드 저장소
   - 마크다운 문서
   - 플로우차트 이미지

2. 데이터 준비 (Data Preparation)
   - 텍스트 추출 및 파싱
   - 이미지 분석 및 OCR
   - 메타데이터 추출

3. 지식 저장소 (Knowledge Repository)
   - 구조화된 데이터 저장
   - 임베딩 벡터 저장
   - 메타데이터 관리

4. 검색 및 검색 (Retrieval &amp; Search)
   - 의미 기반 검색
   - 컨텍스트 관련성 판단
   - 결과 순위 지정

5. 응답 생성 (Response Generation)
   - 관련 컨텍스트 결합
   - 자연어 응답 생성
   - 출력 포맷팅

6. 사용자 인터페이스 (User Interface)
   - 채팅 인터페이스
   - REST API
   - 대시보드</code></pre>
</section>
<section id="데이터-흐름-및-상호작용" class="level3" data-number="4.3">
<h3 data-number="4.3" class="anchored" data-anchor-id="데이터-흐름-및-상호작용"><span class="header-section-number">4.3</span> 데이터 흐름 및 상호작용</h3>
<pre><code>┌─────────────────────────────────────────────────────────────────────┐
│                    RAG System - Conceptual Architecture              │
└─────────────────────────────────────────────────────────────────────┘

GitHub Repo ─┐
             │
Documents ───┼──▶ ┌──────────────┐      ┌─────────────────┐
             │    │   Ingestion  │─────▶│  Knowledge      │
Images ──────┘    │   &amp; Parsing  │      │  Repository     │
                  └──────────────┘      │  (with vectors) │
                                        └────────┬────────┘
                                                 │
                  ┌──────────────┐              │
                  │   User Query │              │
                  └──────┬───────┘              │
                         │                      │
                         ▼                      │
                  ┌──────────────┐              │
                  │Query Encoder │              │
                  └──────┬───────┘              │
                         │                      │
                         ▼                      ▼
                  ┌──────────────────────────────────┐
                  │  Semantic Search &amp; Retrieval     │
                  └──────────────┬───────────────────┘
                                 │
                                 ▼
                  ┌──────────────────────────────────┐
                  │  Context Aggregation             │
                  └──────────────┬───────────────────┘
                                 │
                                 ▼
                  ┌──────────────────────────────────┐
                  │  Response Generation             │
                  │  (Reasoning + Composition)       │
                  └──────────────┬───────────────────┘
                                 │
                                 ▼
                  ┌──────────────────────────────────┐
                  │  Output Formatting               │
                  │  (Natural Language Response)     │
                  └──────────────────────────────────┘</code></pre>
</section>
</section>
<section id="conceptual-architecture-작성-체크리스트" class="level2" data-number="5">
<h2 data-number="5" class="anchored" data-anchor-id="conceptual-architecture-작성-체크리스트"><span class="header-section-number">5</span> Conceptual Architecture 작성 체크리스트</h2>
<p>Conceptual Architecture를 완성하기 전에 확인할 사항:</p>
<ul class="task-list">
<li><label><input type="checkbox">시스템의 최종 목표가 명확하게 표현되었는가?</label></li>
<li><label><input type="checkbox">모든 주요 컴포넌트가 식별되었는가?</label></li>
<li><label><input type="checkbox">각 컴포넌트의 역할이 기술 독립적으로 표현되었는가?</label></li>
<li><label><input type="checkbox">데이터 흐름이 시작부터 끝까지 연결되어 있는가?</label></li>
<li><label><input type="checkbox">외부 시스템/이해관계자와의 상호작용이 표현되었는가?</label></li>
<li><label><input type="checkbox">비기술팀도 이해할 수 있는 용어를 사용했는가?</label></li>
<li><label><input type="checkbox">모호한 부분이 제거되었는가?</label></li>
</ul>
</section>
<section id="conceptual에서-logical으로의-전환" class="level2" data-number="6">
<h2 data-number="6" class="anchored" data-anchor-id="conceptual에서-logical으로의-전환"><span class="header-section-number">6</span> Conceptual에서 Logical으로의 전환</h2>
<p>Conceptual Architecture가 완성되면, 다음 단계에서 Logical Architecture로 전환:</p>
<p><strong>변화:</strong></p>
<ul>
<li>추상적 “Processing Engine” → 구체적 “Data Transformation Pipeline”, “Feature Engineering Module”</li>
<li>추상적 “Storage” → 구체적 “Vector Store”, “Relational Database”, “Document Store”</li>
<li>데이터 구조 정의: 스키마, 인터페이스 계약</li>
<li>모듈 간 통신 프로토콜 정의</li>
</ul>
<p><strong>예시:</strong></p>
<pre><code>Conceptual: "Query Processor" 
Logical: "Embedding Generator" + "Similarity Search Engine" + "Ranking Module"</code></pre>
</section>
<section id="정리" class="level2" data-number="7">
<h2 data-number="7" class="anchored" data-anchor-id="정리"><span class="header-section-number">7</span> 정리</h2>
<p>Conceptual Architecture는:</p>
<ol type="1">
<li><strong>비즈니스 관점</strong> 중심의 고수준 설계</li>
<li><strong>기술 중립적</strong>이지만 기능적으로 명확</li>
<li><strong>이해관계자 커뮤니케이션</strong> 도구</li>
<li><strong>Logical 및 Physical</strong> 설계의 기초</li>
</ol>
<p>이를 체계적으로 작성하면 후속 설계 단계가 명확해지고, 팀 전체가 같은 비전을 공유할 수 있다.</p>


</section>

 ]]></description>
  <category>Engineering</category>
  <category>Architecture</category>
  <guid>kk3225.netlify.app/docs/blog/posts/Engineering/System/Archi_Design/conceptual_dsign.html</guid>
  <pubDate>Fri, 14 Nov 2025 15:00:00 GMT</pubDate>
</item>
<item>
  <title>Functional Data Analysis</title>
  <dc:creator>Kwangmin Kim</dc:creator>
  <link>kk3225.netlify.app/docs/blog/posts/Statistics/FDA/</link>
  <description><![CDATA[ 





<section id="introduction-and-representation" class="level3" data-number="0.0.1">
<h3 data-number="0.0.1" class="anchored" data-anchor-id="introduction-and-representation"><span class="header-section-number">0.0.1</span> Introduction and Representation</h3>
<ul>
<li>2025-11-18, <a href="../2025-11-18_functional_data/index.qmd">What is Functional Data</a></li>
<li>2025-11-19, <a href="../2025-11-19_basis_functions/index.qmd">Basis Function Expansions</a></li>
<li>2025-11-20, <a href="../2025-11-20_bsplines/index.qmd">B-splines</a></li>
<li>2025-11-21, <a href="../2025-11-21_fourier_basis/index.qmd">Fourier Basis</a></li>
<li>2025-11-22, <a href="../2025-11-22_wavelets/index.qmd">Wavelets Basis</a></li>
<li>2025-11-23, <a href="../2025-11-23_smoothing/index.qmd">Smoothing and Roughness Penalty</a></li>
<li>2025-11-24, <a href="../2025-11-24_cv_smoothing/index.qmd">Cross-Validation for Smoothing Parameter</a></li>
</ul>
</section>
<section id="descriptive-statistics" class="level3" data-number="0.0.2">
<h3 data-number="0.0.2" class="anchored" data-anchor-id="descriptive-statistics"><span class="header-section-number">0.0.2</span> Descriptive Statistics</h3>
<ul>
<li>2025-11-25, <a href="../2025-11-25_functional_mean/index.qmd">Functional Mean</a></li>
<li>2025-11-26, <a href="../2025-11-26_functional_variance/index.qmd">Functional Variance</a></li>
<li>2025-11-27, <a href="../2025-11-27_covariance_function/index.qmd">Covariance Function</a></li>
<li>2025-11-28, <a href="../2025-11-28_cross_covariance/index.qmd">Cross-Covariance Function</a></li>
<li>2025-11-29, <a href="../2025-11-29_functional_boxplot/index.qmd">Functional Boxplot</a></li>
<li>2025-11-30, <a href="../2025-11-30_band_depth/index.qmd">Band Depth</a></li>
<li>2025-12-01, <a href="../2025-12-01_modified_band_depth/index.qmd">Modified Band Depth</a></li>
</ul>
</section>
<section id="functional-principal-component-analysis" class="level3" data-number="0.0.3">
<h3 data-number="0.0.3" class="anchored" data-anchor-id="functional-principal-component-analysis"><span class="header-section-number">0.0.3</span> Functional Principal Component Analysis</h3>
<ul>
<li>2025-12-02, <a href="../2025-12-02_karhunen_loeve/index.qmd">Karhunen-Loève Expansion</a></li>
<li>2025-12-03, <a href="../2025-12-03_eigenfunction/index.qmd">Eigenfunction and Eigenvalue</a></li>
<li>2025-12-04, <a href="../2025-12-04_pc_scores/index.qmd">Principal Component Scores</a></li>
<li>2025-12-05, <a href="../2025-12-05_variance_explained/index.qmd">Variance Explained</a></li>
<li>2025-12-06, <a href="../2025-12-06_scree_plot/index.qmd">Scree Plot</a></li>
<li>2025-12-07, <a href="../2025-12-07_pc_interpretation/index.qmd">PC Score Interpretation</a></li>
<li>2025-12-08, <a href="../2025-12-08_dimension_reduction/index.qmd">Dimension Reduction with FPCA</a></li>
</ul>
</section>
<section id="curve-registration" class="level3" data-number="0.0.4">
<h3 data-number="0.0.4" class="anchored" data-anchor-id="curve-registration"><span class="header-section-number">0.0.4</span> Curve Registration</h3>
<ul>
<li>2025-12-09, <a href="../2025-12-09_phase_amplitude/index.qmd">Phase and Amplitude Variation</a></li>
<li>2025-12-10, <a href="../2025-12-10_warping_function/index.qmd">Time Warping Function</a></li>
<li>2025-12-11, <a href="../2025-12-11_landmark_registration/index.qmd">Landmark Registration</a></li>
<li>2025-12-12, <a href="../2025-12-12_continuous_registration/index.qmd">Continuous Registration</a></li>
<li>2025-12-13, <a href="../2025-12-13_fisher_rao/index.qmd">Fisher-Rao Metric</a></li>
<li>2025-12-14, <a href="../2025-12-14_srvf/index.qmd">Square-Root Velocity Function (SRVF)</a></li>
<li>2025-12-15, <a href="../2025-12-15_registration_effects/index.qmd">Registration Effects on Mean and Variance</a></li>
</ul>
</section>
<section id="core-methods" class="level2" data-number="0.1">
<h2 data-number="0.1" class="anchored" data-anchor-id="core-methods"><span class="header-section-number">0.1</span> Core Methods</h2>
<section id="functional-regression---basics" class="level3" data-number="0.1.1">
<h3 data-number="0.1.1" class="anchored" data-anchor-id="functional-regression---basics"><span class="header-section-number">0.1.1</span> Functional Regression - Basics</h3>
<ul>
<li>2025-12-16, <a href="../2025-12-16_functional_linear_model/index.qmd">Functional Linear Model</a></li>
<li>2025-12-17, <a href="../2025-12-17_scalar_on_function/index.qmd">Scalar-on-Function Regression</a></li>
<li>2025-12-18, <a href="../2025-12-18_coeff_estimation/index.qmd">Regression Coefficient Function Estimation</a></li>
<li>2025-12-19, <a href="../2025-12-19_coeff_inference/index.qmd">Coefficient Function Inference</a></li>
<li>2025-12-20, <a href="../2025-12-20_function_on_scalar/index.qmd">Function-on-Scalar Regression</a></li>
<li>2025-12-21, <a href="../2025-12-21_function_on_function/index.qmd">Function-on-Function Regression</a></li>
<li>2025-12-22, <a href="../2025-12-22_bivariate_coeff/index.qmd">Bivariate Coefficient Function</a></li>
</ul>
</section>
<section id="functional-regression---advanced" class="level3" data-number="0.1.2">
<h3 data-number="0.1.2" class="anchored" data-anchor-id="functional-regression---advanced"><span class="header-section-number">0.1.2</span> Functional Regression - Advanced</h3>
<ul>
<li>2025-12-23, <a href="../2025-12-23_ridge_regression/index.qmd">Ridge Regression for Functional Data</a></li>
<li>2025-12-24, <a href="../2025-12-24_lasso/index.qmd">Lasso for Functional Data</a></li>
<li>2025-12-25, <a href="../2025-12-25_group_lasso/index.qmd">Group Lasso</a></li>
<li>2025-12-26, <a href="../2025-12-26_elastic_net/index.qmd">Elastic Net for Functional Data</a></li>
<li>2025-12-27, <a href="../2025-12-27_variable_selection/index.qmd">Variable Selection in Functional Regression</a></li>
<li>2025-12-28, <a href="../2025-12-28_functional_additive/index.qmd">Functional Additive Models</a></li>
<li>2025-12-29, <a href="../2025-12-29_functional_glm/index.qmd">Functional Generalized Linear Models</a></li>
</ul>
</section>
<section id="multivariate-functional-data" class="level3" data-number="0.1.3">
<h3 data-number="0.1.3" class="anchored" data-anchor-id="multivariate-functional-data"><span class="header-section-number">0.1.3</span> Multivariate Functional Data</h3>
<ul>
<li>2025-12-30, <a href="../2025-12-30_multivariate_concept/index.qmd">Multivariate Functional Data Concept</a></li>
<li>2025-12-31, <a href="../2025-12-31_multivariate_covariance/index.qmd">Multivariate Covariance Operator</a></li>
<li>2026-01-01, <a href="../2026-01-01_mfpca/index.qmd">Multivariate FPCA (MFPCA)</a></li>
<li>2026-01-02, <a href="../2026-01-02_jive/index.qmd">Joint and Individual Variation (JIVE)</a></li>
<li>2026-01-03, <a href="../2026-01-03_functional_cca/index.qmd">Canonical Correlation Analysis for Functional Data</a></li>
<li>2026-01-04, <a href="../2026-01-04_multivariate_regression/index.qmd">Multivariate Functional Regression</a></li>
<li>2026-01-05, <a href="../2026-01-05_tensor_product/index.qmd">Tensor Product Basis</a></li>
</ul>
</section>
<section id="hypothesis-testing" class="level3" data-number="0.1.4">
<h3 data-number="0.1.4" class="anchored" data-anchor-id="hypothesis-testing"><span class="header-section-number">0.1.4</span> Hypothesis Testing</h3>
<ul>
<li>2026-01-06, <a href="../2026-01-06_pointwise_testing/index.qmd">Pointwise Testing</a></li>
<li>2026-01-07, <a href="../2026-01-07_multiple_testing/index.qmd">Multiple Testing Correction</a></li>
<li>2026-01-08, <a href="../2026-01-08_global_testing/index.qmd">Global Testing</a></li>
<li>2026-01-09, <a href="../2026-01-09_functional_anova/index.qmd">Functional ANOVA</a></li>
<li>2026-01-10, <a href="../2026-01-10_permutation_tests/index.qmd">Permutation Tests for Functional Data</a></li>
<li>2026-01-11, <a href="../2026-01-11_functional_bootstrap/index.qmd">Bootstrap for Functional Data</a></li>
<li>2026-01-12, <a href="../2026-01-12_confidence_bands/index.qmd">Simultaneous Confidence Bands</a></li>
</ul>
</section>
</section>
<section id="advanced-topics" class="level2" data-number="0.2">
<h2 data-number="0.2" class="anchored" data-anchor-id="advanced-topics"><span class="header-section-number">0.2</span> Advanced Topics</h2>
<section id="classification-and-clustering" class="level3" data-number="0.2.1">
<h3 data-number="0.2.1" class="anchored" data-anchor-id="classification-and-clustering"><span class="header-section-number">0.2.1</span> Classification and Clustering</h3>
<ul>
<li>2026-01-13, <a href="../2026-01-13_functional_discriminant/index.qmd">Functional Discriminant Analysis</a></li>
<li>2026-01-14, <a href="../2026-01-14_functional_logistic/index.qmd">Functional Logistic Regression</a></li>
<li>2026-01-15, <a href="../2026-01-15_functional_kmeans/index.qmd">Functional K-means</a></li>
<li>2026-01-16, <a href="../2026-01-16_hierarchical_clustering/index.qmd">Functional Hierarchical Clustering</a></li>
<li>2026-01-17, <a href="../2026-01-17_model_based_clustering/index.qmd">Model-Based Clustering</a></li>
<li>2026-01-18, <a href="../2026-01-18_mixture_models/index.qmd">Functional Mixture Models</a></li>
<li>2026-01-19, <a href="../2026-01-19_distance_metrics/index.qmd">Distance Metrics for Functional Data</a></li>
</ul>
</section>
<section id="sparse-and-longitudinal-data" class="level3" data-number="0.2.2">
<h3 data-number="0.2.2" class="anchored" data-anchor-id="sparse-and-longitudinal-data"><span class="header-section-number">0.2.2</span> Sparse and Longitudinal Data</h3>
<ul>
<li>2026-01-20, <a href="../2026-01-20_sparse_functional/index.qmd">Sparse Functional Data</a></li>
<li>2026-01-21, <a href="../2026-01-21_pace/index.qmd">PACE (Principal Analysis by Conditional Expectation)</a></li>
<li>2026-01-22, <a href="../2026-01-22_local_polynomial/index.qmd">Local Polynomial Smoothing</a></li>
<li>2026-01-23, <a href="../2026-01-23_functional_mixed/index.qmd">Functional Mixed Models</a></li>
<li>2026-01-24, <a href="../2026-01-24_subject_specific/index.qmd">Subject-Specific Curves</a></li>
<li>2026-01-25, <a href="../2026-01-25_population_inference/index.qmd">Population-Level Inference</a></li>
<li>2026-01-26, <a href="../2026-01-26_random_effects/index.qmd">Functional Random Effects</a></li>
</ul>
</section>
<section id="time-series-and-dynamics" class="level3" data-number="0.2.3">
<h3 data-number="0.2.3" class="anchored" data-anchor-id="time-series-and-dynamics"><span class="header-section-number">0.2.3</span> Time Series and Dynamics</h3>
<ul>
<li>2026-01-27, <a href="../2026-01-27_functional_time_series/index.qmd">Functional Time Series</a></li>
<li>2026-01-28, <a href="../2026-01-28_far_models/index.qmd">Functional Autoregressive Models (FAR)</a></li>
<li>2026-01-29, <a href="../2026-01-29_fma_models/index.qmd">Functional Moving Average Models</a></li>
<li>2026-01-30, <a href="../2026-01-30_forecasting/index.qmd">Forecasting with Functional Data</a></li>
<li>2026-01-31, <a href="../2026-01-31_dynamic_fpca/index.qmd">Dynamic Functional Principal Components</a></li>
<li>2026-02-01, <a href="../2026-02-01_state_space/index.qmd">State Space Models for Functional Data</a></li>
<li>2026-02-02, <a href="../2026-02-02_kalman_filter/index.qmd">Functional Kalman Filter</a></li>
</ul>
</section>
<section id="advanced-topics-and-extensions" class="level3" data-number="0.2.4">
<h3 data-number="0.2.4" class="anchored" data-anchor-id="advanced-topics-and-extensions"><span class="header-section-number">0.2.4</span> Advanced Topics and Extensions</h3>
<ul>
<li>2026-02-03, <a href="../2026-02-03_manifolds/index.qmd">Functional Data on Manifolds</a></li>
<li>2026-02-04, <a href="../2026-02-04_hilbert_spaces/index.qmd">Functional Data in Hilbert Spaces</a></li>
<li>2026-02-05, <a href="../2026-02-05_rkhs/index.qmd">Reproducing Kernel Hilbert Spaces (RKHS)</a></li>
<li>2026-02-06, <a href="../2026-02-06_gaussian_process/index.qmd">Gaussian Process Regression</a></li>
<li>2026-02-07, <a href="../2026-02-07_bayesian_fda/index.qmd">Bayesian Functional Data Analysis</a></li>
<li>2026-02-08, <a href="../2026-02-08_functional_nn/index.qmd">Functional Neural Networks</a></li>
<li>2026-02-09, <a href="../2026-02-09_deep_learning/index.qmd">Deep Learning for Functional Data</a></li>
</ul>
</section>
</section>
<section id="supplementary-topics" class="level2" data-number="0.3">
<h2 data-number="0.3" class="anchored" data-anchor-id="supplementary-topics"><span class="header-section-number">0.3</span> Supplementary Topics</h2>
<section id="computational-methods" class="level3" data-number="0.3.1">
<h3 data-number="0.3.1" class="anchored" data-anchor-id="computational-methods"><span class="header-section-number">0.3.1</span> Computational Methods</h3>
<ul>
<li>1111-11-11, <a href="../numerical_integration/index.qmd">Numerical Integration for Functional Data</a></li>
<li>1111-11-11, <a href="../discretization/index.qmd">Discretization Methods</a></li>
<li>1111-11-11, <a href="../efficient_covariance/index.qmd">Efficient Computation of Covariance Operators</a></li>
<li>1111-11-11, <a href="../parallel_computing/index.qmd">Parallel Computing for FDA</a></li>
</ul>
</section>
<section id="software-and-tools" class="level3" data-number="0.3.2">
<h3 data-number="0.3.2" class="anchored" data-anchor-id="software-and-tools"><span class="header-section-number">0.3.2</span> Software and Tools</h3>
<ul>
<li>1111-11-11, <a href="../r_fda/index.qmd">R Package: fda</a></li>
<li>1111-11-11, <a href="../r_refund/index.qmd">R Package: refund</a></li>
<li>1111-11-11, <a href="../r_fdapace/index.qmd">R Package: fdapace</a></li>
<li>1111-11-11, <a href="../r_fdasrvf/index.qmd">R Package: fdasrvf</a></li>
<li>1111-11-11, <a href="../python_skfda/index.qmd">Python: scikit-fda</a></li>
</ul>
</section>
<section id="applications-optional" class="level3" data-number="0.3.3">
<h3 data-number="0.3.3" class="anchored" data-anchor-id="applications-optional"><span class="header-section-number">0.3.3</span> Applications (Optional)</h3>
<ul>
<li>1111-11-11, <a href="../applications_biomedical/index.qmd">FDA in Biomedical Sciences</a></li>
<li>1111-11-11, <a href="../applications_environmental/index.qmd">FDA in Environmental Sciences</a></li>
<li>1111-11-11, <a href="../applications_finance/index.qmd">FDA in Economics and Finance</a></li>
<li>1111-11-11, <a href="../applications_image/index.qmd">FDA in Image Analysis</a></li>
</ul>
</section>
</section>
<section id="연구-분야-기획" class="level2" data-number="0.4">
<h2 data-number="0.4" class="anchored" data-anchor-id="연구-분야-기획"><span class="header-section-number">0.4</span> 연구 분야 기획</h2>
<section id="최종-목표" class="level3" data-number="0.4.1">
<h3 data-number="0.4.1" class="anchored" data-anchor-id="최종-목표"><span class="header-section-number">0.4.1</span> 최종 목표</h3>
<p>RT-PCR 증폭 곡선 분석을 위한 FDA 핵심 개념 습득 및 실전 적용 능력 확보</p>
<ol type="1">
<li><strong>이론 40% + 구현 60%</strong>: 매 주제마다 R/Python 구현 필수</li>
<li><strong>RT-PCR 중심</strong>: 추상적 이론보다 실제 응용 위주</li>
<li><strong>점진적 심화</strong>: 기초 → 중급 → 고급 → 응용 순서 엄수</li>
</ol>
</section>
</section>
<section id="주차별-시간-배분" class="level2" data-number="0.5">
<h2 data-number="0.5" class="anchored" data-anchor-id="주차별-시간-배분"><span class="header-section-number">0.5</span> 주차별 시간 배분</h2>
<ul>
<li><strong>Month 1</strong>: 기초 개념 및 탐색적 분석 (56시간)</li>
<li><strong>Month 2</strong>: 핵심 방법론 (FPCA, Registration) (56시간)<br>
</li>
<li><strong>Month 3</strong>: 고급 주제 및 RT-PCR 프로젝트 (56시간)</li>
</ul>
</section>
<section id="month-1-기초-개념-및-탐색적-분석" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Month 1: 기초 개념 및 탐색적 분석</h1>
<section id="week-1-fda-개념-및-데이터-표현-14시간" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="week-1-fda-개념-및-데이터-표현-14시간"><span class="header-section-number">1.1</span> Week 1: FDA 개념 및 데이터 표현 (14시간)</h2>
<section id="함수형-데이터의-정의와-특성" class="level3" data-number="1.1.1">
<h3 data-number="1.1.1" class="anchored" data-anchor-id="함수형-데이터의-정의와-특성"><span class="header-section-number">1.1.1</span> 함수형 데이터의 정의와 특성</h3>
<ul>
<li>2025-11-18, <a href="../2025-11-18_fda_intro/index.qmd">함수형 데이터란 무엇인가</a>
<ul>
<li>이산 측정값 vs 연속 함수의 차이</li>
<li>FDA가 필요한 이유: RT-PCR 곡선이 함수인 이유</li>
<li>실습: 45개 사이클 RFU 데이터를 함수로 시각화</li>
</ul></li>
<li>2025-11-19, <a href="../2025-11-19_fda_representation/index.qmd">함수형 데이터의 표현 방법</a>
<ul>
<li>기저 함수(Basis Functions): B-spline, Fourier, Wavelets</li>
<li>평활화(Smoothing): 거칠기 페널티(Roughness Penalty)</li>
<li>실습: RT-PCR 곡선을 B-spline으로 스무딩 (fda 패키지)</li>
</ul></li>
</ul>
</section>
<section id="탐색적-함수형-데이터-분석" class="level3" data-number="1.1.2">
<h3 data-number="1.1.2" class="anchored" data-anchor-id="탐색적-함수형-데이터-분석"><span class="header-section-number">1.1.2</span> 탐색적 함수형 데이터 분석</h3>
<ul>
<li>2025-11-20, <a href="../2025-11-20_fda_mean_variance/index.qmd">함수형 평균과 분산</a>
<ul>
<li>점별(pointwise) 평균 함수: <img src="https://latex.codecogs.com/png.latex?%5Cbar%7BX%7D(t)%20=%20E%5BX(t)%5D"></li>
<li>공분산 함수: <img src="https://latex.codecogs.com/png.latex?Cov(X(s),%20X(t))"></li>
<li>실습: 100개 RT-PCR 곡선의 평균 곡선 및 공분산 히트맵</li>
</ul></li>
<li>2025-11-21, <a href="../2025-11-21_functional_boxplot/index.qmd">함수형 박스플롯과 이상치 탐지</a>
<ul>
<li>함수적 깊이(Functional Depth): Band Depth, Modified Band Depth</li>
<li>Sun &amp; Genton (2011) 방법론</li>
<li>실습: RT-PCR 곡선 중 이상치 자동 탐지</li>
</ul></li>
</ul>
</section>
<section id="주간-프로젝트-6시간" class="level3" data-number="1.1.3">
<h3 data-number="1.1.3" class="anchored" data-anchor-id="주간-프로젝트-6시간"><span class="header-section-number">1.1.3</span> 주간 프로젝트 (6시간)</h3>
<ul>
<li>2025-11-22~23, <a href="../2025-11-23_week1_project/index.qmd">RT-PCR 데이터 탐색적 분석 리포트</a>
<ul>
<li>실제 RT-PCR 데이터셋 로드 및 전처리</li>
<li>스무딩 파라미터 선택 (GCV, Cross-validation)</li>
<li>평균 곡선, 신뢰 밴드, 이상치 시각화</li>
<li>정상 vs 비정상 곡선 육안 비교</li>
</ul></li>
</ul>
<p><strong>핵심 참고문헌:</strong> - Ramsay &amp; Silverman (2005), <em>Functional Data Analysis</em>, Chapter 1-3 - <code>fda</code> R 패키지 튜토리얼</p>
</section>
</section>
<section id="week-2-함수형-회귀-분석-기초-14시간" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="week-2-함수형-회귀-분석-기초-14시간"><span class="header-section-number">1.2</span> Week 2: 함수형 회귀 분석 기초 (14시간)</h2>
<section id="함수-스칼라-회귀" class="level3" data-number="1.2.1">
<h3 data-number="1.2.1" class="anchored" data-anchor-id="함수-스칼라-회귀"><span class="header-section-number">1.2.1</span> 함수-스칼라 회귀</h3>
<ul>
<li>2025-11-25, <a href="../2025-11-25_functional_regression/index.qmd">Functional Linear Model 이론</a>
<ul>
<li>스칼라 반응 변수, 함수 예측 변수: <img src="https://latex.codecogs.com/png.latex?Y%20=%20%5Cint%20X(t)%5Cbeta(t)dt%20+%20%5Cepsilon"></li>
<li>회귀 계수 함수 <img src="https://latex.codecogs.com/png.latex?%5Cbeta(t)">의 추정</li>
<li>실습: RT-PCR 곡선으로 초기 농도(log scale) 예측</li>
</ul></li>
<li>2025-11-26, <a href="../2025-11-26_coeff_interpretation/index.qmd">회귀 계수 함수의 해석</a>
<ul>
<li><img src="https://latex.codecogs.com/png.latex?%5Cbeta(t)">의 의미: 어느 사이클이 정량에 중요한가?</li>
<li>신뢰 구간 및 유의성 검정</li>
<li>실습: 증폭 효율이 다른 그룹 간 <img src="https://latex.codecogs.com/png.latex?%5Cbeta(t)"> 비교</li>
</ul></li>
</ul>
</section>
<section id="스칼라-함수-회귀-및-함수-함수-회귀" class="level3" data-number="1.2.2">
<h3 data-number="1.2.2" class="anchored" data-anchor-id="스칼라-함수-회귀-및-함수-함수-회귀"><span class="header-section-number">1.2.2</span> 스칼라-함수 회귀 및 함수-함수 회귀</h3>
<ul>
<li>2025-11-27, <a href="../2025-11-27_scalar_on_function/index.qmd">Scalar-on-Function Regression</a>
<ul>
<li>예측 변수는 스칼라, 반응 변수는 함수</li>
<li>실습: 초기 농도 → 예상 증폭 곡선 생성</li>
</ul></li>
<li>2025-11-28, <a href="../2025-11-28_function_on_function/index.qmd">Function-on-Function Regression 소개</a>
<ul>
<li>두 함수 간 관계 모델링</li>
<li>실습: 채널 1 곡선 → 채널 2 곡선 예측 (멀티플렉스)</li>
</ul></li>
</ul>
</section>
<section id="주간-프로젝트-6시간-1" class="level3" data-number="1.2.3">
<h3 data-number="1.2.3" class="anchored" data-anchor-id="주간-프로젝트-6시간-1"><span class="header-section-number">1.2.3</span> 주간 프로젝트 (6시간)</h3>
<ul>
<li>2025-11-29~30, <a href="../2025-11-30_week2_project/index.qmd">증폭 효율 프로파일링 파일럿</a>
<ul>
<li>RT-PCR 곡선 → 초기 농도 회귀 모델 구축</li>
<li>기존 <img src="https://latex.codecogs.com/png.latex?C_T"> 기반 선형 회귀와 성능 비교 (<img src="https://latex.codecogs.com/png.latex?R%5E2">, RMSE)</li>
<li><img src="https://latex.codecogs.com/png.latex?%5Cbeta(t)"> 시각화 및 해석: 어느 사이클이 중요한가?</li>
</ul></li>
</ul>
<p><strong>핵심 참고문헌:</strong> - Reiss et al.&nbsp;(2017), <em>Methods for Scalar-on-Function Regression</em> - <code>refund</code> R 패키지 (Regression with Functional Data)</p>
</section>
</section>
<section id="week-3-곡선-정렬-curve-registration-14시간" class="level2" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="week-3-곡선-정렬-curve-registration-14시간"><span class="header-section-number">1.3</span> Week 3: 곡선 정렬 (Curve Registration) (14시간)</h2>
<section id="registration의-필요성과-개념" class="level3" data-number="1.3.1">
<h3 data-number="1.3.1" class="anchored" data-anchor-id="registration의-필요성과-개념"><span class="header-section-number">1.3.1</span> Registration의 필요성과 개념</h3>
<ul>
<li>2025-12-02, <a href="../2025-12-02_phase_amplitude/index.qmd">Phase Variation vs Amplitude Variation</a>
<ul>
<li>왜 곡선을 정렬해야 하는가?</li>
<li>RT-PCR에서의 의미: 증폭 시작 시점 차이 vs 증폭량 차이</li>
<li>실습: 인위적으로 shift된 곡선의 평균 문제 시연</li>
</ul></li>
<li>2025-12-03, <a href="../2025-12-03_landmark_registration/index.qmd">Landmark Registration</a>
<ul>
<li>특징점 기반 정렬 (예: inflection point, maximum derivative)</li>
<li>시간 왜곡 함수(Time Warping Function) <img src="https://latex.codecogs.com/png.latex?h(t)"></li>
<li>실습: RT-PCR 곡선의 변곡점을 정렬</li>
</ul></li>
</ul>
</section>
<section id="continuous-registration" class="level3" data-number="1.3.2">
<h3 data-number="1.3.2" class="anchored" data-anchor-id="continuous-registration"><span class="header-section-number">1.3.2</span> Continuous Registration</h3>
<ul>
<li>2025-12-04, <a href="../2025-12-04_continuous_registration/index.qmd">Continuous Registration 이론</a>
<ul>
<li>Fisher-Rao metric, Square-Root Velocity Function (SRVF)</li>
<li>최적 정렬 문제: <img src="https://latex.codecogs.com/png.latex?%5Cmin%20%5Cint%20%5BX_i(h_i(t))%20-%20%5Cmu(t)%5D%5E2%20dt"></li>
<li>실습: <code>fdasrvf</code> 패키지로 자동 정렬</li>
</ul></li>
<li>2025-12-05, <a href="../2025-12-05_post_registration/index.qmd">Registration 후 분석 전략</a>
<ul>
<li>정렬된 곡선의 평균 vs 원본 곡선의 평균</li>
<li>Phase variation과 Amplitude variation 분리 분석</li>
<li>실습: 복제 실험 곡선 정렬 후 통합</li>
</ul></li>
</ul>
</section>
<section id="주간-프로젝트-6시간-2" class="level3" data-number="1.3.3">
<h3 data-number="1.3.3" class="anchored" data-anchor-id="주간-프로젝트-6시간-2"><span class="header-section-number">1.3.3</span> 주간 프로젝트 (6시간)</h3>
<ul>
<li>2025-12-06~07, <a href="../2025-12-07_week3_project/index.qmd">기술적 복제 곡선 통합 프로젝트</a>
<ul>
<li>3-5개 복제 RT-PCR 곡선 정렬</li>
<li>Phase variation (피펫팅 오차) vs Amplitude variation (억제제) 정량화</li>
<li>정렬 전/후 <img src="https://latex.codecogs.com/png.latex?C_T"> 표준편차 비교</li>
</ul></li>
</ul>
<p><strong>핵심 참고문헌:</strong> - Marron et al.&nbsp;(2015), <em>Functional Data Analysis of Amplitude and Phase Variation</em> - Tucker et al.&nbsp;(2013), <em>Generative Models for Functional Data using Phase and Amplitude Separation</em></p>
</section>
</section>
<section id="week-4-함수-주성분-분석-fpca-기초-14시간" class="level2" data-number="1.4">
<h2 data-number="1.4" class="anchored" data-anchor-id="week-4-함수-주성분-분석-fpca-기초-14시간"><span class="header-section-number">1.4</span> Week 4: 함수 주성분 분석 (FPCA) 기초 (14시간)</h2>
<section id="fpca-이론" class="level3" data-number="1.4.1">
<h3 data-number="1.4.1" class="anchored" data-anchor-id="fpca-이론"><span class="header-section-number">1.4.1</span> FPCA 이론</h3>
<ul>
<li>2025-12-09, <a href="../2025-12-09_fpca_theory/index.qmd">FPCA의 수학적 기초</a>
<ul>
<li>Karhunen-Loève 전개: <img src="https://latex.codecogs.com/png.latex?X(t)%20=%20%5Cmu(t)%20+%20%5Csum_%7Bk=1%7D%5E%7B%5Cinfty%7D%20%5Cxi_k%20%5Cphi_k(t)"></li>
<li>고유함수 <img src="https://latex.codecogs.com/png.latex?%5Cphi_k(t)">와 주성분 점수 <img src="https://latex.codecogs.com/png.latex?%5Cxi_k"></li>
<li>분산 설명률: <img src="https://latex.codecogs.com/png.latex?%5Clambda_k%20/%20%5Csum%20%5Clambda_k"></li>
<li>실습: 장난감 데이터로 FPCA 직관 이해</li>
</ul></li>
<li>2025-12-10, <a href="../2025-12-10_fpca_computation/index.qmd">FPCA 계산 방법</a>
<ul>
<li>공분산 연산자의 고유값 분해</li>
<li>수치적 구현: <code>pca.fd()</code> 함수</li>
<li>실습: RT-PCR 곡선에 FPCA 적용, scree plot</li>
</ul></li>
</ul>
</section>
<section id="fpca-해석-및-활용" class="level3" data-number="1.4.2">
<h3 data-number="1.4.2" class="anchored" data-anchor-id="fpca-해석-및-활용"><span class="header-section-number">1.4.2</span> FPCA 해석 및 활용</h3>
<ul>
<li>2025-12-11, <a href="../2025-12-11_fpca_interpretation/index.qmd">주성분의 해석</a>
<ul>
<li>PC1: 전체 증폭 수준</li>
<li>PC2: 증폭 속도</li>
<li>PC3: 후기 플래토 형태</li>
<li>실습: 각 PC에 <img src="https://latex.codecogs.com/png.latex?%5Cpm%202%5Csigma"> 변동 시각화</li>
</ul></li>
<li>2025-12-12, <a href="../2025-12-12_fpca_classification/index.qmd">FPCA 기반 분류 및 회귀</a>
<ul>
<li>주성분 점수를 특징으로 사용: <img src="https://latex.codecogs.com/png.latex?%5Cxi_1,%20%5Cxi_2,%20...,%20%5Cxi_K"></li>
<li>Logistic regression, Random Forest 결합</li>
<li>실습: 정상/비정상 RT-PCR 곡선 분류</li>
</ul></li>
</ul>
</section>
<section id="주간-프로젝트-6시간-3" class="level3" data-number="1.4.3">
<h3 data-number="1.4.3" class="anchored" data-anchor-id="주간-프로젝트-6시간-3"><span class="header-section-number">1.4.3</span> 주간 프로젝트 (6시간)</h3>
<ul>
<li>2025-12-13~14, <a href="../2025-12-14_week4_project/index.qmd">RT-PCR 곡선 자동 분류 시스템</a>
<ul>
<li>300개 곡선 (정상 200, 비정상 100)에 FPCA 적용</li>
<li>상위 3-5개 PC 점수로 분류 모델 학습</li>
<li>ROC curve, Confusion matrix로 성능 평가</li>
<li>어떤 PC가 정상/비정상 구분에 기여하는지 해석</li>
</ul></li>
</ul>
<p><strong>핵심 참고문헌:</strong> - Ramsay &amp; Silverman (2005), Chapter 7-8 - Yao et al.&nbsp;(2005), <em>Functional Data Analysis for Sparse Longitudinal Data</em></p>
</section>
</section>
</section>
<section id="month-2-핵심-방법론-심화" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Month 2: 핵심 방법론 심화</h1>
<section id="week-5-다변량-fpca-및-공통-주성분-14시간" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="week-5-다변량-fpca-및-공통-주성분-14시간"><span class="header-section-number">2.1</span> Week 5: 다변량 FPCA 및 공통 주성분 (14시간)</h2>
<section id="다변량-함수형-데이터" class="level3" data-number="2.1.1">
<h3 data-number="2.1.1" class="anchored" data-anchor-id="다변량-함수형-데이터"><span class="header-section-number">2.1.1</span> 다변량 함수형 데이터</h3>
<ul>
<li>2025-12-16, <a href="../2025-12-16_multivariate_fda/index.qmd">Multivariate Functional Data 개념</a>
<ul>
<li><img src="https://latex.codecogs.com/png.latex?p">개 채널의 동시 관측: <img src="https://latex.codecogs.com/png.latex?%5Cmathbf%7BX%7D(t)%20=%20%5BX_1(t),%20...,%20X_p(t)%5D%5ET"></li>
<li>RT-PCR 멀티플렉스: 5개 파장대 곡선</li>
<li>실습: 2채널 동시 시각화</li>
</ul></li>
<li>2025-12-17, <a href="../2025-12-17_mfpca/index.qmd">Multivariate FPCA (MFPCA)</a>
<ul>
<li>교차 공분산 함수: <img src="https://latex.codecogs.com/png.latex?Cov(X_i(s),%20X_j(t))"></li>
<li>공통 고유함수와 채널별 로딩</li>
<li>실습: <code>MFPCA</code> 패키지 사용</li>
</ul></li>
</ul>
</section>
<section id="형광-간섭-분석-응용" class="level3" data-number="2.1.2">
<h3 data-number="2.1.2" class="anchored" data-anchor-id="형광-간섭-분석-응용"><span class="header-section-number">2.1.2</span> 형광 간섭 분석 응용</h3>
<ul>
<li>2025-12-18, <a href="../2025-12-18_interference_mfpca/index.qmd">간섭 패턴의 MFPCA 분해</a>
<ul>
<li>공통 변동(간섭) vs 개별 변동(생물학적 신호)</li>
<li>실습: 5채널 RT-PCR 데이터에 MFPCA 적용</li>
</ul></li>
<li>2025-12-19, <a href="../2025-12-19_signal_deconvolution/index.qmd">신호 디컨볼루션 구현</a>
<ul>
<li>간섭 제거 알고리즘 설계</li>
<li>실습: 보정 전/후 SNR 비교</li>
</ul></li>
</ul>
</section>
<section id="주간-프로젝트-6시간-4" class="level3" data-number="2.1.3">
<h3 data-number="2.1.3" class="anchored" data-anchor-id="주간-프로젝트-6시간-4"><span class="header-section-number">2.1.3</span> 주간 프로젝트 (6시간)</h3>
<ul>
<li>2025-12-20~21, <a href="../2025-12-21_week5_project/index.qmd">멀티플렉스 간섭 제거 파일럿</a>
<ul>
<li>실제 5-plex RT-PCR 데이터 준비</li>
<li>MFPCA로 간섭 패턴 추출 및 제거</li>
<li>단일 채널 “순수” 신호와 비교 검증</li>
</ul></li>
</ul>
<p><strong>핵심 참고문헌:</strong> - Happ &amp; Greven (2018), <em>Multivariate Functional Principal Component Analysis</em> - Kayano &amp; Konishi (2009), <em>Sparse Functional Principal Component Analysis</em></p>
</section>
</section>
<section id="week-6-함수형-회귀-심화-및-변수-선택-14시간" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="week-6-함수형-회귀-심화-및-변수-선택-14시간"><span class="header-section-number">2.2</span> Week 6: 함수형 회귀 심화 및 변수 선택 (14시간)</h2>
<section id="정규화-및-변수-선택" class="level3" data-number="2.2.1">
<h3 data-number="2.2.1" class="anchored" data-anchor-id="정규화-및-변수-선택"><span class="header-section-number">2.2.1</span> 정규화 및 변수 선택</h3>
<ul>
<li>2025-12-23, <a href="../2025-12-23_penalized_regression/index.qmd">Ridge &amp; Lasso for Functional Regression</a>
<ul>
<li><img src="https://latex.codecogs.com/png.latex?L_2"> 페널티: Ridge regression</li>
<li><img src="https://latex.codecogs.com/png.latex?L_1"> 페널티: Lasso, 희소성(Sparsity) 유도</li>
<li>실습: 어느 사이클이 정량에 중요한지 자동 선택</li>
</ul></li>
<li>2025-12-24, <a href="../2025-12-24_group_lasso/index.qmd">Group Lasso for Functional Data</a>
<ul>
<li>기저 함수 계수를 그룹으로 페널티</li>
<li>실습: <code>refund</code> 패키지의 <code>pfr()</code> 함수</li>
</ul></li>
</ul>
</section>
<section id="비선형-함수-회귀" class="level3" data-number="2.2.2">
<h3 data-number="2.2.2" class="anchored" data-anchor-id="비선형-함수-회귀"><span class="header-section-number">2.2.2</span> 비선형 함수 회귀</h3>
<ul>
<li>2025-12-26, <a href="../2025-12-26_fgam/index.qmd">Functional Generalized Additive Models (FGAM)</a>
<ul>
<li>비선형 함수-스칼라 관계</li>
<li>Smooth 함수의 합: <img src="https://latex.codecogs.com/png.latex?Y%20=%20%5Csum_j%20s_j(%5Cint%20X(t)%5Cbeta_j(t)dt)"></li>
<li>실습: RT-PCR 곡선의 비선형 효과 모델링</li>
</ul></li>
<li>2025-12-27, <a href="../2025-12-27_functional_rf/index.qmd">Functional Random Forest</a>
<ul>
<li>FPCA 점수를 특징으로 Random Forest 학습</li>
<li>변수 중요도: 어느 PC가 가장 중요한가?</li>
<li>실습: <code>randomForest</code> + FPCA 결합</li>
</ul></li>
</ul>
</section>
<section id="주간-프로젝트-6시간-5" class="level3" data-number="2.2.3">
<h3 data-number="2.2.3" class="anchored" data-anchor-id="주간-프로젝트-6시간-5"><span class="header-section-number">2.2.3</span> 주간 프로젝트 (6시간)</h3>
<ul>
<li>2025-12-28~29, <a href="../2025-12-29_week6_project/index.qmd">증폭 효율 예측 모델 고도화</a>
<ul>
<li>비선형 효과 고려한 함수 회귀</li>
<li>변수 선택으로 핵심 사이클 구간 식별</li>
<li>교차 검증으로 일반화 성능 평가</li>
</ul></li>
</ul>
<p><strong>핵심 참고문헌:</strong> - Goldsmith et al.&nbsp;(2011), <em>Penalized Functional Regression</em> - Scheipl et al.&nbsp;(2015), <em>Functional Additive Mixed Models</em></p>
</section>
</section>
<section id="week-7-함수형-시계열-및-동적-예측-14시간" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="week-7-함수형-시계열-및-동적-예측-14시간"><span class="header-section-number">2.3</span> Week 7: 함수형 시계열 및 동적 예측 (14시간)</h2>
<section id="함수형-시계열-분석" class="level3" data-number="2.3.1">
<h3 data-number="2.3.1" class="anchored" data-anchor-id="함수형-시계열-분석"><span class="header-section-number">2.3.1</span> 함수형 시계열 분석</h3>
<ul>
<li>2025-12-30, <a href="../2025-12-30_functional_time_series/index.qmd">Functional Time Series 개념</a>
<ul>
<li>함수의 시간적 의존성: <img src="https://latex.codecogs.com/png.latex?X_t(s)"></li>
<li>RT-PCR 응용: 사이클 진행 중 실시간 예측</li>
<li>실습: 부분 곡선 시각화</li>
</ul></li>
<li>2025-12-31, <a href="../2025-12-31_far_model/index.qmd">Functional Autoregression (FAR)</a>
<ul>
<li>FAR(1) 모델: <img src="https://latex.codecogs.com/png.latex?X_t(s)%20=%20%5Cint%20%5CPsi(s,u)X_%7Bt-1%7D(u)du%20+%20%5Cepsilon_t(s)"></li>
<li>실습: 사이클 1-20 → 사이클 21-45 예측</li>
</ul></li>
</ul>
</section>
<section id="실시간-모니터링-응용" class="level3" data-number="2.3.2">
<h3 data-number="2.3.2" class="anchored" data-anchor-id="실시간-모니터링-응용"><span class="header-section-number">2.3.2</span> 실시간 모니터링 응용</h3>
<ul>
<li>2026-01-02, <a href="../2026-01-02_dynamic_fpca/index.qmd">동적 함수 주성분 분석</a>
<ul>
<li>사이클이 진행됨에 따라 업데이트되는 FPCA</li>
<li>온라인 이상치 탐지</li>
<li>실습: 사이클 15, 20, 25에서의 PC 점수 추적</li>
</ul></li>
<li>2026-01-03, <a href="../2026-01-03_early_prediction/index.qmd">조기 실패 예측 알고리즘</a>
<ul>
<li>부분 곡선으로 최종 성공/실패 예측</li>
<li>Logistic regression with partial functional predictors</li>
<li>실습: 사이클 20에서 최종 결과 예측 정확도</li>
</ul></li>
</ul>
</section>
<section id="주간-프로젝트-6시간-6" class="level3" data-number="2.3.3">
<h3 data-number="2.3.3" class="anchored" data-anchor-id="주간-프로젝트-6시간-6"><span class="header-section-number">2.3.3</span> 주간 프로젝트 (6시간)</h3>
<ul>
<li>2026-01-04~05, <a href="../2026-01-05_week7_project/index.qmd">실시간 품질 모니터링 시스템 프로토타입</a>
<ul>
<li>사이클 15, 20, 25에서 성공 확률 계산</li>
<li>정상 경로 이탈 감지 알고리즘</li>
<li>실시간 대시보드 시각화 (Shiny app)</li>
</ul></li>
</ul>
<p><strong>핵심 참고문헌:</strong> - Hörmann &amp; Kokoszka (2010), <em>Weakly Dependent Functional Data</em> - Aue et al.&nbsp;(2015), <em>Prediction in Functional Linear Regression</em></p>
</section>
</section>
<section id="week-8-함수형-anova-및-검정-14시간" class="level2" data-number="2.4">
<h2 data-number="2.4" class="anchored" data-anchor-id="week-8-함수형-anova-및-검정-14시간"><span class="header-section-number">2.4</span> Week 8: 함수형 ANOVA 및 검정 (14시간)</h2>
<section id="함수형-데이터의-검정" class="level3" data-number="2.4.1">
<h3 data-number="2.4.1" class="anchored" data-anchor-id="함수형-데이터의-검정"><span class="header-section-number">2.4.1</span> 함수형 데이터의 검정</h3>
<ul>
<li>2026-01-06, <a href="../2026-01-06_functional_testing/index.qmd">Pointwise vs Global Testing</a>
<ul>
<li>점별 검정의 다중 비교 문제</li>
<li>전역(Global) 검정: 곡선 전체가 다른가?</li>
<li>실습: 두 그룹 RT-PCR 곡선 비교</li>
</ul></li>
<li>2026-01-07, <a href="../2026-01-07_functional_anova/index.qmd">Functional ANOVA</a>
<ul>
<li><img src="https://latex.codecogs.com/png.latex?F">-통계량의 함수형 확장</li>
<li>Permutation test for functional data</li>
<li>실습: 억제제 유/무 그룹 간 곡선 차이 검정</li>
</ul></li>
</ul>
</section>
<section id="비모수적-검정" class="level3" data-number="2.4.2">
<h3 data-number="2.4.2" class="anchored" data-anchor-id="비모수적-검정"><span class="header-section-number">2.4.2</span> 비모수적 검정</h3>
<ul>
<li>2026-01-09, <a href="../2026-01-09_functional_bootstrap/index.qmd">Bootstrap for Functional Data</a>
<ul>
<li>함수형 데이터의 resampling</li>
<li>신뢰 구간 및 검정 통계량 추정</li>
<li>실습: 평균 함수의 bootstrap 신뢰 밴드</li>
</ul></li>
<li>2026-01-10, <a href="../2026-01-10_two_sample_test/index.qmd">Two-Sample Tests</a>
<ul>
<li>Hotelling’s <img src="https://latex.codecogs.com/png.latex?T%5E2"> 검정의 함수형 버전</li>
<li>L2 distance 기반 검정</li>
<li>실습: 정상 vs 억제 샘플 곡선 비교</li>
</ul></li>
</ul>
</section>
<section id="주간-프로젝트-6시간-7" class="level3" data-number="2.4.3">
<h3 data-number="2.4.3" class="anchored" data-anchor-id="주간-프로젝트-6시간-7"><span class="header-section-number">2.4.3</span> 주간 프로젝트 (6시간)</h3>
<ul>
<li>2026-01-11~12, <a href="../2026-01-12_week8_project/index.qmd">억제제 영향 정량화 연구</a>
<ul>
<li>다양한 억제제 농도별 RT-PCR 곡선 수집</li>
<li>Functional ANOVA로 농도 효과 검정</li>
<li>억제 패턴의 시각적 특성 추출 및 라이브러리 구축</li>
</ul></li>
</ul>
<p><strong>핵심 참고문헌:</strong> - Zhang (2013), <em>Hypothesis Testing in Functional Linear Models</em> - Cuevas et al.&nbsp;(2004), <em>An ANOVA Test for Functional Data</em></p>
</section>
</section>
</section>
<section id="month-3-고급-주제-및-응용-프로젝트" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Month 3: 고급 주제 및 응용 프로젝트</h1>
<section id="week-9-고급-fpca-및-희소-함수형-데이터-14시간" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="week-9-고급-fpca-및-희소-함수형-데이터-14시간"><span class="header-section-number">3.1</span> Week 9: 고급 FPCA 및 희소 함수형 데이터 (14시간)</h2>
<section id="sparse-functional-data" class="level3" data-number="3.1.1">
<h3 data-number="3.1.1" class="anchored" data-anchor-id="sparse-functional-data"><span class="header-section-number">3.1.1</span> Sparse Functional Data</h3>
<ul>
<li>2026-01-13, <a href="../2026-01-13_sparse_fda/index.qmd">Sparse &amp; Irregular Observations</a>
<ul>
<li>모든 시점에서 관측되지 않은 경우</li>
<li>PACE (Principal Analysis by Conditional Expectation) 방법</li>
<li>실습: <code>fdapace</code> 패키지 사용</li>
</ul></li>
<li>2026-01-14, <a href="../2026-01-14_sparse_fpca_app/index.qmd">Sparse FPCA Applications</a>
<ul>
<li>RT-PCR 결측 사이클 처리</li>
<li>실습: 일부 사이클 누락된 곡선 복원</li>
</ul></li>
</ul>
</section>
<section id="함수형-군집-분석" class="level3" data-number="3.1.2">
<h3 data-number="3.1.2" class="anchored" data-anchor-id="함수형-군집-분석"><span class="header-section-number">3.1.2</span> 함수형 군집 분석</h3>
<ul>
<li>2026-01-16, <a href="../2026-01-16_functional_kmeans/index.qmd">Functional K-means Clustering</a>
<ul>
<li><img src="https://latex.codecogs.com/png.latex?L_2"> 거리 기반 군집화</li>
<li>실습: RT-PCR 곡선 패턴별 자동 그룹화</li>
</ul></li>
<li>2026-01-17, <a href="../2026-01-17_model_based_clustering/index.qmd">Model-based Functional Clustering</a>
<ul>
<li>Functional mixture models</li>
<li>실습: <code>funHDDC</code> 패키지로 곡선 유형 분류</li>
</ul></li>
</ul>
</section>
<section id="주간-프로젝트-6시간-8" class="level3" data-number="3.1.3">
<h3 data-number="3.1.3" class="anchored" data-anchor-id="주간-프로젝트-6시간-8"><span class="header-section-number">3.1.3</span> 주간 프로젝트 (6시간)</h3>
<ul>
<li>2026-01-18~19, <a href="../2026-01-19_week9_project/index.qmd">비정형 곡선 자동 분류 시스템</a>
<ul>
<li>500개 RT-PCR 곡선 (정상, 지연, 플랫, 이중 증폭 등)</li>
<li>비지도 학습으로 자연스러운 그룹 발견</li>
<li>각 클러스터의 특성 해석 및 라벨링</li>
</ul></li>
</ul>
<p><strong>핵심 참고문헌:</strong> - Yao et al.&nbsp;(2005), <em>Functional Data Analysis for Sparse Longitudinal Data</em> - Jacques &amp; Preda (2014), <em>Model-based Clustering for Multivariate Functional Data</em></p>
</section>
</section>
<section id="week-10-딥러닝과-fda-결합-선택적-14시간" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="week-10-딥러닝과-fda-결합-선택적-14시간"><span class="header-section-number">3.2</span> Week 10: 딥러닝과 FDA 결합 (선택적) (14시간)</h2>
<section id="functional-neural-networks" class="level3" data-number="3.2.1">
<h3 data-number="3.2.1" class="anchored" data-anchor-id="functional-neural-networks"><span class="header-section-number">3.2.1</span> Functional Neural Networks</h3>
<ul>
<li>2026-01-20, <a href="../2026-01-20_functional_nn/index.qmd">Neural Networks for Functional Data</a>
<ul>
<li>CNN의 함수형 데이터 적용</li>
<li>1D convolution for RT-PCR curves</li>
<li>실습: Keras로 곡선 분류기 구축</li>
</ul></li>
<li>2026-01-21, <a href="../2026-01-21_functional_autoencoder/index.qmd">Functional Autoencoders</a>
<ul>
<li>비선형 차원 축소</li>
<li>FPCA vs Autoencoder 비교</li>
<li>실습: PyTorch로 RT-PCR 곡선 인코더</li>
</ul></li>
</ul>
</section>
<section id="대안-베이지안-fda-딥러닝-대신-선택-가능" class="level3" data-number="3.2.2">
<h3 data-number="3.2.2" class="anchored" data-anchor-id="대안-베이지안-fda-딥러닝-대신-선택-가능"><span class="header-section-number">3.2.2</span> 대안: 베이지안 FDA (딥러닝 대신 선택 가능)</h3>
<ul>
<li>2026-01-20, <a href="../2026-01-20_bayesian_fda/index.qmd">Bayesian Functional Regression</a>
<ul>
<li>계수 함수의 사후 분포</li>
<li>MCMC 샘플링</li>
<li>실습: <code>brms</code> 패키지 활용</li>
</ul></li>
<li>2026-01-21, <a href="../2026-01-21_gp_fda/index.qmd">Gaussian Process for Functional Data</a>
<ul>
<li>GP prior for smooth functions</li>
<li>실습: <code>GPfit</code> 패키지로 RT-PCR 곡선 모델링</li>
</ul></li>
</ul>
</section>
<section id="주간-프로젝트-6시간-9" class="level3" data-number="3.2.3">
<h3 data-number="3.2.3" class="anchored" data-anchor-id="주간-프로젝트-6시간-9"><span class="header-section-number">3.2.3</span> 주간 프로젝트 (6시간)</h3>
<ul>
<li>2026-01-23~24, <a href="../2026-01-24_week10_project/index.qmd">고급 분류 모델 벤치마크</a>
<ul>
<li>FPCA + Logistic vs CNN vs Functional Random Forest</li>
<li>성능, 해석 가능성, 계산 비용 비교</li>
<li>실전 배포 관점에서 최적 방법 선택</li>
</ul></li>
</ul>
<p><strong>핵심 참고문헌:</strong> - Wang et al.&nbsp;(2016), <em>Functional Data Analysis</em> - Rahman et al.&nbsp;(2019), <em>Deep Learning for Time Series Classification</em></p>
</section>
</section>
<section id="week-11-통합-프로젝트-i---증폭-효율-프로파일링-14시간" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="week-11-통합-프로젝트-i---증폭-효율-프로파일링-14시간"><span class="header-section-number">3.3</span> Week 11: 통합 프로젝트 I - 증폭 효율 프로파일링 (14시간)</h2>
<section id="프로젝트-설계-및-데이터-수집" class="level3" data-number="3.3.1">
<h3 data-number="3.3.1" class="anchored" data-anchor-id="프로젝트-설계-및-데이터-수집"><span class="header-section-number">3.3.1</span> 프로젝트 설계 및 데이터 수집</h3>
<ul>
<li>2026-01-27, <a href="../2026-01-27_project1_setup/index.qmd">프로젝트 목표 및 데이터 준비</a>
<ul>
<li>연구 질문 정의</li>
<li>최소 500개 다양한 RT-PCR 곡선 수집</li>
<li>데이터 품질 점검 및 전처리</li>
</ul></li>
</ul>
</section>
<section id="분석-파이프라인-구축" class="level3" data-number="3.3.2">
<h3 data-number="3.3.2" class="anchored" data-anchor-id="분석-파이프라인-구축"><span class="header-section-number">3.3.2</span> 분석 파이프라인 구축</h3>
<ul>
<li>2026-01-28~29, <a href="../2026-01-29_efficiency_estimation/index.qmd">증폭 효율 함수 추정</a>
<ul>
<li>사이클별 증폭률 계산 및 스무딩</li>
<li>FPCA로 효율 패턴 분류</li>
<li>효율 보정된 정량 알고리즘 구현</li>
</ul></li>
</ul>
</section>
<section id="성능-평가-및-검증" class="level3" data-number="3.3.3">
<h3 data-number="3.3.3" class="anchored" data-anchor-id="성능-평가-및-검증"><span class="header-section-number">3.3.3</span> 성능 평가 및 검증</h3>
<ul>
<li>2026-01-30~31, <a href="../2026-01-31_comparison/index.qmd">기존 방법과 비교 분석</a>
<ul>
<li><img src="https://latex.codecogs.com/png.latex?C_T"> 기반 vs FDA 기반 정량 정확도</li>
<li>CV (변동계수) 감소율 계산</li>
<li>통계적 유의성 검정</li>
</ul></li>
</ul>
</section>
<section id="결과-정리-및-해석" class="level3" data-number="3.3.4">
<h3 data-number="3.3.4" class="anchored" data-anchor-id="결과-정리-및-해석"><span class="header-section-number">3.3.4</span> 결과 정리 및 해석</h3>
<ul>
<li>2026-02-01~02, <a href="../2026-02-02_project1_report/index.qmd">분석 리포트 작성</a>
<ul>
<li>주요 발견 사항 정리</li>
<li>시각화: 효율 프로파일, 보정 효과</li>
<li>한계점 및 향후 연구 방향</li>
</ul></li>
</ul>
</section>
</section>
<section id="week-12-통합-프로젝트-ii---다중-복제-메타-분석-14시간" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="week-12-통합-프로젝트-ii---다중-복제-메타-분석-14시간"><span class="header-section-number">3.4</span> Week 12: 통합 프로젝트 II - 다중 복제 메타 분석 (14시간)</h2>
<section id="프로젝트-설계" class="level3" data-number="3.4.1">
<h3 data-number="3.4.1" class="anchored" data-anchor-id="프로젝트-설계"><span class="header-section-number">3.4.1</span> 프로젝트 설계</h3>
<ul>
<li>2026-02-03, <a href="../2026-02-03_project2_setup/index.qmd">연구 설계 및 데이터 구조</a>
<ul>
<li>기술적 복제 3-5개씩 100개 샘플</li>
<li>복제 품질 평가 메트릭 정의</li>
</ul></li>
</ul>
</section>
<section id="곡선-정렬-및-통합" class="level3" data-number="3.4.2">
<h3 data-number="3.4.2" class="anchored" data-anchor-id="곡선-정렬-및-통합"><span class="header-section-number">3.4.2</span> 곡선 정렬 및 통합</h3>
<ul>
<li>2026-02-04~05, <a href="../2026-02-05_registration_project/index.qmd">Registration 및 변동성 분해</a>
<ul>
<li>Landmark vs Continuous registration 비교</li>
<li>Amplitude vs Phase variation 정량화</li>
<li>통합 대표 곡선 생성</li>
</ul></li>
</ul>
</section>
<section id="품질-스코어-시스템-개발" class="level3" data-number="3.4.3">
<h3 data-number="3.4.3" class="anchored" data-anchor-id="품질-스코어-시스템-개발"><span class="header-section-number">3.4.3</span> 품질 스코어 시스템 개발</h3>
<ul>
<li>2026-02-06~07, <a href="../2026-02-07_quality_score/index.qmd">Replication Quality Score</a>
<ul>
<li>함수적 일치도 측정 알고리즘</li>
<li>0-100점 스코어링 시스템</li>
<li>임계값 설정 (재실험 기준)</li>
</ul></li>
</ul>
</section>
<section id="최종-결과-및-발표-자료" class="level3" data-number="3.4.4">
<h3 data-number="3.4.4" class="anchored" data-anchor-id="최종-결과-및-발표-자료"><span class="header-section-number">3.4.4</span> 최종 결과 및 발표 자료</h3>
<ul>
<li>2026-02-08~09, <a href="../2026-02-09_final_presentation/index.qmd">프로젝트 완성 및 프레젠테이션</a>
<ul>
<li>두 프로젝트 통합 요약</li>
<li>비즈니스 임팩트 정량화</li>
<li>향후 배포 계획 수립</li>
</ul></li>
</ul>
</section>
</section>
</section>
<section id="보충-자료-및-도구" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> 보충 자료 및 도구</h1>
<section id="필수-소프트웨어-및-패키지" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="필수-소프트웨어-및-패키지"><span class="header-section-number">4.1</span> 필수 소프트웨어 및 패키지</h2>
<section id="r-패키지" class="level3" data-number="4.1.1">
<h3 data-number="4.1.1" class="anchored" data-anchor-id="r-패키지"><span class="header-section-number">4.1.1</span> R 패키지</h3>
<ul>
<li><code>fda</code>: 기본 FDA 기능</li>
<li><code>refund</code>: 함수형 회귀</li>
<li><code>fdapace</code>: Sparse functional data</li>
<li><code>fdasrvf</code>: Registration</li>
<li><code>funHDDC</code>: 함수형 군집화</li>
<li><code>MFPCA</code>: 다변량 FPCA</li>
</ul>
</section>
<section id="python-패키지" class="level3" data-number="4.1.2">
<h3 data-number="4.1.2" class="anchored" data-anchor-id="python-패키지"><span class="header-section-number">4.1.2</span> Python 패키지</h3>
<ul>
<li><code>scikit-fda</code>: FDA in Python</li>
<li><code>sktime</code>: 시계열 및 함수형 데이터</li>
<li><code>PyTorch/Keras</code>: 딥러닝 (선택적)</li>
</ul>
</section>
</section>
<section id="핵심-참고-도서" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="핵심-참고-도서"><span class="header-section-number">4.2</span> 핵심 참고 도서</h2>
<ol type="1">
<li><strong>Ramsay &amp; Silverman (2005)</strong>, <em>Functional Data Analysis (2nd ed.)</em>
<ul>
<li>FDA의 바이블, 이론과 응용 모두 포괄</li>
</ul></li>
<li><strong>Kokoszka &amp; Reimherr (2017)</strong>, <em>Introduction to Functional Data Analysis</em>
<ul>
<li>현대적 관점, 실습 중심</li>
</ul></li>
<li><strong>Hsing &amp; Eubank (2015)</strong>, <em>Theoretical Foundations of Functional Data Analysis</em>
<ul>
<li>수학적 엄밀성 (선택적 심화)</li>
</ul></li>
</ol>
</section>
<section id="온라인-자료" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="온라인-자료"><span class="header-section-number">4.3</span> 온라인 자료</h2>
<ul>
<li><a href="https://www.psych.mcgill.ca/misc/fda/">FDA with R Tutorial</a></li>
<li><a href="https://www.coursera.org/learn/functional-data-analysis">Coursera: Functional Data Analysis</a></li>
<li><a href="https://github.com/functionaldata">GitHub: FDA Examples</a></li>
</ul>
</section>
</section>
<section id="학습-점검-체크리스트" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> 학습 점검 체크리스트</h1>
<section id="month-1-종료-시점" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="month-1-종료-시점"><span class="header-section-number">5.1</span> Month 1 종료 시점</h2>
<ul class="task-list">
<li><label><input type="checkbox">RT-PCR 곡선을 B-spline으로 스무딩할 수 있다</label></li>
<li><label><input type="checkbox">함수적 평균, 공분산을 계산하고 시각화할 수 있다</label></li>
<li><label><input type="checkbox">FPCA를 수행하고 주성분을 해석할 수 있다</label></li>
<li><label><input type="checkbox">곡선을 정렬(registration)하고 그 효과를 설명할 수 있다</label></li>
</ul>
</section>
<section id="month-2-종료-시점" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="month-2-종료-시점"><span class="header-section-number">5.2</span> Month 2 종료 시점</h2>
<ul class="task-list">
<li><label><input type="checkbox">함수-스칼라 회귀 모델을 구축하고 <img src="https://latex.codecogs.com/png.latex?%5Cbeta(t)">를 해석할 수 있다</label></li>
<li><label><input type="checkbox">다변량 FPCA로 멀티플렉스 데이터를 분석할 수 있다</label></li>
<li><label><input type="checkbox">부분 곡선으로 최종 결과를 예측할 수 있다</label></li>
<li><label><input type="checkbox">Functional ANOVA로 그룹 간 차이를 검정할 수 있다</label></li>
</ul>
</section>
<section id="month-3-종료-시점" class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="month-3-종료-시점"><span class="header-section-number">5.3</span> Month 3 종료 시점</h2>
<ul class="task-list">
<li><label><input type="checkbox">증폭 효율 프로파일링 파이프라인을 구축했다</label></li>
<li><label><input type="checkbox">다중 복제 메타 분석 시스템을 개발했다</label></li>
<li><label><input type="checkbox">기존 방법 대비 정량적 개선을 입증했다</label></li>
<li><label><input type="checkbox">FDA 지식을 실제 RT-PCR 문제에 적용할 수 있다</label></li>
</ul>
</section>
</section>
<section id="성공을-위한-tips" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> 성공을 위한 Tips</h1>
<section id="이론과-실습의-균형" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="이론과-실습의-균형"><span class="header-section-number">6.1</span> 이론과 실습의 균형</h2>
<ul>
<li>매일 1시간 이론 학습 → 1시간 코딩 실습</li>
<li>이론만 보지 말고 <strong>반드시 손으로 구현</strong></li>
</ul>
</section>
<section id="점진적-난이도-상승" class="level2" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="점진적-난이도-상승"><span class="header-section-number">6.2</span> 점진적 난이도 상승</h2>
<ul>
<li>처음부터 완벽하게 이해하려 하지 말 것</li>
<li>개념의 80%만 이해하고 다음으로 진행</li>
<li>나중에 돌아와서 깊이 있게 재학습</li>
</ul>
</section>
<section id="실제-데이터-중심" class="level2" data-number="6.3">
<h2 data-number="6.3" class="anchored" data-anchor-id="실제-데이터-중심"><span class="header-section-number">6.3</span> 실제 데이터 중심</h2>
<ul>
<li>가능한 한 빨리 실제 RT-PCR 데이터 확보</li>
<li>모든 이론을 RT-PCR 맥락에서 재해석</li>
<li>“이게 우리 문제에 왜 필요한가?” 항상 자문</li>
</ul>
</section>
<section id="커뮤니티-활용" class="level2" data-number="6.4">
<h2 data-number="6.4" class="anchored" data-anchor-id="커뮤니티-활용"><span class="header-section-number">6.4</span> 커뮤니티 활용</h2>
<ul>
<li>R-help, Cross Validated (Stack Exchange) 적극 활용</li>
<li>FDA 관련 논문의 코드 저장소 탐색</li>
<li>막히면 24시간 이상 혼자 고민하지 말고 질문</li>
</ul>
</section>
<section id="문서화-습관" class="level2" data-number="6.5">
<h2 data-number="6.5" class="anchored" data-anchor-id="문서화-습관"><span class="header-section-number">6.5</span> 문서화 습관</h2>
<ul>
<li>모든 분석을 Quarto/R Markdown으로 기록</li>
<li>나중에 블로그 포스트로 변환 가능</li>
<li>“미래의 나”를 위한 설명 작성</li>
</ul>
<p><strong>3개월 후, 당신은 RT-PCR FDA 전문가가 되어 있을 것입니다!</strong> ```</p>


</section>
</section>

 ]]></description>
  <category>Statistics</category>
  <category>Functional Data Analysis</category>
  <category>Time Series</category>
  <guid>kk3225.netlify.app/docs/blog/posts/Statistics/FDA/</guid>
  <pubDate>Fri, 14 Nov 2025 15:00:00 GMT</pubDate>
</item>
<item>
  <title>End-to-End Azure RAG</title>
  <dc:creator>Kwangmin Kim</dc:creator>
  <link>kk3225.netlify.app/docs/blog/posts/Agent/13-Cloud-RAG/09-End-to-End-Azure-RAG.html</link>
  <description><![CDATA[ 





<section id="전체-아키텍처" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="전체-아키텍처"><span class="header-section-number">1</span> 전체 아키텍처</h2>
<p>지금까지 학습한 Azure RAG 컴포넌트를 통합한 엔터프라이즈 아키텍처다.</p>
<section id="시스템-구성도" class="level3" data-number="1.1">
<h3 data-number="1.1" class="anchored" data-anchor-id="시스템-구성도"><span class="header-section-number">1.1</span> 시스템 구성도</h3>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode numberSource mermaid number-lines code-with-copy"><code class="sourceCode"><span id="cb1-1">graph TB</span>
<span id="cb1-2">    subgraph "Data Ingestion"</span>
<span id="cb1-3">        A[Document Upload] --&gt; B[Azure Blob Storage]</span>
<span id="cb1-4">        B --&gt; C[Document Intelligence]</span>
<span id="cb1-5">        C --&gt; D[Text Extraction]</span>
<span id="cb1-6">    end</span>
<span id="cb1-7">    </span>
<span id="cb1-8">    subgraph "Embedding &amp; Indexing"</span>
<span id="cb1-9">        D --&gt; E[Azure OpenAI Embeddings]</span>
<span id="cb1-10">        E --&gt; F[Azure AI Search]</span>
<span id="cb1-11">        F --&gt; G[Vector Store]</span>
<span id="cb1-12">    end</span>
<span id="cb1-13">    </span>
<span id="cb1-14">    subgraph "RAG Engine"</span>
<span id="cb1-15">        H[User Query] --&gt; I[Query Embeddings]</span>
<span id="cb1-16">        I --&gt; J[Retriever]</span>
<span id="cb1-17">        J --&gt; K[LangGraph Workflow]</span>
<span id="cb1-18">        K --&gt; L[Azure OpenAI GPT-4o]</span>
<span id="cb1-19">        L --&gt; M[Response]</span>
<span id="cb1-20">    end</span>
<span id="cb1-21">    </span>
<span id="cb1-22">    subgraph "Deployment"</span>
<span id="cb1-23">        N[Azure Functions] --&gt; O[API Gateway]</span>
<span id="cb1-24">        P[Azure Container Apps] --&gt; O</span>
<span id="cb1-25">        O --&gt; Q[Application Gateway]</span>
<span id="cb1-26">    end</span>
<span id="cb1-27">    </span>
<span id="cb1-28">    subgraph "Monitoring"</span>
<span id="cb1-29">        R[Application Insights]</span>
<span id="cb1-30">        S[Log Analytics]</span>
<span id="cb1-31">        T[Azure Monitor]</span>
<span id="cb1-32">    end</span>
<span id="cb1-33">    </span>
<span id="cb1-34">    G --&gt; J</span>
<span id="cb1-35">    M --&gt; O</span>
<span id="cb1-36">    O --&gt; R</span>
<span id="cb1-37">    O --&gt; S</span>
<span id="cb1-38">    N --&gt; T</span>
<span id="cb1-39">    P --&gt; T</span></code></pre></div>
</section>
<section id="핵심-컴포넌트" class="level3" data-number="1.2">
<h3 data-number="1.2" class="anchored" data-anchor-id="핵심-컴포넌트"><span class="header-section-number">1.2</span> 핵심 컴포넌트</h3>
<table class="table">
<thead>
<tr class="header">
<th>계층</th>
<th>Azure 서비스</th>
<th>역할</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>저장소</strong></td>
<td>Blob Storage</td>
<td>원본 문서 저장</td>
</tr>
<tr class="even">
<td><strong>전처리</strong></td>
<td>Document Intelligence</td>
<td>OCR, 레이아웃 분석</td>
</tr>
<tr class="odd">
<td><strong>임베딩</strong></td>
<td>Azure OpenAI (Embeddings)</td>
<td>텍스트 → 벡터 변환</td>
</tr>
<tr class="even">
<td><strong>검색</strong></td>
<td>Azure AI Search</td>
<td>벡터 저장 및 검색</td>
</tr>
<tr class="odd">
<td><strong>RAG</strong></td>
<td>LangGraph</td>
<td>검색-생성 워크플로우</td>
</tr>
<tr class="even">
<td><strong>LLM</strong></td>
<td>Azure OpenAI (GPT-4o)</td>
<td>답변 생성</td>
</tr>
<tr class="odd">
<td><strong>배포</strong></td>
<td>Functions/Container Apps</td>
<td>API 서빙</td>
</tr>
<tr class="even">
<td><strong>모니터링</strong></td>
<td>Application Insights</td>
<td>로그, 메트릭, 추적</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="인프라-구성" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="인프라-구성"><span class="header-section-number">2</span> 인프라 구성</h2>
<section id="전체-리소스-배포" class="level3" data-number="2.1">
<h3 data-number="2.1" class="anchored" data-anchor-id="전체-리소스-배포"><span class="header-section-number">2.1</span> 전체 리소스 배포</h3>
<p><strong>deploy.bicep:</strong></p>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode numberSource bicep number-lines code-with-copy"><code class="sourceCode"><span id="cb2-1">param location string = resourceGroup().location</span>
<span id="cb2-2">param projectName string = 'rag-prod'</span>
<span id="cb2-3"></span>
<span id="cb2-4">// Storage Account</span>
<span id="cb2-5">resource storageAccount 'Microsoft.Storage/storageAccounts@2023-01-01' = {</span>
<span id="cb2-6">  name: 'st${projectName}'</span>
<span id="cb2-7">  location: location</span>
<span id="cb2-8">  sku: {</span>
<span id="cb2-9">    name: 'Standard_LRS'</span>
<span id="cb2-10">  }</span>
<span id="cb2-11">  kind: 'StorageV2'</span>
<span id="cb2-12">  properties: {</span>
<span id="cb2-13">    accessTier: 'Hot'</span>
<span id="cb2-14">    supportsHttpsTrafficOnly: true</span>
<span id="cb2-15">    minimumTlsVersion: 'TLS1_2'</span>
<span id="cb2-16">  }</span>
<span id="cb2-17">}</span>
<span id="cb2-18"></span>
<span id="cb2-19">// Document Intelligence</span>
<span id="cb2-20">resource documentIntelligence 'Microsoft.CognitiveServices/accounts@2023-05-01' = {</span>
<span id="cb2-21">  name: 'di-${projectName}'</span>
<span id="cb2-22">  location: location</span>
<span id="cb2-23">  sku: {</span>
<span id="cb2-24">    name: 'S0'</span>
<span id="cb2-25">  }</span>
<span id="cb2-26">  kind: 'FormRecognizer'</span>
<span id="cb2-27">  properties: {</span>
<span id="cb2-28">    customSubDomainName: 'di-${projectName}'</span>
<span id="cb2-29">    publicNetworkAccess: 'Enabled'</span>
<span id="cb2-30">  }</span>
<span id="cb2-31">}</span>
<span id="cb2-32"></span>
<span id="cb2-33">// Azure OpenAI</span>
<span id="cb2-34">resource openai 'Microsoft.CognitiveServices/accounts@2023-05-01' = {</span>
<span id="cb2-35">  name: 'openai-${projectName}'</span>
<span id="cb2-36">  location: location</span>
<span id="cb2-37">  sku: {</span>
<span id="cb2-38">    name: 'S0'</span>
<span id="cb2-39">  }</span>
<span id="cb2-40">  kind: 'OpenAI'</span>
<span id="cb2-41">  properties: {</span>
<span id="cb2-42">    customSubDomainName: 'openai-${projectName}'</span>
<span id="cb2-43">    publicNetworkAccess: 'Enabled'</span>
<span id="cb2-44">  }</span>
<span id="cb2-45">}</span>
<span id="cb2-46"></span>
<span id="cb2-47">// Azure AI Search</span>
<span id="cb2-48">resource search 'Microsoft.Search/searchServices@2023-11-01' = {</span>
<span id="cb2-49">  name: 'search-${projectName}'</span>
<span id="cb2-50">  location: location</span>
<span id="cb2-51">  sku: {</span>
<span id="cb2-52">    name: 'standard'</span>
<span id="cb2-53">  }</span>
<span id="cb2-54">  properties: {</span>
<span id="cb2-55">    replicaCount: 1</span>
<span id="cb2-56">    partitionCount: 1</span>
<span id="cb2-57">    hostingMode: 'default'</span>
<span id="cb2-58">  }</span>
<span id="cb2-59">}</span>
<span id="cb2-60"></span>
<span id="cb2-61">// Container Apps Environment</span>
<span id="cb2-62">resource containerAppEnv 'Microsoft.App/managedEnvironments@2023-05-01' = {</span>
<span id="cb2-63">  name: 'cae-${projectName}'</span>
<span id="cb2-64">  location: location</span>
<span id="cb2-65">  properties: {</span>
<span id="cb2-66">    appLogsConfiguration: {</span>
<span id="cb2-67">      destination: 'log-analytics'</span>
<span id="cb2-68">      logAnalyticsConfiguration: {</span>
<span id="cb2-69">        customerId: logAnalytics.properties.customerId</span>
<span id="cb2-70">        sharedKey: logAnalytics.listKeys().primarySharedKey</span>
<span id="cb2-71">      }</span>
<span id="cb2-72">    }</span>
<span id="cb2-73">  }</span>
<span id="cb2-74">}</span>
<span id="cb2-75"></span>
<span id="cb2-76">// Log Analytics</span>
<span id="cb2-77">resource logAnalytics 'Microsoft.OperationalInsights/workspaces@2022-10-01' = {</span>
<span id="cb2-78">  name: 'law-${projectName}'</span>
<span id="cb2-79">  location: location</span>
<span id="cb2-80">  properties: {</span>
<span id="cb2-81">    sku: {</span>
<span id="cb2-82">      name: 'PerGB2018'</span>
<span id="cb2-83">    }</span>
<span id="cb2-84">    retentionInDays: 30</span>
<span id="cb2-85">  }</span>
<span id="cb2-86">}</span>
<span id="cb2-87"></span>
<span id="cb2-88">// Application Insights</span>
<span id="cb2-89">resource appInsights 'Microsoft.Insights/components@2020-02-02' = {</span>
<span id="cb2-90">  name: 'appi-${projectName}'</span>
<span id="cb2-91">  location: location</span>
<span id="cb2-92">  kind: 'web'</span>
<span id="cb2-93">  properties: {</span>
<span id="cb2-94">    Application_Type: 'web'</span>
<span id="cb2-95">    WorkspaceResourceId: logAnalytics.id</span>
<span id="cb2-96">  }</span>
<span id="cb2-97">}</span>
<span id="cb2-98"></span>
<span id="cb2-99">// Container Registry</span>
<span id="cb2-100">resource containerRegistry 'Microsoft.ContainerRegistry/registries@2023-07-01' = {</span>
<span id="cb2-101">  name: 'acr${projectName}'</span>
<span id="cb2-102">  location: location</span>
<span id="cb2-103">  sku: {</span>
<span id="cb2-104">    name: 'Basic'</span>
<span id="cb2-105">  }</span>
<span id="cb2-106">  properties: {</span>
<span id="cb2-107">    adminUserEnabled: true</span>
<span id="cb2-108">  }</span>
<span id="cb2-109">}</span>
<span id="cb2-110"></span>
<span id="cb2-111">output storageAccountName string = storageAccount.name</span>
<span id="cb2-112">output documentIntelligenceEndpoint string = documentIntelligence.properties.endpoint</span>
<span id="cb2-113">output openaiEndpoint string = openai.properties.endpoint</span>
<span id="cb2-114">output searchEndpoint string = search.properties.endpoint</span>
<span id="cb2-115">output containerRegistryName string = containerRegistry.name</span>
<span id="cb2-116">output appInsightsConnectionString string = appInsights.properties.ConnectionString</span></code></pre></div>
</section>
<section id="배포-실행" class="level3" data-number="2.2">
<h3 data-number="2.2" class="anchored" data-anchor-id="배포-실행"><span class="header-section-number">2.2</span> 배포 실행</h3>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 리소스 그룹 생성</span></span>
<span id="cb3-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">az</span> group create <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--name</span> rg-rag-prod <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--location</span> koreacentral</span>
<span id="cb3-3"></span>
<span id="cb3-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Bicep 배포</span></span>
<span id="cb3-5"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">az</span> deployment group create <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-6">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--resource-group</span> rg-rag-prod <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-7">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--template-file</span> deploy.bicep <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-8">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--parameters</span> projectName=ragprod</span>
<span id="cb3-9"></span>
<span id="cb3-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 배포 출력 확인</span></span>
<span id="cb3-11"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">az</span> deployment group show <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-12">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--resource-group</span> rg-rag-prod <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-13">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--name</span> deploy <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb3-14">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--query</span> properties.outputs</span></code></pre></div>
</section>
<section id="환경-변수-통합-관리" class="level3" data-number="2.3">
<h3 data-number="2.3" class="anchored" data-anchor-id="환경-변수-통합-관리"><span class="header-section-number">2.3</span> 환경 변수 통합 관리</h3>
<p><strong>.env:</strong></p>
<div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb4-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Storage</span></span>
<span id="cb4-2"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">AZURE_STORAGE_CONNECTION_STRING</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"DefaultEndpointsProtocol=https;AccountName=stragprod;..."</span></span>
<span id="cb4-3"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">AZURE_STORAGE_CONTAINER</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"documents"</span></span>
<span id="cb4-4"></span>
<span id="cb4-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Document Intelligence</span></span>
<span id="cb4-6"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">AZURE_DOCUMENT_INTELLIGENCE_ENDPOINT</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://di-ragprod.cognitiveservices.azure.com/"</span></span>
<span id="cb4-7"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">AZURE_DOCUMENT_INTELLIGENCE_KEY</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"your-key"</span></span>
<span id="cb4-8"></span>
<span id="cb4-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Azure OpenAI</span></span>
<span id="cb4-10"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">AZURE_OPENAI_ENDPOINT</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://openai-ragprod.openai.azure.com/"</span></span>
<span id="cb4-11"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">AZURE_OPENAI_API_KEY</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"your-key"</span></span>
<span id="cb4-12"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">AZURE_OPENAI_DEPLOYMENT_EMBEDDINGS</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"text-embedding-3-small"</span></span>
<span id="cb4-13"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">AZURE_OPENAI_DEPLOYMENT_LLM</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gpt-4o"</span></span>
<span id="cb4-14"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">AZURE_OPENAI_API_VERSION</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"2024-02-01"</span></span>
<span id="cb4-15"></span>
<span id="cb4-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Azure AI Search</span></span>
<span id="cb4-17"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">AZURE_SEARCH_ENDPOINT</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://search-ragprod.search.windows.net"</span></span>
<span id="cb4-18"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">AZURE_SEARCH_API_KEY</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"your-key"</span></span>
<span id="cb4-19"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">AZURE_SEARCH_INDEX_NAME</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"rag-documents"</span></span>
<span id="cb4-20"></span>
<span id="cb4-21"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Application Insights</span></span>
<span id="cb4-22"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">APPLICATIONINSIGHTS_CONNECTION_STRING</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"InstrumentationKey=..."</span></span>
<span id="cb4-23"></span>
<span id="cb4-24"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># API Configuration</span></span>
<span id="cb4-25"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">API_RATE_LIMIT</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>100</span>
<span id="cb4-26"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">API_TIMEOUT</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>300</span>
<span id="cb4-27"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">MAX_TOKENS</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>1000</span></code></pre></div>
</section>
</section>
<section id="데이터-파이프라인" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="데이터-파이프라인"><span class="header-section-number">3</span> 데이터 파이프라인</h2>
<section id="문서-처리-워크플로우" class="level3" data-number="3.1">
<h3 data-number="3.1" class="anchored" data-anchor-id="문서-처리-워크플로우"><span class="header-section-number">3.1</span> 문서 처리 워크플로우</h3>
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb5-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> os</span>
<span id="cb5-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> azure.storage.blob <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> BlobServiceClient</span>
<span id="cb5-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> azure.ai.formrecognizer <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> DocumentAnalysisClient</span>
<span id="cb5-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> azure.core.credentials <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> AzureKeyCredential</span>
<span id="cb5-5"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> langchain_openai <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> AzureOpenAIEmbeddings</span>
<span id="cb5-6"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> langchain_community.vectorstores.azuresearch <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> AzureSearch</span>
<span id="cb5-7"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> langchain_text_splitters <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> RecursiveCharacterTextSplitter</span>
<span id="cb5-8"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> logging</span>
<span id="cb5-9"></span>
<span id="cb5-10"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">class</span> DocumentProcessor:</span>
<span id="cb5-11">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""엔드투엔드 문서 처리 파이프라인"""</span></span>
<span id="cb5-12">    </span>
<span id="cb5-13">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__init__</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>):</span>
<span id="cb5-14">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Blob Storage</span></span>
<span id="cb5-15">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.blob_client <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> BlobServiceClient.from_connection_string(</span>
<span id="cb5-16">            os.getenv(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"AZURE_STORAGE_CONNECTION_STRING"</span>)</span>
<span id="cb5-17">        )</span>
<span id="cb5-18">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.container_name <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> os.getenv(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"AZURE_STORAGE_CONTAINER"</span>)</span>
<span id="cb5-19">        </span>
<span id="cb5-20">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Document Intelligence</span></span>
<span id="cb5-21">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.doc_intelligence <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> DocumentAnalysisClient(</span>
<span id="cb5-22">            endpoint<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>os.getenv(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"AZURE_DOCUMENT_INTELLIGENCE_ENDPOINT"</span>),</span>
<span id="cb5-23">            credential<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>AzureKeyCredential(os.getenv(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"AZURE_DOCUMENT_INTELLIGENCE_KEY"</span>))</span>
<span id="cb5-24">        )</span>
<span id="cb5-25">        </span>
<span id="cb5-26">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Embeddings</span></span>
<span id="cb5-27">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.embeddings <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> AzureOpenAIEmbeddings(</span>
<span id="cb5-28">            azure_deployment<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>os.getenv(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"AZURE_OPENAI_DEPLOYMENT_EMBEDDINGS"</span>),</span>
<span id="cb5-29">            openai_api_version<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>os.getenv(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"AZURE_OPENAI_API_VERSION"</span>),</span>
<span id="cb5-30">            azure_endpoint<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>os.getenv(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"AZURE_OPENAI_ENDPOINT"</span>),</span>
<span id="cb5-31">            api_key<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>os.getenv(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"AZURE_OPENAI_API_KEY"</span>)</span>
<span id="cb5-32">        )</span>
<span id="cb5-33">        </span>
<span id="cb5-34">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Vector Store</span></span>
<span id="cb5-35">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.vector_store <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> AzureSearch(</span>
<span id="cb5-36">            azure_search_endpoint<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>os.getenv(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"AZURE_SEARCH_ENDPOINT"</span>),</span>
<span id="cb5-37">            azure_search_key<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>os.getenv(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"AZURE_SEARCH_API_KEY"</span>),</span>
<span id="cb5-38">            index_name<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>os.getenv(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"AZURE_SEARCH_INDEX_NAME"</span>),</span>
<span id="cb5-39">            embedding_function<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.embeddings.embed_query</span>
<span id="cb5-40">        )</span>
<span id="cb5-41">        </span>
<span id="cb5-42">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Text Splitter</span></span>
<span id="cb5-43">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.text_splitter <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> RecursiveCharacterTextSplitter(</span>
<span id="cb5-44">            chunk_size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>,</span>
<span id="cb5-45">            chunk_overlap<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">200</span>,</span>
<span id="cb5-46">            length_function<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span></span>
<span id="cb5-47">        )</span>
<span id="cb5-48">        </span>
<span id="cb5-49">        logging.info(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"문서 처리 파이프라인 초기화 완료"</span>)</span>
<span id="cb5-50">    </span>
<span id="cb5-51">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> process_document(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, blob_name: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dict</span>:</span>
<span id="cb5-52">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""단일 문서 처리"""</span></span>
<span id="cb5-53">        logging.info(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"문서 처리 시작: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>blob_name<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb5-54">        </span>
<span id="cb5-55">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 1. Blob에서 문서 다운로드</span></span>
<span id="cb5-56">        blob_client <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.blob_client.get_blob_client(</span>
<span id="cb5-57">            container<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.container_name,</span>
<span id="cb5-58">            blob<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>blob_name</span>
<span id="cb5-59">        )</span>
<span id="cb5-60">        blob_data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> blob_client.download_blob().readall()</span>
<span id="cb5-61">        </span>
<span id="cb5-62">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 2. Document Intelligence로 텍스트 추출</span></span>
<span id="cb5-63">        poller <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.doc_intelligence.begin_analyze_document(</span>
<span id="cb5-64">            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"prebuilt-document"</span>,</span>
<span id="cb5-65">            document<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>blob_data</span>
<span id="cb5-66">        )</span>
<span id="cb5-67">        result <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> poller.result()</span>
<span id="cb5-68">        </span>
<span id="cb5-69">        extracted_text <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span></span>
<span id="cb5-70">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> page <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> result.pages:</span>
<span id="cb5-71">            <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> line <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> page.lines:</span>
<span id="cb5-72">                extracted_text <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> line.content <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb5-73">        </span>
<span id="cb5-74">        logging.info(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"텍스트 추출 완료: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(extracted_text)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> 문자"</span>)</span>
<span id="cb5-75">        </span>
<span id="cb5-76">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 3. 텍스트 분할</span></span>
<span id="cb5-77">        chunks <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.text_splitter.split_text(extracted_text)</span>
<span id="cb5-78">        logging.info(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"청크 생성: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(chunks)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">개"</span>)</span>
<span id="cb5-79">        </span>
<span id="cb5-80">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 4. 메타데이터 생성</span></span>
<span id="cb5-81">        <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> langchain_core.documents <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Document</span>
<span id="cb5-82">        documents <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb5-83">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> i, chunk <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">enumerate</span>(chunks):</span>
<span id="cb5-84">            doc <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Document(</span>
<span id="cb5-85">                page_content<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>chunk,</span>
<span id="cb5-86">                metadata<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>{</span>
<span id="cb5-87">                    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"source"</span>: blob_name,</span>
<span id="cb5-88">                    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"chunk_id"</span>: i,</span>
<span id="cb5-89">                    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"total_chunks"</span>: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(chunks),</span>
<span id="cb5-90">                    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"blob_url"</span>: blob_client.url</span>
<span id="cb5-91">                }</span>
<span id="cb5-92">            )</span>
<span id="cb5-93">            documents.append(doc)</span>
<span id="cb5-94">        </span>
<span id="cb5-95">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 5. 벡터 저장소에 업로드</span></span>
<span id="cb5-96">        ids <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.vector_store.add_documents(documents)</span>
<span id="cb5-97">        logging.info(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"벡터 저장 완료: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(ids)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">개 문서"</span>)</span>
<span id="cb5-98">        </span>
<span id="cb5-99">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> {</span>
<span id="cb5-100">            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"blob_name"</span>: blob_name,</span>
<span id="cb5-101">            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"chunks"</span>: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(chunks),</span>
<span id="cb5-102">            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"vector_ids"</span>: ids,</span>
<span id="cb5-103">            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"status"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"success"</span></span>
<span id="cb5-104">        }</span>
<span id="cb5-105">    </span>
<span id="cb5-106">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> process_all_documents(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>):</span>
<span id="cb5-107">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""컨테이너의 모든 문서 처리"""</span></span>
<span id="cb5-108">        container_client <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.blob_client.get_container_client(</span>
<span id="cb5-109">            <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.container_name</span>
<span id="cb5-110">        )</span>
<span id="cb5-111">        </span>
<span id="cb5-112">        results <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb5-113">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> blob <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> container_client.list_blobs():</span>
<span id="cb5-114">            <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">try</span>:</span>
<span id="cb5-115">                result <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.process_document(blob.name)</span>
<span id="cb5-116">                results.append(result)</span>
<span id="cb5-117">            <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">except</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">Exception</span> <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> e:</span>
<span id="cb5-118">                logging.error(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"문서 처리 실패 (</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>blob<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>name<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">): </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>(e)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb5-119">                results.append({</span>
<span id="cb5-120">                    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"blob_name"</span>: blob.name,</span>
<span id="cb5-121">                    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"status"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"failed"</span>,</span>
<span id="cb5-122">                    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"error"</span>: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>(e)</span>
<span id="cb5-123">                })</span>
<span id="cb5-124">        </span>
<span id="cb5-125">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> results</span></code></pre></div>
</section>
<section id="batch-처리-azure-functions" class="level3" data-number="3.2">
<h3 data-number="3.2" class="anchored" data-anchor-id="batch-처리-azure-functions"><span class="header-section-number">3.2</span> Batch 처리 (Azure Functions)</h3>
<p><strong>function_app.py:</strong></p>
<div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb6-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> azure.functions <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> func</span>
<span id="cb6-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> logging</span>
<span id="cb6-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> document_processor <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> DocumentProcessor</span>
<span id="cb6-4"></span>
<span id="cb6-5">app <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> func.FunctionApp()</span>
<span id="cb6-6"></span>
<span id="cb6-7"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">@app.blob_trigger</span>(</span>
<span id="cb6-8">    arg_name<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"myblob"</span>,</span>
<span id="cb6-9">    path<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"documents/</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{name}</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>,</span>
<span id="cb6-10">    connection<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"AzureWebJobsStorage"</span></span>
<span id="cb6-11">)</span>
<span id="cb6-12"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> blob_trigger_process(myblob: func.InputStream):</span>
<span id="cb6-13">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""Blob 업로드 시 자동 처리"""</span></span>
<span id="cb6-14">    logging.info(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"새 문서 감지: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>myblob<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>name<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb6-15">    </span>
<span id="cb6-16">    processor <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> DocumentProcessor()</span>
<span id="cb6-17">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">try</span>:</span>
<span id="cb6-18">        result <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> processor.process_document(myblob.name)</span>
<span id="cb6-19">        logging.info(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"처리 완료: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>result<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb6-20">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">except</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">Exception</span> <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> e:</span>
<span id="cb6-21">        logging.error(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"처리 실패: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>(e)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb6-22">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">raise</span></span>
<span id="cb6-23"></span>
<span id="cb6-24"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">@app.timer_trigger</span>(</span>
<span id="cb6-25">    arg_name<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"timer"</span>,</span>
<span id="cb6-26">    schedule<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"0 0 2 * * *"</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 매일 새벽 2시</span></span>
<span id="cb6-27">)</span>
<span id="cb6-28"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> scheduled_reindex(timer: func.TimerRequest):</span>
<span id="cb6-29">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""정기적인 재색인"""</span></span>
<span id="cb6-30">    logging.info(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"정기 재색인 시작"</span>)</span>
<span id="cb6-31">    </span>
<span id="cb6-32">    processor <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> DocumentProcessor()</span>
<span id="cb6-33">    results <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> processor.process_all_documents()</span>
<span id="cb6-34">    </span>
<span id="cb6-35">    success <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> r <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> results <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> r[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"status"</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"success"</span>)</span>
<span id="cb6-36">    failed <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(results) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> success</span>
<span id="cb6-37">    </span>
<span id="cb6-38">    logging.info(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"재색인 완료: 성공 </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>success<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">, 실패 </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>failed<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
</section>
</section>
<section id="rag-시스템-통합" class="level2" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="rag-시스템-통합"><span class="header-section-number">4</span> RAG 시스템 통합</h2>
<section id="langgraph-워크플로우" class="level3" data-number="4.1">
<h3 data-number="4.1" class="anchored" data-anchor-id="langgraph-워크플로우"><span class="header-section-number">4.1</span> LangGraph 워크플로우</h3>
<div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb7-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> typing <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> TypedDict, List</span>
<span id="cb7-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> langgraph.graph <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> StateGraph, END</span>
<span id="cb7-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> langchain_core.documents <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Document</span>
<span id="cb7-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> langchain_openai <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> AzureChatOpenAI</span>
<span id="cb7-5"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> langchain_core.prompts <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> ChatPromptTemplate</span>
<span id="cb7-6"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> langchain_core.output_parsers <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> StrOutputParser</span>
<span id="cb7-7"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> logging</span>
<span id="cb7-8"></span>
<span id="cb7-9"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">class</span> RAGState(TypedDict):</span>
<span id="cb7-10">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""RAG 상태"""</span></span>
<span id="cb7-11">    question: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span></span>
<span id="cb7-12">    context: List[Document]</span>
<span id="cb7-13">    answer: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span></span>
<span id="cb7-14">    retrieval_success: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">bool</span></span>
<span id="cb7-15">    confidence: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">float</span></span>
<span id="cb7-16"></span>
<span id="cb7-17"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">class</span> ProductionRAGSystem:</span>
<span id="cb7-18">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""프로덕션급 RAG 시스템"""</span></span>
<span id="cb7-19">    </span>
<span id="cb7-20">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__init__</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>):</span>
<span id="cb7-21">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Vector Store (이미 초기화된 것 사용)</span></span>
<span id="cb7-22">        processor <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> DocumentProcessor()</span>
<span id="cb7-23">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.retriever <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> processor.vector_store.as_retriever(</span>
<span id="cb7-24">            search_type<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"similarity"</span>,</span>
<span id="cb7-25">            search_kwargs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>{<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"k"</span>: <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>}</span>
<span id="cb7-26">        )</span>
<span id="cb7-27">        </span>
<span id="cb7-28">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># LLM</span></span>
<span id="cb7-29">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.llm <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> AzureChatOpenAI(</span>
<span id="cb7-30">            azure_deployment<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>os.getenv(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"AZURE_OPENAI_DEPLOYMENT_LLM"</span>),</span>
<span id="cb7-31">            openai_api_version<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>os.getenv(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"AZURE_OPENAI_API_VERSION"</span>),</span>
<span id="cb7-32">            azure_endpoint<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>os.getenv(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"AZURE_OPENAI_ENDPOINT"</span>),</span>
<span id="cb7-33">            api_key<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>os.getenv(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"AZURE_OPENAI_API_KEY"</span>),</span>
<span id="cb7-34">            temperature<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb7-35">            max_tokens<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span>(os.getenv(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"MAX_TOKENS"</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>))</span>
<span id="cb7-36">        )</span>
<span id="cb7-37">        </span>
<span id="cb7-38">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Prompt</span></span>
<span id="cb7-39">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.prompt <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ChatPromptTemplate.from_template(</span>
<span id="cb7-40">            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"""다음 컨텍스트를 참고하여 질문에 답변하세요.</span></span>
<span id="cb7-41"></span>
<span id="cb7-42"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">## 지침:</span></span>
<span id="cb7-43"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">1. 컨텍스트에 있는 정보만 사용하세요</span></span>
<span id="cb7-44"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">2. 확실하지 않으면 "잘 모르겠습니다"라고 답하세요</span></span>
<span id="cb7-45"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">3. 한국어로 답변하세요</span></span>
<span id="cb7-46"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">4. 출처를 명시하세요</span></span>
<span id="cb7-47"></span>
<span id="cb7-48"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">## 컨텍스트:</span></span>
<span id="cb7-49"><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{context}</span></span>
<span id="cb7-50"></span>
<span id="cb7-51"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">## 질문:</span></span>
<span id="cb7-52"><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{question}</span></span>
<span id="cb7-53"></span>
<span id="cb7-54"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">## 답변:"""</span></span>
<span id="cb7-55">        )</span>
<span id="cb7-56">        </span>
<span id="cb7-57">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Workflow</span></span>
<span id="cb7-58">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.workflow <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>._build_workflow()</span>
<span id="cb7-59">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.app <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.workflow.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">compile</span>()</span>
<span id="cb7-60">        </span>
<span id="cb7-61">        logging.info(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"RAG 시스템 초기화 완료"</span>)</span>
<span id="cb7-62">    </span>
<span id="cb7-63">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> _build_workflow(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>):</span>
<span id="cb7-64">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""LangGraph 워크플로우 구성"""</span></span>
<span id="cb7-65">        workflow <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> StateGraph(RAGState)</span>
<span id="cb7-66">        </span>
<span id="cb7-67">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Nodes</span></span>
<span id="cb7-68">        workflow.add_node(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"retrieve"</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>._retrieve)</span>
<span id="cb7-69">        workflow.add_node(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"generate"</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>._generate)</span>
<span id="cb7-70">        workflow.add_node(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"evaluate"</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>._evaluate)</span>
<span id="cb7-71">        workflow.add_node(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"fallback"</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>._fallback)</span>
<span id="cb7-72">        </span>
<span id="cb7-73">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Edges</span></span>
<span id="cb7-74">        workflow.set_entry_point(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"retrieve"</span>)</span>
<span id="cb7-75">        workflow.add_conditional_edges(</span>
<span id="cb7-76">            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"retrieve"</span>,</span>
<span id="cb7-77">            <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>._should_generate,</span>
<span id="cb7-78">            {</span>
<span id="cb7-79">                <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"generate"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"generate"</span>,</span>
<span id="cb7-80">                <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"fallback"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"fallback"</span></span>
<span id="cb7-81">            }</span>
<span id="cb7-82">        )</span>
<span id="cb7-83">        workflow.add_edge(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"generate"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"evaluate"</span>)</span>
<span id="cb7-84">        workflow.add_conditional_edges(</span>
<span id="cb7-85">            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"evaluate"</span>,</span>
<span id="cb7-86">            <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>._should_retry,</span>
<span id="cb7-87">            {</span>
<span id="cb7-88">                <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"end"</span>: END,</span>
<span id="cb7-89">                <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"fallback"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"fallback"</span></span>
<span id="cb7-90">            }</span>
<span id="cb7-91">        )</span>
<span id="cb7-92">        workflow.add_edge(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"fallback"</span>, END)</span>
<span id="cb7-93">        </span>
<span id="cb7-94">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> workflow</span>
<span id="cb7-95">    </span>
<span id="cb7-96">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> _retrieve(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, state: RAGState) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span> RAGState:</span>
<span id="cb7-97">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""문서 검색"""</span></span>
<span id="cb7-98">        logging.info(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"검색 중: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>state[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'question'</span>]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb7-99">        </span>
<span id="cb7-100">        docs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.retriever.invoke(state[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"question"</span>])</span>
<span id="cb7-101">        </span>
<span id="cb7-102">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> {</span>
<span id="cb7-103">            <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span>state,</span>
<span id="cb7-104">            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"context"</span>: docs,</span>
<span id="cb7-105">            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"retrieval_success"</span>: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(docs) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb7-106">        }</span>
<span id="cb7-107">    </span>
<span id="cb7-108">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> _generate(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, state: RAGState) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span> RAGState:</span>
<span id="cb7-109">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""답변 생성"""</span></span>
<span id="cb7-110">        logging.info(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"답변 생성 중"</span>)</span>
<span id="cb7-111">        </span>
<span id="cb7-112">        context_text <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.join([</span>
<span id="cb7-113">            <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"[출처: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>doc<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>metadata<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>get(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'source'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Unknown'</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">]</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>doc<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>page_content<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb7-114">            <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> doc <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> state[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"context"</span>]</span>
<span id="cb7-115">        ])</span>
<span id="cb7-116">        </span>
<span id="cb7-117">        chain <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.prompt <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.llm <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> StrOutputParser()</span>
<span id="cb7-118">        answer <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> chain.invoke({</span>
<span id="cb7-119">            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"context"</span>: context_text,</span>
<span id="cb7-120">            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"question"</span>: state[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"question"</span>]</span>
<span id="cb7-121">        })</span>
<span id="cb7-122">        </span>
<span id="cb7-123">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> {</span>
<span id="cb7-124">            <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span>state,</span>
<span id="cb7-125">            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"answer"</span>: answer</span>
<span id="cb7-126">        }</span>
<span id="cb7-127">    </span>
<span id="cb7-128">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> _evaluate(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, state: RAGState) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span> RAGState:</span>
<span id="cb7-129">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""답변 품질 평가"""</span></span>
<span id="cb7-130">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 간단한 휴리스틱 평가</span></span>
<span id="cb7-131">        answer <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> state[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"answer"</span>]</span>
<span id="cb7-132">        </span>
<span id="cb7-133">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 길이 체크</span></span>
<span id="cb7-134">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(answer) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>:</span>
<span id="cb7-135">            confidence <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3</span></span>
<span id="cb7-136">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">elif</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"잘 모르겠습니다"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> answer <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">or</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"확실하지 않습니다"</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> answer:</span>
<span id="cb7-137">            confidence <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span></span>
<span id="cb7-138">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span>:</span>
<span id="cb7-139">            confidence <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.8</span></span>
<span id="cb7-140">        </span>
<span id="cb7-141">        logging.info(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"답변 신뢰도: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>confidence<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb7-142">        </span>
<span id="cb7-143">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> {</span>
<span id="cb7-144">            <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span>state,</span>
<span id="cb7-145">            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"confidence"</span>: confidence</span>
<span id="cb7-146">        }</span>
<span id="cb7-147">    </span>
<span id="cb7-148">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> _fallback(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, state: RAGState) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span> RAGState:</span>
<span id="cb7-149">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""대체 응답"""</span></span>
<span id="cb7-150">        logging.warning(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"대체 응답 사용"</span>)</span>
<span id="cb7-151">        </span>
<span id="cb7-152">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> {</span>
<span id="cb7-153">            <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span>state,</span>
<span id="cb7-154">            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"answer"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"죄송합니다. 관련 정보를 찾지 못했습니다. 다른 질문을 해주시겠어요?"</span>,</span>
<span id="cb7-155">            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"confidence"</span>: <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.0</span></span>
<span id="cb7-156">        }</span>
<span id="cb7-157">    </span>
<span id="cb7-158">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> _should_generate(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, state: RAGState) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>:</span>
<span id="cb7-159">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""생성 여부 결정"""</span></span>
<span id="cb7-160">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"generate"</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> state[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"retrieval_success"</span>] <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"fallback"</span></span>
<span id="cb7-161">    </span>
<span id="cb7-162">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> _should_retry(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, state: RAGState) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>:</span>
<span id="cb7-163">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""재시도 여부 결정"""</span></span>
<span id="cb7-164">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"end"</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> state[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"confidence"</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.6</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"fallback"</span></span>
<span id="cb7-165">    </span>
<span id="cb7-166">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> query(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, question: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dict</span>:</span>
<span id="cb7-167">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""RAG 쿼리 실행"""</span></span>
<span id="cb7-168">        initial_state <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> RAGState(</span>
<span id="cb7-169">            question<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>question,</span>
<span id="cb7-170">            context<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[],</span>
<span id="cb7-171">            answer<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>,</span>
<span id="cb7-172">            retrieval_success<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>,</span>
<span id="cb7-173">            confidence<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.0</span></span>
<span id="cb7-174">        )</span>
<span id="cb7-175">        </span>
<span id="cb7-176">        final_state <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.app.invoke(initial_state)</span>
<span id="cb7-177">        </span>
<span id="cb7-178">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> {</span>
<span id="cb7-179">            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"question"</span>: question,</span>
<span id="cb7-180">            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"answer"</span>: final_state[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"answer"</span>],</span>
<span id="cb7-181">            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"confidence"</span>: final_state[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"confidence"</span>],</span>
<span id="cb7-182">            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sources"</span>: [</span>
<span id="cb7-183">                doc.metadata.get(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"source"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Unknown"</span>)</span>
<span id="cb7-184">                <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> doc <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> final_state[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"context"</span>]</span>
<span id="cb7-185">            ]</span>
<span id="cb7-186">        }</span></code></pre></div>
</section>
</section>
<section id="api-서버-배포" class="level2" data-number="5">
<h2 data-number="5" class="anchored" data-anchor-id="api-서버-배포"><span class="header-section-number">5</span> API 서버 배포</h2>
<section id="fastapi-통합" class="level3" data-number="5.1">
<h3 data-number="5.1" class="anchored" data-anchor-id="fastapi-통합"><span class="header-section-number">5.1</span> FastAPI 통합</h3>
<p><strong>main.py:</strong></p>
<div class="sourceCode" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb8-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> fastapi <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> FastAPI, HTTPException, Depends</span>
<span id="cb8-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> fastapi.middleware.cors <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> CORSMiddleware</span>
<span id="cb8-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> pydantic <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> BaseModel</span>
<span id="cb8-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> typing <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Optional</span>
<span id="cb8-5"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> os</span>
<span id="cb8-6"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> logging</span>
<span id="cb8-7"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> prometheus_client <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Counter, Histogram, generate_latest</span>
<span id="cb8-8"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> fastapi.responses <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Response</span>
<span id="cb8-9"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> time</span>
<span id="cb8-10"></span>
<span id="cb8-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 메트릭</span></span>
<span id="cb8-12">REQUEST_COUNT <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Counter(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'rag_requests_total'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Total RAG requests'</span>)</span>
<span id="cb8-13">REQUEST_DURATION <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Histogram(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'rag_request_duration_seconds'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'RAG request duration'</span>)</span>
<span id="cb8-14">ERROR_COUNT <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Counter(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'rag_errors_total'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Total RAG errors'</span>)</span>
<span id="cb8-15"></span>
<span id="cb8-16">app <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> FastAPI(</span>
<span id="cb8-17">    title<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Production RAG API"</span>,</span>
<span id="cb8-18">    version<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"1.0.0"</span>,</span>
<span id="cb8-19">    description<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Azure 기반 프로덕션급 RAG API"</span></span>
<span id="cb8-20">)</span>
<span id="cb8-21"></span>
<span id="cb8-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># CORS</span></span>
<span id="cb8-23">app.add_middleware(</span>
<span id="cb8-24">    CORSMiddleware,</span>
<span id="cb8-25">    allow_origins<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*"</span>],</span>
<span id="cb8-26">    allow_credentials<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span>,</span>
<span id="cb8-27">    allow_methods<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*"</span>],</span>
<span id="cb8-28">    allow_headers<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*"</span>],</span>
<span id="cb8-29">)</span>
<span id="cb8-30"></span>
<span id="cb8-31"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># RAG 시스템 (전역)</span></span>
<span id="cb8-32">rag_system <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span></span>
<span id="cb8-33"></span>
<span id="cb8-34"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">@app.on_event</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"startup"</span>)</span>
<span id="cb8-35"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">async</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> startup_event():</span>
<span id="cb8-36">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""애플리케이션 시작 시 초기화"""</span></span>
<span id="cb8-37">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">global</span> rag_system</span>
<span id="cb8-38">    logging.info(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"RAG 시스템 초기화 중..."</span>)</span>
<span id="cb8-39">    rag_system <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ProductionRAGSystem()</span>
<span id="cb8-40">    logging.info(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"RAG 시스템 초기화 완료"</span>)</span>
<span id="cb8-41"></span>
<span id="cb8-42"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">class</span> QueryRequest(BaseModel):</span>
<span id="cb8-43">    question: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span></span>
<span id="cb8-44">    include_sources: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">bool</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span></span>
<span id="cb8-45"></span>
<span id="cb8-46"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">class</span> QueryResponse(BaseModel):</span>
<span id="cb8-47">    question: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span></span>
<span id="cb8-48">    answer: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span></span>
<span id="cb8-49">    confidence: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">float</span></span>
<span id="cb8-50">    sources: Optional[<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">list</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span></span>
<span id="cb8-51">    duration_ms: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span></span>
<span id="cb8-52"></span>
<span id="cb8-53"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">@app.get</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/"</span>)</span>
<span id="cb8-54"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">async</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> root():</span>
<span id="cb8-55">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> {</span>
<span id="cb8-56">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"service"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Production RAG API"</span>,</span>
<span id="cb8-57">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"version"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"1.0.0"</span>,</span>
<span id="cb8-58">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"status"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"running"</span></span>
<span id="cb8-59">    }</span>
<span id="cb8-60"></span>
<span id="cb8-61"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">@app.get</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/health"</span>)</span>
<span id="cb8-62"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">async</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> health():</span>
<span id="cb8-63">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""Health check"""</span></span>
<span id="cb8-64">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"status"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"healthy"</span>}</span>
<span id="cb8-65"></span>
<span id="cb8-66"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">@app.get</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/metrics"</span>)</span>
<span id="cb8-67"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">async</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> metrics():</span>
<span id="cb8-68">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""Prometheus 메트릭"""</span></span>
<span id="cb8-69">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> Response(generate_latest(), media_type<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"text/plain"</span>)</span>
<span id="cb8-70"></span>
<span id="cb8-71"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">@app.post</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/query"</span>, response_model<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>QueryResponse)</span>
<span id="cb8-72"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">async</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> query(request: QueryRequest):</span>
<span id="cb8-73">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""RAG 쿼리"""</span></span>
<span id="cb8-74">    REQUEST_COUNT.inc()</span>
<span id="cb8-75">    start_time <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> time.time()</span>
<span id="cb8-76">    </span>
<span id="cb8-77">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">try</span>:</span>
<span id="cb8-78">        result <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> rag_system.query(request.question)</span>
<span id="cb8-79">        </span>
<span id="cb8-80">        duration_ms <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span>((time.time() <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> start_time) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>)</span>
<span id="cb8-81">        REQUEST_DURATION.observe(time.time() <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> start_time)</span>
<span id="cb8-82">        </span>
<span id="cb8-83">        response <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> QueryResponse(</span>
<span id="cb8-84">            question<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>request.question,</span>
<span id="cb8-85">            answer<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>result[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"answer"</span>],</span>
<span id="cb8-86">            confidence<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>result[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"confidence"</span>],</span>
<span id="cb8-87">            sources<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>result[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sources"</span>] <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> request.include_sources <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>,</span>
<span id="cb8-88">            duration_ms<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>duration_ms</span>
<span id="cb8-89">        )</span>
<span id="cb8-90">        </span>
<span id="cb8-91">        logging.info(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"쿼리 완료: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>duration_ms<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">ms, 신뢰도: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>result[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'confidence'</span>]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb8-92">        </span>
<span id="cb8-93">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> response</span>
<span id="cb8-94">    </span>
<span id="cb8-95">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">except</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">Exception</span> <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> e:</span>
<span id="cb8-96">        ERROR_COUNT.inc()</span>
<span id="cb8-97">        logging.error(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"쿼리 실패: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>(e)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb8-98">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">raise</span> HTTPException(status_code<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">500</span>, detail<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>(e))</span>
<span id="cb8-99"></span>
<span id="cb8-100"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">__name__</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"__main__"</span>:</span>
<span id="cb8-101">    <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> uvicorn</span>
<span id="cb8-102">    uvicorn.run(app, host<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"0.0.0.0"</span>, port<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8000</span>)</span></code></pre></div>
</section>
<section id="container-배포" class="level3" data-number="5.2">
<h3 data-number="5.2" class="anchored" data-anchor-id="container-배포"><span class="header-section-number">5.2</span> Container 배포</h3>
<div class="sourceCode" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb9-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 이미지 빌드</span></span>
<span id="cb9-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">docker</span> build <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-t</span> rag-api-prod:latest .</span>
<span id="cb9-3"></span>
<span id="cb9-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ACR 푸시</span></span>
<span id="cb9-5"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">az</span> acr login <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--name</span> acrragprod</span>
<span id="cb9-6"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">docker</span> tag rag-api-prod:latest acrragprod.azurecr.io/rag-api-prod:latest</span>
<span id="cb9-7"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">docker</span> push acrragprod.azurecr.io/rag-api-prod:latest</span>
<span id="cb9-8"></span>
<span id="cb9-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Container App 배포</span></span>
<span id="cb9-10"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">az</span> containerapp create <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb9-11">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--name</span> ca-rag-prod <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb9-12">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--resource-group</span> rg-rag-prod <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb9-13">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--environment</span> cae-ragprod <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb9-14">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--image</span> acrragprod.azurecr.io/rag-api-prod:latest <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb9-15">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--target-port</span> 8000 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb9-16">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--ingress</span> external <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb9-17">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--min-replicas</span> 1 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb9-18">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--max-replicas</span> 10 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb9-19">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--cpu</span> 2.0 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb9-20">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--memory</span> 4.0Gi <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb9-21">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--env-vars-file</span> env.yaml</span></code></pre></div>
</section>
</section>
<section id="모니터링-및-관측성" class="level2" data-number="6">
<h2 data-number="6" class="anchored" data-anchor-id="모니터링-및-관측성"><span class="header-section-number">6</span> 모니터링 및 관측성</h2>
<section id="application-insights-통합" class="level3" data-number="6.1">
<h3 data-number="6.1" class="anchored" data-anchor-id="application-insights-통합"><span class="header-section-number">6.1</span> Application Insights 통합</h3>
<div class="sourceCode" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb10-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> opencensus.ext.azure.log_exporter <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> AzureLogHandler</span>
<span id="cb10-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> opencensus.ext.azure <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> metrics_exporter</span>
<span id="cb10-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> opencensus.stats <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> aggregation <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> aggregation_module</span>
<span id="cb10-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> opencensus.stats <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> measure <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> measure_module</span>
<span id="cb10-5"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> opencensus.stats <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> stats <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> stats_module</span>
<span id="cb10-6"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> opencensus.stats <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> view <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> view_module</span>
<span id="cb10-7"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> opencensus.tags <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> tag_map <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> tag_map_module</span>
<span id="cb10-8"></span>
<span id="cb10-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Application Insights 설정</span></span>
<span id="cb10-10">logger <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> logging.getLogger(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">__name__</span>)</span>
<span id="cb10-11">logger.addHandler(AzureLogHandler(</span>
<span id="cb10-12">    connection_string<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>os.getenv(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"APPLICATIONINSIGHTS_CONNECTION_STRING"</span>)</span>
<span id="cb10-13">))</span>
<span id="cb10-14"></span>
<span id="cb10-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 커스텀 메트릭</span></span>
<span id="cb10-16">stats <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> stats_module.stats</span>
<span id="cb10-17">view_manager <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> stats.view_manager</span>
<span id="cb10-18">stats_recorder <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> stats.stats_recorder</span>
<span id="cb10-19"></span>
<span id="cb10-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 메트릭 정의</span></span>
<span id="cb10-21">rag_latency_measure <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> measure_module.MeasureFloat(</span>
<span id="cb10-22">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"rag_latency"</span>,</span>
<span id="cb10-23">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"RAG query latency"</span>,</span>
<span id="cb10-24">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ms"</span></span>
<span id="cb10-25">)</span>
<span id="cb10-26"></span>
<span id="cb10-27">rag_latency_view <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> view_module.View(</span>
<span id="cb10-28">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"rag_latency_view"</span>,</span>
<span id="cb10-29">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"distribution of RAG latencies"</span>,</span>
<span id="cb10-30">    [],</span>
<span id="cb10-31">    rag_latency_measure,</span>
<span id="cb10-32">    aggregation_module.DistributionAggregation([<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">500</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5000</span>])</span>
<span id="cb10-33">)</span>
<span id="cb10-34"></span>
<span id="cb10-35">view_manager.register_view(rag_latency_view)</span>
<span id="cb10-36"></span>
<span id="cb10-37"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 메트릭 Exporter</span></span>
<span id="cb10-38">exporter <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> metrics_exporter.new_metrics_exporter(</span>
<span id="cb10-39">    connection_string<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>os.getenv(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"APPLICATIONINSIGHTS_CONNECTION_STRING"</span>)</span>
<span id="cb10-40">)</span>
<span id="cb10-41">view_manager.register_exporter(exporter)</span>
<span id="cb10-42"></span>
<span id="cb10-43"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 사용</span></span>
<span id="cb10-44"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> query_with_metrics(question: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>):</span>
<span id="cb10-45">    start <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> time.time()</span>
<span id="cb10-46">    </span>
<span id="cb10-47">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># RAG 실행</span></span>
<span id="cb10-48">    result <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> rag_system.query(question)</span>
<span id="cb10-49">    </span>
<span id="cb10-50">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 메트릭 기록</span></span>
<span id="cb10-51">    latency_ms <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (time.time() <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> start) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span></span>
<span id="cb10-52">    mmap <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> stats_recorder.new_measurement_map()</span>
<span id="cb10-53">    tmap <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> tag_map_module.TagMap()</span>
<span id="cb10-54">    </span>
<span id="cb10-55">    mmap.measure_float_put(rag_latency_measure, latency_ms)</span>
<span id="cb10-56">    mmap.record(tmap)</span>
<span id="cb10-57">    </span>
<span id="cb10-58">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 로그</span></span>
<span id="cb10-59">    logger.info(</span>
<span id="cb10-60">        <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"RAG Query"</span>,</span>
<span id="cb10-61">        extra<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>{</span>
<span id="cb10-62">            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"custom_dimensions"</span>: {</span>
<span id="cb10-63">                <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"question_length"</span>: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(question),</span>
<span id="cb10-64">                <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"answer_length"</span>: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(result[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"answer"</span>]),</span>
<span id="cb10-65">                <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"confidence"</span>: result[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"confidence"</span>],</span>
<span id="cb10-66">                <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"latency_ms"</span>: latency_ms</span>
<span id="cb10-67">            }</span>
<span id="cb10-68">        }</span>
<span id="cb10-69">    )</span>
<span id="cb10-70">    </span>
<span id="cb10-71">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> result</span></code></pre></div>
</section>
<section id="kusto-쿼리" class="level3" data-number="6.2">
<h3 data-number="6.2" class="anchored" data-anchor-id="kusto-쿼리"><span class="header-section-number">6.2</span> Kusto 쿼리</h3>
<p><strong>응답 시간 분석:</strong></p>
<div class="sourceCode" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode numberSource kusto number-lines code-with-copy"><code class="sourceCode"><span id="cb11-1">customMetrics</span>
<span id="cb11-2">| where name == "rag_request_duration_seconds"</span>
<span id="cb11-3">| summarize </span>
<span id="cb11-4">    P50=percentile(value, 50),</span>
<span id="cb11-5">    P95=percentile(value, 95),</span>
<span id="cb11-6">    P99=percentile(value, 99),</span>
<span id="cb11-7">    Avg=avg(value)</span>
<span id="cb11-8">  by bin(timestamp, 5m)</span>
<span id="cb11-9">| render timechart</span></code></pre></div>
<p><strong>오류율 모니터링:</strong></p>
<div class="sourceCode" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode numberSource kusto number-lines code-with-copy"><code class="sourceCode"><span id="cb12-1">customMetrics</span>
<span id="cb12-2">| where name in ("rag_requests_total", "rag_errors_total")</span>
<span id="cb12-3">| summarize </span>
<span id="cb12-4">    Total=sumif(value, name == "rag_requests_total"),</span>
<span id="cb12-5">    Errors=sumif(value, name == "rag_errors_total")</span>
<span id="cb12-6">  by bin(timestamp, 5m)</span>
<span id="cb12-7">| extend ErrorRate = (Errors * 100.0 / Total)</span>
<span id="cb12-8">| project timestamp, ErrorRate</span>
<span id="cb12-9">| render timechart</span></code></pre></div>
<p><strong>사용자 쿼리 분석:</strong></p>
<div class="sourceCode" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode numberSource kusto number-lines code-with-copy"><code class="sourceCode"><span id="cb13-1">traces</span>
<span id="cb13-2">| where customDimensions.question_length &gt; 0</span>
<span id="cb13-3">| summarize </span>
<span id="cb13-4">    Count=count(),</span>
<span id="cb13-5">    AvgLength=avg(toint(customDimensions.question_length)),</span>
<span id="cb13-6">    AvgConfidence=avg(todouble(customDimensions.confidence))</span>
<span id="cb13-7">  by bin(timestamp, 1h)</span>
<span id="cb13-8">| render timechart</span></code></pre></div>
</section>
</section>
<section id="성능-최적화" class="level2" data-number="7">
<h2 data-number="7" class="anchored" data-anchor-id="성능-최적화"><span class="header-section-number">7</span> 성능 최적화</h2>
<section id="캐싱-전략" class="level3" data-number="7.1">
<h3 data-number="7.1" class="anchored" data-anchor-id="캐싱-전략"><span class="header-section-number">7.1</span> 캐싱 전략</h3>
<div class="sourceCode" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb14-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> redis</span>
<span id="cb14-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> json</span>
<span id="cb14-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> hashlib</span>
<span id="cb14-4"></span>
<span id="cb14-5"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">class</span> CachedRAGSystem(ProductionRAGSystem):</span>
<span id="cb14-6">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""캐시가 통합된 RAG 시스템"""</span></span>
<span id="cb14-7">    </span>
<span id="cb14-8">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__init__</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>):</span>
<span id="cb14-9">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">super</span>().<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__init__</span>()</span>
<span id="cb14-10">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.redis_client <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> redis.Redis(</span>
<span id="cb14-11">            host<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>os.getenv(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"REDIS_HOST"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"localhost"</span>),</span>
<span id="cb14-12">            port<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span>(os.getenv(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"REDIS_PORT"</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6379</span>)),</span>
<span id="cb14-13">            decode_responses<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span></span>
<span id="cb14-14">        )</span>
<span id="cb14-15">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.cache_ttl <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3600</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 1시간</span></span>
<span id="cb14-16">    </span>
<span id="cb14-17">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> _get_cache_key(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, question: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>:</span>
<span id="cb14-18">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""질문을 캐시 키로 변환"""</span></span>
<span id="cb14-19">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"rag:</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>hashlib<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>md5(question.encode())<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>hexdigest()<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb14-20">    </span>
<span id="cb14-21">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> query(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, question: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dict</span>:</span>
<span id="cb14-22">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""캐시 우선 쿼리"""</span></span>
<span id="cb14-23">        cache_key <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>._get_cache_key(question)</span>
<span id="cb14-24">        </span>
<span id="cb14-25">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 캐시 확인</span></span>
<span id="cb14-26">        cached <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.redis_client.get(cache_key)</span>
<span id="cb14-27">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> cached:</span>
<span id="cb14-28">            logging.info(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"캐시 히트"</span>)</span>
<span id="cb14-29">            <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> json.loads(cached)</span>
<span id="cb14-30">        </span>
<span id="cb14-31">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># RAG 실행</span></span>
<span id="cb14-32">        result <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">super</span>().query(question)</span>
<span id="cb14-33">        </span>
<span id="cb14-34">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 캐시 저장</span></span>
<span id="cb14-35">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.redis_client.setex(</span>
<span id="cb14-36">            cache_key,</span>
<span id="cb14-37">            <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.cache_ttl,</span>
<span id="cb14-38">            json.dumps(result)</span>
<span id="cb14-39">        )</span>
<span id="cb14-40">        </span>
<span id="cb14-41">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> result</span></code></pre></div>
</section>
<section id="배치-처리" class="level3" data-number="7.2">
<h3 data-number="7.2" class="anchored" data-anchor-id="배치-처리"><span class="header-section-number">7.2</span> 배치 처리</h3>
<div class="sourceCode" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb15-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> typing <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> List</span>
<span id="cb15-2"></span>
<span id="cb15-3"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> batch_query(questions: List[<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>], batch_size: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span> List[<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dict</span>]:</span>
<span id="cb15-4">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""배치 쿼리 처리"""</span></span>
<span id="cb15-5">    results <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb15-6">    </span>
<span id="cb15-7">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(questions), batch_size):</span>
<span id="cb15-8">        batch <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> questions[i:i<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>batch_size]</span>
<span id="cb15-9">        </span>
<span id="cb15-10">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 병렬 임베딩</span></span>
<span id="cb15-11">        embeddings <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> processor.embeddings.embed_documents(batch)</span>
<span id="cb15-12">        </span>
<span id="cb15-13">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 배치 검색</span></span>
<span id="cb15-14">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> question, embedding <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">zip</span>(batch, embeddings):</span>
<span id="cb15-15">            docs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> vector_store.similarity_search_by_vector(</span>
<span id="cb15-16">                embedding,</span>
<span id="cb15-17">                k<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span></span>
<span id="cb15-18">            )</span>
<span id="cb15-19">            </span>
<span id="cb15-20">            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 답변 생성</span></span>
<span id="cb15-21">            answer <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> llm.invoke(...)</span>
<span id="cb15-22">            </span>
<span id="cb15-23">            results.append({</span>
<span id="cb15-24">                <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"question"</span>: question,</span>
<span id="cb15-25">                <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"answer"</span>: answer</span>
<span id="cb15-26">            })</span>
<span id="cb15-27">    </span>
<span id="cb15-28">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> results</span></code></pre></div>
</section>
</section>
<section id="보안-강화" class="level2" data-number="8">
<h2 data-number="8" class="anchored" data-anchor-id="보안-강화"><span class="header-section-number">8</span> 보안 강화</h2>
<section id="managed-identity-전환" class="level3" data-number="8.1">
<h3 data-number="8.1" class="anchored" data-anchor-id="managed-identity-전환"><span class="header-section-number">8.1</span> Managed Identity 전환</h3>
<div class="sourceCode" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb16-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> azure.identity <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> DefaultAzureCredential</span>
<span id="cb16-2"></span>
<span id="cb16-3">credential <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> DefaultAzureCredential()</span>
<span id="cb16-4"></span>
<span id="cb16-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Azure OpenAI</span></span>
<span id="cb16-6">llm <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> AzureChatOpenAI(</span>
<span id="cb16-7">    azure_deployment<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gpt-4o"</span>,</span>
<span id="cb16-8">    azure_endpoint<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>os.getenv(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"AZURE_OPENAI_ENDPOINT"</span>),</span>
<span id="cb16-9">    azure_ad_token_provider<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">lambda</span>: credential.get_token(</span>
<span id="cb16-10">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://cognitiveservices.azure.com/.default"</span></span>
<span id="cb16-11">    ).token</span>
<span id="cb16-12">)</span>
<span id="cb16-13"></span>
<span id="cb16-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Azure Search</span></span>
<span id="cb16-15"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> azure.search.documents <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> SearchClient</span>
<span id="cb16-16"></span>
<span id="cb16-17">search_client <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> SearchClient(</span>
<span id="cb16-18">    endpoint<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>os.getenv(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"AZURE_SEARCH_ENDPOINT"</span>),</span>
<span id="cb16-19">    index_name<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>os.getenv(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"AZURE_SEARCH_INDEX_NAME"</span>),</span>
<span id="cb16-20">    credential<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>credential</span>
<span id="cb16-21">)</span></code></pre></div>
</section>
<section id="api-인증" class="level3" data-number="8.2">
<h3 data-number="8.2" class="anchored" data-anchor-id="api-인증"><span class="header-section-number">8.2</span> API 인증</h3>
<div class="sourceCode" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb17-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> fastapi <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Security, HTTPException</span>
<span id="cb17-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> fastapi.security <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> HTTPBearer, HTTPAuthorizationCredentials</span>
<span id="cb17-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> jwt</span>
<span id="cb17-4"></span>
<span id="cb17-5">security <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> HTTPBearer()</span>
<span id="cb17-6"></span>
<span id="cb17-7"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> verify_token(credentials: HTTPAuthorizationCredentials <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Security(security)):</span>
<span id="cb17-8">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""JWT 토큰 검증"""</span></span>
<span id="cb17-9">    token <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> credentials.credentials</span>
<span id="cb17-10">    </span>
<span id="cb17-11">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">try</span>:</span>
<span id="cb17-12">        payload <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> jwt.decode(</span>
<span id="cb17-13">            token,</span>
<span id="cb17-14">            os.getenv(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"JWT_SECRET"</span>),</span>
<span id="cb17-15">            algorithms<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"HS256"</span>]</span>
<span id="cb17-16">        )</span>
<span id="cb17-17">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> payload</span>
<span id="cb17-18">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">except</span> jwt.ExpiredSignatureError:</span>
<span id="cb17-19">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">raise</span> HTTPException(status_code<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">401</span>, detail<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"토큰 만료"</span>)</span>
<span id="cb17-20">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">except</span> jwt.InvalidTokenError:</span>
<span id="cb17-21">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">raise</span> HTTPException(status_code<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">401</span>, detail<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"유효하지 않은 토큰"</span>)</span>
<span id="cb17-22"></span>
<span id="cb17-23"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">@app.post</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/query"</span>)</span>
<span id="cb17-24"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">async</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> query(request: QueryRequest, user<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>Depends(verify_token)):</span>
<span id="cb17-25">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""인증된 쿼리"""</span></span>
<span id="cb17-26">    logging.info(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"사용자 </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>user[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'sub'</span>]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;"> 쿼리"</span>)</span>
<span id="cb17-27">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> rag_system.query(request.question)</span></code></pre></div>
</section>
</section>
<section id="비용-최적화" class="level2" data-number="9">
<h2 data-number="9" class="anchored" data-anchor-id="비용-최적화"><span class="header-section-number">9</span> 비용 최적화</h2>
<section id="월별-비용-추정" class="level3" data-number="9.1">
<h3 data-number="9.1" class="anchored" data-anchor-id="월별-비용-추정"><span class="header-section-number">9.1</span> 월별 비용 추정</h3>
<table class="table">
<colgroup>
<col style="width: 25%">
<col style="width: 19%">
<col style="width: 25%">
<col style="width: 29%">
</colgroup>
<thead>
<tr class="header">
<th>서비스</th>
<th>사양</th>
<th>사용량</th>
<th>월 비용</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Blob Storage</strong></td>
<td>Standard LRS</td>
<td>100GB</td>
<td>$2.00</td>
</tr>
<tr class="even">
<td><strong>Document Intelligence</strong></td>
<td>S0</td>
<td>1,000 페이지</td>
<td>$10.00</td>
</tr>
<tr class="odd">
<td><strong>Azure OpenAI (Embeddings)</strong></td>
<td>text-embedding-3-small</td>
<td>10M 토큰</td>
<td>$1.00</td>
</tr>
<tr class="even">
<td><strong>Azure OpenAI (LLM)</strong></td>
<td>GPT-4o</td>
<td>1M in, 500K out</td>
<td>$12.50</td>
</tr>
<tr class="odd">
<td><strong>Azure AI Search</strong></td>
<td>Standard S1</td>
<td>1 SU</td>
<td>$250.00</td>
</tr>
<tr class="even">
<td><strong>Container Apps</strong></td>
<td>1 vCPU, 2GB</td>
<td>1 인스턴스 항상 실행</td>
<td>$77.00</td>
</tr>
<tr class="odd">
<td><strong>Application Insights</strong></td>
<td>-</td>
<td>5GB 로그</td>
<td>$12.50</td>
</tr>
<tr class="even">
<td><strong>Log Analytics</strong></td>
<td>-</td>
<td>5GB 저장</td>
<td>$12.50</td>
</tr>
<tr class="odd">
<td><strong>총 비용</strong></td>
<td></td>
<td></td>
<td><strong>$377.50/월</strong></td>
</tr>
</tbody>
</table>
</section>
<section id="비용-절감-팁" class="level3" data-number="9.2">
<h3 data-number="9.2" class="anchored" data-anchor-id="비용-절감-팁"><span class="header-section-number">9.2</span> 비용 절감 팁</h3>
<ol type="1">
<li><strong>Azure AI Search 최적화</strong></li>
</ol>
<div class="sourceCode" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb18-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 개발 환경: Basic 사용 (월 $75)</span></span>
<span id="cb18-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">az</span> search service update <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb18-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--name</span> search-rag-dev <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb18-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--resource-group</span> rg-rag-dev <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb18-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--sku</span> basic</span></code></pre></div>
<ol start="2" type="1">
<li><strong>Container Apps 스케일링</strong></li>
</ol>
<div class="sourceCode" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb19-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 오프피크 시간에 0으로 스케일</span></span>
<span id="cb19-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">az</span> containerapp update <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb19-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--name</span> ca-rag-prod <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb19-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--resource-group</span> rg-rag-prod <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb19-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--min-replicas</span> 0</span></code></pre></div>
<ol start="3" type="1">
<li><strong>캐싱으로 OpenAI 호출 감소</strong></li>
</ol>
<ul>
<li>Redis 캐시로 중복 쿼리 방지</li>
<li>예상 절감: 월 $5-10</li>
</ul>
<ol start="4" type="1">
<li><strong>Blob Storage 라이프사이클 정책</strong></li>
</ol>
<div class="sourceCode" id="cb20" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb20-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 90일 후 Cool tier로 이동</span></span>
<span id="cb20-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">az</span> storage account management-policy create <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb20-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--account-name</span> stragprod <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb20-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--policy</span> @lifecycle-policy.json</span></code></pre></div>
</section>
</section>
<section id="배포-체크리스트" class="level2" data-number="10">
<h2 data-number="10" class="anchored" data-anchor-id="배포-체크리스트"><span class="header-section-number">10</span> 배포 체크리스트</h2>
<section id="프로덕션-배포-전" class="level3" data-number="10.1">
<h3 data-number="10.1" class="anchored" data-anchor-id="프로덕션-배포-전"><span class="header-section-number">10.1</span> 프로덕션 배포 전</h3>
<ul class="task-list">
<li><label><input type="checkbox">모든 환경 변수가 Key Vault에 저장됨</label></li>
<li><label><input type="checkbox">Managed Identity 구성 완료</label></li>
<li><label><input type="checkbox">Application Insights 통합 및 테스트</label></li>
<li><label><input type="checkbox">로그 쿼리 알림 설정</label></li>
<li><label><input type="checkbox">API 인증/인가 구현</label></li>
<li><label><input type="checkbox">Rate limiting 설정</label></li>
<li><label><input type="checkbox">CORS 정책 확인</label></li>
<li><label><input type="checkbox">Health check 엔드포인트 구현</label></li>
<li><label><input type="checkbox">에러 처리 및 재시도 로직</label></li>
<li><label><input type="checkbox">캐싱 전략 구현</label></li>
<li><label><input type="checkbox">Blue-Green 배포 설정</label></li>
<li><label><input type="checkbox">백업 및 복구 계획</label></li>
<li><label><input type="checkbox">부하 테스트 완료</label></li>
<li><label><input type="checkbox">보안 스캔 통과</label></li>
<li><label><input type="checkbox">문서화 완료</label></li>
</ul>
</section>
</section>
<section id="참고-자료" class="level2" data-number="11">
<h2 data-number="11" class="anchored" data-anchor-id="참고-자료"><span class="header-section-number">11</span> 참고 자료</h2>
<section id="공식-문서" class="level3" data-number="11.1">
<h3 data-number="11.1" class="anchored" data-anchor-id="공식-문서"><span class="header-section-number">11.1</span> 공식 문서</h3>
<ul>
<li><a href="https://learn.microsoft.com/en-us/azure/architecture/ai-ml/guide/rag/rag-solution-design-and-evaluation-guide">Azure Architecture Center - RAG</a></li>
<li><a href="https://learn.microsoft.com/en-us/azure/ai-services/openai/concepts/best-practices">Azure OpenAI Best Practices</a></li>
<li><a href="https://python.langchain.com/docs/integrations/platforms/microsoft">LangChain Azure Integration</a></li>
</ul>
</section>
<section id="github-샘플" class="level3" data-number="11.2">
<h3 data-number="11.2" class="anchored" data-anchor-id="github-샘플"><span class="header-section-number">11.2</span> GitHub 샘플</h3>
<ul>
<li><a href="https://github.com/Azure-Samples/azure-search-openai-demo">Azure Search OpenAI Demo</a></li>
<li><a href="https://github.com/Azure-Samples/azure-openai-rag-workshop">Enterprise RAG</a></li>
</ul>
</section>
</section>
<section id="다음-단계" class="level2" data-number="12">
<h2 data-number="12" class="anchored" data-anchor-id="다음-단계"><span class="header-section-number">12</span> 다음 단계</h2>
<p>이제 완전한 Azure RAG 시스템을 구축했다. 지속적인 개선을 위해 다음을 고려하자:</p>
<ol type="1">
<li><strong>모니터링 강화</strong>: 사용자 피드백 수집, A/B 테스트</li>
<li><strong>고급 RAG 패턴</strong>: Self-RAG, Corrective RAG, Adaptive RAG</li>
<li><strong>다국어 지원</strong>: 언어별 임베딩 모델</li>
<li><strong>멀티모달</strong>: 이미지, 테이블 처리</li>
<li><strong>에이전트 통합</strong>: LangGraph로 복잡한 워크플로우</li>
</ol>


</section>

 ]]></description>
  <category>AI</category>
  <category>RAG</category>
  <category>Azure</category>
  <category>MLOps</category>
  <guid>kk3225.netlify.app/docs/blog/posts/Agent/13-Cloud-RAG/09-End-to-End-Azure-RAG.html</guid>
  <pubDate>Sun, 09 Nov 2025 15:00:00 GMT</pubDate>
</item>
<item>
  <title>Experimentation</title>
  <dc:creator>Kwangmin Kim</dc:creator>
  <link>kk3225.netlify.app/docs/blog/posts/Experimentation/</link>
  <description><![CDATA[ 





<section id="experimentation" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Experimentation</h1>
<ul>
<li>실험 설계와 인과추론의 체계적 이해를 위한 구조화된 학습 경로를 제시</li>
<li>Epidemiology 기반 지식을 활용하여 A/B Testing과 Multi-Armed Bandit을 포함한 Experimentation 전반을 학습할 수 있도록 구성</li>
</ul>
<section id="experimentation-하위구조" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="experimentation-하위구조"><span class="header-section-number">1.1</span> Experimentation 하위구조</h2>
<ul>
<li>Experimentation
<ul>
<li>Epidemiolog</li>
<li>AB_test</li>
<li>Fundamentals</li>
<li>MAB (Multi-Armed Badit)</li>
<li>Causal_inference</li>
<li>Advanced</li>
<li>Platform</li>
</ul></li>
</ul>
</section>
<section id="learning-path" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="learning-path"><span class="header-section-number">1.2</span> Learning Path</h2>
<p>이 학습 경로는 <strong>Epidemiology → Classical A/B Testing → Multi-Armed Bandits → Advanced Methods</strong> 순서로 실험 설계와 인과추론을 체계적으로 학습하도록 설계</p>
<section id="core-concepts-connection-map" class="level3" data-number="1.2.1">
<h3 data-number="1.2.1" class="anchored" data-anchor-id="core-concepts-connection-map"><span class="header-section-number">1.2.1</span> Core Concepts Connection Map</h3>
<pre><code>Epidemiology RCT → A/B Testing → Sequential Testing → Adaptive Testing → MAB
       ↓              ↓                                        ↓
Causal Inference → DAG/SUTVA ────────────────────→ Interference Handling
       ↓              ↓                                        ↓
Effect Measures → Lift/Uplift ──────────────────→ Heterogeneous TE
       ↓
Sample Size → Power Analysis → Sequential Monitoring → Variance Reduction</code></pre>
</section>
<section id="key-mathematical-connections" class="level3" data-number="1.2.2">
<h3 data-number="1.2.2" class="anchored" data-anchor-id="key-mathematical-connections"><span class="header-section-number">1.2.2</span> Key Mathematical Connections</h3>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Epidemiology</th>
<th>Experimentation</th>
<th>수식</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Relative Risk</td>
<td>Lift</td>
<td><img src="https://latex.codecogs.com/png.latex?%5Cfrac%7BP(Y=1%7CT=1)%7D%7BP(Y=1%7CT=0)%7D"></td>
</tr>
<tr class="even">
<td>Risk Difference</td>
<td>Absolute Uplift</td>
<td><img src="https://latex.codecogs.com/png.latex?P(Y=1%7CT=1)%20-%20P(Y=1%7CT=0)"></td>
</tr>
<tr class="odd">
<td>NNT</td>
<td>Number to Convert</td>
<td><img src="https://latex.codecogs.com/png.latex?%5Cfrac%7B1%7D%7BRD%7D"></td>
</tr>
<tr class="even">
<td>Effect Modification</td>
<td>HTE</td>
<td><img src="https://latex.codecogs.com/png.latex?E%5BY(1)-Y(0)%7CX%5D"></td>
</tr>
</tbody>
</table>
</section>
<section id="recommended-study-time" class="level3" data-number="1.2.3">
<h3 data-number="1.2.3" class="anchored" data-anchor-id="recommended-study-time"><span class="header-section-number">1.2.3</span> Recommended Study Time</h3>
<pre><code>Phase 1: 1-2개월 (주 10-15시간)
  - Epidemiology: 2-3주
  - Statistics: 1주
  - Classical A/B: 2-3주

Phase 2: 2-3개월 (주 10-15시간)
  - Advanced A/B: 2-3주
  - Causal Inference: 3-4주 ⭐ (가장 중요)
  - MAB Fundamentals: 2주
  - Classical Algorithms: 2-3주

Phase 3: 2-3개월 (주 8-12시간)
  - HTE: 2-3주
  - Variance Reduction: 2주
  - Advanced Bandits: 3-4주
  - Practical Challenges: 2-3주

Phase 4: 지속적 (프로젝트 기반)
  - Platform: 필요시
  - Applications: 도메인별
  - Research: 관심분야별</code></pre>
</section>
</section>
<section id="foundations-1-2개월" class="level2" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="foundations-1-2개월"><span class="header-section-number">1.3</span> Foundations (1-2개월)</h2>
<section id="epidemiology-foundations" class="level3" data-number="1.3.1">
<h3 data-number="1.3.1" class="anchored" data-anchor-id="epidemiology-foundations"><span class="header-section-number">1.3.1</span> Epidemiology Foundations</h3>
<p>RCT(무작위 대조 시험)는 A/B Testing의 직접적 원형이며, 인과추론의 수학적 프레임워크(Potential Outcomes, SUTVA)가 실험 설계의 이론적 기초를 제공한다. 역학의 effect measures(RR, RD, NNT)는 디지털 실험의 lift와 uplift 지표로 직접 대응되며, bias와 confounding 개념은 실험의 타당도를 판단하는 핵심 도구다. Sample size와 power 계산은 모든 실험 설계의 출발점이다.</p>
<ul>
<li><a href="../../../../docs/blog/posts/Experimentation/Epidemiology/index.html">Epidemiology Overview</a> ⭐
<ul>
<li>Study Design Framework
<ul>
<li>1111-11-11, <a href="./Epidemiology/experimental/rct.qmd">Randomized Controlled Trial (무작위 대조 시험)</a> ⭐</li>
<li>1111-11-11, <a href="./Epidemiology/experimental/quasi_experimental.qmd">Quasi-experimental Studies (준실험 연구)</a></li>
<li>1111-11-11, <a href="./Epidemiology/experimental/factorial_design.qmd">Factorial Design (요인 설계)</a></li>
</ul></li>
<li>Measures of Association and Impact
<ul>
<li>1111-11-11, <a href="./Epidemiology/measures/relative_risk.qmd">Relative Risk and Risk Difference</a></li>
<li>1111-11-11, <a href="./Epidemiology/measures/effect_size.qmd">Effect Size Measures</a></li>
<li>1111-11-11, <a href="./Epidemiology/measures/nnt.qmd">Number Needed to Treat</a></li>
</ul></li>
<li>Bias and Confounding
<ul>
<li>1111-11-11, <a href="./Epidemiology/bias/selection_bias.qmd">Selection Bias</a></li>
<li>1111-11-11, <a href="./Epidemiology/bias/information_bias.qmd">Information Bias</a></li>
<li>1111-11-11, <a href="./Epidemiology/confounding/index.qmd">Confounding and Control</a></li>
</ul></li>
<li>Study Design Fundamentals
<ul>
<li>1111-11-11, <a href="./Epidemiology/fundamentals/sample_size_power.qmd">Sample Size and Power</a> ⭐</li>
<li>1111-11-11, <a href="./Epidemiology/fundamentals/randomization.qmd">Randomization Methods</a> ⭐</li>
</ul></li>
</ul></li>
</ul>
</section>
<section id="statistical-foundations" class="level3" data-number="1.3.2">
<h3 data-number="1.3.2" class="anchored" data-anchor-id="statistical-foundations"><span class="header-section-number">1.3.2</span> Statistical Foundations</h3>
<p>가설 검정의 Type I/II 오류와 statistical power 개념은 실험 결과 해석의 필수 요소다. Multiple testing problem은 여러 지표를 동시에 평가하거나 중간 결과를 확인할 때 발생하는 false positive를 통제하는 방법을 제공한다. Effect size와 MDE(최소감지효과) 이해 없이는 실무적으로 의미 있는 실험 설계가 불가능하다.</p>
<ul>
<li><a href="./Fundamentals/statistics.qmd">Statistical Foundations for Experimentation</a>
<ul>
<li>1111-11-11, <a href="./Fundamentals/hypothesis_testing.qmd">Hypothesis Testing Framework</a>
<ul>
<li>1111-11-11, Type I and Type II Errors (1종·2종 오류)</li>
<li>1111-11-11, Statistical Power (검정력)</li>
<li>1111-11-11, p-values and Significance (p-값과 유의성)</li>
</ul></li>
<li>1111-11-11, <a href="./Fundamentals/effect_size.qmd">Effect Size and Practical Significance</a>
<ul>
<li>1111-11-11, Minimum Detectable Effect (MDE, 최소감지효과)</li>
<li>1111-11-11, Cohen’s d and Standardized Effect Sizes</li>
</ul></li>
<li>1111-11-11, <a href="./Fundamentals/multiple_testing.qmd">Multiple Testing Problem</a>
<ul>
<li>1111-11-11, Family-wise Error Rate (FWER)</li>
<li>1111-11-11, False Discovery Rate (FDR)</li>
<li>1111-11-11, Bonferroni and Holm Corrections</li>
</ul></li>
<li>1111-11-11, <a href="./Fundamentals/confidence_intervals.qmd">Confidence Intervals</a>
<ul>
<li>1111-11-11, Interpretation and Common Mistakes</li>
<li>1111-11-11, Bootstrap Methods</li>
</ul></li>
</ul></li>
</ul>
</section>
<section id="classical-ab-testing-fundamentals" class="level3" data-number="1.3.3">
<h3 data-number="1.3.3" class="anchored" data-anchor-id="classical-ab-testing-fundamentals"><span class="header-section-number">1.3.3</span> Classical A/B Testing Fundamentals</h3>
<p>디지털 제품에서 RCT 원리를 적용하는 구체적 방법론이다. Randomization unit 선택, traffic allocation, metric selection 등 실무적 의사결정 프레임워크를 제공한다. Fixed-horizon testing의 원칙과 “peeking problem”을 이해해야 sequential testing과 MAB의 필요성을 정확히 파악할 수 있다. 대부분의 실무 실험이 이 방법으로 진행되므로 가장 실용적이다.</p>
<ul>
<li><a href="./AB_test/index.qmd">Classical A/B Testing</a> ⭐
<ul>
<li>1111-11-11, <a href="./AB_test/design_principles.qmd">A/B Test Design Principles</a>
<ul>
<li>1111-11-11, Hypothesis Formulation (가설 수립)</li>
<li>1111-11-11, Metric Selection (지표 선택)</li>
<li>1111-11-11, Randomization Unit (무작위 배정 단위)</li>
<li>1111-11-11, Traffic Allocation (트래픽 할당)</li>
</ul></li>
<li>1111-11-11, <a href="./AB_test/sample_size.qmd">Sample Size Calculation</a> ⭐
<ul>
<li>1111-11-11, Power Analysis for A/B Tests</li>
<li>1111-11-11, Continuous vs.&nbsp;Binary Metrics</li>
<li>1111-11-11, Unequal Allocation</li>
</ul></li>
<li>1111-11-11, <a href="./AB_test/randomization.qmd">Randomization Strategies</a>
<ul>
<li>1111-11-11, Simple Randomization</li>
<li>1111-11-11, Stratified Randomization</li>
<li>1111-11-11, Consistent Hashing</li>
</ul></li>
<li>1111-11-11, <a href="./AB_test/analysis.qmd">Analysis Methods</a>
<ul>
<li>1111-11-11, t-tests and z-tests</li>
<li>1111-11-11, Chi-square Tests</li>
<li>1111-11-11, Non-parametric Tests (Mann-Whitney)</li>
</ul></li>
<li>1111-11-11, <a href="./AB_test/duration.qmd">Duration and Stopping Rules</a>
<ul>
<li>1111-11-11, Fixed Horizon Testing</li>
<li>1111-11-11, When to Stop (언제 중단할 것인가)</li>
<li>1111-11-11, Peeking Problem (중간확인 문제)</li>
</ul></li>
</ul></li>
</ul>
</section>
</section>
<section id="core-methods-2-3개월" class="level2" data-number="1.4">
<h2 data-number="1.4" class="anchored" data-anchor-id="core-methods-2-3개월"><span class="header-section-number">1.4</span> Core Methods (2-3개월)</h2>
<section id="advanced-ab-testing" class="level3" data-number="1.4.1">
<h3 data-number="1.4.1" class="anchored" data-anchor-id="advanced-ab-testing"><span class="header-section-number">1.4.1</span> Advanced A/B Testing</h3>
<p>Sequential testing은 실험 진행 중 중간 결과를 확인하면서도 Type I 오류를 통제하는 방법으로, 실무에서 가장 많이 요구되는 기술이다. Bayesian A/B testing은 “승률 확률” 같은 비즈니스 친화적 해석을 제공한다. Multi-variate testing은 여러 요소의 상호작용 효과를 동시에 평가할 수 있어 복잡한 제품 최적화에 필수적이다.</p>
<ul>
<li><a href="./AB_test/advanced/index.qmd">Advanced A/B Testing Techniques</a>
<ul>
<li>1111-11-11, <a href="./AB_test/advanced/sequential.qmd">Sequential Testing</a> ⭐
<ul>
<li>1111-11-11, Group Sequential Designs (그룹순차설계)</li>
<li>1111-11-11, Sequential Probability Ratio Test (SPRT)</li>
<li>1111-11-11, Alpha Spending Functions</li>
<li>1111-11-11, Always-Valid Inference</li>
</ul></li>
<li>1111-11-11, <a href="./AB_test/advanced/bayesian.qmd">Bayesian A/B Testing</a>
<ul>
<li>1111-11-11, Prior Distribution Selection (사전분포 선택)</li>
<li>1111-11-11, Posterior Probability (사후확률)</li>
<li>1111-11-11, Credible Intervals (신용구간)</li>
<li>1111-11-11, Probability of Being Best</li>
</ul></li>
<li>1111-11-11, <a href="./AB_test/advanced/multivariate.qmd">Multi-variate Testing</a>
<ul>
<li>1111-11-11, Full Factorial Designs (완전요인설계)</li>
<li>1111-11-11, Fractional Factorial Designs (부분요인설계)</li>
<li>1111-11-11, Interaction Effects (상호작용효과)</li>
</ul></li>
<li>1111-11-11, <a href="./AB_test/advanced/aa_testing.qmd">A/A Testing</a>
<ul>
<li>1111-11-11, Platform Validation</li>
<li>1111-11-11, Sample Ratio Mismatch (SRM) Detection</li>
</ul></li>
</ul></li>
</ul>
</section>
<section id="causal-inference-framework" class="level3" data-number="1.4.2">
<h3 data-number="1.4.2" class="anchored" data-anchor-id="causal-inference-framework"><span class="header-section-number">1.4.2</span> Causal Inference Framework</h3>
<p>Potential outcomes와 DAG는 “왜 무작위 배정이 중요한가”, “어떤 변수를 통제해야 하는가”에 대한 수학적으로 엄밀한 답을 제공한다. SUTVA 위반(network effects, spillover)은 디지털 실험에서 흔히 발생하며, 이를 감지하고 처리하는 방법이 필요하다. HTE(heterogeneous treatment effects) 분석의 이론적 기초가 되어 “어떤 사용자에게 효과적인가”를 과학적으로 답할 수 있게 한다.</p>
<ul>
<li><a href="./Causal_inference/index.qmd">Causal Inference for Experimentation</a> ⭐
<ul>
<li>1111-11-11, <a href="./Causal_inference/potential_outcomes.qmd">Potential Outcomes Framework</a> ⭐
<ul>
<li>1111-11-11, Rubin Causal Model (루빈 인과 모형)</li>
<li>1111-11-11, Average Treatment Effect (ATE, 평균처치효과)</li>
<li>1111-11-11, CATE and ITE (조건부·개별 처치효과)</li>
<li>1111-11-11, SUTVA (안정단위처치값 가정)</li>
</ul></li>
<li>1111-11-11, <a href="./Causal_inference/dag.qmd">Directed Acyclic Graphs</a> ⭐
<ul>
<li>1111-11-11, Causal Pathways (인과경로)</li>
<li>1111-11-11, Confounding Paths (교란경로)</li>
<li>1111-11-11, Colliders and Selection Bias (충돌자와 선택편향)</li>
<li>1111-11-11, d-separation (d-분리)</li>
<li>1111-11-11, Backdoor and Frontdoor Criteria</li>
</ul></li>
<li>1111-11-11, <a href="./Causal_inference/assignment.qmd">Assignment Mechanisms</a>
<ul>
<li>1111-11-11, Intent-to-Treat (ITT) Analysis</li>
<li>1111-11-11, Per-Protocol Analysis</li>
<li>1111-11-11, As-Treated Analysis</li>
<li>1111-11-11, Complier Average Causal Effect (CACE)</li>
</ul></li>
<li>1111-11-11, <a href="./Causal_inference/interference.qmd">Interference and Spillover</a>
<ul>
<li>1111-11-11, Network Effects (네트워크 효과)</li>
<li>1111-11-11, Cluster Randomization (군집 무작위배정)</li>
<li>1111-11-11, Switchback Experiments</li>
<li>1111-11-11, Geo-experiments</li>
</ul></li>
</ul></li>
</ul>
</section>
<section id="multi-armed-bandit-fundamentals" class="level3" data-number="1.4.3">
<h3 data-number="1.4.3" class="anchored" data-anchor-id="multi-armed-bandit-fundamentals"><span class="header-section-number">1.4.3</span> Multi-Armed Bandit Fundamentals</h3>
<p>A/B Testing이 “학습 후 의사결정”이라면, MAB는 “학습과 최적화를 동시에” 수행한다. Exploration-exploitation trade-off는 제한된 자원(트래픽)으로 최대 성과를 내는 전략의 핵심이다. Regret 개념은 “실험 비용”을 수학적으로 정량화하여 알고리즘 간 비교를 가능하게 한다.</p>
<ul>
<li><a href="./MAB/index.qmd">Multi-Armed Bandits Overview</a> ⭐
<ul>
<li>1111-11-11, <a href="./MAB/formulation.qmd">MAB Problem Formulation</a>
<ul>
<li>1111-11-11, Exploration vs.&nbsp;Exploitation Trade-off</li>
<li>1111-11-11, Regret Definition (후회 정의)
<ul>
<li>Cumulative Regret (누적 후회)</li>
<li>Simple Regret (단순 후회)</li>
</ul></li>
<li>1111-11-11, Reward Distributions (보상 분포)</li>
<li>1111-11-11, Stationarity Assumptions (정상성 가정)</li>
</ul></li>
<li>1111-11-11, <a href="./MAB/metrics.qmd">Performance Metrics</a>
<ul>
<li>1111-11-11, Expected Cumulative Regret</li>
<li>1111-11-11, Best Arm Identification</li>
<li>1111-11-11, Sample Complexity</li>
<li>1111-11-11, Convergence Rates</li>
</ul></li>
</ul></li>
</ul>
</section>
<section id="classical-mab-algorithms" class="level3" data-number="1.4.4">
<h3 data-number="1.4.4" class="anchored" data-anchor-id="classical-mab-algorithms"><span class="header-section-number">1.4.4</span> Classical MAB Algorithms</h3>
<p>Epsilon-greedy는 가장 단순하지만 exploration 비율을 수동으로 조정해야 하는 한계가 있다. UCB는 불확실성을 자동으로 정량화하여 exploration을 관리하며, 이론적 regret bound가 증명되었다. Thompson Sampling은 1933년 의학 실험을 위해 개발된 알고리즘으로, 실무에서 가장 성능이 좋고 구현이 간단하여 광범위하게 사용된다.</p>
<ul>
<li><a href="./MAB/classical/index.qmd">Classical Bandit Algorithms</a>
<ul>
<li>1111-11-11, <a href="./MAB/classical/epsilon_greedy.qmd">Epsilon-Greedy Methods</a>
<ul>
<li>1111-11-11, Fixed Epsilon Strategy</li>
<li>1111-11-11, Decaying Epsilon Strategy</li>
<li>1111-11-11, Theoretical Regret Bounds</li>
</ul></li>
<li>1111-11-11, <a href="./MAB/classical/ucb.qmd">Upper Confidence Bound (UCB)</a>
<ul>
<li>1111-11-11, UCB1 Algorithm</li>
<li>1111-11-11, UCB-Tuned</li>
<li>1111-11-11, Bayesian UCB</li>
<li>1111-11-11, KL-UCB</li>
</ul></li>
<li>1111-11-11, <a href="./MAB/classical/thompson_sampling.qmd">Thompson Sampling</a> ⭐
<ul>
<li>1111-11-11, Beta-Bernoulli Thompson Sampling</li>
<li>1111-11-11, Gaussian Thompson Sampling</li>
<li>1111-11-11, Theoretical Properties</li>
<li>1111-11-11, Historical Context (의학 실험 기원)</li>
</ul></li>
</ul></li>
</ul>
</section>
<section id="mab-vs.-ab-testing" class="level3" data-number="1.4.5">
<h3 data-number="1.4.5" class="anchored" data-anchor-id="mab-vs.-ab-testing"><span class="header-section-number">1.4.5</span> MAB vs.&nbsp;A/B Testing</h3>
<p>두 방법의 trade-off를 이해해야 상황에 맞는 선택이 가능하다. A/B Testing은 statistical validity가 명확하고 효과 크기를 정확히 추정하지만, MAB는 실험 중 기회비용을 최소화한다. 비즈니스 목표(정확한 측정 vs.&nbsp;빠른 최적화), 트래픽 규모, 의사결정 맥락에 따라 최적 방법이 달라진다.</p>
</section>
</section>
<section id="advanced-applications-2-3개월" class="level2" data-number="1.5">
<h2 data-number="1.5" class="anchored" data-anchor-id="advanced-applications-2-3개월"><span class="header-section-number">1.5</span> Advanced Applications (2-3개월)</h2>
<section id="heterogeneous-treatment-effects" class="level3" data-number="1.5.1">
<h3 data-number="1.5.1" class="anchored" data-anchor-id="heterogeneous-treatment-effects"><span class="header-section-number">1.5.1</span> Heterogeneous Treatment Effects</h3>
<p>“평균적으로 효과가 있다”는 것과 “모든 사용자에게 효과가 있다”는 것은 다르다. HTE 분석을 통해 어떤 사용자 세그먼트에서 효과가 크고 작은지 파악할 수 있다. Causal forests와 meta-learners 같은 ML 방법은 수백 개의 특성 조합에서 효과 패턴을 자동으로 발견한다. 개인화 전략 수립의 과학적 기반이 된다.</p>
<ul>
<li>1111-11-11, <a href="./MAB/comparison.qmd">When to Use MAB vs.&nbsp;A/B Testing</a> ⭐
<ul>
<li>1111-11-11, Trade-offs and Decision Framework</li>
<li>1111-11-11, Statistical Validity Considerations</li>
<li>1111-11-11, Business Context and Goals</li>
<li>1111-11-11, Hybrid Approaches</li>
</ul></li>
<li><a href="./Causal_inference/hte/index.qmd">Heterogeneous Treatment Effects</a> ⭐
<ul>
<li>1111-11-11, <a href="./Causal_inference/hte/subgroup.qmd">Subgroup Analysis</a>
<ul>
<li>1111-11-11, Pre-specified Subgroups</li>
<li>1111-11-11, Multiple Comparison Corrections</li>
<li>1111-11-11, Statistical vs.&nbsp;Practical Significance</li>
</ul></li>
<li>1111-11-11, <a href="./Causal_inference/hte/effect_modification.qmd">Effect Modification Analysis</a>
<ul>
<li>1111-11-11, Interaction Terms (상호작용항)</li>
<li>1111-11-11, Stratified Analysis (층화분석)</li>
</ul></li>
<li>1111-11-11, <a href="./Causal_inference/hte/ml_methods.qmd">Machine Learning Methods</a>
<ul>
<li>1111-11-11, Causal Forests</li>
<li>1111-11-11, Meta-learners (S-, T-, X-learner)</li>
<li>1111-11-11, Double Machine Learning (DML)</li>
<li>1111-11-11, BART (Bayesian Additive Regression Trees)</li>
</ul></li>
</ul></li>
</ul>
</section>
<section id="variance-reduction-techniques" class="level3" data-number="1.5.2">
<h3 data-number="1.5.2" class="anchored" data-anchor-id="variance-reduction-techniques"><span class="header-section-number">1.5.2</span> Variance Reduction Techniques</h3>
<p>동일한 sample size로 더 정확한 추정이 가능하면, 실험 기간을 단축하거나 더 작은 효과를 감지할 수 있다. CUPED는 실험 전 데이터(baseline)를 활용해 분산을 최대 50% 이상 줄일 수 있어 실무에서 표준 기법이 되었다. Stratification과 regression adjustment는 역학에서 검증된 방법으로, 디지털 실험에 직접 적용 가능하다.</p>
<ul>
<li><a href="./Advanced/variance_reduction/index.qmd">Variance Reduction Methods</a> ⭐
<ul>
<li>1111-11-11, <a href="./Advanced/variance_reduction/pre_experiment.qmd">Pre-experiment Methods</a>
<ul>
<li>1111-11-11, Stratification (층화)</li>
<li>1111-11-11, Matched Pair Design (대응설계)</li>
<li>1111-11-11, Blocking (블록화)</li>
</ul></li>
<li>1111-11-11, <a href="./Advanced/variance_reduction/post_experiment.qmd">Post-experiment Methods</a>
<ul>
<li>1111-11-11, CUPED (Controlled-experiment Using Pre-Experiment Data) ⭐</li>
<li>1111-11-11, CUPAC (CUPED with Asymptotic Confidence)</li>
<li>1111-11-11, Regression Adjustment (회귀조정)</li>
<li>1111-11-11, Difference-in-Differences (이중차분법)</li>
</ul></li>
</ul></li>
</ul>
</section>
<section id="contextual-and-advanced-bandits" class="level3" data-number="1.5.3">
<h3 data-number="1.5.3" class="anchored" data-anchor-id="contextual-and-advanced-bandits"><span class="header-section-number">1.5.3</span> Contextual and Advanced Bandits</h3>
<p>Contextual bandits는 사용자 특성(context)을 고려해 개인화된 의사결정을 내린다. Non-stationary bandits는 시간에 따라 최적 선택지가 변하는 현실을 반영한다. 추천 시스템, 동적 가격 책정, 개인화 마케팅 등 복잡한 실무 문제에 적용된다.</p>
<ul>
<li><a href="./MAB/advanced/index.qmd">Advanced Bandit Methods</a>
<ul>
<li>1111-11-11, <a href="./MAB/advanced/contextual.qmd">Contextual Bandits</a>
<ul>
<li>1111-11-11, Linear Contextual Bandits</li>
<li>1111-11-11, LinUCB Algorithm</li>
<li>1111-11-11, Neural Bandits</li>
<li>1111-11-11, Policy Gradient Methods</li>
</ul></li>
<li>1111-11-11, <a href="./MAB/advanced/non_stationary.qmd">Non-stationary Bandits</a>
<ul>
<li>1111-11-11, Sliding Window Approaches</li>
<li>1111-11-11, Discounted Rewards</li>
<li>1111-11-11, Change Detection Methods</li>
<li>1111-11-11, Switching Bandits</li>
</ul></li>
<li>1111-11-11, <a href="./MAB/advanced/structured.qmd">Structured Bandits</a>
<ul>
<li>1111-11-11, Combinatorial Bandits</li>
<li>1111-11-11, Dueling Bandits</li>
<li>1111-11-11, Ranking Bandits</li>
</ul></li>
</ul></li>
</ul>
</section>
<section id="practical-implementation-challenges" class="level3" data-number="1.5.4">
<h3 data-number="1.5.4" class="anchored" data-anchor-id="practical-implementation-challenges"><span class="header-section-number">1.5.4</span> Practical Implementation Challenges</h3>
<p>이론적으로 완벽한 실험도 실무에서는 metric 정의, novelty effects, network interference, SRM 등 다양한 문제에 직면한다. 이러한 문제들을 감지하고 완화하는 방법을 모르면 잘못된 의사결정으로 이어진다. North star metric과 guardrail metric 설정은 실험 프로그램의 성공을 좌우한다.</p>
<ul>
<li><a href="./Advanced/practical/index.qmd">Practical Experimentation Challenges</a>
<ul>
<li>1111-11-11, <a href="./Advanced/practical/metrics.qmd">Metric Design</a>
<ul>
<li>1111-11-11, North Star Metrics (핵심지표)</li>
<li>1111-11-11, Proxy Metrics (대리지표)</li>
<li>1111-11-11, Guardrail Metrics (가드레일지표)</li>
<li>1111-11-11, Long-term vs.&nbsp;Short-term Metrics</li>
</ul></li>
<li>1111-11-11, <a href="./Advanced/practical/novelty_effects.qmd">Novelty and Primacy Effects</a>
<ul>
<li>1111-11-11, Detection Methods</li>
<li>1111-11-11, Mitigation Strategies</li>
</ul></li>
<li>1111-11-11, <a href="./Advanced/practical/interference.qmd">Network Effects and Interference</a>
<ul>
<li>1111-11-11, Detection of SUTVA Violations</li>
<li>1111-11-11, Cluster-based Approaches</li>
<li>1111-11-11, Graph Cluster Randomization</li>
</ul></li>
<li>1111-11-11, <a href="./Advanced/practical/srm.qmd">Sample Ratio Mismatch</a>
<ul>
<li>1111-11-11, Detection Methods</li>
<li>1111-11-11, Root Cause Analysis</li>
<li>1111-11-11, Prevention Strategies</li>
</ul></li>
</ul></li>
</ul>
</section>
</section>
<section id="platform-and-specialization-지속적" class="level2" data-number="1.6">
<h2 data-number="1.6" class="anchored" data-anchor-id="platform-and-specialization-지속적"><span class="header-section-number">1.6</span> Platform and Specialization (지속적)</h2>
<section id="experimentation-platform-architecture" class="level4" data-number="1.6.0.1">
<h4 data-number="1.6.0.1" class="anchored" data-anchor-id="experimentation-platform-architecture"><span class="header-section-number">1.6.0.1</span> Experimentation Platform Architecture</h4>
<p>실험이 일회성이 아닌 조직의 표준 프로세스가 되려면 확장 가능한 인프라가 필요하다. Assignment service, logging, analysis engine의 설계는 실험의 신뢰성과 효율성을 결정한다. Feature flag integration과 auto-stopping 같은 자동화는 실험 운영 비용을 획기적으로 줄인다.</p>
<ul>
<li><a href="./Platform/index.qmd">Platform Design and Infrastructure</a>
<ul>
<li>1111-11-11, <a href="./Platform/components.qmd">Core Components</a>
<ul>
<li>1111-11-11, Assignment Service (배정 서비스)</li>
<li>1111-11-11, Logging and Tracking (로깅과 추적)</li>
<li>1111-11-11, Analysis Engine (분석 엔진)</li>
<li>1111-11-11, Reporting Dashboard (보고 대시보드)</li>
</ul></li>
<li>1111-11-11, <a href="./Platform/technical.qmd">Technical Considerations</a>
<ul>
<li>1111-11-11, Consistent Hashing for Assignment</li>
<li>1111-11-11, Experiment Overlap and Orthogonality</li>
<li>1111-11-11, Feature Flag Integration</li>
<li>1111-11-11, A/A Testing for Validation</li>
</ul></li>
<li>1111-11-11, <a href="./Platform/automation.qmd">Scale and Automation</a>
<ul>
<li>1111-11-11, Auto-stopping Rules (자동중단규칙)</li>
<li>1111-11-11, Winner Selection Algorithms</li>
<li>1111-11-11, Multi-objective Optimization</li>
</ul></li>
</ul></li>
</ul>
</section>
<section id="domain-specific-applications" class="level3" data-number="1.6.1">
<h3 data-number="1.6.1" class="anchored" data-anchor-id="domain-specific-applications"><span class="header-section-number">1.6.1</span> Domain-Specific Applications</h3>
<p>제품 최적화, 마케팅, 의료 등 도메인마다 고유한 제약과 요구사항이 있다. Healthcare의 경우 FDA guidance를 따라야 하며, marketplace 실험은 양면 시장의 특성을 고려해야 한다. 도메인 특화 지식이 실험 설계의 성공 여부를 결정한다.</p>
<ul>
<li><a href="./Advanced/applications/index.qmd">Industry Applications</a>
<ul>
<li>1111-11-11, <a href="./Advanced/applications/product.qmd">Product Optimization</a>
<ul>
<li>1111-11-11, UI/UX Experiments</li>
<li>1111-11-11, Recommendation System Testing</li>
<li>1111-11-11, Search Ranking Experiments</li>
</ul></li>
<li>1111-11-11, <a href="./Advanced/applications/growth.qmd">Growth and Marketing</a>
<ul>
<li>1111-11-11, Conversion Funnel Optimization</li>
<li>1111-11-11, Pricing Experiments</li>
<li>1111-11-11, Email and Notification Testing</li>
</ul></li>
<li>1111-11-11, <a href="./Advanced/applications/healthcare.qmd">Healthcare Applications</a>
<ul>
<li>1111-11-11, Adaptive Clinical Trials</li>
<li>1111-11-11, Response-Adaptive Randomization</li>
<li>1111-11-11, Platform Trials</li>
<li>1111-11-11, Regulatory Considerations (FDA Guidance)</li>
</ul></li>
</ul></li>
</ul>
</section>
<section id="research-frontiers" class="level3" data-number="1.6.2">
<h3 data-number="1.6.2" class="anchored" data-anchor-id="research-frontiers"><span class="header-section-number">1.6.2</span> Research Frontiers</h3>
<p>RL과의 통합, differential privacy, causal discovery 등은 차세대 실험 방법론이다. Off-policy evaluation은 과거 실험 데이터로 새로운 정책을 평가할 수 있게 하여 실험 비용을 줄인다. 이 분야의 최신 연구를 추적하면 경쟁 우위를 확보할 수 있다.</p>
<ul>
<li><a href="./Advanced/research/index.qmd">Emerging Topics and Research</a>
<ul>
<li>1111-11-11, <a href="./Advanced/research/rl.qmd">Reinforcement Learning Integration</a>
<ul>
<li>1111-11-11, Bandits as RL Problems</li>
<li>1111-11-11, Deep RL for Experimentation</li>
<li>1111-11-11, Off-policy Evaluation</li>
</ul></li>
<li>1111-11-11, <a href="./Advanced/research/privacy.qmd">Privacy-Preserving Experiments</a>
<ul>
<li>1111-11-11, Differential Privacy in Experiments</li>
<li>1111-11-11, Federated A/B Testing</li>
</ul></li>
<li>1111-11-11, <a href="./Advanced/research/causal_discovery.qmd">Causal Discovery</a>
<ul>
<li>1111-11-11, Constraint-based Methods</li>
<li>1111-11-11, Score-based Methods</li>
<li>1111-11-11, Experimentation for Graph Learning</li>
</ul></li>
</ul></li>
</ul>
</section>
</section>
<section id="references" class="level2" data-number="1.7">
<h2 data-number="1.7" class="anchored" data-anchor-id="references"><span class="header-section-number">1.7</span> References</h2>
<p><strong>Books:</strong> - Kohavi, Tang, and Xu (2020). “Trustworthy Online Controlled Experiments” - Lattimore and Szepesvári (2020). “Bandit Algorithms” - Imbens and Rubin (2015). “Causal Inference for Statistics, Social, and Biomedical Sciences” - Pearl and Mackenzie (2018). “The Book of Why”</p>
<p><strong>Papers:</strong> - Thompson (1933). “On the likelihood that one unknown probability exceeds another” - Auer et al.&nbsp;(2002). “Finite-time analysis of the multiarmed bandit problem” - Deng et al.&nbsp;(2013). “Improving the Sensitivity of Online Controlled Experiments by Utilizing Pre-Experiment Data” (CUPED)</p>
<p><strong>Online Courses:</strong> - Stanford CS234: Reinforcement Learning - MIT 6.S897: Machine Learning for Healthcare</p>


</section>
</section>

 ]]></description>
  <category>Experimentation</category>
  <guid>kk3225.netlify.app/docs/blog/posts/Experimentation/</guid>
  <pubDate>Sun, 09 Nov 2025 15:00:00 GMT</pubDate>
</item>
<item>
  <title>Azure Container Apps</title>
  <dc:creator>Kwangmin Kim</dc:creator>
  <link>kk3225.netlify.app/docs/blog/posts/Agent/13-Cloud-RAG/08-Azure-Container-Apps.html</link>
  <description><![CDATA[ 





<section id="azure-container-apps란" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="azure-container-apps란"><span class="header-section-number">1</span> Azure Container Apps란?</h2>
<p>Azure Container Apps는 서버리스 컨테이너 플랫폼으로, Kubernetes 복잡도 없이 컨테이너를 실행할 수 있다.</p>
<p><strong>주요 특징:</strong> - Kubernetes 기반이지만 관리 불필요 - HTTPS Ingress 자동 구성 - Dapr 통합 - KEDA 기반 자동 스케일링 - Revision 관리 (Blue-Green 배포)</p>
<p><strong>Azure Functions와 비교:</strong></p>
<table class="table">
<thead>
<tr class="header">
<th>항목</th>
<th>Functions</th>
<th>Container Apps</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>실행 시간</strong></td>
<td>최대 10분</td>
<td>무제한</td>
</tr>
<tr class="even">
<td><strong>Cold Start</strong></td>
<td>3-5초</td>
<td>1-2초</td>
</tr>
<tr class="odd">
<td><strong>커스터마이징</strong></td>
<td>제한적</td>
<td>완전 제어</td>
</tr>
<tr class="even">
<td><strong>WebSocket</strong></td>
<td>불가</td>
<td>가능</td>
</tr>
<tr class="odd">
<td><strong>최소 인스턴스</strong></td>
<td>0 (Consumption)</td>
<td>0~30</td>
</tr>
<tr class="even">
<td><strong>비용</strong></td>
<td>실행 시간 기반</td>
<td>vCPU/메모리 시간</td>
</tr>
</tbody>
</table>
<p><strong>Container Apps 권장 시나리오:</strong> - 실행 시간 &gt; 10분 - WebSocket 또는 gRPC 필요 - 복잡한 종속성 - 지속적인 백그라운드 작업 - Multi-container (사이드카 패턴)</p>
</section>
<section id="환경-설정" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="환경-설정"><span class="header-section-number">2</span> 환경 설정</h2>
<section id="docker-설치" class="level3" data-number="2.1">
<h3 data-number="2.1" class="anchored" data-anchor-id="docker-설치"><span class="header-section-number">2.1</span> Docker 설치</h3>
<p><strong>Windows:</strong></p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode numberSource powershell number-lines code-with-copy"><code class="sourceCode powershell"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Docker Desktop 설치</span></span>
<span id="cb1-2">winget install Docker<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">DockerDesktop</span></span></code></pre></div>
<p><strong>macOS:</strong></p>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">brew</span> install <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--cask</span> docker</span></code></pre></div>
<p><strong>Linux:</strong></p>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">curl</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-fsSL</span> https://get.docker.com <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-o</span> get-docker.sh</span>
<span id="cb3-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sudo</span> sh get-docker.sh</span></code></pre></div>
</section>
<section id="azure-cli-확장" class="level3" data-number="2.2">
<h3 data-number="2.2" class="anchored" data-anchor-id="azure-cli-확장"><span class="header-section-number">2.2</span> Azure CLI 확장</h3>
<div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb4-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Container Apps 확장 설치</span></span>
<span id="cb4-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">az</span> extension add <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--name</span> containerapp <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--upgrade</span></span>
<span id="cb4-3"></span>
<span id="cb4-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 확인</span></span>
<span id="cb4-5"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">az</span> containerapp <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--version</span></span></code></pre></div>
</section>
</section>
<section id="dockerfile-작성" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="dockerfile-작성"><span class="header-section-number">3</span> Dockerfile 작성</h2>
<section id="프로젝트-구조" class="level3" data-number="3.1">
<h3 data-number="3.1" class="anchored" data-anchor-id="프로젝트-구조"><span class="header-section-number">3.1</span> 프로젝트 구조</h3>
<pre><code>rag-container/
├── app/
│   ├── __init__.py
│   ├── main.py
│   └── rag.py
├── Dockerfile
├── requirements.txt
└── .dockerignore</code></pre>
</section>
<section id="requirements.txt" class="level3" data-number="3.2">
<h3 data-number="3.2" class="anchored" data-anchor-id="requirements.txt"><span class="header-section-number">3.2</span> requirements.txt</h3>
<div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode numberSource txt number-lines code-with-copy"><code class="sourceCode default"><span id="cb6-1">fastapi==0.109.0</span>
<span id="cb6-2">uvicorn[standard]==0.27.0</span>
<span id="cb6-3">langchain==0.1.6</span>
<span id="cb6-4">langchain-openai==0.0.5</span>
<span id="cb6-5">langchain-community==0.0.20</span>
<span id="cb6-6">azure-search-documents==11.4.0</span>
<span id="cb6-7">azure-identity==1.15.0</span>
<span id="cb6-8">python-dotenv==1.0.0</span></code></pre></div>
</section>
<section id="appmain.py" class="level3" data-number="3.3">
<h3 data-number="3.3" class="anchored" data-anchor-id="appmain.py"><span class="header-section-number">3.3</span> app/main.py</h3>
<div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb7-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> fastapi <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> FastAPI, HTTPException</span>
<span id="cb7-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> pydantic <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> BaseModel</span>
<span id="cb7-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> os</span>
<span id="cb7-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> app.rag <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> RAGSystem</span>
<span id="cb7-5"></span>
<span id="cb7-6">app <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> FastAPI(title<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"RAG API"</span>, version<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"1.0.0"</span>)</span>
<span id="cb7-7"></span>
<span id="cb7-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># RAG 시스템 초기화</span></span>
<span id="cb7-9">rag <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> RAGSystem()</span>
<span id="cb7-10"></span>
<span id="cb7-11"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">class</span> QueryRequest(BaseModel):</span>
<span id="cb7-12">    question: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span></span>
<span id="cb7-13">    top_k: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span></span>
<span id="cb7-14"></span>
<span id="cb7-15"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">class</span> QueryResponse(BaseModel):</span>
<span id="cb7-16">    question: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span></span>
<span id="cb7-17">    answer: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span></span>
<span id="cb7-18">    sources: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">list</span>[<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>]</span>
<span id="cb7-19"></span>
<span id="cb7-20"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">@app.get</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/"</span>)</span>
<span id="cb7-21"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">async</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> root():</span>
<span id="cb7-22">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""Health check"""</span></span>
<span id="cb7-23">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"status"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"healthy"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"service"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"RAG API"</span>}</span>
<span id="cb7-24"></span>
<span id="cb7-25"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">@app.get</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/health"</span>)</span>
<span id="cb7-26"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">async</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> health():</span>
<span id="cb7-27">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""Health probe endpoint"""</span></span>
<span id="cb7-28">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">try</span>:</span>
<span id="cb7-29">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 컴포넌트 상태 확인</span></span>
<span id="cb7-30">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> rag.is_initialized():</span>
<span id="cb7-31">            <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"status"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"healthy"</span>}</span>
<span id="cb7-32">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span>:</span>
<span id="cb7-33">            <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"status"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"initializing"</span>}</span>
<span id="cb7-34">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">except</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">Exception</span> <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> e:</span>
<span id="cb7-35">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"status"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"unhealthy"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"error"</span>: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>(e)}</span>
<span id="cb7-36"></span>
<span id="cb7-37"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">@app.post</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/query"</span>, response_model<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>QueryResponse)</span>
<span id="cb7-38"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">async</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> query(request: QueryRequest):</span>
<span id="cb7-39">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""RAG 쿼리 엔드포인트"""</span></span>
<span id="cb7-40">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">try</span>:</span>
<span id="cb7-41">        result <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> rag.query(</span>
<span id="cb7-42">            question<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>request.question,</span>
<span id="cb7-43">            top_k<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>request.top_k</span>
<span id="cb7-44">        )</span>
<span id="cb7-45">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> QueryResponse(</span>
<span id="cb7-46">            question<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>request.question,</span>
<span id="cb7-47">            answer<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>result[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"answer"</span>],</span>
<span id="cb7-48">            sources<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>result[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sources"</span>]</span>
<span id="cb7-49">        )</span>
<span id="cb7-50">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">except</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">Exception</span> <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> e:</span>
<span id="cb7-51">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">raise</span> HTTPException(status_code<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">500</span>, detail<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>(e))</span>
<span id="cb7-52"></span>
<span id="cb7-53"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">@app.post</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/stream"</span>)</span>
<span id="cb7-54"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">async</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> stream_query(request: QueryRequest):</span>
<span id="cb7-55">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""스트리밍 응답"""</span></span>
<span id="cb7-56">    <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> fastapi.responses <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> StreamingResponse</span>
<span id="cb7-57">    </span>
<span id="cb7-58">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">async</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> generate():</span>
<span id="cb7-59">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">async</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> chunk <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> rag.stream_query(request.question):</span>
<span id="cb7-60">            <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">yield</span> <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"data: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>chunk<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n\n</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb7-61">    </span>
<span id="cb7-62">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> StreamingResponse(generate(), media_type<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"text/event-stream"</span>)</span></code></pre></div>
</section>
<section id="apprag.py" class="level3" data-number="3.4">
<h3 data-number="3.4" class="anchored" data-anchor-id="apprag.py"><span class="header-section-number">3.4</span> app/rag.py</h3>
<div class="sourceCode" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb8-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> os</span>
<span id="cb8-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> langchain_openai <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> AzureOpenAIEmbeddings, AzureChatOpenAI</span>
<span id="cb8-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> langchain_community.vectorstores.azuresearch <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> AzureSearch</span>
<span id="cb8-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> langchain_core.prompts <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> ChatPromptTemplate</span>
<span id="cb8-5"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> langchain_core.output_parsers <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> StrOutputParser</span>
<span id="cb8-6"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> langchain_core.runnables <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> RunnablePassthrough</span>
<span id="cb8-7"></span>
<span id="cb8-8"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">class</span> RAGSystem:</span>
<span id="cb8-9">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__init__</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>):</span>
<span id="cb8-10">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>._initialized <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span></span>
<span id="cb8-11">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>._init_components()</span>
<span id="cb8-12">    </span>
<span id="cb8-13">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> _init_components(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>):</span>
<span id="cb8-14">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""RAG 컴포넌트 초기화"""</span></span>
<span id="cb8-15">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Embeddings</span></span>
<span id="cb8-16">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.embeddings <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> AzureOpenAIEmbeddings(</span>
<span id="cb8-17">            azure_deployment<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"text-embedding-3-small"</span>,</span>
<span id="cb8-18">            openai_api_version<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>os.getenv(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"AZURE_OPENAI_API_VERSION"</span>),</span>
<span id="cb8-19">            azure_endpoint<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>os.getenv(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"AZURE_OPENAI_ENDPOINT"</span>),</span>
<span id="cb8-20">            api_key<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>os.getenv(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"AZURE_OPENAI_API_KEY"</span>)</span>
<span id="cb8-21">        )</span>
<span id="cb8-22">        </span>
<span id="cb8-23">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Vector Store</span></span>
<span id="cb8-24">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.vector_store <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> AzureSearch(</span>
<span id="cb8-25">            azure_search_endpoint<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>os.getenv(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"AZURE_SEARCH_ENDPOINT"</span>),</span>
<span id="cb8-26">            azure_search_key<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>os.getenv(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"AZURE_SEARCH_API_KEY"</span>),</span>
<span id="cb8-27">            index_name<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>os.getenv(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"AZURE_SEARCH_INDEX_NAME"</span>),</span>
<span id="cb8-28">            embedding_function<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.embeddings.embed_query</span>
<span id="cb8-29">        )</span>
<span id="cb8-30">        </span>
<span id="cb8-31">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># LLM</span></span>
<span id="cb8-32">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.llm <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> AzureChatOpenAI(</span>
<span id="cb8-33">            azure_deployment<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>os.getenv(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"AZURE_OPENAI_DEPLOYMENT"</span>),</span>
<span id="cb8-34">            openai_api_version<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>os.getenv(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"AZURE_OPENAI_API_VERSION"</span>),</span>
<span id="cb8-35">            azure_endpoint<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>os.getenv(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"AZURE_OPENAI_ENDPOINT"</span>),</span>
<span id="cb8-36">            api_key<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>os.getenv(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"AZURE_OPENAI_API_KEY"</span>),</span>
<span id="cb8-37">            temperature<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb8-38">        )</span>
<span id="cb8-39">        </span>
<span id="cb8-40">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Retriever</span></span>
<span id="cb8-41">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.retriever <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.vector_store.as_retriever(</span>
<span id="cb8-42">            search_kwargs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>{<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"k"</span>: <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>}</span>
<span id="cb8-43">        )</span>
<span id="cb8-44">        </span>
<span id="cb8-45">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Prompt</span></span>
<span id="cb8-46">        prompt <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ChatPromptTemplate.from_template(</span>
<span id="cb8-47">            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"""다음 컨텍스트를 참고하여 질문에 답변하세요.</span></span>
<span id="cb8-48"></span>
<span id="cb8-49"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">컨텍스트:</span></span>
<span id="cb8-50"><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{context}</span></span>
<span id="cb8-51"></span>
<span id="cb8-52"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">질문: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{question}</span></span>
<span id="cb8-53"></span>
<span id="cb8-54"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">답변:"""</span></span>
<span id="cb8-55">        )</span>
<span id="cb8-56">        </span>
<span id="cb8-57">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># RAG Chain</span></span>
<span id="cb8-58">        <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> format_docs(docs):</span>
<span id="cb8-59">            <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.join([doc.page_content <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> doc <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> docs])</span>
<span id="cb8-60">        </span>
<span id="cb8-61">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.rag_chain <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (</span>
<span id="cb8-62">            {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"context"</span>: <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.retriever <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> format_docs, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"question"</span>: RunnablePassthrough()}</span>
<span id="cb8-63">            <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> prompt</span>
<span id="cb8-64">            <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.llm</span>
<span id="cb8-65">            <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> StrOutputParser()</span>
<span id="cb8-66">        )</span>
<span id="cb8-67">        </span>
<span id="cb8-68">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>._initialized <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span></span>
<span id="cb8-69">    </span>
<span id="cb8-70">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> is_initialized(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">bool</span>:</span>
<span id="cb8-71">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>._initialized</span>
<span id="cb8-72">    </span>
<span id="cb8-73">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> query(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, question: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>, top_k: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dict</span>:</span>
<span id="cb8-74">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""RAG 쿼리 실행"""</span></span>
<span id="cb8-75">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 문서 검색</span></span>
<span id="cb8-76">        docs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.retriever.invoke(question)</span>
<span id="cb8-77">        </span>
<span id="cb8-78">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 답변 생성</span></span>
<span id="cb8-79">        answer <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.rag_chain.invoke(question)</span>
<span id="cb8-80">        </span>
<span id="cb8-81">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 출처 추출</span></span>
<span id="cb8-82">        sources <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [doc.metadata.get(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"source"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Unknown"</span>) <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> doc <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> docs]</span>
<span id="cb8-83">        </span>
<span id="cb8-84">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> {</span>
<span id="cb8-85">            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"answer"</span>: answer,</span>
<span id="cb8-86">            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sources"</span>: sources</span>
<span id="cb8-87">        }</span>
<span id="cb8-88">    </span>
<span id="cb8-89">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">async</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> stream_query(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, question: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>):</span>
<span id="cb8-90">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""스트리밍 쿼리"""</span></span>
<span id="cb8-91">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">async</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> chunk <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.rag_chain.astream(question):</span>
<span id="cb8-92">            <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">yield</span> chunk</span></code></pre></div>
</section>
<section id="dockerfile" class="level3" data-number="3.5">
<h3 data-number="3.5" class="anchored" data-anchor-id="dockerfile"><span class="header-section-number">3.5</span> Dockerfile</h3>
<div class="sourceCode" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode numberSource dockerfile number-lines code-with-copy"><code class="sourceCode dockerfile"><span id="cb9-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">FROM</span> python:3.11-slim</span>
<span id="cb9-2"></span>
<span id="cb9-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 작업 디렉토리</span></span>
<span id="cb9-4"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">WORKDIR</span> /app</span>
<span id="cb9-5"></span>
<span id="cb9-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 시스템 패키지 업데이트</span></span>
<span id="cb9-7"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">RUN</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">apt-get</span> update <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">&amp;&amp;</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">apt-get</span> install <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-y</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb9-8">    build-essential <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb9-9">    curl <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb9-10">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">&amp;&amp;</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rm</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-rf</span> /var/lib/apt/lists/<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">*</span></span>
<span id="cb9-11"></span>
<span id="cb9-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Python 종속성 설치</span></span>
<span id="cb9-13"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">COPY</span> requirements.txt .</span>
<span id="cb9-14"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">RUN</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">pip</span> install <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--no-cache-dir</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-r</span> requirements.txt</span>
<span id="cb9-15"></span>
<span id="cb9-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 애플리케이션 코드 복사</span></span>
<span id="cb9-17"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">COPY</span> ./app ./app</span>
<span id="cb9-18"></span>
<span id="cb9-19"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 포트 노출</span></span>
<span id="cb9-20"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">EXPOSE</span> 8000</span>
<span id="cb9-21"></span>
<span id="cb9-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Health check</span></span>
<span id="cb9-23"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">HEALTHCHECK</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--interval=30s</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--timeout=3s</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--start-period=5s</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--retries=3</span> \</span>
<span id="cb9-24">  <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">CMD</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">curl</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-f</span> http://localhost:8000/health <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">||</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">exit</span> 1</span>
<span id="cb9-25"></span>
<span id="cb9-26"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 애플리케이션 실행</span></span>
<span id="cb9-27"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">CMD</span> [<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"uvicorn"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"app.main:app"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--host"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"0.0.0.0"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--port"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"8000"</span>]</span></code></pre></div>
</section>
<section id="dockerignore" class="level3" data-number="3.6">
<h3 data-number="3.6" class="anchored" data-anchor-id="dockerignore"><span class="header-section-number">3.6</span> .dockerignore</h3>
<pre><code>__pycache__
*.pyc
*.pyo
*.pyd
.Python
env/
venv/
.venv/
.git
.gitignore
.dockerignore
Dockerfile
README.md
.env</code></pre>
</section>
</section>
<section id="로컬-테스트" class="level2" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="로컬-테스트"><span class="header-section-number">4</span> 로컬 테스트</h2>
<section id="docker-빌드-및-실행" class="level3" data-number="4.1">
<h3 data-number="4.1" class="anchored" data-anchor-id="docker-빌드-및-실행"><span class="header-section-number">4.1</span> Docker 빌드 및 실행</h3>
<div class="sourceCode" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb11-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 이미지 빌드</span></span>
<span id="cb11-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">docker</span> build <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-t</span> rag-api:latest .</span>
<span id="cb11-3"></span>
<span id="cb11-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 로컬 실행</span></span>
<span id="cb11-5"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">docker</span> run <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-p</span> 8000:8000 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb11-6">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-e</span> AZURE_OPENAI_ENDPOINT=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://openai-rag.openai.azure.com/"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb11-7">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-e</span> AZURE_OPENAI_API_KEY=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"your-key"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb11-8">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-e</span> AZURE_OPENAI_DEPLOYMENT=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gpt-4o"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb11-9">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-e</span> AZURE_OPENAI_API_VERSION=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"2024-02-01"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb11-10">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-e</span> AZURE_SEARCH_ENDPOINT=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://search-rag.search.windows.net"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb11-11">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-e</span> AZURE_SEARCH_API_KEY=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"your-key"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb11-12">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-e</span> AZURE_SEARCH_INDEX_NAME=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"rag-documents"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb11-13">  rag-api:latest</span>
<span id="cb11-14"></span>
<span id="cb11-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Health check</span></span>
<span id="cb11-16"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">curl</span> http://localhost:8000/health</span>
<span id="cb11-17"></span>
<span id="cb11-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 쿼리 테스트</span></span>
<span id="cb11-19"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">curl</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-X</span> POST http://localhost:8000/query <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb11-20">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-H</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Content-Type: application/json"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb11-21">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-d</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'{"question": "Azure AI Search란?"}'</span></span></code></pre></div>
</section>
<section id="docker-compose.yml-개발용" class="level3" data-number="4.2">
<h3 data-number="4.2" class="anchored" data-anchor-id="docker-compose.yml-개발용"><span class="header-section-number">4.2</span> docker-compose.yml (개발용)</h3>
<div class="sourceCode" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode numberSource yaml number-lines code-with-copy"><code class="sourceCode yaml"><span id="cb12-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">version</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'3.8'</span></span>
<span id="cb12-2"></span>
<span id="cb12-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">services</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb12-4"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">  </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rag-api</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb12-5"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">build</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> .</span></span>
<span id="cb12-6"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ports</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb12-7"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">-</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"8000:8000"</span></span>
<span id="cb12-8"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">environment</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb12-9"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">-</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> AZURE_OPENAI_ENDPOINT=${AZURE_OPENAI_ENDPOINT}</span></span>
<span id="cb12-10"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">-</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> AZURE_OPENAI_API_KEY=${AZURE_OPENAI_API_KEY}</span></span>
<span id="cb12-11"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">-</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> AZURE_OPENAI_DEPLOYMENT=${AZURE_OPENAI_DEPLOYMENT}</span></span>
<span id="cb12-12"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">-</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> AZURE_OPENAI_API_VERSION=2024-02-01</span></span>
<span id="cb12-13"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">-</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> AZURE_SEARCH_ENDPOINT=${AZURE_SEARCH_ENDPOINT}</span></span>
<span id="cb12-14"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">-</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> AZURE_SEARCH_API_KEY=${AZURE_SEARCH_API_KEY}</span></span>
<span id="cb12-15"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">-</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> AZURE_SEARCH_INDEX_NAME=${AZURE_SEARCH_INDEX_NAME}</span></span>
<span id="cb12-16"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">volumes</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb12-17"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">-</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> ./app:/app/app</span></span>
<span id="cb12-18"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">command</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> uvicorn app.main:app --host 0.0.0.0 --port 8000 --reload</span></span></code></pre></div>
<p>실행:</p>
<div class="sourceCode" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb13-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">docker-compose</span> up</span></code></pre></div>
</section>
</section>
<section id="azure-container-registry" class="level2" data-number="5">
<h2 data-number="5" class="anchored" data-anchor-id="azure-container-registry"><span class="header-section-number">5</span> Azure Container Registry</h2>
<section id="acr-생성" class="level3" data-number="5.1">
<h3 data-number="5.1" class="anchored" data-anchor-id="acr-생성"><span class="header-section-number">5.1</span> ACR 생성</h3>
<div class="sourceCode" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb14-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 리소스 그룹 생성</span></span>
<span id="cb14-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">az</span> group create <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--name</span> rg-rag-prod <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--location</span> koreacentral</span>
<span id="cb14-3"></span>
<span id="cb14-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Container Registry 생성</span></span>
<span id="cb14-5"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">az</span> acr create <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-6">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--resource-group</span> rg-rag-prod <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-7">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--name</span> acrragprod <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-8">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--sku</span> Basic <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb14-9">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--location</span> koreacentral</span>
<span id="cb14-10"></span>
<span id="cb14-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ACR 로그인</span></span>
<span id="cb14-12"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">az</span> acr login <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--name</span> acrragprod</span></code></pre></div>
</section>
<section id="이미지-푸시" class="level3" data-number="5.2">
<h3 data-number="5.2" class="anchored" data-anchor-id="이미지-푸시"><span class="header-section-number">5.2</span> 이미지 푸시</h3>
<div class="sourceCode" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb15-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 이미지 태깅</span></span>
<span id="cb15-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">docker</span> tag rag-api:latest acrragprod.azurecr.io/rag-api:latest</span>
<span id="cb15-3"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">docker</span> tag rag-api:latest acrragprod.azurecr.io/rag-api:v1.0.0</span>
<span id="cb15-4"></span>
<span id="cb15-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 이미지 푸시</span></span>
<span id="cb15-6"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">docker</span> push acrragprod.azurecr.io/rag-api:latest</span>
<span id="cb15-7"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">docker</span> push acrragprod.azurecr.io/rag-api:v1.0.0</span>
<span id="cb15-8"></span>
<span id="cb15-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 이미지 확인</span></span>
<span id="cb15-10"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">az</span> acr repository list <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--name</span> acrragprod <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--output</span> table</span>
<span id="cb15-11"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">az</span> acr repository show-tags <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--name</span> acrragprod <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--repository</span> rag-api <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--output</span> table</span></code></pre></div>
</section>
</section>
<section id="container-apps-environment" class="level2" data-number="6">
<h2 data-number="6" class="anchored" data-anchor-id="container-apps-environment"><span class="header-section-number">6</span> Container Apps Environment</h2>
<section id="environment-생성" class="level3" data-number="6.1">
<h3 data-number="6.1" class="anchored" data-anchor-id="environment-생성"><span class="header-section-number">6.1</span> Environment 생성</h3>
<div class="sourceCode" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb16-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Log Analytics Workspace 생성</span></span>
<span id="cb16-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">az</span> monitor log-analytics workspace create <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb16-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--resource-group</span> rg-rag-prod <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb16-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--workspace-name</span> law-rag-prod <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb16-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--location</span> koreacentral</span>
<span id="cb16-6"></span>
<span id="cb16-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Workspace ID 조회</span></span>
<span id="cb16-8"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">WORKSPACE_ID</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">az</span> monitor log-analytics workspace show <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb16-9">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--resource-group</span> rg-rag-prod <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb16-10">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--workspace-name</span> law-rag-prod <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb16-11">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--query</span> customerId <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-o</span> tsv<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb16-12"></span>
<span id="cb16-13"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">WORKSPACE_KEY</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">az</span> monitor log-analytics workspace get-shared-keys <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb16-14">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--resource-group</span> rg-rag-prod <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb16-15">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--workspace-name</span> law-rag-prod <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb16-16">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--query</span> primarySharedKey <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-o</span> tsv<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb16-17"></span>
<span id="cb16-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Container Apps Environment 생성</span></span>
<span id="cb16-19"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">az</span> containerapp env create <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb16-20">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--name</span> cae-rag-prod <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb16-21">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--resource-group</span> rg-rag-prod <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb16-22">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--location</span> koreacentral <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb16-23">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--logs-workspace-id</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$WORKSPACE_ID</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb16-24">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--logs-workspace-key</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$WORKSPACE_KEY</span></span></code></pre></div>
</section>
</section>
<section id="container-app-배포" class="level2" data-number="7">
<h2 data-number="7" class="anchored" data-anchor-id="container-app-배포"><span class="header-section-number">7</span> Container App 배포</h2>
<section id="acr-통합" class="level3" data-number="7.1">
<h3 data-number="7.1" class="anchored" data-anchor-id="acr-통합"><span class="header-section-number">7.1</span> ACR 통합</h3>
<div class="sourceCode" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb17-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ACR Admin 활성화</span></span>
<span id="cb17-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">az</span> acr update <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--name</span> acrragprod <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--admin-enabled</span> true</span>
<span id="cb17-3"></span>
<span id="cb17-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ACR 자격 증명 조회</span></span>
<span id="cb17-5"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">ACR_USERNAME</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">az</span> acr credential show <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--name</span> acrragprod <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--query</span> username <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-o</span> tsv<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb17-6"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">ACR_PASSWORD</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">az</span> acr credential show <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--name</span> acrragprod <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--query</span> passwords<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">[</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">0</span><span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">]</span>.value <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-o</span> tsv<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span></code></pre></div>
</section>
<section id="container-app-생성" class="level3" data-number="7.2">
<h3 data-number="7.2" class="anchored" data-anchor-id="container-app-생성"><span class="header-section-number">7.2</span> Container App 생성</h3>
<div class="sourceCode" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb18-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">az</span> containerapp create <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb18-2">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--name</span> ca-rag-api <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb18-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--resource-group</span> rg-rag-prod <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb18-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--environment</span> cae-rag-prod <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb18-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--image</span> acrragprod.azurecr.io/rag-api:latest <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb18-6">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--target-port</span> 8000 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb18-7">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--ingress</span> external <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb18-8">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--registry-server</span> acrragprod.azurecr.io <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb18-9">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--registry-username</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$ACR_USERNAME</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb18-10">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--registry-password</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$ACR_PASSWORD</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb18-11">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--cpu</span> 1.0 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb18-12">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--memory</span> 2.0Gi <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb18-13">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--min-replicas</span> 0 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb18-14">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--max-replicas</span> 10 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb18-15">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--env-vars</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb18-16">    AZURE_OPENAI_ENDPOINT=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://openai-rag.openai.azure.com/"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb18-17">    AZURE_OPENAI_DEPLOYMENT=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gpt-4o"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb18-18">    AZURE_OPENAI_API_VERSION=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"2024-02-01"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb18-19">    AZURE_SEARCH_ENDPOINT=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://search-rag.search.windows.net"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb18-20">    AZURE_SEARCH_INDEX_NAME=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"rag-documents"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb18-21">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--secrets</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb18-22">    azure-openai-key=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"your-openai-key"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb18-23">    azure-search-key=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"your-search-key"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb18-24">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--secret-env-vars</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb18-25">    AZURE_OPENAI_API_KEY=azure-openai-key <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb18-26">    AZURE_SEARCH_API_KEY=azure-search-key</span></code></pre></div>
</section>
<section id="fqdn-확인" class="level3" data-number="7.3">
<h3 data-number="7.3" class="anchored" data-anchor-id="fqdn-확인"><span class="header-section-number">7.3</span> FQDN 확인</h3>
<div class="sourceCode" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb19-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Container App FQDN 조회</span></span>
<span id="cb19-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">az</span> containerapp show <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb19-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--name</span> ca-rag-api <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb19-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--resource-group</span> rg-rag-prod <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb19-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--query</span> properties.configuration.ingress.fqdn <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-o</span> tsv</span>
<span id="cb19-6"></span>
<span id="cb19-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 출력: ca-rag-api.politebeach-12345678.koreacentral.azurecontainerapps.io</span></span></code></pre></div>
</section>
<section id="배포-테스트" class="level3" data-number="7.4">
<h3 data-number="7.4" class="anchored" data-anchor-id="배포-테스트"><span class="header-section-number">7.4</span> 배포 테스트</h3>
<div class="sourceCode" id="cb20" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb20-1"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">FQDN</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">az</span> containerapp show <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb20-2">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--name</span> ca-rag-api <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb20-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--resource-group</span> rg-rag-prod <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb20-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--query</span> properties.configuration.ingress.fqdn <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-o</span> tsv<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb20-5"></span>
<span id="cb20-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Health check</span></span>
<span id="cb20-7"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">curl</span> https://<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$FQDN</span>/health</span>
<span id="cb20-8"></span>
<span id="cb20-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 쿼리 테스트</span></span>
<span id="cb20-10"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">curl</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-X</span> POST https://<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$FQDN</span>/query <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb20-11">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-H</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Content-Type: application/json"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb20-12">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-d</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'{"question": "Azure Container Apps란?"}'</span></span></code></pre></div>
</section>
</section>
<section id="스케일링-전략" class="level2" data-number="8">
<h2 data-number="8" class="anchored" data-anchor-id="스케일링-전략"><span class="header-section-number">8</span> 스케일링 전략</h2>
<section id="http-기반-스케일링" class="level3" data-number="8.1">
<h3 data-number="8.1" class="anchored" data-anchor-id="http-기반-스케일링"><span class="header-section-number">8.1</span> HTTP 기반 스케일링</h3>
<div class="sourceCode" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb21-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">az</span> containerapp update <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb21-2">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--name</span> ca-rag-api <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb21-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--resource-group</span> rg-rag-prod <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb21-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--min-replicas</span> 1 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb21-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--max-replicas</span> 10 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb21-6">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--scale-rule-name</span> http-rule <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb21-7">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--scale-rule-type</span> http <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb21-8">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--scale-rule-http-concurrency</span> 50</span></code></pre></div>
<p><strong>설정 의미:</strong> - <code>min-replicas 1</code>: 항상 1개 인스턴스 유지 (Cold Start 방지) - <code>max-replicas 10</code>: 최대 10개까지 확장 - <code>http-concurrency 50</code>: 동시 요청 50개당 1개 인스턴스 추가</p>
</section>
<section id="cpu메모리-기반-스케일링" class="level3" data-number="8.2">
<h3 data-number="8.2" class="anchored" data-anchor-id="cpu메모리-기반-스케일링"><span class="header-section-number">8.2</span> CPU/메모리 기반 스케일링</h3>
<div class="sourceCode" id="cb22" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb22-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">az</span> containerapp update <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb22-2">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--name</span> ca-rag-api <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb22-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--resource-group</span> rg-rag-prod <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb22-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--scale-rule-name</span> cpu-rule <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb22-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--scale-rule-type</span> cpu <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb22-6">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--scale-rule-metadata</span> type=Utilization value=70</span></code></pre></div>
</section>
<section id="커스텀-메트릭-스케일링-keda" class="level3" data-number="8.3">
<h3 data-number="8.3" class="anchored" data-anchor-id="커스텀-메트릭-스케일링-keda"><span class="header-section-number">8.3</span> 커스텀 메트릭 스케일링 (KEDA)</h3>
<p><strong>YAML 정의:</strong></p>
<div class="sourceCode" id="cb23" style="background: #f1f3f5;"><pre class="sourceCode numberSource yaml number-lines code-with-copy"><code class="sourceCode yaml"><span id="cb23-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scaleRules</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb23-2"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">  </span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">-</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">name</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> queue-based-scaling</span></span>
<span id="cb23-3"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">custom</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb23-4"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">type</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> azure-queue</span></span>
<span id="cb23-5"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">metadata</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb23-6"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">        </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">queueName</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> rag-requests</span></span>
<span id="cb23-7"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">        </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">queueLength</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"5"</span></span>
<span id="cb23-8"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">        </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">accountName</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> stragprod</span></span>
<span id="cb23-9"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">auth</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb23-10"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">        </span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">-</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">secretRef</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> queue-connection</span></span>
<span id="cb23-11"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">          </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">triggerParameter</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> connection</span></span></code></pre></div>
</section>
</section>
<section id="revision-관리" class="level2" data-number="9">
<h2 data-number="9" class="anchored" data-anchor-id="revision-관리"><span class="header-section-number">9</span> Revision 관리</h2>
<section id="blue-green-배포" class="level3" data-number="9.1">
<h3 data-number="9.1" class="anchored" data-anchor-id="blue-green-배포"><span class="header-section-number">9.1</span> Blue-Green 배포</h3>
<div class="sourceCode" id="cb24" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb24-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 새 Revision 배포 (트래픽 0%)</span></span>
<span id="cb24-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">az</span> containerapp update <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb24-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--name</span> ca-rag-api <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb24-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--resource-group</span> rg-rag-prod <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb24-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--image</span> acrragprod.azurecr.io/rag-api:v2.0.0 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb24-6">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--revision-suffix</span> v2</span>
<span id="cb24-7"></span>
<span id="cb24-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Revision 목록 확인</span></span>
<span id="cb24-9"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">az</span> containerapp revision list <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb24-10">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--name</span> ca-rag-api <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb24-11">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--resource-group</span> rg-rag-prod <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb24-12">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--output</span> table</span>
<span id="cb24-13"></span>
<span id="cb24-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 트래픽 분할 (50:50)</span></span>
<span id="cb24-15"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">az</span> containerapp ingress traffic set <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb24-16">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--name</span> ca-rag-api <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb24-17">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--resource-group</span> rg-rag-prod <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb24-18">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--revision-weight</span> ca-rag-api--v1=50 ca-rag-api--v2=50</span>
<span id="cb24-19"></span>
<span id="cb24-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 100% v2로 전환</span></span>
<span id="cb24-21"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">az</span> containerapp ingress traffic set <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb24-22">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--name</span> ca-rag-api <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb24-23">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--resource-group</span> rg-rag-prod <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb24-24">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--revision-weight</span> ca-rag-api--v2=100</span>
<span id="cb24-25"></span>
<span id="cb24-26"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 이전 Revision 비활성화</span></span>
<span id="cb24-27"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">az</span> containerapp revision deactivate <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb24-28">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--name</span> ca-rag-api <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb24-29">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--resource-group</span> rg-rag-prod <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb24-30">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--revision</span> ca-rag-api--v1</span></code></pre></div>
</section>
<section id="롤백" class="level3" data-number="9.2">
<h3 data-number="9.2" class="anchored" data-anchor-id="롤백"><span class="header-section-number">9.2</span> 롤백</h3>
<div class="sourceCode" id="cb25" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb25-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 즉시 롤백</span></span>
<span id="cb25-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">az</span> containerapp ingress traffic set <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb25-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--name</span> ca-rag-api <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb25-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--resource-group</span> rg-rag-prod <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb25-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--revision-weight</span> ca-rag-api--v1=100</span></code></pre></div>
</section>
</section>
<section id="멀티-컨테이너-사이드카" class="level2" data-number="10">
<h2 data-number="10" class="anchored" data-anchor-id="멀티-컨테이너-사이드카"><span class="header-section-number">10</span> 멀티 컨테이너 (사이드카)</h2>
<section id="redis-캐시-사이드카" class="level3" data-number="10.1">
<h3 data-number="10.1" class="anchored" data-anchor-id="redis-캐시-사이드카"><span class="header-section-number">10.1</span> Redis 캐시 사이드카</h3>
<p><strong>containerapp.yaml:</strong></p>
<div class="sourceCode" id="cb26" style="background: #f1f3f5;"><pre class="sourceCode numberSource yaml number-lines code-with-copy"><code class="sourceCode yaml"><span id="cb26-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">properties</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb26-2"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">  </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">template</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb26-3"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">containers</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb26-4"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">-</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">name</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> rag-api</span></span>
<span id="cb26-5"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">        </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">image</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> acrragprod.azurecr.io/rag-api:latest</span></span>
<span id="cb26-6"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">        </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">env</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb26-7"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">          </span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">-</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">name</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> REDIS_HOST</span></span>
<span id="cb26-8"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">            </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> localhost</span></span>
<span id="cb26-9"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">          </span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">-</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">name</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> REDIS_PORT</span></span>
<span id="cb26-10"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">            </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">value</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"6379"</span></span>
<span id="cb26-11"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">        </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">resources</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb26-12"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">          </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cpu</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.0</span></span>
<span id="cb26-13"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">          </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">memory</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> 2.0Gi</span></span>
<span id="cb26-14"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span></span>
<span id="cb26-15"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">-</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">name</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> redis</span></span>
<span id="cb26-16"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">        </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">image</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> redis:7-alpine</span></span>
<span id="cb26-17"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">        </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">resources</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb26-18"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">          </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cpu</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span></span>
<span id="cb26-19"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">          </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">memory</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> 1.0Gi</span></span></code></pre></div>
<p>배포:</p>
<div class="sourceCode" id="cb27" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb27-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">az</span> containerapp create <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb27-2">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--name</span> ca-rag-with-cache <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb27-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--resource-group</span> rg-rag-prod <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb27-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--environment</span> cae-rag-prod <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb27-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--yaml</span> containerapp.yaml</span></code></pre></div>
</section>
<section id="캐시-통합-코드" class="level3" data-number="10.2">
<h3 data-number="10.2" class="anchored" data-anchor-id="캐시-통합-코드"><span class="header-section-number">10.2</span> 캐시 통합 코드</h3>
<div class="sourceCode" id="cb28" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb28-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> redis</span>
<span id="cb28-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> functools <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> lru_cache</span>
<span id="cb28-3"></span>
<span id="cb28-4"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">class</span> RAGSystemWithCache(RAGSystem):</span>
<span id="cb28-5">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__init__</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>):</span>
<span id="cb28-6">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">super</span>().<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__init__</span>()</span>
<span id="cb28-7">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.redis_client <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> redis.Redis(</span>
<span id="cb28-8">            host<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>os.getenv(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"REDIS_HOST"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"localhost"</span>),</span>
<span id="cb28-9">            port<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span>(os.getenv(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"REDIS_PORT"</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6379</span>)),</span>
<span id="cb28-10">            decode_responses<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span></span>
<span id="cb28-11">        )</span>
<span id="cb28-12">    </span>
<span id="cb28-13">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> query(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, question: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>, top_k: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dict</span>:</span>
<span id="cb28-14">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 캐시 확인</span></span>
<span id="cb28-15">        cache_key <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"rag:</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>question<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb28-16">        cached <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.redis_client.get(cache_key)</span>
<span id="cb28-17">        </span>
<span id="cb28-18">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> cached:</span>
<span id="cb28-19">            <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> json.loads(cached)</span>
<span id="cb28-20">        </span>
<span id="cb28-21">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># RAG 실행</span></span>
<span id="cb28-22">        result <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">super</span>().query(question, top_k)</span>
<span id="cb28-23">        </span>
<span id="cb28-24">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 캐시 저장 (10분)</span></span>
<span id="cb28-25">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.redis_client.setex(cache_key, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">600</span>, json.dumps(result))</span>
<span id="cb28-26">        </span>
<span id="cb28-27">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> result</span></code></pre></div>
</section>
</section>
<section id="모니터링" class="level2" data-number="11">
<h2 data-number="11" class="anchored" data-anchor-id="모니터링"><span class="header-section-number">11</span> 모니터링</h2>
<section id="application-insights-통합" class="level3" data-number="11.1">
<h3 data-number="11.1" class="anchored" data-anchor-id="application-insights-통합"><span class="header-section-number">11.1</span> Application Insights 통합</h3>
<div class="sourceCode" id="cb29" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb29-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Application Insights 생성</span></span>
<span id="cb29-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">az</span> monitor app-insights component create <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb29-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--app</span> rag-api-insights <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb29-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--location</span> koreacentral <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb29-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--resource-group</span> rg-rag-prod <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb29-6">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--workspace</span> law-rag-prod</span>
<span id="cb29-7"></span>
<span id="cb29-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Instrumentation Key 조회</span></span>
<span id="cb29-9"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">INSTRUMENTATION_KEY</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">az</span> monitor app-insights component show <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb29-10">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--app</span> rag-api-insights <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb29-11">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--resource-group</span> rg-rag-prod <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb29-12">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--query</span> instrumentationKey <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-o</span> tsv<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb29-13"></span>
<span id="cb29-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Container App 업데이트</span></span>
<span id="cb29-15"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">az</span> containerapp update <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb29-16">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--name</span> ca-rag-api <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb29-17">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--resource-group</span> rg-rag-prod <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb29-18">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--set-env-vars</span> APPLICATIONINSIGHTS_CONNECTION_STRING=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"InstrumentationKey=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$INSTRUMENTATION_KEY</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span></code></pre></div>
</section>
<section id="opentelemetry-계측" class="level3" data-number="11.2">
<h3 data-number="11.2" class="anchored" data-anchor-id="opentelemetry-계측"><span class="header-section-number">11.2</span> OpenTelemetry 계측</h3>
<p><strong>requirements.txt 추가:</strong></p>
<div class="sourceCode" id="cb30" style="background: #f1f3f5;"><pre class="sourceCode numberSource txt number-lines code-with-copy"><code class="sourceCode default"><span id="cb30-1">opentelemetry-api==1.21.0</span>
<span id="cb30-2">opentelemetry-sdk==1.21.0</span>
<span id="cb30-3">opentelemetry-instrumentation-fastapi==0.42b0</span>
<span id="cb30-4">azure-monitor-opentelemetry-exporter==1.0.0b21</span></code></pre></div>
<p><strong>main.py 수정:</strong></p>
<div class="sourceCode" id="cb31" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb31-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> opentelemetry <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> trace</span>
<span id="cb31-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> opentelemetry.sdk.trace <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> TracerProvider</span>
<span id="cb31-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> opentelemetry.sdk.trace.export <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> BatchSpanProcessor</span>
<span id="cb31-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> azure.monitor.opentelemetry.exporter <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> AzureMonitorTraceExporter</span>
<span id="cb31-5"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> opentelemetry.instrumentation.fastapi <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> FastAPIInstrumentor</span>
<span id="cb31-6"></span>
<span id="cb31-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Tracer 설정</span></span>
<span id="cb31-8">trace.set_tracer_provider(TracerProvider())</span>
<span id="cb31-9">tracer <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> trace.get_tracer(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">__name__</span>)</span>
<span id="cb31-10"></span>
<span id="cb31-11">exporter <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> AzureMonitorTraceExporter.from_connection_string(</span>
<span id="cb31-12">    os.getenv(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"APPLICATIONINSIGHTS_CONNECTION_STRING"</span>)</span>
<span id="cb31-13">)</span>
<span id="cb31-14">trace.get_tracer_provider().add_span_processor(</span>
<span id="cb31-15">    BatchSpanProcessor(exporter)</span>
<span id="cb31-16">)</span>
<span id="cb31-17"></span>
<span id="cb31-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># FastAPI 자동 계측</span></span>
<span id="cb31-19">app <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> FastAPI()</span>
<span id="cb31-20">FastAPIInstrumentor.instrument_app(app)</span>
<span id="cb31-21"></span>
<span id="cb31-22"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">@app.post</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"/query"</span>)</span>
<span id="cb31-23"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">async</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> query(request: QueryRequest):</span>
<span id="cb31-24">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">with</span> tracer.start_as_current_span(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"rag_query"</span>) <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> span:</span>
<span id="cb31-25">        span.set_attribute(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"question.length"</span>, <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(request.question))</span>
<span id="cb31-26">        result <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> rag.query(request.question)</span>
<span id="cb31-27">        span.set_attribute(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"answer.length"</span>, <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(result[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"answer"</span>]))</span>
<span id="cb31-28">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> result</span></code></pre></div>
</section>
<section id="로그-쿼리" class="level3" data-number="11.3">
<h3 data-number="11.3" class="anchored" data-anchor-id="로그-쿼리"><span class="header-section-number">11.3</span> 로그 쿼리</h3>
<div class="sourceCode" id="cb32" style="background: #f1f3f5;"><pre class="sourceCode numberSource kusto number-lines code-with-copy"><code class="sourceCode"><span id="cb32-1">// Container App 로그</span>
<span id="cb32-2">ContainerAppConsoleLogs_CL</span>
<span id="cb32-3">| where ContainerAppName_s == "ca-rag-api"</span>
<span id="cb32-4">| where TimeGenerated &gt; ago(1h)</span>
<span id="cb32-5">| order by TimeGenerated desc</span>
<span id="cb32-6">| take 100</span>
<span id="cb32-7"></span>
<span id="cb32-8">// 시스템 로그</span>
<span id="cb32-9">ContainerAppSystemLogs_CL</span>
<span id="cb32-10">| where ContainerAppName_s == "ca-rag-api"</span>
<span id="cb32-11">| where TimeGenerated &gt; ago(1h)</span>
<span id="cb32-12">| project TimeGenerated, Log_s</span>
<span id="cb32-13"></span>
<span id="cb32-14">// HTTP 요청 분석</span>
<span id="cb32-15">requests</span>
<span id="cb32-16">| where cloud_RoleName == "ca-rag-api"</span>
<span id="cb32-17">| summarize </span>
<span id="cb32-18">    Count=count(),</span>
<span id="cb32-19">    AvgDuration=avg(duration),</span>
<span id="cb32-20">    P95Duration=percentile(duration, 95)</span>
<span id="cb32-21">  by bin(timestamp, 5m)</span>
<span id="cb32-22">| render timechart</span></code></pre></div>
</section>
</section>
<section id="cicd-파이프라인" class="level2" data-number="12">
<h2 data-number="12" class="anchored" data-anchor-id="cicd-파이프라인"><span class="header-section-number">12</span> CI/CD 파이프라인</h2>
<section id="github-actions" class="level3" data-number="12.1">
<h3 data-number="12.1" class="anchored" data-anchor-id="github-actions"><span class="header-section-number">12.1</span> GitHub Actions</h3>
<p><strong>.github/workflows/deploy.yml:</strong></p>
<div class="sourceCode" id="cb33" style="background: #f1f3f5;"><pre class="sourceCode numberSource yaml number-lines code-with-copy"><code class="sourceCode yaml"><span id="cb33-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">name</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> Build and Deploy to Azure Container Apps</span></span>
<span id="cb33-2"></span>
<span id="cb33-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">on</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb33-4"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">  </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">push</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb33-5"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">branches</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb33-6"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">-</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> main</span></span>
<span id="cb33-7"></span>
<span id="cb33-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">env</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb33-9"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">  </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">AZURE_CONTAINER_REGISTRY</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> acrragprod</span></span>
<span id="cb33-10"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">  </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">CONTAINER_APP_NAME</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> ca-rag-api</span></span>
<span id="cb33-11"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">  </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">RESOURCE_GROUP</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> rg-rag-prod</span></span>
<span id="cb33-12"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">  </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">IMAGE_NAME</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> rag-api</span></span>
<span id="cb33-13"></span>
<span id="cb33-14"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">jobs</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb33-15"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">  </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">build-and-deploy</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb33-16"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">runs-on</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> ubuntu-latest</span></span>
<span id="cb33-17"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">steps</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb33-18"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">-</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">name</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> Checkout code</span></span>
<span id="cb33-19"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">        </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">uses</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> actions/checkout@v4</span></span>
<span id="cb33-20"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span></span>
<span id="cb33-21"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">-</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">name</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> Login to Azure</span></span>
<span id="cb33-22"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">        </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">uses</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> azure/login@v1</span></span>
<span id="cb33-23"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">        </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">with</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb33-24"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">          </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">creds</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> ${{ secrets.AZURE_CREDENTIALS }}</span></span>
<span id="cb33-25"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span></span>
<span id="cb33-26"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">-</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">name</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> Login to ACR</span></span>
<span id="cb33-27"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">        run</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">: </span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">|</span></span>
<span id="cb33-28">          az acr login --name ${{ env.AZURE_CONTAINER_REGISTRY }}</span>
<span id="cb33-29"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span></span>
<span id="cb33-30"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">-</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">name</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> Build and push image</span></span>
<span id="cb33-31"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">        run</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">: </span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">|</span></span>
<span id="cb33-32">          IMAGE_TAG=${{ env.AZURE_CONTAINER_REGISTRY }}.azurecr.io/${{ env.IMAGE_NAME }}:${{ github.sha }}</span>
<span id="cb33-33">          docker build -t $IMAGE_TAG .</span>
<span id="cb33-34">          docker push $IMAGE_TAG</span>
<span id="cb33-35"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span></span>
<span id="cb33-36"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">-</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">name</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> Deploy to Container Apps</span></span>
<span id="cb33-37"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">        run</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">: </span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">|</span></span>
<span id="cb33-38">          az containerapp update \</span>
<span id="cb33-39">            --name ${{ env.CONTAINER_APP_NAME }} \</span>
<span id="cb33-40">            --resource-group ${{ env.RESOURCE_GROUP }} \</span>
<span id="cb33-41">            --image ${{ env.AZURE_CONTAINER_REGISTRY }}.azurecr.io/${{ env.IMAGE_NAME }}:${{ github.sha }}</span></code></pre></div>
</section>
</section>
<section id="보안" class="level2" data-number="13">
<h2 data-number="13" class="anchored" data-anchor-id="보안"><span class="header-section-number">13</span> 보안</h2>
<section id="managed-identity" class="level3" data-number="13.1">
<h3 data-number="13.1" class="anchored" data-anchor-id="managed-identity"><span class="header-section-number">13.1</span> Managed Identity</h3>
<div class="sourceCode" id="cb34" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb34-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># System-assigned identity 활성화</span></span>
<span id="cb34-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">az</span> containerapp identity assign <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb34-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--name</span> ca-rag-api <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb34-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--resource-group</span> rg-rag-prod <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb34-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--system-assigned</span></span>
<span id="cb34-6"></span>
<span id="cb34-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Principal ID 조회</span></span>
<span id="cb34-8"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">PRINCIPAL_ID</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">az</span> containerapp identity show <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb34-9">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--name</span> ca-rag-api <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb34-10">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--resource-group</span> rg-rag-prod <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb34-11">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--query</span> principalId <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-o</span> tsv<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb34-12"></span>
<span id="cb34-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Azure OpenAI 권한 부여</span></span>
<span id="cb34-14"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">az</span> role assignment create <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb34-15">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--assignee</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$PRINCIPAL_ID</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb34-16">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--role</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Cognitive Services OpenAI User"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb34-17">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--scope</span> /subscriptions/{subscription-id}/resourceGroups/rg-rag-prod/providers/Microsoft.CognitiveServices/accounts/openai-rag-prod</span>
<span id="cb34-18"></span>
<span id="cb34-19"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Azure Search 권한 부여</span></span>
<span id="cb34-20"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">az</span> role assignment create <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb34-21">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--assignee</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$PRINCIPAL_ID</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb34-22">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--role</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Search Index Data Reader"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb34-23">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--scope</span> /subscriptions/{subscription-id}/resourceGroups/rg-rag-prod/providers/Microsoft.Search/searchServices/search-rag-prod</span></code></pre></div>
</section>
<section id="defaultazurecredential-사용" class="level3" data-number="13.2">
<h3 data-number="13.2" class="anchored" data-anchor-id="defaultazurecredential-사용"><span class="header-section-number">13.2</span> DefaultAzureCredential 사용</h3>
<div class="sourceCode" id="cb35" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb35-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> azure.identity <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> DefaultAzureCredential</span>
<span id="cb35-2"></span>
<span id="cb35-3">credential <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> DefaultAzureCredential()</span>
<span id="cb35-4"></span>
<span id="cb35-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># OpenAI (Managed Identity)</span></span>
<span id="cb35-6">llm <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> AzureChatOpenAI(</span>
<span id="cb35-7">    azure_deployment<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gpt-4o"</span>,</span>
<span id="cb35-8">    azure_endpoint<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>os.getenv(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"AZURE_OPENAI_ENDPOINT"</span>),</span>
<span id="cb35-9">    azure_ad_token_provider<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">lambda</span>: credential.get_token(</span>
<span id="cb35-10">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://cognitiveservices.azure.com/.default"</span></span>
<span id="cb35-11">    ).token</span>
<span id="cb35-12">)</span>
<span id="cb35-13"></span>
<span id="cb35-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Azure Search (Managed Identity)</span></span>
<span id="cb35-15"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> azure.search.documents <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> SearchClient</span>
<span id="cb35-16"></span>
<span id="cb35-17">search_client <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> SearchClient(</span>
<span id="cb35-18">    endpoint<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>os.getenv(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"AZURE_SEARCH_ENDPOINT"</span>),</span>
<span id="cb35-19">    index_name<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>os.getenv(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"AZURE_SEARCH_INDEX_NAME"</span>),</span>
<span id="cb35-20">    credential<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>credential</span>
<span id="cb35-21">)</span></code></pre></div>
</section>
<section id="네트워크-보안" class="level3" data-number="13.3">
<h3 data-number="13.3" class="anchored" data-anchor-id="네트워크-보안"><span class="header-section-number">13.3</span> 네트워크 보안</h3>
<div class="sourceCode" id="cb36" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb36-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># VNET 통합</span></span>
<span id="cb36-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">az</span> containerapp env create <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb36-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--name</span> cae-rag-secure <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb36-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--resource-group</span> rg-rag-prod <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb36-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--location</span> koreacentral <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb36-6">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--infrastructure-subnet-resource-id</span> /subscriptions/{sub-id}/resourceGroups/rg-rag-prod/providers/Microsoft.Network/virtualNetworks/vnet-rag/subnets/subnet-containerapp</span>
<span id="cb36-7"></span>
<span id="cb36-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Internal Ingress (Private)</span></span>
<span id="cb36-9"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">az</span> containerapp create <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb36-10">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--name</span> ca-rag-internal <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb36-11">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--resource-group</span> rg-rag-prod <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb36-12">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--environment</span> cae-rag-secure <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb36-13">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--image</span> acrragprod.azurecr.io/rag-api:latest <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb36-14">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--ingress</span> internal <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb36-15">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--target-port</span> 8000</span></code></pre></div>
</section>
</section>
<section id="비용-최적화" class="level2" data-number="14">
<h2 data-number="14" class="anchored" data-anchor-id="비용-최적화"><span class="header-section-number">14</span> 비용 최적화</h2>
<section id="가격-구조" class="level3" data-number="14.1">
<h3 data-number="14.1" class="anchored" data-anchor-id="가격-구조"><span class="header-section-number">14.1</span> 가격 구조</h3>
<p><strong>Container Apps 비용:</strong> - vCPU: $0.000024/초 ($0.0864/vCPU-시간) - 메모리: $0.0000027/GB-초 ($0.00972/GB-시간) - 요청: 첫 200만 건 무료, 이후 $0.40/100만 건</p>
<p><strong>예시 계산</strong> (1 vCPU, 2GB, min=1, max=10):</p>
<p><strong>시나리오 1: 낮은 트래픽</strong> - 평균 인스턴스: 1개 - 월간 시간: 730시간 - vCPU 비용: 1 × 730 × $0.0864 = $63.07 - 메모리 비용: 2GB × 730 × $0.00972 = $14.19 - <strong>총 비용</strong>: ~$77/월</p>
<p><strong>시나리오 2: 중간 트래픽</strong> - 평균 인스턴스: 3개 - 월간 시간: 730시간 - vCPU 비용: 3 × 730 × $0.0864 = $189.22 - 메모리 비용: 3 × 2GB × 730 × $0.00972 = $42.57 - <strong>총 비용</strong>: ~$232/월</p>
</section>
<section id="비용-절감-팁" class="level3" data-number="14.2">
<h3 data-number="14.2" class="anchored" data-anchor-id="비용-절감-팁"><span class="header-section-number">14.2</span> 비용 절감 팁</h3>
<ol type="1">
<li><strong>min-replicas 조정</strong></li>
</ol>
<div class="sourceCode" id="cb37" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb37-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 오프피크에 0으로 설정 (Cold Start 허용)</span></span>
<span id="cb37-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">az</span> containerapp update <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb37-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--name</span> ca-rag-api <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb37-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--resource-group</span> rg-rag-prod <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb37-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--min-replicas</span> 0</span></code></pre></div>
<ol start="2" type="1">
<li><strong>리소스 최적화</strong></li>
</ol>
<div class="sourceCode" id="cb38" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb38-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 필요한 최소 리소스만 할당</span></span>
<span id="cb38-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">az</span> containerapp update <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb38-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--name</span> ca-rag-api <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb38-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--resource-group</span> rg-rag-prod <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb38-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--cpu</span> 0.5 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb38-6">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--memory</span> 1.0Gi</span></code></pre></div>
<ol start="3" type="1">
<li><strong>Consumption Plan 사용</strong></li>
</ol>
<div class="sourceCode" id="cb39" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb39-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Consumption 환경 (더 저렴)</span></span>
<span id="cb39-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">az</span> containerapp env create <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb39-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--name</span> cae-rag-consumption <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb39-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--resource-group</span> rg-rag-prod <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb39-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--location</span> koreacentral <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb39-6">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--enable-workload-profiles</span> false</span></code></pre></div>
</section>
</section>
<section id="참고-자료" class="level2" data-number="15">
<h2 data-number="15" class="anchored" data-anchor-id="참고-자료"><span class="header-section-number">15</span> 참고 자료</h2>
<section id="공식-문서" class="level3" data-number="15.1">
<h3 data-number="15.1" class="anchored" data-anchor-id="공식-문서"><span class="header-section-number">15.1</span> 공식 문서</h3>
<ul>
<li><a href="https://learn.microsoft.com/en-us/azure/container-apps/">Azure Container Apps</a></li>
<li><a href="https://azure.microsoft.com/en-us/pricing/details/container-apps/">Container Apps 가격</a></li>
<li><a href="https://keda.sh/docs/scalers/">KEDA Scalers</a></li>
</ul>
</section>
</section>
<section id="다음-단계" class="level2" data-number="16">
<h2 data-number="16" class="anchored" data-anchor-id="다음-단계"><span class="header-section-number">16</span> 다음 단계</h2>
<p>컨테이너 배포가 완료되었다면, 이제 전체 시스템을 통합하자:</p>
<p>👉 <a href="../../../../../docs/blog/posts/Agent/13-Cloud-RAG/09-End-to-End-Azure-RAG.html">09-End-to-End-Azure-RAG.qmd</a> - End-to-End Azure RAG 시스템 구축</p>


</section>

 ]]></description>
  <category>AI</category>
  <category>RAG</category>
  <category>Azure</category>
  <guid>kk3225.netlify.app/docs/blog/posts/Agent/13-Cloud-RAG/08-Azure-Container-Apps.html</guid>
  <pubDate>Sat, 08 Nov 2025 15:00:00 GMT</pubDate>
</item>
<item>
  <title>Azure Functions Apps</title>
  <dc:creator>Kwangmin Kim</dc:creator>
  <link>kk3225.netlify.app/docs/blog/posts/Agent/13-Cloud-RAG/07-Azure-Functions-Apps.html</link>
  <description><![CDATA[ 





<section id="azure-functions란" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="azure-functions란"><span class="header-section-number">1</span> Azure Functions란?</h2>
<p>Azure Functions는 서버리스 컴퓨팅 플랫폼으로, 인프라 관리 없이 코드를 실행할 수 있다.</p>
<p><strong>서버리스 장점:</strong> - 인프라 관리 불필요 - 자동 스케일링 - 사용한 만큼만 과금 - 이벤트 기반 실행</p>
<p><strong>RAG 시스템 배포에 적합한 경우:</strong> - 간헐적인 요청 (일 100~1000건) - 트래픽 변동이 큼 - 빠른 배포 필요 - 비용 최적화 중요</p>
</section>
<section id="azure-functions-vs-container-apps" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="azure-functions-vs-container-apps"><span class="header-section-number">2</span> Azure Functions vs Container Apps</h2>
<table class="table">
<thead>
<tr class="header">
<th>항목</th>
<th>Azure Functions</th>
<th>Container Apps</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>아키텍처</strong></td>
<td>서버리스 함수</td>
<td>컨테이너 기반</td>
</tr>
<tr class="even">
<td><strong>확장</strong></td>
<td>자동 (초 단위)</td>
<td>자동 (분 단위)</td>
</tr>
<tr class="odd">
<td><strong>Cold Start</strong></td>
<td>있음 (3-5초)</td>
<td>있음 (1-2초)</td>
</tr>
<tr class="even">
<td><strong>최대 실행 시간</strong></td>
<td>10분</td>
<td>무제한</td>
</tr>
<tr class="odd">
<td><strong>비용</strong></td>
<td>실행 시간 기반</td>
<td>vCPU/메모리 기반</td>
</tr>
<tr class="even">
<td><strong>권장 사용</strong></td>
<td>간헐적 요청</td>
<td>지속적 서비스</td>
</tr>
</tbody>
</table>
<p><strong>Azure Functions 권장</strong>: 트래픽이 적거나 불규칙한 경우 <strong>Container Apps 권장</strong>: 지속적인 트래픽, WebSocket 필요</p>
</section>
<section id="환경-설정" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="환경-설정"><span class="header-section-number">3</span> 환경 설정</h2>
<section id="azure-functions-core-tools-설치" class="level3" data-number="3.1">
<h3 data-number="3.1" class="anchored" data-anchor-id="azure-functions-core-tools-설치"><span class="header-section-number">3.1</span> Azure Functions Core Tools 설치</h3>
<p><strong>Windows (PowerShell):</strong></p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode numberSource powershell number-lines code-with-copy"><code class="sourceCode powershell"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Chocolatey로 설치</span></span>
<span id="cb1-2">choco install azure-functions-core-tools-4</span>
<span id="cb1-3"></span>
<span id="cb1-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 또는 npm으로 설치</span></span>
<span id="cb1-5">npm install <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>g azure-functions-core-tools@<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span></span></code></pre></div>
<p><strong>macOS:</strong></p>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">brew</span> tap azure/functions</span>
<span id="cb2-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">brew</span> install azure-functions-core-tools@4</span></code></pre></div>
<p><strong>Linux:</strong></p>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wget</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-q</span> https://packages.microsoft.com/config/ubuntu/20.04/packages-microsoft-prod.deb</span>
<span id="cb3-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sudo</span> dpkg <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-i</span> packages-microsoft-prod.deb</span>
<span id="cb3-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sudo</span> apt-get update</span>
<span id="cb3-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sudo</span> apt-get install azure-functions-core-tools-4</span></code></pre></div>
</section>
<section id="python-환경" class="level3" data-number="3.2">
<h3 data-number="3.2" class="anchored" data-anchor-id="python-환경"><span class="header-section-number">3.2</span> Python 환경</h3>
<div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb4-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Python 3.9, 3.10, 3.11 지원</span></span>
<span id="cb4-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">python</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--version</span></span>
<span id="cb4-3"></span>
<span id="cb4-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 가상환경 생성</span></span>
<span id="cb4-5"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">python</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-m</span> venv .venv</span>
<span id="cb4-6"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">source</span> .venv/bin/activate  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Linux/macOS</span></span>
<span id="cb4-7"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">.venv\Scripts\activate</span>     <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Windows</span></span>
<span id="cb4-8"></span>
<span id="cb4-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 필수 패키지</span></span>
<span id="cb4-10"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">pip</span> install azure-functions</span>
<span id="cb4-11"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">pip</span> install langchain-openai</span>
<span id="cb4-12"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">pip</span> install langchain-community</span>
<span id="cb4-13"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">pip</span> install azure-search-documents</span>
<span id="cb4-14"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">pip</span> install python-dotenv</span></code></pre></div>
</section>
</section>
<section id="functions-프로젝트-생성" class="level2" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="functions-프로젝트-생성"><span class="header-section-number">4</span> Functions 프로젝트 생성</h2>
<section id="프로젝트-초기화" class="level3" data-number="4.1">
<h3 data-number="4.1" class="anchored" data-anchor-id="프로젝트-초기화"><span class="header-section-number">4.1</span> 프로젝트 초기화</h3>
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 새 프로젝트 생성</span></span>
<span id="cb5-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">func</span> init rag-function-app <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--python</span></span>
<span id="cb5-3"></span>
<span id="cb5-4"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">cd</span> rag-function-app</span>
<span id="cb5-5"></span>
<span id="cb5-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># HTTP 트리거 함수 생성</span></span>
<span id="cb5-7"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">func</span> new <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--name</span> rag-query <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--template</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"HTTP trigger"</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--authlevel</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"function"</span></span></code></pre></div>
<p><strong>생성된 구조:</strong></p>
<pre><code>rag-function-app/
├── rag-query/
│   ├── __init__.py
│   └── function.json
├── host.json
├── local.settings.json
└── requirements.txt</code></pre>
</section>
<section id="requirements.txt" class="level3" data-number="4.2">
<h3 data-number="4.2" class="anchored" data-anchor-id="requirements.txt"><span class="header-section-number">4.2</span> requirements.txt</h3>
<div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode numberSource txt number-lines code-with-copy"><code class="sourceCode default"><span id="cb7-1">azure-functions</span>
<span id="cb7-2">langchain-openai</span>
<span id="cb7-3">langchain-community</span>
<span id="cb7-4">azure-search-documents</span>
<span id="cb7-5">python-dotenv</span>
<span id="cb7-6">tiktoken</span></code></pre></div>
</section>
<section id="local.settings.json" class="level3" data-number="4.3">
<h3 data-number="4.3" class="anchored" data-anchor-id="local.settings.json"><span class="header-section-number">4.3</span> local.settings.json</h3>
<div class="sourceCode" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode numberSource json number-lines code-with-copy"><code class="sourceCode json"><span id="cb8-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb8-2">  <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"IsEncrypted"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">false</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb8-3">  <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"Values"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb8-4">    <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"AzureWebJobsStorage"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb8-5">    <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"FUNCTIONS_WORKER_RUNTIME"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"python"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb8-6">    <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"AZURE_OPENAI_ENDPOINT"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://openai-rag-prod.openai.azure.com/"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb8-7">    <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"AZURE_OPENAI_API_KEY"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"your-key"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb8-8">    <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"AZURE_OPENAI_DEPLOYMENT"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gpt-4o"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb8-9">    <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"AZURE_OPENAI_API_VERSION"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"2024-02-01"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb8-10">    <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"AZURE_SEARCH_ENDPOINT"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://search-rag-prod.search.windows.net"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb8-11">    <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"AZURE_SEARCH_API_KEY"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"your-key"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb8-12">    <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"AZURE_SEARCH_INDEX_NAME"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"rag-documents"</span></span>
<span id="cb8-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb8-14"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">}</span></span></code></pre></div>
</section>
</section>
<section id="rag-함수-구현" class="level2" data-number="5">
<h2 data-number="5" class="anchored" data-anchor-id="rag-함수-구현"><span class="header-section-number">5</span> RAG 함수 구현</h2>
<section id="rag-queryinit.py" class="level3" data-number="5.1">
<h3 data-number="5.1" class="anchored" data-anchor-id="rag-queryinit.py"><span class="header-section-number">5.1</span> rag-query/<strong>init</strong>.py</h3>
<div class="sourceCode" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb9-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> azure.functions <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> func</span>
<span id="cb9-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> logging</span>
<span id="cb9-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> json</span>
<span id="cb9-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> os</span>
<span id="cb9-5"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> langchain_openai <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> AzureOpenAIEmbeddings, AzureChatOpenAI</span>
<span id="cb9-6"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> langchain_community.vectorstores.azuresearch <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> AzureSearch</span>
<span id="cb9-7"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> langchain_core.prompts <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> ChatPromptTemplate</span>
<span id="cb9-8"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> langchain_core.output_parsers <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> StrOutputParser</span>
<span id="cb9-9"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> langchain_core.runnables <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> RunnablePassthrough</span>
<span id="cb9-10"></span>
<span id="cb9-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 환경 변수 로드</span></span>
<span id="cb9-12">AZURE_OPENAI_ENDPOINT <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> os.getenv(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"AZURE_OPENAI_ENDPOINT"</span>)</span>
<span id="cb9-13">AZURE_OPENAI_API_KEY <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> os.getenv(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"AZURE_OPENAI_API_KEY"</span>)</span>
<span id="cb9-14">AZURE_OPENAI_DEPLOYMENT <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> os.getenv(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"AZURE_OPENAI_DEPLOYMENT"</span>)</span>
<span id="cb9-15">AZURE_OPENAI_API_VERSION <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> os.getenv(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"AZURE_OPENAI_API_VERSION"</span>)</span>
<span id="cb9-16">AZURE_SEARCH_ENDPOINT <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> os.getenv(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"AZURE_SEARCH_ENDPOINT"</span>)</span>
<span id="cb9-17">AZURE_SEARCH_API_KEY <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> os.getenv(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"AZURE_SEARCH_API_KEY"</span>)</span>
<span id="cb9-18">AZURE_SEARCH_INDEX_NAME <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> os.getenv(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"AZURE_SEARCH_INDEX_NAME"</span>)</span>
<span id="cb9-19"></span>
<span id="cb9-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 전역 초기화 (Cold Start 최적화)</span></span>
<span id="cb9-21">embeddings <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span></span>
<span id="cb9-22">vector_store <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span></span>
<span id="cb9-23">llm <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span></span>
<span id="cb9-24">rag_chain <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span></span>
<span id="cb9-25"></span>
<span id="cb9-26"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> init_rag_components():</span>
<span id="cb9-27">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""RAG 컴포넌트 초기화 (한 번만 실행)"""</span></span>
<span id="cb9-28">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">global</span> embeddings, vector_store, llm, rag_chain</span>
<span id="cb9-29">    </span>
<span id="cb9-30">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> rag_chain <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">is</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">not</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>:</span>
<span id="cb9-31">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 이미 초기화됨</span></span>
<span id="cb9-32">    </span>
<span id="cb9-33">    logging.info(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"RAG 컴포넌트 초기화 중..."</span>)</span>
<span id="cb9-34">    </span>
<span id="cb9-35">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Embeddings</span></span>
<span id="cb9-36">    embeddings <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> AzureOpenAIEmbeddings(</span>
<span id="cb9-37">        azure_deployment<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"text-embedding-3-small"</span>,</span>
<span id="cb9-38">        openai_api_version<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>AZURE_OPENAI_API_VERSION,</span>
<span id="cb9-39">        azure_endpoint<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>AZURE_OPENAI_ENDPOINT,</span>
<span id="cb9-40">        api_key<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>AZURE_OPENAI_API_KEY</span>
<span id="cb9-41">    )</span>
<span id="cb9-42">    </span>
<span id="cb9-43">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Vector Store</span></span>
<span id="cb9-44">    vector_store <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> AzureSearch(</span>
<span id="cb9-45">        azure_search_endpoint<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>AZURE_SEARCH_ENDPOINT,</span>
<span id="cb9-46">        azure_search_key<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>AZURE_SEARCH_API_KEY,</span>
<span id="cb9-47">        index_name<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>AZURE_SEARCH_INDEX_NAME,</span>
<span id="cb9-48">        embedding_function<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>embeddings.embed_query</span>
<span id="cb9-49">    )</span>
<span id="cb9-50">    </span>
<span id="cb9-51">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># LLM</span></span>
<span id="cb9-52">    llm <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> AzureChatOpenAI(</span>
<span id="cb9-53">        azure_deployment<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>AZURE_OPENAI_DEPLOYMENT,</span>
<span id="cb9-54">        openai_api_version<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>AZURE_OPENAI_API_VERSION,</span>
<span id="cb9-55">        azure_endpoint<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>AZURE_OPENAI_ENDPOINT,</span>
<span id="cb9-56">        api_key<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>AZURE_OPENAI_API_KEY,</span>
<span id="cb9-57">        temperature<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb9-58">    )</span>
<span id="cb9-59">    </span>
<span id="cb9-60">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Retriever</span></span>
<span id="cb9-61">    retriever <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> vector_store.as_retriever(search_kwargs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>{<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"k"</span>: <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>})</span>
<span id="cb9-62">    </span>
<span id="cb9-63">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Prompt</span></span>
<span id="cb9-64">    prompt <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ChatPromptTemplate.from_template(</span>
<span id="cb9-65">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"""다음 컨텍스트를 참고하여 질문에 답변하세요.</span></span>
<span id="cb9-66"></span>
<span id="cb9-67"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">컨텍스트:</span></span>
<span id="cb9-68"><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{context}</span></span>
<span id="cb9-69"></span>
<span id="cb9-70"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">질문: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{question}</span></span>
<span id="cb9-71"></span>
<span id="cb9-72"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">답변:"""</span></span>
<span id="cb9-73">    )</span>
<span id="cb9-74">    </span>
<span id="cb9-75">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># RAG Chain</span></span>
<span id="cb9-76">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> format_docs(docs):</span>
<span id="cb9-77">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>.join([doc.page_content <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> doc <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> docs])</span>
<span id="cb9-78">    </span>
<span id="cb9-79">    rag_chain <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (</span>
<span id="cb9-80">        {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"context"</span>: retriever <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> format_docs, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"question"</span>: RunnablePassthrough()}</span>
<span id="cb9-81">        <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> prompt</span>
<span id="cb9-82">        <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> llm</span>
<span id="cb9-83">        <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> StrOutputParser()</span>
<span id="cb9-84">    )</span>
<span id="cb9-85">    </span>
<span id="cb9-86">    logging.info(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"RAG 컴포넌트 초기화 완료"</span>)</span>
<span id="cb9-87"></span>
<span id="cb9-88"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> main(req: func.HttpRequest) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span> func.HttpResponse:</span>
<span id="cb9-89">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""HTTP 트리거 함수"""</span></span>
<span id="cb9-90">    logging.info(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'RAG 쿼리 요청 수신'</span>)</span>
<span id="cb9-91">    </span>
<span id="cb9-92">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">try</span>:</span>
<span id="cb9-93">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># RAG 컴포넌트 초기화</span></span>
<span id="cb9-94">        init_rag_components()</span>
<span id="cb9-95">        </span>
<span id="cb9-96">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 요청 파싱</span></span>
<span id="cb9-97">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">try</span>:</span>
<span id="cb9-98">            req_body <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> req.get_json()</span>
<span id="cb9-99">            question <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> req_body.get(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'question'</span>)</span>
<span id="cb9-100">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">except</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">ValueError</span>:</span>
<span id="cb9-101">            question <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> req.params.get(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'question'</span>)</span>
<span id="cb9-102">        </span>
<span id="cb9-103">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">not</span> question:</span>
<span id="cb9-104">            <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> func.HttpResponse(</span>
<span id="cb9-105">                json.dumps({<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"error"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"질문을 입력해주세요"</span>}),</span>
<span id="cb9-106">                mimetype<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"application/json"</span>,</span>
<span id="cb9-107">                status_code<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">400</span></span>
<span id="cb9-108">            )</span>
<span id="cb9-109">        </span>
<span id="cb9-110">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># RAG 실행</span></span>
<span id="cb9-111">        logging.info(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"질문: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>question<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb9-112">        answer <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> rag_chain.invoke(question)</span>
<span id="cb9-113">        </span>
<span id="cb9-114">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 응답 반환</span></span>
<span id="cb9-115">        response <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {</span>
<span id="cb9-116">            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"question"</span>: question,</span>
<span id="cb9-117">            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"answer"</span>: answer,</span>
<span id="cb9-118">            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"status"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"success"</span></span>
<span id="cb9-119">        }</span>
<span id="cb9-120">        </span>
<span id="cb9-121">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> func.HttpResponse(</span>
<span id="cb9-122">            json.dumps(response, ensure_ascii<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>),</span>
<span id="cb9-123">            mimetype<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"application/json"</span>,</span>
<span id="cb9-124">            status_code<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">200</span></span>
<span id="cb9-125">        )</span>
<span id="cb9-126">    </span>
<span id="cb9-127">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">except</span> <span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">Exception</span> <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> e:</span>
<span id="cb9-128">        logging.error(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"오류 발생: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>(e)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb9-129">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> func.HttpResponse(</span>
<span id="cb9-130">            json.dumps({<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"error"</span>: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>(e)}),</span>
<span id="cb9-131">            mimetype<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"application/json"</span>,</span>
<span id="cb9-132">            status_code<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">500</span></span>
<span id="cb9-133">        )</span></code></pre></div>
</section>
<section id="function.json" class="level3" data-number="5.2">
<h3 data-number="5.2" class="anchored" data-anchor-id="function.json"><span class="header-section-number">5.2</span> function.json</h3>
<div class="sourceCode" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode numberSource json number-lines code-with-copy"><code class="sourceCode json"><span id="cb10-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb10-2">  <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"scriptFile"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"__init__.py"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb10-3">  <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"bindings"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">[</span></span>
<span id="cb10-4">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb10-5">      <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"authLevel"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"function"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb10-6">      <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"type"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"httpTrigger"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb10-7">      <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"direction"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"in"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb10-8">      <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"name"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"req"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb10-9">      <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"methods"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">[</span></span>
<span id="cb10-10">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"get"</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb10-11">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"post"</span></span>
<span id="cb10-12">      <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb10-13">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">}</span><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb10-14">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">{</span></span>
<span id="cb10-15">      <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"type"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"http"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb10-16">      <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"direction"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"out"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">,</span></span>
<span id="cb10-17">      <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">"name"</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"$return"</span></span>
<span id="cb10-18">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb10-19">  <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">]</span></span>
<span id="cb10-20"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">}</span></span></code></pre></div>
</section>
</section>
<section id="로컬-테스트" class="level2" data-number="6">
<h2 data-number="6" class="anchored" data-anchor-id="로컬-테스트"><span class="header-section-number">6</span> 로컬 테스트</h2>
<section id="로컬-실행" class="level3" data-number="6.1">
<h3 data-number="6.1" class="anchored" data-anchor-id="로컬-실행"><span class="header-section-number">6.1</span> 로컬 실행</h3>
<div class="sourceCode" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb11-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Functions 앱 시작</span></span>
<span id="cb11-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">func</span> start</span></code></pre></div>
<p>출력:</p>
<pre><code>Functions:
        rag-query: [GET,POST] http://localhost:7071/api/rag-query</code></pre>
</section>
<section id="curl-테스트" class="level3" data-number="6.2">
<h3 data-number="6.2" class="anchored" data-anchor-id="curl-테스트"><span class="header-section-number">6.2</span> cURL 테스트</h3>
<div class="sourceCode" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb13-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># POST 요청</span></span>
<span id="cb13-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">curl</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-X</span> POST http://localhost:7071/api/rag-query <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb13-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-H</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Content-Type: application/json"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb13-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-d</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'{"question": "Azure AI Search란 무엇인가?"}'</span></span>
<span id="cb13-5"></span>
<span id="cb13-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># GET 요청</span></span>
<span id="cb13-7"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">curl</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"http://localhost:7071/api/rag-query?question=Azure+AI+Search란+무엇인가?"</span></span></code></pre></div>
</section>
<section id="python으로-테스트" class="level3" data-number="6.3">
<h3 data-number="6.3" class="anchored" data-anchor-id="python으로-테스트"><span class="header-section-number">6.3</span> Python으로 테스트</h3>
<div class="sourceCode" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb14-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> requests</span>
<span id="cb14-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> json</span>
<span id="cb14-3"></span>
<span id="cb14-4">url <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"http://localhost:7071/api/rag-query"</span></span>
<span id="cb14-5">data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"question"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Azure AI Search란 무엇인가?"</span>}</span>
<span id="cb14-6"></span>
<span id="cb14-7">response <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> requests.post(url, json<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>data)</span>
<span id="cb14-8">result <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> response.json()</span>
<span id="cb14-9"></span>
<span id="cb14-10"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"질문: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>result[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'question'</span>]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb14-11"><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"답변: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>result[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'answer'</span>]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span></code></pre></div>
</section>
</section>
<section id="azure-배포" class="level2" data-number="7">
<h2 data-number="7" class="anchored" data-anchor-id="azure-배포"><span class="header-section-number">7</span> Azure 배포</h2>
<section id="function-app-리소스-생성" class="level3" data-number="7.1">
<h3 data-number="7.1" class="anchored" data-anchor-id="function-app-리소스-생성"><span class="header-section-number">7.1</span> Function App 리소스 생성</h3>
<div class="sourceCode" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb15-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 리소스 그룹 생성</span></span>
<span id="cb15-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">az</span> group create <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--name</span> rg-rag-prod <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--location</span> koreacentral</span>
<span id="cb15-3"></span>
<span id="cb15-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Storage Account 생성 (Functions 필수)</span></span>
<span id="cb15-5"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">az</span> storage account create <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb15-6">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--name</span> stragprod <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb15-7">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--resource-group</span> rg-rag-prod <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb15-8">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--location</span> koreacentral <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb15-9">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--sku</span> Standard_LRS</span>
<span id="cb15-10"></span>
<span id="cb15-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Function App 생성 (Python 3.11)</span></span>
<span id="cb15-12"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">az</span> functionapp create <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb15-13">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--resource-group</span> rg-rag-prod <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb15-14">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--consumption-plan-location</span> koreacentral <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb15-15">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--runtime</span> python <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb15-16">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--runtime-version</span> 3.11 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb15-17">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--functions-version</span> 4 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb15-18">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--name</span> func-rag-prod <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb15-19">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--storage-account</span> stragprod <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb15-20">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--os-type</span> Linux</span></code></pre></div>
</section>
<section id="환경-변수-설정" class="level3" data-number="7.2">
<h3 data-number="7.2" class="anchored" data-anchor-id="환경-변수-설정"><span class="header-section-number">7.2</span> 환경 변수 설정</h3>
<div class="sourceCode" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb16-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Application Settings 설정</span></span>
<span id="cb16-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">az</span> functionapp config appsettings set <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb16-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--name</span> func-rag-prod <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb16-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--resource-group</span> rg-rag-prod <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb16-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--settings</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb16-6">    AZURE_OPENAI_ENDPOINT=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://openai-rag-prod.openai.azure.com/"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb16-7">    AZURE_OPENAI_API_KEY=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"your-key"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb16-8">    AZURE_OPENAI_DEPLOYMENT=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gpt-4o"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb16-9">    AZURE_OPENAI_API_VERSION=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"2024-02-01"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb16-10">    AZURE_SEARCH_ENDPOINT=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://search-rag-prod.search.windows.net"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb16-11">    AZURE_SEARCH_API_KEY=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"your-key"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb16-12">    AZURE_SEARCH_INDEX_NAME=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"rag-documents"</span></span></code></pre></div>
</section>
<section id="배포" class="level3" data-number="7.3">
<h3 data-number="7.3" class="anchored" data-anchor-id="배포"><span class="header-section-number">7.3</span> 배포</h3>
<div class="sourceCode" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb17-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Azure에 배포</span></span>
<span id="cb17-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">func</span> azure functionapp publish func-rag-prod</span>
<span id="cb17-3"></span>
<span id="cb17-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 배포 완료 후 URL 확인</span></span>
<span id="cb17-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># https://func-rag-prod.azurewebsites.net/api/rag-query</span></span></code></pre></div>
</section>
<section id="배포-테스트" class="level3" data-number="7.4">
<h3 data-number="7.4" class="anchored" data-anchor-id="배포-테스트"><span class="header-section-number">7.4</span> 배포 테스트</h3>
<div class="sourceCode" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb18-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Function Key 조회</span></span>
<span id="cb18-2"><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">FUNCTION_KEY</span><span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$(</span><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">az</span> functionapp keys list <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb18-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--name</span> func-rag-prod <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb18-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--resource-group</span> rg-rag-prod <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb18-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--query</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"functionKeys.default"</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-o</span> tsv<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">)</span></span>
<span id="cb18-6"></span>
<span id="cb18-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># API 호출</span></span>
<span id="cb18-8"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">curl</span> <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-X</span> POST https://func-rag-prod.azurewebsites.net/api/rag-query<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">?</span>code=<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">$FUNCTION_KEY</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb18-9">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-H</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Content-Type: application/json"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb18-10">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">-d</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'{"question": "Azure AI Search란?"}'</span></span></code></pre></div>
</section>
</section>
<section id="cold-start-최적화" class="level2" data-number="8">
<h2 data-number="8" class="anchored" data-anchor-id="cold-start-최적화"><span class="header-section-number">8</span> Cold Start 최적화</h2>
<section id="premium-plan" class="level3" data-number="8.1">
<h3 data-number="8.1" class="anchored" data-anchor-id="premium-plan"><span class="header-section-number">8.1</span> Premium Plan</h3>
<p>Consumption Plan의 Cold Start를 개선하려면 Premium Plan으로 변경한다.</p>
<div class="sourceCode" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb19-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Premium Plan 생성</span></span>
<span id="cb19-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">az</span> functionapp plan create <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb19-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--resource-group</span> rg-rag-prod <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb19-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--name</span> plan-rag-premium <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb19-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--location</span> koreacentral <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb19-6">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--sku</span> EP1 <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb19-7">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--is-linux</span></span>
<span id="cb19-8"></span>
<span id="cb19-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Function App을 Premium Plan으로 변경</span></span>
<span id="cb19-10"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">az</span> functionapp update <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb19-11">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--name</span> func-rag-prod <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb19-12">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--resource-group</span> rg-rag-prod <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb19-13">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--plan</span> plan-rag-premium</span></code></pre></div>
<p><strong>Premium Plan 장점:</strong> - Always-on (Cold Start 없음) - VNET 통합 - 더 많은 메모리/CPU</p>
<p><strong>비용</strong>: ~$146/월 (EP1)</p>
</section>
<section id="컴포넌트-재사용" class="level3" data-number="8.2">
<h3 data-number="8.2" class="anchored" data-anchor-id="컴포넌트-재사용"><span class="header-section-number">8.2</span> 컴포넌트 재사용</h3>
<p>전역 변수로 컴포넌트를 캐싱하여 재초기화를 방지한다.</p>
<div class="sourceCode" id="cb20" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb20-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 전역 초기화 (함수 외부)</span></span>
<span id="cb20-2">embeddings <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span></span>
<span id="cb20-3">vector_store <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span></span>
<span id="cb20-4"></span>
<span id="cb20-5"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> init_components():</span>
<span id="cb20-6">    <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">global</span> embeddings, vector_store</span>
<span id="cb20-7">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> embeddings <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">is</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>:</span>
<span id="cb20-8">        embeddings <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> AzureOpenAIEmbeddings(...)</span>
<span id="cb20-9">        vector_store <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> AzureSearch(...)</span></code></pre></div>
</section>
</section>
<section id="스트리밍-응답" class="level2" data-number="9">
<h2 data-number="9" class="anchored" data-anchor-id="스트리밍-응답"><span class="header-section-number">9</span> 스트리밍 응답</h2>
<p>Azure Functions는 기본적으로 스트리밍을 지원하지 않지만, Server-Sent Events (SSE)로 구현 가능하다.</p>
<section id="sse-함수" class="level3" data-number="9.1">
<h3 data-number="9.1" class="anchored" data-anchor-id="sse-함수"><span class="header-section-number">9.1</span> SSE 함수</h3>
<div class="sourceCode" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb21-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> asyncio</span>
<span id="cb21-2"></span>
<span id="cb21-3"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">async</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> main(req: func.HttpRequest) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span> func.HttpResponse:</span>
<span id="cb21-4">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""스트리밍 응답"""</span></span>
<span id="cb21-5">    question <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> req.get_json().get(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'question'</span>)</span>
<span id="cb21-6">    </span>
<span id="cb21-7">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">async</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> generate():</span>
<span id="cb21-8">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">yield</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data: "</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> json.dumps({<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"type"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"start"</span>}) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb21-9">        </span>
<span id="cb21-10">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 스트리밍 실행</span></span>
<span id="cb21-11">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">async</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> chunk <span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> streaming_llm.astream(question):</span>
<span id="cb21-12">            <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">yield</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data: "</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> json.dumps({</span>
<span id="cb21-13">                <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"type"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"chunk"</span>,</span>
<span id="cb21-14">                <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"content"</span>: chunk.content</span>
<span id="cb21-15">            }) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb21-16">        </span>
<span id="cb21-17">        <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">yield</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"data: "</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> json.dumps({<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"type"</span>: <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"end"</span>}) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span></span>
<span id="cb21-18">    </span>
<span id="cb21-19">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> func.HttpResponse(</span>
<span id="cb21-20">        generate(),</span>
<span id="cb21-21">        mimetype<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"text/event-stream"</span></span>
<span id="cb21-22">    )</span></code></pre></div>
</section>
</section>
<section id="모니터링" class="level2" data-number="10">
<h2 data-number="10" class="anchored" data-anchor-id="모니터링"><span class="header-section-number">10</span> 모니터링</h2>
<section id="application-insights" class="level3" data-number="10.1">
<h3 data-number="10.1" class="anchored" data-anchor-id="application-insights"><span class="header-section-number">10.1</span> Application Insights</h3>
<p>Application Insights는 자동으로 활성화된다.</p>
<p><strong>로그 확인:</strong></p>
<div class="sourceCode" id="cb22" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb22-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Azure Portal에서 확인</span></span>
<span id="cb22-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Function App → Application Insights → Logs</span></span>
<span id="cb22-3"></span>
<span id="cb22-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 예시 쿼리</span></span>
<span id="cb22-5"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">traces</span></span>
<span id="cb22-6"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">where</span> message contains <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"RAG"</span></span>
<span id="cb22-7"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">order</span> by timestamp desc</span>
<span id="cb22-8"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">|</span> <span class="ex" style="color: null;
background-color: null;
font-style: inherit;">take</span> 100</span></code></pre></div>
</section>
<section id="커스텀-메트릭" class="level3" data-number="10.2">
<h3 data-number="10.2" class="anchored" data-anchor-id="커스텀-메트릭"><span class="header-section-number">10.2</span> 커스텀 메트릭</h3>
<div class="sourceCode" id="cb23" style="background: #f1f3f5;"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb23-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> applicationinsights <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> TelemetryClient</span>
<span id="cb23-2"></span>
<span id="cb23-3">tc <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> TelemetryClient(os.getenv(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"APPINSIGHTS_INSTRUMENTATIONKEY"</span>))</span>
<span id="cb23-4"></span>
<span id="cb23-5"><span class="kw" style="color: #003B4F;
background-color: null;
font-style: inherit;">def</span> main(req: func.HttpRequest) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span> func.HttpResponse:</span>
<span id="cb23-6">    start_time <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> time.time()</span>
<span id="cb23-7">    </span>
<span id="cb23-8">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># RAG 실행</span></span>
<span id="cb23-9">    answer <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> rag_chain.invoke(question)</span>
<span id="cb23-10">    </span>
<span id="cb23-11">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 메트릭 전송</span></span>
<span id="cb23-12">    duration <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> time.time() <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> start_time</span>
<span id="cb23-13">    tc.track_metric(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"RAGQueryDuration"</span>, duration)</span>
<span id="cb23-14">    tc.track_event(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"RAGQuery"</span>, {<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"question_length"</span>: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(question)})</span>
<span id="cb23-15">    tc.flush()</span>
<span id="cb23-16">    </span>
<span id="cb23-17">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">return</span> func.HttpResponse(...)</span></code></pre></div>
</section>
</section>
<section id="cors-설정" class="level2" data-number="11">
<h2 data-number="11" class="anchored" data-anchor-id="cors-설정"><span class="header-section-number">11</span> CORS 설정</h2>
<p>웹 앱에서 API를 호출하려면 CORS 설정이 필요하다.</p>
<div class="sourceCode" id="cb24" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb24-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># CORS 허용</span></span>
<span id="cb24-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">az</span> functionapp cors add <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb24-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--name</span> func-rag-prod <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb24-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--resource-group</span> rg-rag-prod <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb24-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--allowed-origins</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://your-app.com"</span></span>
<span id="cb24-6"></span>
<span id="cb24-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 모든 오리진 허용 (개발 환경)</span></span>
<span id="cb24-8"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">az</span> functionapp cors add <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb24-9">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--name</span> func-rag-prod <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb24-10">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--resource-group</span> rg-rag-prod <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb24-11">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--allowed-origins</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"*"</span></span></code></pre></div>
</section>
<section id="보안" class="level2" data-number="12">
<h2 data-number="12" class="anchored" data-anchor-id="보안"><span class="header-section-number">12</span> 보안</h2>
<section id="managed-identity" class="level3" data-number="12.1">
<h3 data-number="12.1" class="anchored" data-anchor-id="managed-identity"><span class="header-section-number">12.1</span> Managed Identity</h3>
<p>API 키 대신 Managed Identity를 사용한다.</p>
<div class="sourceCode" id="cb25" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb25-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Managed Identity 활성화</span></span>
<span id="cb25-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">az</span> functionapp identity assign <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb25-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--name</span> func-rag-prod <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb25-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--resource-group</span> rg-rag-prod</span>
<span id="cb25-5"></span>
<span id="cb25-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Azure OpenAI에 권한 부여</span></span>
<span id="cb25-7"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">az</span> role assignment create <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb25-8">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--assignee</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>managed-identity-principal-id<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb25-9">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--role</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Cognitive Services OpenAI User"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb25-10">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--scope</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span>azure-openai-resource-id<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span></span></code></pre></div>
</section>
<section id="key-vault-통합" class="level3" data-number="12.2">
<h3 data-number="12.2" class="anchored" data-anchor-id="key-vault-통합"><span class="header-section-number">12.2</span> Key Vault 통합</h3>
<div class="sourceCode" id="cb26" style="background: #f1f3f5;"><pre class="sourceCode numberSource bash number-lines code-with-copy"><code class="sourceCode bash"><span id="cb26-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Key Vault 생성</span></span>
<span id="cb26-2"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">az</span> keyvault create <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb26-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--name</span> kv-rag-prod <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb26-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--resource-group</span> rg-rag-prod <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb26-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--location</span> koreacentral</span>
<span id="cb26-6"></span>
<span id="cb26-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 비밀 저장</span></span>
<span id="cb26-8"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">az</span> keyvault secret set <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb26-9">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--vault-name</span> kv-rag-prod <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb26-10">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--name</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"AzureOpenAIKey"</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb26-11">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--value</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"your-key"</span></span>
<span id="cb26-12"></span>
<span id="cb26-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Function App에서 참조</span></span>
<span id="cb26-14"><span class="ex" style="color: null;
background-color: null;
font-style: inherit;">az</span> functionapp config appsettings set <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb26-15">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--name</span> func-rag-prod <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb26-16">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--resource-group</span> rg-rag-prod <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb26-17">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">--settings</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">\</span></span>
<span id="cb26-18">    AZURE_OPENAI_API_KEY=<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"@Microsoft.KeyVault(SecretUri=https://kv-rag-prod.vault.azure.net/secrets/AzureOpenAIKey/)"</span></span></code></pre></div>
</section>
</section>
<section id="비용-최적화" class="level2" data-number="13">
<h2 data-number="13" class="anchored" data-anchor-id="비용-최적화"><span class="header-section-number">13</span> 비용 최적화</h2>
<section id="consumption-plan-비용" class="level3" data-number="13.1">
<h3 data-number="13.1" class="anchored" data-anchor-id="consumption-plan-비용"><span class="header-section-number">13.1</span> Consumption Plan 비용</h3>
<p><strong>계산식:</strong> - 실행 시간: $0.000016/GB-초 - 요청: $0.20/100만 요청</p>
<p><strong>예시</strong> (월 10,000 요청, 각 5초, 1.5GB 메모리): - 실행 비용: 10,000 × 5초 × 1.5GB × $0.000016 = $1.20 - 요청 비용: 10,000 / 1,000,000 × $0.20 = $0.002 - <strong>총 비용</strong>: ~$1.20/월</p>
<p><strong>무료 할당량:</strong> - 매월 400,000 GB-초 무료 - 매월 1,000,000 요청 무료</p>
</section>
</section>
<section id="참고-자료" class="level2" data-number="14">
<h2 data-number="14" class="anchored" data-anchor-id="참고-자료"><span class="header-section-number">14</span> 참고 자료</h2>
<section id="공식-문서" class="level3" data-number="14.1">
<h3 data-number="14.1" class="anchored" data-anchor-id="공식-문서"><span class="header-section-number">14.1</span> 공식 문서</h3>
<ul>
<li><a href="https://learn.microsoft.com/en-us/azure/azure-functions/functions-reference-python">Azure Functions Python</a></li>
<li><a href="https://azure.microsoft.com/en-us/pricing/details/functions/">Functions 가격</a></li>
</ul>
</section>
</section>
<section id="다음-단계" class="level2" data-number="15">
<h2 data-number="15" class="anchored" data-anchor-id="다음-단계"><span class="header-section-number">15</span> 다음 단계</h2>
<p>서버리스 배포가 완료되었다면, 이제 컨테이너 기반 배포를 살펴보자:</p>
<p>👉 <a href="../../../../../docs/blog/posts/Agent/13-Cloud-RAG/08-Azure-Container-Apps.html">08-Azure-Container-Apps.qmd</a> - Azure Container Apps를 활용한 컨테이너 배포</p>


</section>

 ]]></description>
  <category>AI</category>
  <category>RAG</category>
  <category>Azure</category>
  <guid>kk3225.netlify.app/docs/blog/posts/Agent/13-Cloud-RAG/07-Azure-Functions-Apps.html</guid>
  <pubDate>Fri, 07 Nov 2025 15:00:00 GMT</pubDate>
</item>
</channel>
</rss>
