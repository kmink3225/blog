---
title: "Microsoft Word"
subtitle: 문서 로더
description: |
  다양한 형식의 문서를 LangChain으로 로드하는 방법을 다룬다.
categories:
  - AI
  - RAG
  - LangChain
author: Kwangmin Kim
date: 12/31/2024
format: 
  html:
    page-layout: full
    code-fold: true
    toc: true
    number-sections: true
draft: False
execute:
    eval: false
---



[Microsoft Word](https://www.microsoft.com/en-us/microsoft-365/word)는 Microsoft에서 개발한 워드 프로세서입니다.

이는 `Word` 문서를 하류에서 사용할 수 있는 문서 형식으로 로드하는 방법을 다룹니다.

## Docx2txtLoader

`Docx2txt`를 사용하여 .docx 파일을 문서로 불러올 수 있습니다.

```{python}
# 설치
# !pip install -qU docx2txt
```

```{python}
from langchain_community.document_loaders import Docx2txtLoader

loader = Docx2txtLoader("./data/sample-word-document.docx")  # 문서 로더 초기화

docs = loader.load()  # 문서 로딩

print(len(docs))
```

## UnstructuredWordDocumentLoader

```{python}
from langchain_community.document_loaders import UnstructuredWordDocumentLoader

# 비구조화된 워드 문서 로더 인스턴스화
loader = UnstructuredWordDocumentLoader("./data/sample-word-document.docx")

# 문서 로드
docs = loader.load()

print(len(docs))
```

결과는 1개의 단일 Document 로 로드됩니다.

```{python}
# metadata 출력
print(docs[0].metadata)
```

내부적으로 비정형은 텍스트 덩어리마다 서로 다른 "**요소**"를 만듭니다. 

기본적으로 이들은 함께 결합되어 있지만 `mode="elements"` 를 지정하여 쉽게 분리할 수 있습니다.

```{python}
# UnstructuredWordDocumentLoader
loader = UnstructuredWordDocumentLoader(
    "./data/sample-word-document.docx", mode="elements"
)

# 데이터 로드
docs = loader.load()

# 로드한 문서의 개수 출력
print(len(docs))
```

```{python}
# 첫번째 문서의 내용 출력
print(docs[0].page_content)
```

```{python}
# 첫번째 문서의 내용 출력
docs[0].metadata
```

