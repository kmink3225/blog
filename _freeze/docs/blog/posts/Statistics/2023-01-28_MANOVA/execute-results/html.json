{
  "hash": "992c57f63eed61598aa9bba36631b272",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: MANOVA\nsubtitle: ANOVA, one-way ANOVA, Two-way ANOVA, ANCOVA, repeated measures ANOVA, MANOVA\ndescription: | \n  The analysis of variance (ANOVA) is one of the most widely used statistical techniques. When we conduct a comparison testing of multiple groups such as A, B, and C on each with numeric data, the statistical test for a significant difference among the groups is called analysis of variance, or ANOVA.  \ncategories:\n  - Statistics\nauthor: Kwangmin Kim\ndate: 01/07/2023\ndraft: false\nformat: \n  html:\n    toc: true\n    number-sections: True\n    code-fold: true\n    page-layout: full\nexecute: \n  warning: false\n  message: false\n---\n\n\n\n## Description\n\n 다변량 분산분석(Multivariate Analysis of Variance, MANOVA)\n\n- 2개 이상의 종속변수가 있을 경우 집단별  차이를 동시에 검정\n- 연구의 타당성 증가\n\n## Example\n\n### Load Libraries and Data\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(faraway)\nlibrary(markdown)\nlibrary(heplots)\nlibrary(HH)\nlibrary(psych)\n```\n:::\n\n\n### Data Description\n\n::: {.cell}\n\n```{.r .cell-code}\nstr(Skulls)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n'data.frame':\t150 obs. of  5 variables:\n $ epoch: Ord.factor w/ 5 levels \"c4000BC\"<\"c3300BC\"<..: 1 1 1 1 1 1 1 1 1 1 ...\n $ mb   : num  131 125 131 119 136 138 139 125 131 134 ...\n $ bh   : num  138 131 132 132 143 137 130 136 134 134 ...\n $ bl   : num  89 92 99 96 100 89 108 93 102 99 ...\n $ nh   : num  49 48 50 44 54 56 48 48 51 51 ...\n```\n\n\n:::\n:::\n\n\nR console에 `?Skulls`를 입력하면 다음과 같은 설명이 나온다.\n\n**Measurements made on Egyptian skulls from five epochs.**\n\n* The epochs correspond to the following periods of Egyptian history:\n  * the early predynstic period (circa 4000 BC);\n  * the late predynatic period (circa 3300 BC);\n  * the 12th and 13t dynasties (circa 1850 BC);\n  * the Ptolemiac peiod (circa 200 BC);\n  * the Roman period(circa 150 AD).\n\n**The question is hether the measurements change over time. Non-constant measurements of the skulls over time would indicate interbreeding with immigrant populations. Note that using polynomial contrasts for epoch essentially treats the time points as equally spaced**\n\n즉, skulls 고대 이집트 왕조 부터 로마시대까지 이집트 지역에서 발군된 두개골의 크기를 측정한 데이터 이집트 역사를 5개의 시대로 구분하고 각 시대별로 30개씩의 두개골을 4개의 지표로 측정\n\n이 data는 5개의 변수와 150개의 samples을 포함한다.\n\n* epoch : \n* mb : \n* bh : \n* bl : \n* nh : \n\n\n\n## EDA\n\n### Descriptive Statistics\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(heplots)\n#skulls 고대 이집트 왕조 부터 로마시대까지 이집트 지역에서 발군된 두개골의 크기를 측정한 데이터\n# 이집트 역사를 5개의 시대로 구분하고 각 시대별로 30개씩의 두개골을 4개의 지표로 측정\n# epoch: 이집트의 시대를 5개로 구분, 독립변수\n# mb : 두개골의 폭, 종속 변수\n# bh : 두개골의 높이, 종속 변수\n# bl : 두개골의 길이, 종속 변수\n# nh : 코의 높이, 종속 변수\n\nlibrary(dplyr)\nsample_n(Skulls,10)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n      epoch  mb  bh  bl nh\n82  c1850BC 133 131 100 50\n150  cAD150 136 133  97 51\n39  c3300BC 131 134  96 50\n52  c3300BC 126 131 100 48\n33  c3300BC 138 134  98 45\n112  c200BC 144 124  86 50\n76  c1850BC 135 138 102 55\n13  c4000BC 126 129 109 51\n36  c3300BC 135 136  98 52\n10  c4000BC 134 134  99 51\n```\n\n\n:::\n\n```{.r .cell-code}\nattach(Skulls)# Skulls를 작업 경로에 포함시키기\nsearch() # 작업 경로 확인인\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n [1] \".GlobalEnv\"           \"Skulls\"               \"package:psych\"       \n [4] \"package:HH\"           \"package:gridExtra\"    \"package:multcomp\"    \n [7] \"package:TH.data\"      \"package:MASS\"         \"package:survival\"    \n[10] \"package:mvtnorm\"      \"package:latticeExtra\" \"package:grid\"        \n[13] \"package:lattice\"      \"package:heplots\"      \"package:broom\"       \n[16] \"package:markdown\"     \"package:faraway\"      \"package:lubridate\"   \n[19] \"package:forcats\"      \"package:stringr\"      \"package:dplyr\"       \n[22] \"package:purrr\"        \"package:readr\"        \"package:tidyr\"       \n[25] \"package:tibble\"       \"package:ggplot2\"      \"package:tidyverse\"   \n[28] \"package:stats\"        \"package:graphics\"     \"package:grDevices\"   \n[31] \"package:utils\"        \"package:datasets\"     \"package:methods\"     \n[34] \"Autoloads\"            \"package:base\"        \n```\n\n\n:::\n\n```{.r .cell-code}\n# 종속 변수를 결합시켜 하나의 행렬로 만들기\ny<-cbind(mb,bh,bl,nh)\n# 시대별 두개골  길이의 평균 보기\naggregate(y,by=list(epoch),mean) # 언뜻 보기에 차이가 있는 것 처럼 보임\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  Group.1       mb       bh       bl       nh\n1 c4000BC 131.3667 133.6000 99.16667 50.53333\n2 c3300BC 132.3667 132.7000 99.06667 50.23333\n3 c1850BC 134.4667 133.8000 96.03333 50.56667\n4  c200BC 135.5000 132.3000 94.53333 51.96667\n5  cAD150 136.1667 130.3333 93.50000 51.36667\n```\n\n\n:::\n\n```{.r .cell-code}\n# 모집단으로 일반화하기 위해 통계적 검정 시행\nskulls_manova<-manova(y~epoch)\nsummary(skulls_manova)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n           Df  Pillai approx F num Df den Df    Pr(>F)    \nepoch       4 0.35331    3.512     16    580 4.675e-06 ***\nResiduals 145                                             \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n\n```{.r .cell-code}\n# 시대별 두개골 측정값이 차이가 있는 것으로 보임\n\n# 구체적으로 어느 두개 골 측정값에서 차이가 나는지 확인\nsummary.aov(skulls_manova)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n Response mb :\n             Df  Sum Sq Mean Sq F value    Pr(>F)    \nepoch         4  502.83 125.707  5.9546 0.0001826 ***\nResiduals   145 3061.07  21.111                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n Response bh :\n             Df Sum Sq Mean Sq F value  Pr(>F)  \nepoch         4  229.9  57.477  2.4474 0.04897 *\nResiduals   145 3405.3  23.485                  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n Response bl :\n             Df Sum Sq Mean Sq F value    Pr(>F)    \nepoch         4  803.3 200.823  8.3057 4.636e-06 ***\nResiduals   145 3506.0  24.179                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n Response nh :\n             Df Sum Sq Mean Sq F value Pr(>F)\nepoch         4   61.2  15.300   1.507 0.2032\nResiduals   145 1472.1  10.153               \n```\n\n\n:::\n\n```{.r .cell-code}\n# nh는 차이가 없는 것으로 보임\n\n## 시간에 따라 두개골 측정이 다르다는 것은 이민족 유입의 혼혈 가능성이 있음\n\ndetach(Skulls)# 작업경로에서 삭제제\n```\n:::\n\n\n\n\n### One-Way ANOVA \n\n\n\n\n::: {.cell}\n\n:::\n\n\n\n\n## Blog Guide Map Link\n\n* [Statistics Blog](../guide_map/index.qmd)\n* [Engineering Blog](../../Engineering/guide_map/index.qmd)\n* [Deep Learning Blog](../../DL/guide_map/index.qmd)\n* [Machine Learning Blog](../../ML/guide_map/index.qmd)\n* [Mathematics Blog](../../Mathmatics/guide_map/index.qmd)\n* [Patent Blog](../../Patent/guide_map/index.qmd)\n* [Validation Blog](../../Validation/guide_map/index.qmd)\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}