{
  "hash": "82920c1ad73771a3669df43fdd564e6b",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: Maximum Likelihood Estimation, Statistical Bias, and Point Estimation\nsubtitle: Overview\ndescription: |\n  template\ncategories:\n  - Statistics\nauthor: Kwangmin Kim\ndate: 03/29/2023\nformat: \n  html:\n    page-layout: full\n    code-fold: true\n    toc: true\n    number-sections: true\nexecute:\n  warning: false\ndraft: false\n---\n\n\n### Definition\n\nTo talk about MLE (Maximum Likelihood Estimation), we need to recap the concepts and definitions of probability and likelihood. They are related but distinct concepts.\n\n* probability is a measure of the chance that an event will occur, given some prior knowledge or assumptions.\n* likelihood is a measure of the plausibility or compatibility of a particular set of model parameters, given the observed data.\n\n::: {.callout-tip}\n#### Chance vs Plausibility (personal opinion)\n  * chance is a general term but closer term to statistics, which is used in the situation of the probability or likelihood of an event occurring based on randomness or uncertainty.  \n  * plausibility chance is a term more often used in everyday life, which refers to the degree to which something is believable based on the available evidence or information.\n:::\n\n:::{#def-likelihood}\n\n Let $X_1, X_2, ..., X_n$ be a set of iid random variables with pdf or pmf $f(x_i | \\theta)$, where $\\theta$ is a vector of unknown parameters. Then, \n **the likelihood function is defined as the joint pdf or pmf of the observed data, given the values of the parameters**:\n\n$$\nL(\\theta | x_1, x_2, ..., x_n) = L(\\theta | \\mathbf x) = \\prod_{i=1}^n f(x_i | \\theta)\n$$\n:::\n\nThe likelihood function is a function of the parameters $\\theta$. The function measures the probability of observing a set of data, given the values of the parameters of a statistical model in order to estimate the values of the parameters by finding the values that maximize the likelihood function. The likelihood function is often used in the maximum likelihood estimation (MLE) method, where the MLE estimator is the set of parameter values that maximize the likelihood function.\n\nThe likelihood function is related to the concept of conditional probability. Given a set of observed data $x_1, x_2, ..., x_n$, the likelihood function measures the probability of observing these data, assuming a particular set of parameter values. The likelihood function is not a probability distribution, but it can be used to derive a probability distribution for the parameters, known as the posterior distribution, using Bayes' theorem.\n\n::: {.callout-tip}\n\n#### Probability\n\nProbability is a measure of the likelihood or chance that an event will occur, which is used to quantify uncertainty and randomness.  \nprobability is a function that maps a real number mapped from a random variable into $[0,1]$. The probability function, denoted by $P$, satisfies the following axioms:\n\n* Non-negativity: For any event $A \\in \\Omega$, $P(A) \\geq 0$.\n* Normalization: The probability of the entire sample space is 1, i.e., $P(\\Omega) = 1$.\n* Additivity: For any two disjoint events $A, B \\in \\Omega$, or $A \\cap B = \\emptyset$, the probability of their union is equal to the sum of their individual probabilities, i.e., $P(A \\cup B) = P(A) + P(B)$.\n:::\n\n#### Probability vs Likelihood\n\nProbability and likelihood are related but distinct concepts in statistics.\n\n* Probability refers to the measure of the likelihood that a particular event will occur, scaled on $[0,1]$. It is calculated based on a known probability distribution (= some prior knowledge or assumptions) before the data is observed. \n* On the other hand, likelihood refers to the probability of observing a set of data given a particular set of parameter values in a statistical model. It is calculated based on the unknown parameters after the data is observed. \n\nThe likelihood function is used to estimate the values of the parameters by finding the parameter values that maximize the likelihood function.\n\nFor instance of a coin flip, the **probability** of getting heads on a coin flip is 0.5, regardless of whether the coin has been flipped or not (i.e., without data). In contrast, the **likelihood** of observing heads after a coin has been flipped depends on the parameter of interest. We need to find the parameter given data, the results of multiple coin flips. \n\nIf we want to estimate the probability of heads, we can use the maximum likelihood estimation (MLE) approach, which involves finding the value of the coin bias that maximizes the likelihood of observing the observed sequence of heads and tails. The likelihood of the data is calculated using the binomial distribution, which gives the probability of observing a certain number of heads, given the number of tosses and the coin bias. In this case, the likelihood function is a function of the coin bias, and the probability of heads is the value of the coin bias that maximizes the likelihood function.\n\n#### Relation between Likelihood and PMF or PDF\n\nThe likelihood function is closely related to pmf or pdf of the data, which is a function that describes the probability of observing a particular value or range of values for the data, given the model parameters. The pmf or pdf is a function of the data, not the parameters, and is often written as $f(x|\\theta)$. The likelihood function is proportional to the pdf because is a product of pdfs when $X_i$ is independent, but with the data fixed and the parameter values treated as variables.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n\n# Probability of getting heads on a fair coin flip\nprob <- 0.5\n\n# likelihood\n## Simulate a coin flip with a biased coin\nset.seed(123) # Set random seed for reproducibility\nn <- 100 # flipping numbers\np <- 0.2 # Probability of getting heads\nx <- rbinom(n, size = 1, prob = p) # Simulate n coin flips\nx%>%head(10)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n [1] 0 0 0 1 1 0 0 1 0 0\n```\n\n\n:::\n\n```{.r .cell-code}\n## Calculate the likelihood of observing the data given the parameter value p\nlikelihood <- prod(dbinom(x, size = 1, prob = p))\nlikelihood%>%round()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0\n```\n\n\n:::\n:::\n\n\nIn this example, `prob` is the assumed probability of getting heads on a fair coin flip. The probability of getting heads on a fair coin flip is 0.5, which is a fixed value that does not depend on any specific data. On the other hand, `p` is the probability of getting heads for the biased coin that we are simulating. The likelihood of observing a set of coin flips depends on the parameter value, which is unknown (actually, we know that it was $p=0.2$), and the observed data. We simulate a set of 100 coin flips with a biased coin that has a probability of 0.2 of getting heads. We then calculate the likelihood of observing this data given the parameter value of 0.2, which is the product of the probability mass function for each flip. \n\nHowever, in a real-world scenario, we would not know the true value of `p` and we would need to estimate it based on the observed data. By finding the Maximum Likelihood Estimation (MLE) of p, we are estimating the value of p that is most likely to have generated the observed data. To find MLE of `p` that maximizes the likelihood function, we can use numerical optimization methods.\n\nAs n increases, the product term in the likelihood function $\\prod_{i=1}^{n} f(x_i; \\theta)$, where $f$ is the pdf or pmf of the distribution being used, can become very small (since it is a product of values less than 1) and may result in numerical underflow (i.e., the product becomes so small that it rounds down to 0 in computer calculations). In practice, we typically take the logarithm of the likelihood function, called the log-likelihood, to avoid this issue:\n\n$$\n\\log L(\\theta|x_1, x_2, ..., x_n) = \\sum_{i=1}^{n} \\log f(x_i; \\theta)\n$$\n\nUsing the logarithm allows us to convert the product of small probabilities into a sum of log-probabilities, which are typically easier to work with numerically and mathematically. In this case, as n increases, the sum term in the log-likelihood can decrease (since it is a sum of negative values), but the decrease may not be as severe as in the product term of the likelihood function because of the log scale converting very small or large values into larger or smaller values .\n\n:::{#def-MLE}\nThe MLE estimator $\\hat{\\theta}$ is the value of the parameter vector that maximizes the likelihood function:\n\n$$\n\\hat{\\theta}_{MLE} = \\underset{\\theta}{\\operatorname{argmax}} L(\\theta | x_1, x_2, ..., x_n)\n$$\n\nor equivalently, maximizes the log-likelihood function:\n\n$$\n\\hat{\\theta}_{MLE} = \\underset{\\theta}{\\operatorname{argmax}} \\log L(\\theta | x_1, x_2, ..., x_n)\n$$\n\n\n:::\n\n\nThe Maximum Likelihood Estimation (MLE) is a method of estimating the parameters of a statistical model by finding the values of the parameters that maximize the likelihood function. The likelihood function is the probability of observing the data, given the parameters of the model. The MLE estimator is the set of parameter values that maximize the likelihood function. In other words, the MLE is the set of parameter values that make the observed data most probable, given the assumed probability distribution. The likelihood function is typically the product or the sum (depending on whether the observations are assumed to be independent or not) of the probabilities or probability densities of the observations, evaluated at the values of the parameters.\n\nThe MLE estimator has desirable statistical properties, such as consistency, efficiency, and asymptotic normality, under certain regularity conditions on the likelihood function and the parameter space. However, it is important to note that the MLE is not always the best estimator for a given problem, and other estimation methods may be more appropriate depending on the specific characteristics of the data and the model.\n\nThe likelihood function is the joint probability density (or mass) function of the data, viewed as a function of the parameters, and we find the maximum of this function **by differentiating** it with respect to the parameters and setting the derivative to zero.\n\n\n\n### MLE of OLS{#sec-mle_ols}\n\nIn a linear regression, the maximum likelihood estimate of the ordinary least squares (OLS) coefficients is equivalent to the least squares estimate. To derive this, we assume that $\\epsilon_i \\sim N(0,\\sigma^2)$ and that the observations are independent. Then, the likelihood function for the data $Y = (Y_1, Y_2, \\dots, Y_n)$ is:\n\n$$\nL(Y|\\theta) =L(Y|\\beta,\\sigma^2) = (2\\pi\\sigma^2)^{-\\frac{n}{2}} e^{-\\frac{1}{2\\sigma^2} \\sum_{i=1}^n (Y_i - X_i\\beta)^2}\n$$\n\nwhere $X_i$ is the $i$ th row of the design matrix $X$ and $\\beta$ is the vector of regression coefficients.\n\nTo find the maximum likelihood estimates of $\\beta$ and $\\sigma^2$, we maximize the likelihood function with respect to these parameters. Taking the log of the likelihood function and simplifying, we obtain:\n\n$$\n\\log L(Y|\\theta) = \\log L(Y|\\beta,\\sigma^2) = -\\frac{n}{2} \\log (2\\pi) - \\frac{n}{2} \\log(\\sigma^2) - \\frac{1}{2\\sigma^2} \\sum_{i=1}^n (Y_i - X_i\\beta)^2\n$$\n\nTo maximize this function with respect to $\\beta$, we differentiate with respect to $\\beta$ and set the derivative to zero, $\\frac{\\partial}{\\partial \\theta} \\log L(Y|\\theta) = 0$:\n\nSolving for $\\beta$, we obtain:\n\n$$\n \\frac{\\partial}{\\partial \\theta} \\log L(Y|\\beta,\\sigma^2) = -\\frac{1}{2\\sigma^2} \\sum_{i=1}^n 2X_i(Y_i - X_i\\beta) = 0 \n$$\n\n$$\n\\hat{\\beta} = (X^T X)^{-1} X^T Y\n$$\n, which is the OLS estimate of $\\beta$.\n\nSolving for $\\sigma^2$, we differentiate with respect to $sigma^2$ and set the derivative to zero:\n\n$$\n\\frac{\\partial}{\\partial \\sigma^2} log L(Y|\\beta,\\sigma^2) = -\\frac{n}{2\\sigma^2} + \\frac{1}{2\\sigma^4} \\sum_{i=1}^n (Y_i - X_i\\beta)^2 = 0\n$$\n$$\n\\hat{\\sigma}^2 = \\frac{\\sum_{i=1}^n (Y_i - X_i\\beta)^2}{n}\n$$\n\n\nwhich is the OLS estimate of $\\sigma^2$.\n\nTherefore, we see that the maximum likelihood estimates of $\\beta$ and $\\sigma^2$ in linear regression with normally distributed errors are equivalent to the OLS estimates of these parameters.\n\n### Statistical Bias\n\nStatistical bias refers to a systematic error or deviation in the results of a statistical analysis that is caused by factors other than chance. A biased estimator is one that consistently produces estimates that are systematically different from the true value of the parameter being estimated.\n\n::: {.callout-tip}\n\n#### There are 5 Types of bias \n\nThe above article discusses five types of statistical bias that analysts, data scientists, and other business professionals should be aware of to minimize their effects on the final results. \n\n1. selection bias: data selection methods are not truly random, leading to unequal representation of the population.\n2. bias in assignment: pre-existing differences between groups in an experiment can affect the outcome, a.k.a  allocation bias, treatment assignment bias, or exposure assignment bias. \n3. confounders: additional variables not accounted for in the experimental design can impact the results. \n4. self-serving bias: individuals tend to downplay undesirable qualities and overemphasize desirable ones a.k.a cognitive bias. In other words, people tend to take credit for their successes and blame outside factors for their failures.\n5. experimenter expectations: researchers can unconsciously influence the data through verbal or non-verbal cues. \n\nBeing aware of these biases can lead to better models and more reliable insights for data-backed business decisions.\n\n[Source: Article Written by Jenny Gutbezahl](https://online.hbs.edu/blog/post/types-of-statistical-bias)\n:::\n\nIt is important to detect and correct for bias in statistical analyses, as biased estimates can lead to incorrect conclusions and decisions. One way to correct for bias is to use an unbiased estimator, which is one that has a zero bias, i.e., its expected value is equal to the true value of the parameter being estimated.\n\n\n:::{#def-bias}\nAn estimator $\\hat{\\theta}$ is said to be biased if\n\n$$\n\\operatorname{E}(\\hat{\\theta})\\ne \\theta\n$$\n\nwhere $\\operatorname{E}(\\hat{\\theta})$ is the expected value of the estimator $\\hat{\\theta}$, and $\\theta$ is the true value of the parameter being estimated.\n:::\n\nAn estimator is said to be unbiased if **its expected value is equal to the true value of the parameter being estimated**. In other words, an estimator is unbiased if, on average, it gives an estimate that is equal to the true value of the parameter.\n\n\n\n\n\n::: {.cell evale='false'}\n\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}