{
  "hash": "39d2ce39952926166a057121812e719c",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: \"ConversationKGMemory\"\nsubtitle: 대화 메모리\ndescription: |\n  대화 컨텍스트를 관리하는 다양한 메모리 시스템을 다룬다.\ncategories:\n  - AI\n  - RAG\n  - LangChain\nauthor: Kwangmin Kim\ndate: 12/31/2024\nformat: \n  html:\n    page-layout: full\n    code-fold: true\n    toc: true\n    number-sections: true\ndraft: False\nexecute:\n    eval: false\n---\n\n지식 그래프의 힘을 활용하여 정보를 저장하고 불러옵니다.\n\n이를 통해 모델이 서로 다른 개체 간의 관계를 이해하는 데 도움을 주고, 복잡한 연결망과 역사적 맥락을 기반으로 대응하는 능력을 향상시킵니다.\n\n::: {#2a8738ef .cell execution_count=1}\n``` {.python .cell-code}\n# API KEY를 환경변수로 관리하기 위한 설정 파일\nfrom dotenv import load_dotenv\n\n# API KEY 정보로드\nload_dotenv()\n```\n:::\n\n\n::: {#4069a21a .cell execution_count=2}\n``` {.python .cell-code}\nfrom langchain_openai import ChatOpenAI\nfrom langchain.memory import ConversationKGMemory\n```\n:::\n\n\n::: {#1ae8adcd .cell execution_count=3}\n``` {.python .cell-code}\nllm = ChatOpenAI(temperature=0)\n\nmemory = ConversationKGMemory(llm=llm, return_messages=True)\nmemory.save_context(\n    {\"input\": \"이쪽은 Pangyo 에 거주중인 김셜리씨 입니다.\"},\n    {\"output\": \"김셜리씨는 누구시죠?\"},\n)\nmemory.save_context(\n    {\"input\": \"김셜리씨는 우리 회사의 신입 디자이너입니다.\"},\n    {\"output\": \"만나서 반갑습니다.\"},\n)\n```\n:::\n\n\n::: {#4a9862a6 .cell execution_count=4}\n``` {.python .cell-code}\nmemory.load_memory_variables({\"input\": \"김셜리씨는 누구입니까?\"})\n```\n:::\n\n\n## Chain 에 메모리 활용하기\n\n`ConversationChain` 에 `ConversationKGMemory` 를 메모리로 지정하여 대화를 나눈 후 memory 를 확인해 보도록 하겠습니다.\n\n::: {#939130fa .cell execution_count=5}\n``` {.python .cell-code}\nfrom langchain.prompts.prompt import PromptTemplate\nfrom langchain.chains import ConversationChain\n\nllm = ChatOpenAI(temperature=0)\n\ntemplate = \"\"\"The following is a friendly conversation between a human and an AI. \nThe AI is talkative and provides lots of specific details from its context. \nIf the AI does not know the answer to a question, it truthfully says it does not know. \nThe AI ONLY uses information contained in the \"Relevant Information\" section and does not hallucinate.\n\nRelevant Information:\n\n{history}\n\nConversation:\nHuman: {input}\nAI:\"\"\"\nprompt = PromptTemplate(\n    input_variables=[\"history\", \"input\"], template=template)\n\nconversation_with_kg = ConversationChain(\n    llm=llm, prompt=prompt, memory=ConversationKGMemory(llm=llm)\n)\n```\n:::\n\n\n첫 번째 대화를 시작합니다. 간단한 인물에 대한 정보를 제공해 보겠습니다.\n\n::: {#fb40f341 .cell execution_count=6}\n``` {.python .cell-code}\nconversation_with_kg.predict(\n    input=\"My name is Teddy. Shirley is a coworker of mine, and she's a new designer at our company.\"\n)\n```\n:::\n\n\nShirley 라는 사람에 대한 질문을 진행합니다.\n\n::: {#1b4fd5b8 .cell execution_count=7}\n``` {.python .cell-code}\n# Shirley 에 대한 질문\nconversation_with_kg.memory.load_memory_variables({\"input\": \"who is Shirley?\"})\n```\n:::\n\n\n",
    "supporting": [
      "05-ConversationKnowledgeGraph_files"
    ],
    "filters": [],
    "includes": {}
  }
}