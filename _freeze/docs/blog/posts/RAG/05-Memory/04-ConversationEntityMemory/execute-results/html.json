{
  "hash": "058ff90103a5b3fd10edb7c0c663b46b",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: \"ConversationEntityMemory\"\nsubtitle: 대화 메모리\ndescription: |\n  대화 컨텍스트를 관리하는 다양한 메모리 시스템을 다룬다.\ncategories:\n  - AI\n  - RAG\n  - LangChain\nauthor: Kwangmin Kim\ndate: 12/31/2024\nformat: \n  html:\n    page-layout: full\n    code-fold: true\n    toc: true\n    number-sections: true\ndraft: False\nexecute:\n    eval: false\n---\n\n엔티티 메모리는 대화에서 특정 엔티티에 대한 주어진 사실을 기억합니다.\n\n엔티티 메모리는 엔티티에 대한 정보를 추출하고(LLM 사용) 시간이 지남에 따라 해당 엔티티에 대한 지식을 축적합니다(역시 LLM 사용).\n\n::: {#51a8801b .cell execution_count=1}\n``` {.python .cell-code}\n# API KEY를 환경변수로 관리하기 위한 설정 파일\nfrom dotenv import load_dotenv\n\n# API KEY 정보로드\nload_dotenv()\n```\n:::\n\n\n::: {#4371f98f .cell execution_count=2}\n``` {.python .cell-code}\nfrom langchain_openai import ChatOpenAI\nfrom langchain.chains import ConversationChain\nfrom langchain.memory import ConversationEntityMemory\nfrom langchain.memory.prompt import ENTITY_MEMORY_CONVERSATION_TEMPLATE\n```\n:::\n\n\nEntity 메모리를 효과적으로 사용하기 위하여, 제공되는 프롬프트를 사용합니다.\n\n::: {#cde5be6b .cell execution_count=3}\n``` {.python .cell-code}\n# Entity Memory를 사용하는 프롬프트 내용을 출력합니다.\nprint(ENTITY_MEMORY_CONVERSATION_TEMPLATE.template)\n```\n:::\n\n\n::: {#81cbffd3 .cell execution_count=4}\n``` {.python .cell-code}\n# LLM 을 생성합니다.\nllm = ChatOpenAI(model_name=\"gpt-4.1-mini\", temperature=0)\n\n# ConversationChain 을 생성합니다.\nconversation = ConversationChain(\n    llm=llm,\n    prompt=ENTITY_MEMORY_CONVERSATION_TEMPLATE,\n    memory=ConversationEntityMemory(llm=llm),\n)\n```\n:::\n\n\n대화를 시작합니다.\n\n입력한 대화를 바탕으로 `ConversationEntityMemory` 는 주요 Entity 정보를 별도로 저장합니다.\n\n::: {#50dd0d80 .cell execution_count=5}\n``` {.python .cell-code}\nconversation.predict(\n    input=\"테디와 셜리는 한 회사에서 일하는 동료입니다.\"\n    \"테디는 개발자이고 셜리는 디자이너입니다. \"\n    \"그들은 최근 회사에서 일하는 것을 그만두고 자신들의 회사를 차릴 계획을 세우고 있습니다.\"\n)\n```\n:::\n\n\nEntity는 `memory.entity_store.store` 에서 확인할 수 있습니다.\n\n::: {#5160d473 .cell execution_count=6}\n``` {.python .cell-code}\n# entity memory 를 출력합니다.\nconversation.memory.entity_store.store\n```\n:::\n\n\n",
    "supporting": [
      "04-ConversationEntityMemory_files"
    ],
    "filters": [],
    "includes": {}
  }
}