{
  "hash": "d5a6a849167559f2eb0462db2c0724b9",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: \"Excel\"\nsubtitle: 문서 로더\ndescription: |\n  다양한 형식의 문서를 LangChain으로 로드하는 방법을 다룬다.\ncategories:\n  - AI\n  - RAG\n  - LangChain\nauthor: Kwangmin Kim\ndate: 12/31/2024\nformat: \n  html:\n    page-layout: full\n    code-fold: true\n    toc: true\n    number-sections: true\ndraft: False\nexecute:\n    eval: false\n---\n\n`UnstructuredExcelLoader`는 `Microsoft Excel` 파일을 로드하는 데 사용됩니다. \n\n이 로더는 `.xlsx` 및 `.xls` 파일 모두에서 작동합니다. 페이지 내용은 Excel 파일의 원시 텍스트가 됩니다. \n\n`\"elements\"` 모드에서 로더를 사용하는 경우, 문서 메타데이터의 `text_as_html` 키 아래에서 Excel 파일의 HTML 표현이 제공됩니다.\n\n::: {#f7f806b1 .cell execution_count=1}\n``` {.python .cell-code}\n# 설치\n# !pip install -qU langchain-community unstructured openpyxl\n```\n:::\n\n\n::: {#bbe9bda4 .cell execution_count=2}\n``` {.python .cell-code}\nfrom langchain_community.document_loaders import UnstructuredExcelLoader\n\n# UnstructuredExcelLoader 생성\nloader = UnstructuredExcelLoader(\"./data/titanic.xlsx\", mode=\"elements\")\n\n# 문서 로드\ndocs = loader.load()\n\n# 문서 길이 출력\nprint(len(docs))\n```\n:::\n\n\n1개의 문서로 로드되었음을 확인합니다. \n\n`page_content` 에는 각 행의 데이터가 저장되고, `metadata` 의 `text_as_html` 에는 각 행의 데이터를 HTML 형식으로 저장합니다.\n\n::: {#ad58ad26 .cell execution_count=3}\n``` {.python .cell-code}\n# 문서 출력\nprint(docs[0].page_content[:200])\n```\n:::\n\n\n::: {#ea7a4649 .cell execution_count=4}\n``` {.python .cell-code}\n# metadata 의 text_as_html 출력\nprint(docs[0].metadata[\"text_as_html\"][:1000])\n```\n:::\n\n\n## DataFrameLoader\n\n- CSV 파일과 마찬가지로 Excel 파일을 로드하는 `read_excel()` 기능을 사용하여 DataFrame 으로 만든 뒤, 로드합니다.\n\n::: {#86138d98 .cell execution_count=5}\n``` {.python .cell-code}\nimport pandas as pd\n\n# Excel 파일 읽기\ndf = pd.read_excel(\"./data/titanic.xlsx\")\n```\n:::\n\n\n::: {#b9f1297b .cell execution_count=6}\n``` {.python .cell-code}\nfrom langchain_community.document_loaders import DataFrameLoader\n\n# 데이터 프레임 로더 설정, 페이지 내용 컬럼 지정\nloader = DataFrameLoader(df, page_content_column=\"Name\")\n\n# 문서 로드\ndocs = loader.load()\n\n# 데이터 출력\nprint(docs[0].page_content)\n\n# 메타데이터 출력\nprint(docs[0].metadata)\n```\n:::\n\n\n",
    "supporting": [
      "04-Excel-Loader_files"
    ],
    "filters": [],
    "includes": {}
  }
}