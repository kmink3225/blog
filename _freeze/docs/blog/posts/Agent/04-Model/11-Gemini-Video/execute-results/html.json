{
  "hash": "28b7344f2364ccf0517204fae9807b31",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: \"Gemini Video Analysis\"\nsubtitle: ì–¸ì–´ ëª¨ë¸\ndescription: |\n  ë‹¤ì–‘í•œ LLM ì œê³µìì™€ ëª¨ë¸ í™œìš©ë²•ì„ ë‹¤ë£¬ë‹¤.\ncategories:\n  - AI\n  - RAG\n  - LangChain\nauthor: Kwangmin Kim\ndate: 02/11/2025\nformat: \n  html:\n    page-layout: full\n    code-fold: true\n    toc: true\n    number-sections: true\ndraft: False\nexecute:\n    eval: false\n---\n\n**ì£¼ìš” íë¦„**\n\n1. `File API`ë¥¼ ì‚¬ìš©í•˜ì—¬ ë¹„ë””ì˜¤ íŒŒì¼ì„ ì—…ë¡œë“œí•©ë‹ˆë‹¤.\n2. `GenerateContent` ìš”ì²­ì„ í†µí•´ ë¹„ë””ì˜¤ì— ëŒ€í•œ ì§ˆë¬¸ì„ ìš”ì²­í•©ë‹ˆë‹¤.\n3. ìƒì„±ëœ ì‘ë‹µì„ í™•ì¸í•©ë‹ˆë‹¤.\n4. ì—…ë¡œë“œí•œ Video íŒŒì¼ì„ ì‚­ì œí•©ë‹ˆë‹¤.\n\n\n**ì¤‘ìš”:** \n\n- ë³¸ íŠœí† ë¦¬ì–¼ì˜ `File API` ëŠ” ì¸ì¦ ë° ì ‘ê·¼ì„ ìœ„í•´ `API keys`ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤. \n\n- ì—…ë¡œë“œëœ íŒŒì¼ì€ `API key`ì˜ í´ë¼ìš°ë“œ í”„ë¡œì íŠ¸ì™€ ì—°ê²°ë©ë‹ˆë‹¤. \n\në‹¤ë¥¸ `Gemini API` ì™€ ë‹¬ë¦¬, `API key`ëŠ” `File API`ì— ì—…ë¡œë“œí•œ ë°ì´í„°ì— ëŒ€í•œ ì ‘ê·¼ ê¶Œí•œë„ ë¶€ì—¬í•˜ë¯€ë¡œ `API key`ë¥¼ ì•ˆì „í•˜ê²Œ ë³´ê´€í•˜ëŠ” ë° íŠ¹ë³„íˆ ì£¼ì˜í•´ì•¼ í•©ë‹ˆë‹¤.\n\n**Reference**\n\n- [Gemini API(Cookbook) - Video](https://ai.google.dev/api/rest/v1/models/generateContent#media)\n\n**API KEY ë°œê¸‰**\n\n- [ë§í¬](https://makersuite.google.com/app/apikey?hl=ko) ì—ì„œ API KEYë¥¼ ë°œê¸‰ë°›ì•„ì£¼ì„¸ìš”.\n- ì‚¬ìš©ìì˜ Google API í‚¤ë¥¼ í™˜ê²½ ë³€ìˆ˜ `GOOGLE_API_KEY`ë¡œ ì„¤ì •í•©ë‹ˆë‹¤.\n\n`.env` íŒŒì¼ì— ì•„ë˜ì™€ ê°™ì´ ì…ë ¥í•©ë‹ˆë‹¤.\n\n```\nGOOGLE_API_KEY=<ì‚¬ìš©ìì˜ API KEY>\n```\n\n::: {#b2f04af0 .cell execution_count=1}\n``` {.python .cell-code}\n# LangSmith ì¶”ì  ì„¤ì •\n# !pip install langchain-teddynote\nfrom langchain_teddynote import logging\n\n# í”„ë¡œì íŠ¸ ì´ë¦„ ì…ë ¥\nlogging.langsmith(\"CH04-Models\")\n```\n:::\n\n\n::: {#8563b606 .cell execution_count=2}\n``` {.python .cell-code}\n# LangSmith ì¶”ì  ì„¤ì •\n# !pip install langchain-teddynote\nfrom langchain_teddynote import logging\n\n# í”„ë¡œì íŠ¸ ì´ë¦„ ì…ë ¥\nlogging.langsmith(\"CH04-Gemini-Video\")\n```\n:::\n\n\n## ë¹„ë””ì˜¤ ì—…ë¡œë“œ\n\n`Gemini API` ëŠ” ë¹„ë””ì˜¤ íŒŒì¼ í˜•ì‹ì„ ì§ì ‘ ìˆ˜ìš©í•©ë‹ˆë‹¤. \n\n**ì œí•œì‚¬í•­**\n\n- `File API`ëŠ” 2GB ì´í•˜ì˜ íŒŒì¼ì„ ìˆ˜ìš©í•˜ë©° í”„ë¡œì íŠ¸ë‹¹ ìµœëŒ€ 20GBì˜ íŒŒì¼ì„ ì €ì¥í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. \n- íŒŒì¼ì€ 2ì¼ ë™ì•ˆ ìœ ì§€ë˜ë©° APIì—ì„œ **ë‹¤ìš´ë¡œë“œí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤**. \n\në³¸ ì˜ˆì œëŠ” í…Œë””ë…¸íŠ¸ YouTube ì±„ë„ì— ê²Œì‹œëœ ë¹„ë””ì˜¤ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤. (ë‹¤ë¥¸ ë¹„ë””ì˜¤ë¡œ êµì²´í•˜ì—¬ ì§„í–‰í•´ë„ ì¢‹ìŠµë‹ˆë‹¤)\n\n- [ğŸ§‘â€ğŸ’» #PDF ì „ì²˜ë¦¬ í•  ìˆ˜ ìˆëŠ” ê±´ ë‹¤ í•´ë´¤ìŒ.](https://youtu.be/O3qFWRObAXw)\n\n::: {#e24e3aed .cell execution_count=3}\n``` {.python .cell-code}\n# íŒŒì¼ ë‹¤ìš´ë¡œë“œ í›„ teddynote-sample-video.mp4 íŒŒì¼ë¡œ ì €ì¥\n!wget \"https://www.dropbox.com/scl/fi/ugue14fyo010jgc7wuh4g/teddynote-sample-video.mp4?rlkey=wcsiktklt7jgoibsluft3m6z9&st=prv4p2uu&dl=1\" -qO teddynote-sample-video.mp4\n```\n:::\n\n\nì•„ë˜ ë¹„ë””ì˜¤ íŒŒì¼ì˜ ê²½ë¡œë¥¼ ì…ë ¥í•©ë‹ˆë‹¤.\n\n::: {#6535df82 .cell execution_count=4}\n``` {.python .cell-code}\n# ë¹„ë””ì˜¤ íŒŒì¼ ì´ë¦„ ì§€ì •\nvideo_file_name = \"teddynote-sample-video.mp4\"\n```\n:::\n\n\në‹¤ìŒìœ¼ë¡œëŠ” `File API`ë¥¼ ì‚¬ìš©í•˜ì—¬ ë¹„ë””ì˜¤ íŒŒì¼ì„ ì—…ë¡œë“œí•©ë‹ˆë‹¤.\n\n::: {#27fd1970 .cell execution_count=5}\n``` {.python .cell-code}\nimport google.generativeai as genai\n\n# íŒŒì¼ ì—…ë¡œë“œ ì§„í–‰ ë©”ì‹œì§€ ì¶œë ¥\nprint(f\"íŒŒì¼ì„ ì—…ë¡œë“œ ì¤‘ì…ë‹ˆë‹¤...\")\n\n# íŒŒì¼ ì—…ë¡œë“œ ë° íŒŒì¼ ê°ì²´ ë°˜í™˜\nvideo_file = genai.upload_file(path=video_file_name)\n\n# ì—…ë¡œë“œ ì™„ë£Œ ë©”ì‹œì§€ ë° íŒŒì¼ URI ì¶œë ¥\nprint(f\"ì—…ë¡œë“œ ì™„ë£Œ: {video_file.uri}\")\n```\n:::\n\n\níŒŒì¼ì„ ì—…ë¡œë“œí•œ í›„, `files.get` ì„ í˜¸ì¶œí•˜ì—¬ APIê°€ íŒŒì¼ì„ ì„±ê³µì ìœ¼ë¡œ ì™„ë£Œë˜ì—ˆëŠ”ì§€ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. \n\n`files.get`ì€  API í‚¤ê°€ ì†í•œ í´ë¼ìš°ë“œ í”„ë¡œì íŠ¸ì™€ ì—°ê´€ëœ íŒŒì¼ APIì— ì—…ë¡œë“œëœ íŒŒì¼ì„ í™•ì¸í•  ìˆ˜ ìˆê²Œ í•´ì¤ë‹ˆë‹¤. \n\n::: {#d8fb0def .cell execution_count=6}\n``` {.python .cell-code}\nimport time\n\n# ë¹„ë””ì˜¤ íŒŒì¼ ì²˜ë¦¬ ìƒíƒœ í™•ì¸\nwhile video_file.state.name == \"PROCESSING\":\n    # ì²˜ë¦¬ ì™„ë£Œ ëŒ€ê¸° ë©”ì‹œì§€ ì¶œë ¥\n    print(\"ë¹„ë””ì˜¤ ì—…ë¡œë“œ ë° ì „ì²˜ë¦¬ê°€ ì™„ë£Œë  ë•Œê¹Œì§€ ì ì‹œë§Œ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”...\")\n    # 10ì´ˆ ëŒ€ê¸°\n    time.sleep(10)\n    # ë¹„ë””ì˜¤ íŒŒì¼ ìƒíƒœ ê°±ì‹ \n    video_file = genai.get_file(video_file.name)\n\n# ì²˜ë¦¬ ì‹¤íŒ¨ ì‹œ ì˜ˆì™¸ ë°œìƒ\nif video_file.state.name == \"FAILED\":\n    raise ValueError(video_file.state.name)\n\n# ì²˜ë¦¬ ì™„ë£Œ ë©”ì‹œì§€ ì¶œë ¥\nprint(\n    f\"\\në¹„ë””ì˜¤ ì²˜ë¦¬ê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!\\nì´ì œ ëŒ€í™”ë¥¼ ì‹œì‘í•  ìˆ˜ ìˆì–´ìš”: \" + video_file.uri\n)\n```\n:::\n\n\në¹„ë””ì˜¤ê°€ ì—…ë¡œë“œëœ í›„, `generate_content` í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ Video ì— ëŒ€í•œ ì§ˆë¬¸ì„ ìš”ì²­í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\n::: {#ed8f885c .cell execution_count=7}\n``` {.python .cell-code}\n# í”„ë¡¬í”„íŠ¸\nprompt = \"ì´ ì˜ìƒì— ëŒ€í•´ì„œ ì§§ê²Œ ìš”ì•½í•´ ì¤„ ìˆ˜ ìˆë‚˜ìš”?\"\n\n# ëª¨ë¸ì„ Gemini 1.5 Flashë¡œ ì„¤ì •\nmodel = genai.GenerativeModel(model_name=\"models/gemini-1.5-flash\")\n\n# LLM ë‹µë³€ ìš”ì²­\nresponse = model.generate_content(\n    [prompt, video_file], request_options={\"timeout\": 600}\n)\n# ê²°ê³¼ ì¶œë ¥\nprint(response.text)\n```\n:::\n\n\nì•„ë˜ëŠ” ìŠ¤íŠ¸ë¦¼ ì¶œë ¥ ì˜ˆì œì…ë‹ˆë‹¤. (`stream=True` ì˜µì…˜ ì¶”ê°€)\n\n::: {#55cff8d0 .cell execution_count=8}\n``` {.python .cell-code}\n# í”„ë¡¬í”„íŠ¸ ìƒì„±\nprompt = \"ì´ ì˜ìƒì—ì„œ Gencon ê´€ë ¨ ì–¸ê¸‰í•œ ë¶€ë¶„ì˜ ì‹œê°„ì„ ì•Œë ¤ì£¼ê³ , ì–´ë–¤ ë‚´ìš©ì„ ë§í–ˆëŠ”ì§€ ì•Œë ¤ì£¼ì„¸ìš”.\"\n\n# ëª¨ë¸ì„ Gemini 1.5 Flashë¡œ ì„¤ì •\nmodel = genai.GenerativeModel(model_name=\"models/gemini-1.5-flash\")\n\n# LLM ìŠ¤íŠ¸ë¦¼ ë‹µë³€ ìš”ì²­\nresponse = model.generate_content(\n    [prompt, video_file], request_options={\"timeout\": 600}, stream=True\n)\n\n# ìƒì„±ëœ ì½˜í…ì¸  ì¶œë ¥\nfor chunk in response:\n    print(chunk.text, end=\"\", flush=True)\n```\n:::\n\n\n## íŒŒì¼ ì‚­ì œ\n\níŒŒì¼ì€ 2ì¼ í›„ ìë™ìœ¼ë¡œ ì‚­ì œë˜ê±°ë‚˜ `files.delete()`ë¥¼ ì‚¬ìš©í•˜ì—¬ ìˆ˜ë™ìœ¼ë¡œ ì‚­ì œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\n\n::: {#8ca7e9bf .cell execution_count=9}\n``` {.python .cell-code}\n# íŒŒì¼ ì‚­ì œ\ngenai.delete_file(video_file.name)\n\n# ì‚­ì œ ì™„ë£Œ ë©”ì‹œì§€ ì¶œë ¥\nprint(f\"ì˜ìƒì„ ì‚­ì œí–ˆìŠµë‹ˆë‹¤: {video_file.uri}\")\n```\n:::\n\n\n",
    "supporting": [
      "11-Gemini-Video_files"
    ],
    "filters": [],
    "includes": {}
  }
}