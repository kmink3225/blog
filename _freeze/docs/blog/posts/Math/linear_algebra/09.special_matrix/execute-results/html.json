{
  "hash": "ee643e569f5e13679aaea1eb60e8397e",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Basics (3) - Special Matrices\"\nsubtitle: Square Matrix, Diagnogal Matrix, Identity Matrix, Symmetric Matrix, Idempotent Matrix, Oncs Matrix, Centering Matrix, Covariance Matrix, Positive Definite Matrix\ndescription: |\n  template\ncategories:\n  - Mathematics\nauthor: Kwangmin Kim\ndate: 03/31/2023\nformat: \n  html:\n    page-layout: full\n    code-fold: true\n    toc: true\n    number-sections: true\ndraft: False\n---\n\n\n## Special Matrix\n\n### Square Matrix\n\nA square matrix $\\mathbf{A}$ is a matrix with the same number of rows and columns, i.e., $\\mathbf{A}$ is an $n \\times n$ matrix.\n\nFor example, the following is a $3 \\times 3$ square matrix:\n\n$$\n\\mathbf A= \\begin{bmatrix}\n1 & 4 & 7\\\\\n2 & 5 & 8\\\\\n3 & 6 & 9\n\\end{bmatrix}\n$$\n\n#### Properties\n\nLet $\\mathbf{A}$ be an $n\\times n$ square matrix. Then, the following properties hold:\n\n* $\\mathbf{A}$ is invertible if and only if $\\text{det}(\\mathbf{A}) \\neq 0$.\n* The trace of $\\mathbf{A}$ is defined as $\\text{tr}(\\mathbf{A}) = \\sum_{i=1}^n a_{ii}$, where $a_{ii}$ is the $i$th diagonal element of $\\mathbf{A}$.\n* If $\\mathbf{A}$ is symmetric, then it has $n$ real eigenvalues and an orthonormal set of eigenvectors.\n* If $\\mathbf{A}$ is diagonalizable, then $\\mathbf{A}$ can be written as $\\mathbf{A} = \\mathbf{PDP}^{-1}$, where $\\mathbf{P}$ is the matrix whose columns are the eigenvectors of $\\mathbf{A}$, and $\\mathbf{D}$ is the diagonal matrix whose diagonal elements are the corresponding eigenvalues.\n* The transpose of $\\mathbf{A}$, denoted $\\mathbf{A}^\\top$, is obtained by reflecting $\\mathbf{A}$ across its main diagonal. That is, $(\\mathbf{A}^\\top)_{ij} = a_{ji}$.\n\nHere's an example of a $3 \\times 3$ matrix:\n\n$$\n\\mathbf A= \\begin{bmatrix}\n1 & 4 & 7\\\\\n2 & 5 & 8\\\\\n3 & 6 & 9\n\\end{bmatrix}\n$$\n\nWith this matrix, we can see that $\\text{det}(\\mathbf{A}) = 0$, so $\\mathbf{A}$ is not invertible. The trace of $\\mathbf{A}$ is $\\text{tr}(\\mathbf{A}) = 1 + 5 + 9 = 15$. Since $\\mathbf{A}$ is not symmetric, we cannot say that it has real eigenvalues and an orthonormal set of eigenvectors. However, we can check that $\\mathbf{A}$ is diagonalizable, and we can find that $\\mathbf{A} = \\mathbf{PDP}^{-1}$ with\n\n$$\n\\begin{equation*}\nP=\\begin{pmatrix}\n-0.8252 & -0.2886 & 0.4848\\\\\n-0.3779 & -0.7551 & -0.5375\\\\\n0.2185 & -0.5800 & 0.7830\n\\end{pmatrix}, \\text{ } D=\\begin{pmatrix}\n16.1168 & 0 & 0\\\\\n0 & -1.1168 & 0\\\\\n0 & 0 & 0\n\\end{pmatrix}\n\\end{equation*}\n$$\n\n### Diagonal Matrix\n\nA diagonal matrix is a square matrix in which all the off-diagonal elements are zero. The diagonal elements can be any scalar value. \n\n$$\n\\begin{equation*}\n\\mathbf{D} = \\begin{pmatrix}\nd_{1} & 0 & 0 & \\cdots & 0 \\\\\n0 & d_{2} & 0 & \\cdots & 0 \\\\\n0 & 0 & d_{3} & \\cdots & 0 \\\\\n\\vdots & \\vdots & \\vdots & \\ddots & \\vdots \\\\\n0 & 0 & 0 & \\cdots & d_{n}\n\\end{pmatrix}\n\\end{equation*}\n$$\n\n\nHere, $\\mathbf{D}$ is an $n \\times n$ diagonal matrix with diagonal elements $d_1, d_2, \\ldots, d_n$. An example of a $3 \\times 3$ diagonal matrix is:\n\n$$\n\\begin{equation*}\n\\mathbf{D} = \\begin{pmatrix}\n2 & 0 & 0 \\\\\n0 & -1 & 0 \\\\\n0 & 0 & 4\n\\end{pmatrix}\n\\end{equation*}\n$$\n\n#### Properties\n\nA diagonal matrix is a square matrix in which all the off-diagonal elements are zero, i.e., $a_{ij} = 0$ for $i \\neq j$. Some properties of a diagonal matrix are:\n\n* For two diagnoal matrices $\\mathbf D$ and $\\mathbf E$, \n$$\n\\begin{equation*}\n\\mathbf{DE}=\n\\begin{pmatrix}\nd_{1}e_{1} & 0 & 0 & \\cdots & 0 \\\\\n0 & d_{2}e_{2} & 0 & \\cdots & 0 \\\\\n0 & 0 & d_{3}e_{3} & \\cdots & 0 \\\\\n\\vdots & \\vdots & \\vdots & \\ddots & \\vdots \\\\\n0 & 0 & 0 & \\cdots & d_{n}e_{n}\n\\end{pmatrix}\n\\end{equation*}\n$$\n\n* The determinant of a diagonal matrix is the product of its diagonal entries.\n* The trace of a diagonal matrix is the sum of its diagonal entries.\n* The inverse of a non-singular diagonal matrix is a diagonal matrix with the reciprocal of its diagonal entries as its diagonal entries.\n\n### Identity Matrix\n\nAn identity matrix is a square matrix in which all the diagonal elements are equal to $1$ and all the off-diagonal elements are equal to 0. The notation for an identity matrix of size $n$ is $\\mathbf{I}_n$.\n\n#### Example\n\nExample of a $3\\times 3$ identity matrix, $\\mathbf{I}_3$:\n$$\n\\begin{equation}\n\\mathbf{I}_3 =\n\\begin{bmatrix}\n1 & 0 & 0 \\\\\n0 & 1 & 0 \\\\\n0 & 0 & 1 \n\\end{bmatrix}\n\\end{equation}\n$$\n\n#### Properties\n\nSome properties of an identity matrix include:\n\n* Multiplying any matrix by an identity matrix results in the same matrix: $\\mathbf{A} \\mathbf{I} = \\mathbf{I} \\mathbf{A} = \\mathbf{A}$.\n* The product of any matrix and its corresponding inverse is an identity matrix: $\\mathbf{A} \\mathbf{A}^{-1} = \\mathbf{A}^{-1} \\mathbf{A} = \\mathbf{I}$.\n* The determinant of an identity matrix is 1: $\\det(\\mathbf{I}) = 1$.\n* An identity matrix is symmetric: $\\mathbf{I} = \\mathbf{I}^T$.\n\n\n### Symmetric Matrix\n\nA symmetric matrix is a square matrix that is equal to its own transpose, i.e., $\\mathbf{A} = \\mathbf{A}^T$. Let $\\mathbf{A}$ be an $n \\times n$ matrix, then $\\mathbf{A}$ is symmetric if and only if $a_{ij} = a_{ji}$ for all $i$ and $j$ such that $1 \\le i$, $j \\le n$.\n\nHere's an example of a symmetric matrix:\n$$\n\\mathbf{A} = \\begin{bmatrix}\n1 & 2 & 3 \\\\\n2 & 4 & 5 \\\\\n3 & 5 & 6\n\\end{bmatrix}\n$$\n\n#### Properties\n\nA symmetric matrix is a square matrix that is equal to its own transpose. Some properties of symmetric matrices include:\n\n* The diagonal entries are real numbers.\n* The matrix is diagonalizable, meaning it can be expressed as **a product of diagonal and orthogonal matrices**.\n* The eigenvalues of a symmetric matrix are real numbers.\n* The eigenvectors corresponding to different eigenvalues are orthogonal.\n* The sum and difference of two symmetric matrices is also symmetric.\n\n### Idempotent Matrix\n\nAn idempotent matrix is a square matrix that when multiplied by itself yields itself. In other words, an idempotent matrix $\\mathbf{P}$ satisfies $\\mathbf{P}^2 = \\mathbf{P}$.\n\nAn example of an idempotent matrix is:\n\n$$\n\\begin{equation}\n\\mathbf{P} =\n\\begin{bmatrix}\n1 & 0 & 0 \\\\\n0 & 0 & 0 \\\\\n0 & 0 & 1 \n\\end{bmatrix}\n\\end{equation}\n$$\n\n#### Properties\n\n* $\\mathbf{A}^2 = \\mathbf A$.\n* If $\\mathbf{A}$ is an idempotent matrix, $\\mathbf{I_n}-\\mathbf{A}$ is also an idempotent matrix.\n$$\n\\begin{aligned}\n(\\mathbf{I_n}-\\mathbf{A})^2&=(\\mathbf{I_n}-\\mathbf{A})(\\mathbf{I_n}-\\mathbf{A})\\\\\n&=\\mathbf{I_n}\\mathbf{I_n}-\\mathbf{I_n}\\mathbf{A}-\\mathbf{A}\\mathbf{I_n}+\\mathbf{A}\\mathbf{A}\\\\\n&=\\mathbf{I_n}\\mathbf{I_n}-\\mathbf{A}-\\mathbf{A}+\\mathbf{A} \\quad \\because \\text{A is idempotent}\\\\\n&=\\mathbf{I_n}\\mathbf{I_n}-\\mathbf{A}\\\\\n&=\\mathbf{I_n}-\\mathbf{A}\n\\end{aligned}\n$$\n* The determinant of $\\mathbf{A}$ is either 0 or 1.\n* If $\\mathbf{A}$ is symmetric, $\\mathbf{A}$ is idempotent if only if the eigenvalue of $\\mathbf{A}$ is either $0$ or $1$.\n* The rank of $\\mathbf A$ is equal to the trace of $\\mathbf A$, which is the sum of the diagonal elements of $\\mathbf A$.\n\n### Ones Matrix\n\nThe ones matrix, denoted as $\\mathbf{J}$, is a matrix in which every entry is equal to 1. \n\n:::{.callout-warning}\nThe letter $\\mathbf{J}$ is not related to the jacobian matrix at all. The letter $\\mathbf{J}$ of the ones matrix is used for convention.\n:::\n\nHere is an example of a $3\\times 3$ ones matrix:\n\n$$\n\\mathbf{J} =\n\\begin{pmatrix}\n1 & 1 & 1 \\\\\n1 & 1 & 1 \\\\\n1 & 1 & 1 \n\\end{pmatrix}\n$$\n\n\n#### Properties\n\n* $\\mathbf J$ is a square matrix\n* $\\mathbf J$ is symmetric\n* $\\mathbf J$ has rank 1\n* Trace: The trace of the $\\mathbf J$ matrix is equal to the dimension of the matrix. For the $\\mathbf J$ matrix, it is equal to the number of rows or columns in the matrix.\n* Matrix multiplication: When multiplied by any matrix $\\mathbf{A}$, the $\\mathbf{J}$ matrix results in a matrix where each row (or column, depending on the multiplication order) is the sum of the elements of the corresponding row (or column) of $\\mathbf{A}$. \n  * In other words, $\\mathbf{J}$ multiplied by a matrix $\\mathbf{A}$ performs a row (or column) summation operation on $\\mathbf{A}$. \n  * If A is any $n \\times n$ matrix, then $\\mathbf{AJ} = \\mathbf{JA} = \\operatorname{trace}(\\mathbf{A})\\mathbf{J}$, where $\\operatorname{trace}(\\mathbf{A})$ is the sum of the diagonal elements of $\\mathbf{A}$.\n* $\\mathbf J_{m\\times n}$ can be represented as the product of two vectors, $\\mathbf 1_{m}$, $\\mathbf 1_{n}$, i.e., $\\mathbf J_{m\\times n} = \\mathbf 1_{m} \\mathbf 1_{n}^T$ where $m=n$\n* Eigenvalues and eigenvectors: The $\\mathbf J$ matrix has one eigenvalue equal to the dimension of the matrix, with the corresponding eigenvector being a vector of all 1's.\n* Inverse: The $\\mathbf J$ matrix is a special case where it does not have an inverse, as all its rows (or columns) are linearly dependent.\n\n#### Applications\n\n* calculate a sum using a $\\mathbf 1_n$ vector for $\\mathbf x_n$:\n$$\n\\mathbf 1^T\\mathbf x =\\sum_{i=1}^{n}1\\times x_i=x_1+x_2+\\dots+x_n\n$$\n\n* calculate a mean using a $\\mathbf 1_n$ vector for $\\mathbf x_n$:\n\n$$\n\\bar{x}=\\frac{1}{n}\\mathbf 1^T\\mathbf x =\\frac{1}{n}\\sum_{i=1}^{n}1\\times x_i=\\frac{1}{n}(x_1+x_2+\\dots+x_n)\n$$\n\n* calculate $n$ column sums of a dataset using a $\\mathbf 1_m$ vector for $\\mathbf X_{m\\times n}$:\n$$\n\\bar{\\mathbf x}=\\frac{1}{m}\\mathbf X^T\\mathbf 1_m\n$$\n$$\n\\begin{aligned}\n\\bar{\\mathbf x}&=\\frac{1}{m}\\mathbf X^T\\mathbf 1 \\\\\n&=\\frac{1}{m}\n\\begin{bmatrix}\nx_{11} & x_{21} & \\cdots & x_{m1} \\\\\nx_{12} & x_{22} & \\cdots & x_{m2} \\\\\n\\vdots & \\vdots & \\ddots & \\vdots \\\\\nx_{1n} & x_{2n} & \\cdots & x_{mn}\n\\end{bmatrix}\n\\begin{bmatrix}\n1_1 \\\\ 1_2 \\\\ \\vdots \\\\ 1_m\n\\end{bmatrix}\\\\\n&=\\frac{1}{m}\n\\begin{bmatrix}\nx_{11} + x_{21} + \\cdots + x_{m1} \\\\\nx_{12} + x_{22} + \\cdots + x_{m2} \\\\\n\\vdots  \\\\\nx_{1n} + x_{2n} + \\cdots + x_{mn}\n\\end{bmatrix} \\\\\n&=\\frac{1}{m}\n\\begin{bmatrix}\n\\sum_{i=1}^{m }x_{i1} \\\\\n\\sum_{i=1}^{m }x_{i2} \\\\\n\\vdots  \\\\\n\\sum_{i=1}^{m }x_{jn} \n\\end{bmatrix} \\\\\n&=\n\\begin{bmatrix}\n\\bar{x}_{1} \\\\\n\\bar{x}_{2} \\\\\n\\vdots  \\\\\n\\bar{x}_{n}\n\\end{bmatrix} \\\\\n&=\\bar{\\mathbf x}\n\\end{aligned}\n$$\n\n\n### Centering Matrix\n\nA centering matrix is a square matrix that is used in multivariate statistical analysis to center data by subtracting the mean of each variable from each observation. The resulting matrix is called the centered data matrix with the mean equal to $0$. The centering matrix is defined as:\n\n$$\n\\begin{equation}\n  \\mathbf C = \\mathbf I - \\frac{1}{m}\\mathbf J\n\\end{equation}\n$$\n\nwhere $\\mathbf I$ is the identity matrix, $\\mathbf J$ is a matrix of ones, and $m$ is the number of observations. \n\n#### Example\n\nHere is an example of a centering matrix of size $3 \\times 3$:\n\n$$\n\\begin{equation*}\n\\mathbf C = \\frac{1}{3} \\begin{bmatrix}\n2 & -1 & -1 \\\\\n-1 & 2 & -1 \\\\\n-1 & -1 & 2\n\\end{bmatrix}\n\\end{equation*}\n$$\n\n#### Properties\n\nThe centering matrix is often used in multivariate statistical analysis, such as principal component analysis, to transform the data into a new coordinate system where the variance of each variable is equal to its eigenvalue.\n\n* A centering matrix is a square matrix.\n* A centering matrix is a symmetric matrix.\n* A centering matrix is a idempotent matrix.\n* The diagonal elements of a centering matrix are all equal and are given by $\\frac{1}{m}$, where $n$ is the size of the matrix.\n* The off-diagonal elements of a centering matrix are all equal and are given by $-\\frac{1}{m}$.\n* Multiplying a matrix $\\mathbf A$ on the left by a centering matrix $\\mathbf C$, $\\mathbf{CA}$ is equivalent to subtracting the mean of the columns of $\\mathbf A$ from each column of $\\mathbf A$.\n* Multiplying a matrix $\\mathbf A$ on the right by a centering matrix $\\mathbf C$, $\\mathbf{AC}$ is equivalent to subtracting the mean of the rows of $\\mathbf A$ from each row of $\\mathbf A$.\n\n#### Applications\n\n* find a centered matrix, $\\tilde{\\mathbf X}$ using a $\\mathbf 1_m$ vector for $\\mathbf X_{m\\times n}$:\n\n$$\n\\mathbf C = \\mathbf I - \\frac{1}{m}\\mathbf J\n$$\n$$\n\\begin{aligned}\n\\mathbf X&= \n\\begin{bmatrix}\nx_{11} & x_{12} & \\cdots & x_{1n} \\\\\nx_{21} & x_{22} & \\cdots & x_{2n} \\\\\n\\vdots & \\vdots & \\ddots & \\vdots \\\\\nx_{m1} & x_{m2} & \\cdots & x_{mn}\n\\end{bmatrix} \\text{ } \\\\\n\\mathbf {1_m\\bar{x}^T}&= \n\\begin{bmatrix}\n1 \\\\\n1 \\\\\n\\vdots \\\\\n1\n\\end{bmatrix}\n\\begin{bmatrix}\n\\bar{x}_{1} & \\bar{x}_{2} & \\dots & \\bar{x}_{n}\n\\end{bmatrix}\\\\\n&=\\begin{bmatrix}\n\\bar{x}_{1} & \\bar{x}_{2} & \\dots & \\bar{x}_{n}\\\\\n\\bar{x}_{1} & \\bar{x}_{2} & \\dots & \\bar{x}_{n}\\\\\n\\vdots & \\vdots & \\ddots & \\vdots\\\\\n\\bar{x}_{1} & \\bar{x}_{2} & \\dots & \\bar{x}_{n}\n\\end{bmatrix}_{m\\times n}\\\\\n\\\\\n\\tilde{\\mathbf X}&=\\mathbf X -{\\mathbf{1}}_{m}\\bar{\\mathbf x}^T\\\\\n&=\\mathbf X -\\mathbf{1}_{m}(\\frac{1}{m}\\mathbf X^T \\mathbf{1}_m)^T\\\\\n&=\\mathbf X -\\mathbf{1}_{m}\\mathbf{1}_m^T\\frac{1}{m}\\mathbf X\\\\\n&=(\\mathbf I -\\frac{1}{m}\\mathbf J)\\mathbf X\\\\\n&=\\mathbf C \\mathbf X\\\\\n\\end{aligned}\n$$\n\n### Covariance Matrix\n\nThe covariance matrix of a dataset matrix $\\mathbf{X}$ with $m$ observations and $n$ variables is a symmetric $n \\times n$ matrix given by:\n\n#### Algebraic Expression\n\nFor two random variables, $X_1,X_2$, if there are $m$ of the observed samples or realized values, we can represent the sample data as:\n\n$$\n(x_{11},x_{12}),(x_{21},x_{22}),\\dots,(x_{m1},x_{m2})\n$$\n\nThen, the sample variance between the two random variables are represented as:\n\n$$\ns_{x_1x_2} = \\frac{\\sum_{i=1}^{m}(x_{i1}-\\bar{x_1})(x_{i2}-\\bar{x_2})}{m-1}\n$$\n\n:::{.callout-note}\n#### Sample Variance\n\nFor each variate, $X_j$, $j=1,\\dots, n$\n\n$$\ns^2_{x}=s_{xx} = \\frac{\\sum_{i=1}^{m}(x_{ij}-\\bar{x})^2}{m-1}\n$$\n\nFor two random variables, $X_1$, $X_2$,\n$$\ns_{x_1x_2} = \\frac{\\sum_{i=1}^{m}(x_{i1}-\\bar{x_1})(x_{i2}-\\bar{x_2})}{m-1}\n$$\n\nOften for the notation of sample variance, the squared power is added for the sample variance with one random variable, but it is not for the covariance between two random variables.\n\n:::\n\nFor two random variables ,$X_1,X_2$,\n\n$$\n\\begin{aligned}\n  \\mathbf{S}\n  &=\\begin{bmatrix} \n    s_{11}&s_{12}\\\\\n    s_{21}&s_{22}\n  \\end{bmatrix}\\\\\n  &=\\begin{bmatrix} \n    s_{x_1x_1}&s_{x_1x_2}\\\\\n    s_{x_2x_1}&s_{x_2x_2}\n  \\end{bmatrix}\\\\\n  &=\\frac{1}{n-1}\n  \\begin{bmatrix} \n    \\sum_{i=1}^{m}(x_{i1}-\\bar{x}_1)(x_{i1}-\\bar{x}_1)&\\sum_{i=1}^{m}(x_{i1}-\\bar{x}_1)(x_{i2}-\\bar{x}_2)\\\\\n    \\sum_{i=1}^{m}(x_{i2}-\\bar{x}_2)(x_{i1}-\\bar{x}_1)&\\sum_{i=1}^{m}(x_{i2}-\\bar{x}_2)(x_{i2}-\\bar{x}_2)\n  \\end{bmatrix}\n\\end{aligned}\n$$\n\n\nFor $n$ of random variables, $X_1,\\dots,X_n$, if we observed the sample vectors with $m$ observations, the sample covariance matrix can be represented as:\n\n$$\n\\mathbf{S}=\\begin{bmatrix} \ns_{11}&s_{12}&\\dots&s_{1n}\\\\\ns_{21}&s_{22}&\\dots&s_{2n}\\\\\n\\vdots&\\vdots&\\ddots&\\vdots\\\\\ns_{n1}&s_{n2}&\\dots&s_{nn} \n\\end{bmatrix}\n$$\n\nwhere $s_{jk} = \\frac{\\sum_{i=1}^{m}(x_{ij}-\\bar{x_j})(x_{ik}-\\bar{x_k})}{m-1}$. The diagonal entries are the sample variances of each random variable, and the off-diagonal entires are the sample covariance between two different random variables.\n\n\n#### Vector Form of Sample Variance in Linear Algebra\n\nThe complicating algebraic notation can be represented as the simpler form in linear algebra. To do so, let a sample vector $\\mathbf x =\\begin{bmatrix}x_{1}\\\\x_{2}\\\\ \\vdots\\\\x_{n}\\end{bmatrix}$. In othe words, a record, a row, or the observations across $n$ variables in a dataset:\n\n$$\n\\mathbf{X}=\n\\begin{bmatrix} \n\\mathbf{x}_{1}^T\\\\\n\\mathbf{x}_{2}^T\\\\\n\\vdots\\\\\n\\mathbf{x}_{m}^T \n\\end{bmatrix}\n=\\begin{bmatrix} \nx_{11}&x_{12}&\\dots&x_{1n}\\\\\nx_{21}&x_{22}&\\dots&x_{2n}\\\\\n\\vdots&\\vdots&\\ddots&\\vdots\\\\\nx_{m1}&x_{m2}&\\dots&x_{mn} \n\\end{bmatrix}\n$$\n\n$$\n\\begin{aligned}\n\\mathbf S \n&= \\operatorname{Cov}(\\mathbf{X}) \\\\\n&= \\frac{1}{m-1}\\sum_{i=1}^{m}(\\mathbf x_i - \\bar{\\mathbf x}_i)(\\mathbf x_i - \\bar{\\mathbf x}_i)^T\\\\\n&= \\frac{1}{m-1}\\tilde{\\mathbf{X}}^T\\tilde{\\mathbf{X}}\\\\\n&= \\frac{1}{m-1}(\\mathbf{CX})^T(\\mathbf{CX})\\\\\n&= \\frac{1}{m-1}\\mathbf{X}^T\\mathbf{C}^T\\mathbf{CX}\\\\\n&= \\frac{1}{m-1}\\mathbf{X}^T\\mathbf{C}\\mathbf{C}\\mathbf{X}\\quad (\\because \\mathbf{C}\\text{ is symmetric})\\\\\n&= \\frac{1}{m-1}\\mathbf{X}^T\\mathbf{C}\\mathbf{X}\\quad (\\because \\mathbf{C}\\text{ is an idempotent matrix})\n\\end{aligned}\n$$\n\nwhere $\\mathbf{X}$ is the dataset matrix, $\\mathbf{x_i}=\\begin{bmatrix}x_{i1}\\\\x_{i2}\\\\ \\vdots\\\\x_{in}\\end{bmatrix}$ is the observations of each variable along the columns, $\\bar{\\mathbf{x}}_i=\\begin{bmatrix}\\bar{x}_{1}\\\\\\bar{x}_{2}\\\\ \\vdots\\\\\\bar{x}_{n}\\end{bmatrix}$ and $(\\mathbf{x}_i - \\bar{\\mathbf{x}}_i)^T=\\tilde{\\mathbf{X}}$ is the transpose of the centered dataset matrix.\n\nThe size of $\\mathbf S$ is $(1 \\times n)^T(1 \\times n)=(n \\times 1)(1 \\times n)=(n \\times n)$\n\n:::{.callout-tip}\n\nFor the $i$ th observation of $m$ observations and the $j$ th variable of $n$ variables in a dataset, $\\mathbf{X}$, the outer product of $(\\mathbf x_i - \\bar{\\mathbf x}_i)(\\mathbf x_i - \\bar{\\mathbf x}_i)^T$ generates the following $n \\times n$ matrix.\n\n$$\n\\begin{aligned}\n(\\mathbf x_i - \\bar{\\mathbf x}_i)(\\mathbf x_i - \\bar{\\mathbf x}_i)^T\n&= \\begin{bmatrix} \nx_{i1} -\\bar{x}_{i1}\\\\ x_{i2} -\\bar{x}_{i2}\\\\ \\vdots \\\\ x_{in} -\\bar{x}_{in} \n\\end{bmatrix}\\begin{bmatrix} \nx_{i1} -\\bar{x}_{i1}&x_{i2} -\\bar{x}_{i2}&\\dots&x_{in} -\\bar{x}_{in}\n\\end{bmatrix} \\\\\n&=\\begin{bmatrix} \n(x_{i1}-\\bar{x}_{i1})(x_{i1}-\\bar{x}_{i1}) & (x_{i1}-\\bar{x}_{i1})(x_{i2}-\\bar{x}_{i2}) & \\dots & (x_{i1}-\\bar{x}_{i1})(x_{in}-\\bar{x}_{in})\\\\\n(x_{i2}-\\bar{x}_{i2})(x_{i1}-\\bar{x}_{i1}) & (x_{i2}-\\bar{x}_{i2})(x_{i2}-\\bar{x}_{i2}) & \\dots & (x_{i2}-\\bar{x}_{i2})(x_{in}-\\bar{x}_{in})\\\\\n\\vdots&\\vdots&\\ddots&\\vdots\\\\\n(x_{in}-\\bar{x}_{in})(x_{i1}-\\bar{x}_{i1})&(x_{in}-\\bar{x}_{in})(x_{i2}-\\bar{x}_{i2})&\\dots&(x_{in}-\\bar{x}_{in})(x_{in}-\\bar{x}_{in}) \n\\end{bmatrix}_{n\\times n}\n\\end{aligned}\n$$\n\nThe $n \\times n$ matrix right above is gnerated by $m$ times for the $m$ observations of $\\mathbf{X}_{m \\times n}$, the $\\operatorname{Cov}(\\mathbf X)$ is the sum of the $m$ of $n \\times n$ matrices divided by $\\frac{1}{m-1}$. In other words,\n\n$$\n\\frac{1}{m-1}\\sum_{i=1}^{m}(\\mathbf x_i - \\bar{\\mathbf x}_i)(\\mathbf x_i - \\bar{\\mathbf x}_i)^T\n$$\n\n:::\n\n\n#### Example\n\n**Example 1**\n\nLet's say we have a dataset with three variables, $\\mathbf{x}_1, \\mathbf{x}_2, \\text{ and } \\mathbf{x}_3,$ with $m$ observations. The dataset can be represented as a matrix $\\mathbf{X}$ with dimensions $m \\times 3$, where each row represents an observation and each column represents a variable. The covariance matrix, $\\operatorname{Cov}(\\mathbf{X})$, of the dataset can be computed as follows:\n\n$$\n\\begin{aligned}\n\\operatorname{Cov}(\\mathbf{X}) &= \\frac{1}{m-1}\\sum_{i=1}^{m}(\\mathbf x_i - \\bar{\\mathbf x}_i)^T(\\mathbf x_i - \\bar{\\mathbf x}_i)\\\\\n&=\\frac{\\tilde{\\mathbf X}^T\\tilde{\\mathbf X}}{m-1}\n\\end{aligned}\n$$\n\nwhere $\\mathbf{X}$ is the dataset matrix, $\\bar{x}$ is the mean of each variable computed along the rows, and $(\\mathbf{x_i} - \\bar{\\mathbf{x_i}})^T$ is the transpose of the centered dataset matrix. The covariance matrix $\\operatorname{Cov}(\\mathbf{X})$ will be a $3 \\times 3$ matrix, with the $(i, j)$ th entry representing the covariance between the $i$ th and $j$ th variables in the dataset.\n\n**Example 2**\n\nThe second example is to calculate $\\operatorname{Cov}(\\mathbf{X})$ where $\\mathbf{X}$ is the `mtcars` dataset.\n\n::: {.cell}\n\n```{.r .cell-code}\nX<-as.matrix(mtcars)\nx_bar_vec<-colMeans(mtcars)\n\nas.numeric(mtcars[1,1:5]-x_bar_vec)%*%t(as.numeric(mtcars[1,1:5]-x_bar_vec)) # for 1th row\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n            [,1]        [,2]       [,3]        [,4]         [,5]\n[1,]   0.8269629 -0.17050781  -64.31271  -33.362695   0.27593848\n[2,]  -0.1705078  0.03515625   13.26035    6.878906  -0.05689453\n[3,] -64.3127051 13.26035156 5001.58360 2594.608789 -21.45966895\n[4,] -33.3626953  6.87890625 2594.60879 1345.972656 -11.13236328\n[5,]   0.2759385 -0.05689453  -21.45967  -11.132363   0.09207432\n```\n\n\n:::\n\n```{.r .cell-code}\nas.numeric(mtcars[2,1:5]-x_bar_vec)%*%t(as.numeric(mtcars[2,1:5]-x_bar_vec)) # for 2nd row\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n            [,1]        [,2]       [,3]        [,4]         [,5]\n[1,]   0.8269629 -0.17050781  -64.31271  -33.362695   0.27593848\n[2,]  -0.1705078  0.03515625   13.26035    6.878906  -0.05689453\n[3,] -64.3127051 13.26035156 5001.58360 2594.608789 -21.45966895\n[4,] -33.3626953  6.87890625 2594.60879 1345.972656 -11.13236328\n[5,]   0.2759385 -0.05689453  -21.45967  -11.132363   0.09207432\n```\n\n\n:::\n\n```{.r .cell-code}\nX_sweeped<-sweep(X,MARGIN=2,STAT=x_bar_vec,FUN='-')\nresult<-matrix(0,ncol=ncol(mtcars),nrow=ncol(mtcars))\nfor (i in 1:nrow(mtcars)){\n  result<-result+X_sweeped[i,]%*%t(X_sweeped[i,])\n}\nresult/(nrow(mtcars)-1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n              mpg         cyl        disp          hp         drat          wt\n [1,]   36.324103  -9.1723790  -633.09721 -320.732056   2.19506351  -5.1166847\n [2,]   -9.172379   3.1895161   199.66028  101.931452  -0.66836694   1.3673710\n [3,] -633.097208 199.6602823 15360.79983 6721.158669 -47.06401915 107.6842040\n [4,] -320.732056 101.9314516  6721.15867 4700.866935 -16.45110887  44.1926613\n [5,]    2.195064  -0.6683669   -47.06402  -16.451109   0.28588135  -0.3727207\n [6,]   -5.116685   1.3673710   107.68420   44.192661  -0.37272073   0.9573790\n [7,]    4.509149  -1.8868548   -96.05168  -86.770081   0.08714073  -0.3054816\n [8,]    2.017137  -0.7298387   -44.37762  -24.987903   0.11864919  -0.2736613\n [9,]    1.803931  -0.4657258   -36.56401   -8.320565   0.19015121  -0.3381048\n[10,]    2.135685  -0.6491935   -50.80262   -6.358871   0.27598790  -0.4210806\n[11,]   -5.363105   1.5201613    79.06875   83.036290  -0.07840726   0.6757903\n              qsec           vs           am        gear        carb\n [1,]   4.50914919   2.01713710   1.80393145   2.1356855 -5.36310484\n [2,]  -1.88685484  -0.72983871  -0.46572581  -0.6491935  1.52016129\n [3,] -96.05168145 -44.37762097 -36.56401210 -50.8026210 79.06875000\n [4,] -86.77008065 -24.98790323  -8.32056452  -6.3588710 83.03629032\n [5,]   0.08714073   0.11864919   0.19015121   0.2759879 -0.07840726\n [6,]  -0.30548161  -0.27366129  -0.33810484  -0.4210806  0.67579032\n [7,]   3.19316613   0.67056452  -0.20495968  -0.2804032 -1.89411290\n [8,]   0.67056452   0.25403226   0.04233871   0.0766129 -0.46370968\n [9,]  -0.20495968   0.04233871   0.24899194   0.2923387  0.04637097\n[10,]  -0.28040323   0.07661290   0.29233871   0.5443548  0.32661290\n[11,]  -1.89411290  -0.46370968   0.04637097   0.3266129  2.60887097\n```\n\n\n:::\n\n```{.r .cell-code}\n# J matrix\nm<-nrow(mtcars)\nJ<-(1/m)*matrix(1,ncol=m,nrow=m)\n# Centering matrix\nC<-diag(m)-J\n# Covariance\n(1/(m-1))*t(X)%*%C%*%X\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n             mpg         cyl        disp          hp         drat          wt\nmpg    36.324103  -9.1723790  -633.09721 -320.732056   2.19506351  -5.1166847\ncyl    -9.172379   3.1895161   199.66028  101.931452  -0.66836694   1.3673710\ndisp -633.097208 199.6602823 15360.79983 6721.158669 -47.06401915 107.6842040\nhp   -320.732056 101.9314516  6721.15867 4700.866935 -16.45110887  44.1926613\ndrat    2.195064  -0.6683669   -47.06402  -16.451109   0.28588135  -0.3727207\nwt     -5.116685   1.3673710   107.68420   44.192661  -0.37272073   0.9573790\nqsec    4.509149  -1.8868548   -96.05168  -86.770081   0.08714073  -0.3054816\nvs      2.017137  -0.7298387   -44.37762  -24.987903   0.11864919  -0.2736613\nam      1.803931  -0.4657258   -36.56401   -8.320565   0.19015121  -0.3381048\ngear    2.135685  -0.6491935   -50.80262   -6.358871   0.27598790  -0.4210806\ncarb   -5.363105   1.5201613    79.06875   83.036290  -0.07840726   0.6757903\n             qsec           vs           am        gear        carb\nmpg    4.50914919   2.01713710   1.80393145   2.1356855 -5.36310484\ncyl   -1.88685484  -0.72983871  -0.46572581  -0.6491935  1.52016129\ndisp -96.05168145 -44.37762097 -36.56401210 -50.8026210 79.06875000\nhp   -86.77008065 -24.98790323  -8.32056452  -6.3588710 83.03629032\ndrat   0.08714073   0.11864919   0.19015121   0.2759879 -0.07840726\nwt    -0.30548161  -0.27366129  -0.33810484  -0.4210806  0.67579032\nqsec   3.19316613   0.67056452  -0.20495968  -0.2804032 -1.89411290\nvs     0.67056452   0.25403226   0.04233871   0.0766129 -0.46370968\nam    -0.20495968   0.04233871   0.24899194   0.2923387  0.04637097\ngear  -0.28040323   0.07661290   0.29233871   0.5443548  0.32661290\ncarb  -1.89411290  -0.46370968   0.04637097   0.3266129  2.60887097\n```\n\n\n:::\n\n```{.r .cell-code}\nvar(X) #=cov(X)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n             mpg         cyl        disp          hp         drat          wt\nmpg    36.324103  -9.1723790  -633.09721 -320.732056   2.19506351  -5.1166847\ncyl    -9.172379   3.1895161   199.66028  101.931452  -0.66836694   1.3673710\ndisp -633.097208 199.6602823 15360.79983 6721.158669 -47.06401915 107.6842040\nhp   -320.732056 101.9314516  6721.15867 4700.866935 -16.45110887  44.1926613\ndrat    2.195064  -0.6683669   -47.06402  -16.451109   0.28588135  -0.3727207\nwt     -5.116685   1.3673710   107.68420   44.192661  -0.37272073   0.9573790\nqsec    4.509149  -1.8868548   -96.05168  -86.770081   0.08714073  -0.3054816\nvs      2.017137  -0.7298387   -44.37762  -24.987903   0.11864919  -0.2736613\nam      1.803931  -0.4657258   -36.56401   -8.320565   0.19015121  -0.3381048\ngear    2.135685  -0.6491935   -50.80262   -6.358871   0.27598790  -0.4210806\ncarb   -5.363105   1.5201613    79.06875   83.036290  -0.07840726   0.6757903\n             qsec           vs           am        gear        carb\nmpg    4.50914919   2.01713710   1.80393145   2.1356855 -5.36310484\ncyl   -1.88685484  -0.72983871  -0.46572581  -0.6491935  1.52016129\ndisp -96.05168145 -44.37762097 -36.56401210 -50.8026210 79.06875000\nhp   -86.77008065 -24.98790323  -8.32056452  -6.3588710 83.03629032\ndrat   0.08714073   0.11864919   0.19015121   0.2759879 -0.07840726\nwt    -0.30548161  -0.27366129  -0.33810484  -0.4210806  0.67579032\nqsec   3.19316613   0.67056452  -0.20495968  -0.2804032 -1.89411290\nvs     0.67056452   0.25403226   0.04233871   0.0766129 -0.46370968\nam    -0.20495968   0.04233871   0.24899194   0.2923387  0.04637097\ngear  -0.28040323   0.07661290   0.29233871   0.5443548  0.32661290\ncarb  -1.89411290  -0.46370968   0.04637097   0.3266129  2.60887097\n```\n\n\n:::\n:::\n\n\n\n#### Properties\n\n* Symmetry\n* Diagonal Entries: The diagonal entries of the covariance matrix represent the variances of the individual variables.\n* Linearity: The covariance matrix exhibits linearity in the sense that the covariance of a linear combination of variables can be expressed as a linear combination of their covariances. Mathematically, if $a$ and $b$ are constants and $X$, $Y$, and $Z$ are random variables, then $\\operatorname{Cov}(aX + bY, Z) = a\\operatorname{Cov}(X, Z) + b\\operatorname{Cov}(Y, Z)$.\n* Scale Invariance: The covariance between variables is invariant to changes in scale or units of measurement. For example, if variables are measured in different units or are on different scales, the covariance matrix will still be valid and informative for measuring the linear relationship between the variables.\n* Independence: If two variables $X_i$ and $X_j$ are independent, their covariance $\\operatorname{Cov}(X_j, X_k)$ is zero.\n* Positive Semidefiniteness: The covariance matrix is positive semidefinite, which means that all of its eigenvalues are non-negative. This property ensures that the covariance matrix is a valid variance-covariance matrix. \n\n### Positive Definite Matrix\n\nA symmetric matrix $\\mathbf{A}$ is positive definite if and only if the quadratic form $f(\\mathbf{x})=\\mathbf{x}^T \\mathbf{A} \\mathbf{x}$ is positive for all nonzero vectors $\\mathbf{x}$.\n\nTo see why this is true, consider the eigenvalue decomposition of $\\mathbf{A}$, which can be written as $\\mathbf{A} = \\mathbf{Q} \\Lambda \\mathbf{Q}^T$, where $\\mathbf{Q}$ is an orthogonal matrix and $\\Lambda$ is a diagonal matrix containing the eigenvalues of $\\mathbf{A}$. Then, for any nonzero vector $\\mathbf{x}$, \n\n$$\n\\begin{aligned}\n\\mathbf x^T \\mathbf A \\mathbf x&=\\mathbf x^T \\mathbf Q \\mathbf \\Lambda \\mathbf Q^T \\mathbf x\\\\\n&=(\\mathbf x^T \\mathbf Q)\\mathbf \\Lambda ( \\mathbf Q^T\\mathbf x)\\\\\n&=\\sum_{i=1}^{n} \\lambda_iy_i^2\n\\end{aligned}\n$$\n\nwhere $y_i = (\\mathbf{x}^T \\mathbf{Q})_i$ is the $i$ th coordinate (i.e., a scalar value that represents the position of a point or a vector relative to a chosen basis) of $\\mathbf{x}^T \\mathbf{Q}$ and $n$ is the dimension of $\\mathbf{x}$ and $\\mathbf{A}$. Note that since $\\mathbf{Q}$ is orthogonal, we have $\\mathbf{Q}^T \\mathbf{Q} = I$, so $y_i = \\mathbf{q}_i^T \\mathbf{x}$, where $\\mathbf{q}_i$ is the $i$ th column of $Q$. Therefore, the quadratic form $f(\\mathbf{x}) = \\mathbf{x}^T A \\mathbf{x}$ can be written in terms of the eigenvalues of $\\mathbf{A}$ and the coordinates of $\\mathbf{x}$ with respect to the eigenvectors of $\\mathbf{A}$.\n\nSince $\\mathbf{A}$ is positive definite, we have $\\lambda_i > 0$ for all $i$, and so $\\sum_{i=1}^n \\lambda_i y_i^2 > 0$ for all nonzero vectors $\\mathbf{x}$. Therefore, the quadratic form $f(\\mathbf{x})=\\mathbf{x}^T \\mathbf{A} \\mathbf{x}$ is positive for all nonzero vectors $\\mathbf{x}$, which implies that $\\mathbf{A}$ is positive definite.\n\nIn other words, the positive definiteness of a symmetric matrix $\\mathbf{A}$ is equivalent to the positivity of the associated quadratic form $f(\\mathbf{x})=\\mathbf{x}^T \\mathbf{A} \\mathbf{x}$ for all nonzero vectors $\\mathbf{x}$.\n\nTherefore, a symmetric matrix, $\\mathbf A$ is said to be positive definite if all of its eigenvalues are positive or equivalently, a symmetric matrix, $\\mathbf A$ is positive definite if left-multiplying and right-multiplying it by the same vector, $\\mathbf x$ always gives a positive number if $\\mathbf x^T \\mathbf A \\mathbf x$\n\n#### Properties\n\nProperties of a positive definite matrix:\n\n* All eigenvalues are positive.\n* The matrix is symmetric.\n* All principal submatrices have determinants that are positive.\n\nExample of a positive definite matrix:\n\n$$\n\\begin{equation}\n\\mathbf{A} = \\begin{bmatrix}\n4 & -1 & 0 \\\\\n-1 & 5 & -1 \\\\\n0 & -1 & 2\n\\end{bmatrix}\n\\end{equation}\n$$",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}