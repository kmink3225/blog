{
  "hash": "ca01aa86e22c1b73899640c3fd6efc92",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: Repeated Meausres ANOVA\nsubtitle: ANOVA, one-way ANOVA, Two-way ANOVA, ANCOVA, repeated measures ANOVA, MANOVA, MANCOVA\ndescription: | \n  .  \ncategories:\n  - Statistics\nauthor: Kwangmin Kim\ndate: 01/27/2023\ndraft: false\nformat: \n  html:\n    toc: true\n    number-sections: True\n    code-fold: true\n    page-layout: full\nexecute: \n  warning: false\n  message: false\n---\n\n(Draft, 바쁘니까 일단 대충이라도 적어놓음 ㅠ)\n\n\n## Description\n\nRepeated Meausres ANOVA (반복 측정 분산 분석)\n\n* 동일한 대상에 대해 여러 번 반복측정하여 반복측정(3번 이상) 집단 간에 차이가 존재하는지 검정\n  * 대응 표본 검정은 동일한 대상에 2번 반복 측정함 2개의 대응표본에 대한 검정\n* 이 때, 반복 측정 기간은 집단 내 요인이라 부르고 이를 반복측정 일원분산분석-집단내요인이라고 부름\n* 반복측정 기간외에 대상을 구분하는 집단 변수가 포함되면 반복측정 이원분산분석- 집단내요인 & 집단간 요인\n\n## Example\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstr(CO2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nClasses 'nfnGroupedData', 'nfGroupedData', 'groupedData' and 'data.frame':\t84 obs. of  5 variables:\n $ Plant    : Ord.factor w/ 12 levels \"Qn1\"<\"Qn2\"<\"Qn3\"<..: 1 1 1 1 1 1 1 2 2 2 ...\n $ Type     : Factor w/ 2 levels \"Quebec\",\"Mississippi\": 1 1 1 1 1 1 1 1 1 1 ...\n $ Treatment: Factor w/ 2 levels \"nonchilled\",\"chilled\": 1 1 1 1 1 1 1 1 1 1 ...\n $ conc     : num  95 175 250 350 500 675 1000 95 175 250 ...\n $ uptake   : num  16 30.4 34.8 37.2 35.3 39.2 39.7 13.6 27.3 37.1 ...\n - attr(*, \"formula\")=Class 'formula'  language uptake ~ conc | Plant\n  .. ..- attr(*, \".Environment\")=<environment: R_EmptyEnv> \n - attr(*, \"outer\")=Class 'formula'  language ~Treatment * Type\n  .. ..- attr(*, \".Environment\")=<environment: R_EmptyEnv> \n - attr(*, \"labels\")=List of 2\n  ..$ x: chr \"Ambient carbon dioxide concentration\"\n  ..$ y: chr \"CO2 uptake rate\"\n - attr(*, \"units\")=List of 2\n  ..$ x: chr \"(uL/L)\"\n  ..$ y: chr \"(umol/m^2 s)\"\n```\n\n\n:::\n\n```{.r .cell-code}\nnames(CO2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Plant\"     \"Type\"      \"Treatment\" \"conc\"      \"uptake\"   \n```\n\n\n:::\n:::\n\n\nR console에 `?CO2`를 입력하면 다음과 같은 설명이 나온다.\n\n*The CO2 data frame has 84 rows and 5 columns of data from an experiment on the cold tolerance of the grass species Echinochloa crus-galli.The $CO_2$ uptake of six plants from Quebec and six plants from Mississippi was measured at several levels of ambient $CO_2$ concentration. Half the plants of each type were chilled overnight before the experiment was conducted.*\n\n\n즉, 식물이 **저온의 환경에서 견디는 정도를 실험한 데이터**로 퀘벡 지역의 6개의 나무와 미시시피 지역의 6개 나무의 이산화 탄소 흡수율을 7개의 서로 다른 이산화 탄소 농도 하에서 반복적으로 측정했다. \n\n### Goals \n\n분석의 편의를 위해 저온 처리된 나무에 한정하여 분석\n\n1. 두 지역간의 CO2흡수율의 차이를 검정\n2. 7개의 서로 다른 이산화탄소 농도에 따라서 이산화 탄소의 흡수율 차이를 검정\n3. 나무의 출신 지역과 이산화 탄소 흡수율 간의 관계가 이산화탄소 농도에 따라 달라지는 지도 검정\n\n### Data Description\n\n* Plant: plant id\n* Type: 나무의 출신 지역, 2개의 범주, 집단간 요인\n* Treatment: 퀘벡 지역 나무와 미시시피 지역 나무dp 각 각 절반씩 실험 전에 저온 처리 했음, 저온 처리 여부가 treatment 변수에 저장됨\n* conc: co2농도, 7개의 범주, 집단 내 요인\n* uptake: 종속 변수, 이산화 탄소 흡수율\n\n### Load Libraries and Data\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(faraway)\nlibrary(markdown)\nlibrary(effects)\nlibrary(HH)\nlibrary(psych)\n```\n:::\n\n\n### EDA\n\n::: {.cell}\n\n```{.r .cell-code}\ndata=CO2%>%\nfilter(Treatment=='chilled')%>%\nmutate(conc=factor(conc),\ntype=factor(conc))\n```\n:::\n\n### Descriptive Statistics\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata%>%\ngroup_by(Type)%>%\nsummarise(count=n(),\nmean_uptake=mean(uptake),\nsd_uptake=sd(uptake)\n)%>%knitr::kable()\n```\n\n::: {.cell-output-display}\n\n\n|Type        | count| mean_uptake| sd_uptake|\n|:-----------|-----:|-----------:|---------:|\n|Quebec      |    21|    31.75238|  9.644823|\n|Mississippi |    21|    15.81429|  4.058976|\n\n\n:::\n:::\n\n\n두 지역의 분산과 평균 흡수율이 차이가 남\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata%>%\ngroup_by(conc)%>%\nsummarise(count=n(),\nmean_uptake=mean(uptake),\nsd_uptake=sd(uptake)\n)%>%knitr::kable()\n```\n\n::: {.cell-output-display}\n\n\n|conc | count| mean_uptake| sd_uptake|\n|:----|-----:|-----------:|---------:|\n|95   |     6|    11.23333|  2.860536|\n|175  |     6|    19.45000|  5.886510|\n|250  |     6|    25.28333| 10.569090|\n|350  |     6|    26.20000| 10.831251|\n|500  |     6|    26.65000| 11.445479|\n|675  |     6|    27.88333| 10.958361|\n|1000 |     6|    29.78333| 12.410547|\n\n\n:::\n:::\n\n\n농도에 따라서 평균 흡수율과 분산이 약간 차이가 나는 것 같음. 다만, 고농도가 될수록 변화량이 줄어드는 것으로 보임\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata%>%\ngroup_by(Type,conc)%>%\nsummarise(count=n(),\nmean_uptake=mean(uptake),\nsd_uptake=sd(uptake)\n)%>%knitr::kable()\n```\n\n::: {.cell-output-display}\n\n\n|Type        |conc | count| mean_uptake| sd_uptake|\n|:-----------|:----|-----:|-----------:|---------:|\n|Quebec      |95   |     3|    12.86667|  3.121431|\n|Quebec      |175  |     3|    24.13333|  3.150132|\n|Quebec      |250  |     3|    34.46667|  3.927255|\n|Quebec      |350  |     3|    35.80000|  2.615339|\n|Quebec      |500  |     3|    36.66667|  3.611556|\n|Quebec      |675  |     3|    37.50000|  2.100000|\n|Quebec      |1000 |     3|    40.83333|  1.913984|\n|Mississippi |95   |     3|     9.60000|  1.646208|\n|Mississippi |175  |     3|    14.76667|  3.302020|\n|Mississippi |250  |     3|    16.10000|  3.292416|\n|Mississippi |350  |     3|    16.60000|  3.157531|\n|Mississippi |500  |     3|    16.63333|  3.667879|\n|Mississippi |675  |     3|    18.26667|  4.285246|\n|Mississippi |1000 |     3|    18.73333|  3.883727|\n\n\n:::\n:::\n\n\n농도가 증가함에 따라 지역간 평균 흡수율의 차이가 커지는 것을 관찰할 수 있음\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nboxplot(uptake~Type*conc,data=data,col=c(\"darkblue\",\"darkred\"),\n        las=2,cex.axis=0.7,xlab=\"\",ylab=\"Carbon Dioxide Uptake Rate\",\n        main=\"Effects of Plant Ype and CO2 on Carbon Dioxide Uptake\")\nlegend(\"topleft\",inset=0.025, legend=c(\"Quebec\",\"Mississippi\"),\n       fill=c(\"darkblue\",\"darkred\"))\n```\n\n::: {.cell-output-display}\n![](2023-01-27_rmANOVA_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\n### One-Wway ANOVA\n\n반복 측정 일원분산분석: y~W+Error(subject) where W= a within grouping variable, subject= a sample identifier\n\n\n::: {.cell}\n\n```{.r .cell-code}\naov(uptake~Type+Error(Plant),data=data)%>%summary()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nError: Plant\n          Df Sum Sq Mean Sq F value  Pr(>F)   \nType       1 2667.2  2667.2   60.41 0.00148 **\nResiduals  4  176.6    44.1                   \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nError: Within\n          Df Sum Sq Mean Sq F value Pr(>F)\nResiduals 36   2013   55.93               \n```\n\n\n:::\n\n```{.r .cell-code}\naov(uptake~conc+Error(Plant),data=data)%>%summary()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nError: Plant\n          Df Sum Sq Mean Sq F value Pr(>F)\nResiduals  5   2844   568.8               \n\nError: Within\n          Df Sum Sq Mean Sq F value   Pr(>F)    \nconc       6   1472  245.40   13.61 2.09e-07 ***\nResiduals 30    541   18.03                     \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n:::\n\n\n지역간 농도간 평균 흡수율이 차이가 5% 유의수준에서 유의하다.\n\n### Two-Wway ANOVA\n\n반복측정 이원분산 분석: y~B*W+Error(subject/W) where W= within grouping variable, B =Between Group Variable, and subject= a sample identifier\n\n\n::: {.cell}\n\n```{.r .cell-code}\naov(uptake~Type*conc+Error(Plant/conc),data=data)%>%summary()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nError: Plant\n          Df Sum Sq Mean Sq F value  Pr(>F)   \nType       1 2667.2  2667.2   60.41 0.00148 **\nResiduals  4  176.6    44.1                   \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nError: Plant:conc\n          Df Sum Sq Mean Sq F value   Pr(>F)    \nconc       6 1472.4  245.40   52.52 1.26e-12 ***\nType:conc  6  428.8   71.47   15.30 3.75e-07 ***\nResiduals 24  112.1    4.67                     \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n:::\n\n\n지역간 농도간 집단간에서 흡수율 차이가 유의한것으로 나타나고 둘의 상호작용 또한 5% 유의수준에서 유의하다.\n\n## Blog Guide Map Link\n\n* [Statistics Blog](../guide_map/index.qmd)\n* [Engineering Blog](../../Engineering/guide_map/index.qmd)\n* [Deep Learning Blog](../../DL/guide_map/index.qmd)\n* [Machine Learning Blog](../../ML/guide_map/index.qmd)\n* [Mathematics Blog](../../Mathmatics/guide_map/index.qmd)\n* [Patent Blog](../../Patent/guide_map/index.qmd)\n* [Validation Blog](../../Validation/guide_map/index.qmd)\n",
    "supporting": [
      "2023-01-27_rmANOVA_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}