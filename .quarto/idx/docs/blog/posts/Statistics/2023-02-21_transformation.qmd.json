{"title":"Transformation of Random Variables","markdown":{"yaml":{"title":"Transformation of Random Variables","subtitle":"Transformation of Functions","description":"","categories":["Statistics"],"author":"Kwangmin Kim","date":"02/21/2023","draft":false,"format":{"html":{"toc":true,"number-sections":true,"code-fold":true,"page-layout":"full"}},"execute":{"warning":false,"message":false}},"headingText":"Trnasformation of Random Variables","containsRefs":false,"markdown":"\n\n<ul class=\"nav nav-pills\" id=\"language-tab\" role=\"tablist\">\n  <li class=\"nav-item\" role=\"presentation\">\n    <button class=\"nav-link active\" id=\"Korean-tab\" data-bs-toggle=\"tab\" data-bs-target=\"#Korean\" type=\"button\" role=\"tab\" aria-controls=\"Korean\" aria-selected=\"true\">Korean</button>\n  </li>\n  <li class=\"nav-item\" role=\"presentation\">\n    <button class=\"nav-link\" id=\"English-tab\" data-bs-toggle=\"tab\" data-bs-target=\"#English\" type=\"button\" role=\"tab\" aria-controls=\"knitr\" aria-selected=\"false\">English</button>\n  </li>\n\n<div class=\"tab-content\" id=\"language-tabcontent\">\n\n<div class=\"tab-pane fade  show active\" id=\"Korean\" role=\"tabpanel\" aria-labelledby=\"Korean-tab\">\n\n::: {#Korean .tab-pane .fade .show .active role=\"tabpanel\" aria-labelledby=\"Korean-tab\"}\n\n\n\n\n### Introduction\n\n확률 변수 2개 이상에 대한 확률 분포를 joint probability distribution (결합확률분포)라고 하는데 두 확률 변수 $X$ 와 $Y$ 의 관계에 대해서 규명해야 할 때가 있다. 예를 들어, X 와 Y의 높은 상관계수라든지 또는 비선형적인 관계가 관찰될 때 그 관계가 수리적으로 모델링이 가능하고 한 확률 변수의 분포에 대한 정보를 알고있다면 미지의 다른 확률 변수의 분포가 추정가능해진다. 이 때 두 변수에 대한 관계 정도가 높으면 높을수록 추정이 쉬워진다.\n\n이번 블로그에서는 주어진 확률 변수 $X$ 에 대해서 $X$ 의 pmf (probability mass function) 또는 pdf (probability density function) $f_x(x)$ 를 알고있을 때 확률 변수에 $X$ 에 적절한 함수의 변환을 적용해 확률 변수 $Y$ 를 $Y=u(X)$ 라는 관계식이 정의 가능할 때 $Y$ 의 pmf 또는 pdf를 구하는 방법에 집중한다. 후에 MGF (Momment Generating Function) 학습에 응용될 수 있는 개념으로 잘 정리할 필요가 있다. \n\n### Trnasformation of Discrete Random Variables\n\n::: {#thm-discrete}\n\nDiscrete random variable $X$ 의 probability distribution이 $f_X(x)$ 이고  $X$ 와 $Y$ 사이에는 $Y=u(X)$ 라는 one-to-one relation이 성립될 때 $y=u(x)$ 를 유일한 $x$ 를 $y$ 에 대한 함수인 $x=w(y)$ 로 표현 가능하다면 $Y$ 의 probability distribution는 \n$$\nf_Y(y)=f_X(w(y))\n$$ \n이다.  \n\n:::\n\n#### Example\n\n* In the case of a One-to-One relation\n\n동전을 독립적으로 2번 던질 때, 확률 변수 $X$ 가 앞면이 나오는 수라고 정의했을 때, 확률 분포 아래 표 (a)와 같다.  $Y=2X+1$ 라는 관계가 성립할 때 $Y$ 의 분포는 아래 표 (b)와 같다.\n\n::: {#tbl-panel layout-ncol=2}\n\n| $X$      |    0 |     1 |      2 |\n|----------|:----:|:-----:|:------:|\n| $P_X(X=x)$| $\\frac{1}{4}$ | $\\frac{2}{4}$ | $\\frac{1}{4}$ |\n\n: Probability Distribution of $X$ \n\n| $Y=2X+1$ |    1 |     3 |      5 |\n|----------|:----:|:-----:|:------:|\n| $P_Y(Y=y)$| $\\frac{1}{4}$ | $\\frac{2}{4}$ | $\\frac{1}{4}$ |\n\n: Probability Distribution of $Y=2X+1$\n\nExmaple: Transformation of Discrete Random Variable (One to One)\n:::\n\n* In the case of not a One-to-One relation\n\n동전을 독립적으로 2번 던질 때, 확률 변수 $X$ 가 앞면이 나오는 수의 합이라고 정의 했을때, $X$ 의 확률 분포는 아래 표 (a) 와 같다. 이 때 $Y=mod(X,2)$ 라는 관계가 성립할 때 $Y$ 의 분포는 아래 표 (b) 같다.\n\n::: {#tbl-panel layout-ncol=2}\n\n| $X$      |    0 |     1 |      2 |\n|----------|:----:|:-----:|:------:|\n| $P_X(X=x)$| $\\frac{1}{4}$ | $\\frac{2}{4}$ | $\\frac{1}{4}$ |\n\n: Probability Distribution of $X$\n\n| $Y=mod(x,2)$ |    0 |     1 |\n|----------|:----:|:-----:|\n| $P_Y(Y=y)$| $\\frac{2}{4}$ | $\\frac{2}{4}$ |\n\n: Probability Distribution of $Y=mod(x,2)$\n\nExmaple: Transformation of Discrete Random Variable (Not One to One)\n:::\n\n위의 예시와 같이 두 확률 변수가 one to one 관계일 때는 확률분포가 그대로 유지되어서 쉽게 변환된 확률 변수의 분포가 추정가능하지만 one to one 관계가 아닐 경우 확률 분포가 바뀌게 된다.\n\n* another example (In the case of not a One-to-One relation)\n\n기하분포 (Geometric Distribution)란 동일한 베르누이 (Bernoulli) 분포의 시행을 독립적으로 반복할 때 첫 성공까지의 시행 횟수를 확률변수 $X$ 로 하는 분포이다. 즉, $x-1$ 번째까지 베르누이 시행이 실패하고 $x$ 번째 시행에서 성공할 확률 분포를 말한다. \n\nNotation은 $X \\sim Geometric(p)$ 또는 $X \\sim Geo(p)$ 라고 표현하고, $p$ 는 독립 시행에서 성공할 확률이다. (참고: $text{E}(X)=\\frac{1}{p}$, $\\text{Var}(X)=\\frac{1-p}{p^2}$)\n\n$X \\sim Geometric(\\frac{4}{5})$ 일 때 $X$ 의 확률분포 $f(x)=\\frac{4}{5}(\\frac{1}{5})^{(x-1)}$, $x=1,2,3 ...$ 가 기하분포일 때 $Y=X^2$ 의 확률분포는\n\n$$\n\\begin{aligned}\n  y&=u(x)=x^2 \\\\\n  x&=w(y)=\\sqrt{y} \\text{ } (x>0)\\\\\n  f_Y(y)&=f_X(w(y))=f_X(\\sqrt{y})=\\frac{4}{5}(\\frac{1}{5}^{(\\sqrt{y}-1)})\\\\\n  \\therefore f_Y(y)&=\n  \\begin{cases} \n    \\frac{4}{5}(\\frac{1}{5}^{(\\sqrt{y}-1)}) &\\text{if} \\text{  } y =1, 4, 9, ...\\\\\n     0 \\text{  } & \\text{otherwise}\n    \\end{cases}\n\\end{aligned}\n$$\n\n이다.\n\n### Trnasformation of Joint Discrete Random Variables\n\n::: {#thm-discrete_joint}\n\nTwo discrete random variables $X_1$ 과 $X_2$ 의 joint probability distribution이 $f(x_1,x_2)$ 이고  $(x_1,x_2)$ 와 $(y_1,y_2)$ 가 one-to-one relation이 성립되어 $y_1=u_1(x_1,x_2)$ 와 $y_2=u_2(x_1,x_2)$ 를 유일한 $x_1=w_1(y_1,y_2)$ 와 $x_2=w_2(y_1,y_2)$ 의 함수로 표현 가능하다면 새로운 확률변수 $\\mathbf{Y}$, 즉, $Y_1$ 과 $Y_2$ 의 joint probability distribution는 \n$$\nf_Y(y_1,y_2)=f_X(w_1(y_1,y_2),w_2(y_1,y_2))\n$$ \n이다.  \n\n:::\n\n#### Example \n\n* exmaple 1\n\n다항 분포(multinomial distribution)란 2개 이상의 독립적인 확률 변수 $\\mathbf{X}=X_1, X_2, ...$ 들에 대한 확률분포로, 여러 독립 시행에서 각 각의 값이 특정 횟수가 나타날 확률을 정의하고 독립 변수가 2개인 경우 다항 분포의 특별한 case로 이항 분포 (binomial distribution)가 된다. \n\n참고[( Source: wiki)](https://en.wikipedia.org/wiki/Multinomial_distribution) :\n\n$$\n\\begin{aligned}\n  f_(x) & =\\frac{n!}{x_1!x_2!\\dots x_k!}p_1^{x_1}p_2^{x_2}\\dots p_k^{x_k}\\\\\n  \\text{E}(x)&=np_i\\\\\n  \\text{Var}(x)&=np_i(1-p_i)\n\\end{aligned}\n$$\n\n$X_1$ and $X_2$ 가 다음과 같은 multinomial distribution을 따를 때 \n$$\nf(x_1,x_2) = \\binom{2}{x_1,x_2,2-x_1-x_2}\\frac{1}{4}^{x_1}\\frac{1}{3}^{x_2}\\frac{5}{12}^{2-x_1-x_2} x_1=0,1,2, \\space x_2=0,1,2, \\space x_1+x_2\\le 2\n$$\n\n$Y_1=X_1+X_2$ 와 $Y_2=X_1-X_2$ 의 결합 확률 분포는\n\n$$\n\\begin{aligned}\n  y_1&=u_1(x_1,x_2)=x_1+x_2\\\\\n  y_2&=u_2(x_1,x_2)=x_1-x_2\\\\\n  x_1&=w_1(y_1,y_2)=\\frac{y_1+y_2}{2}\\\\\n  x_2&=w_2(y_1,y_2)=\\frac{y_1-y_2}{2}\\\\\n  f_Y(y_1,y_2)&=\\binom{2}{\\frac{y_1+y_2}{2},\\frac{y_1-y_2}{2},2-y_1 }\\frac{1}{4}^{\\frac{y_1+y_2}{2}}\\frac{5}{12}^{2-y_1} y_1=0,1,2, \\space y_2=-2,-1,0,1,2\n\\end{aligned}\n$$\n이다.\n\n* exmaple 2\n\n$X_1$ 과 $X_2$ 의 결합확률분포가 다음과 같을 때 변환된 $Y_1=X_1+X_2$ 와 $Y_2=X_1X_2$ 의 결합확률 분포는?\n\n::: {#tbl-panel layout-ncol=2}\n\n| $(x_1,x_2)$|   (0, 0) |     (0, 1) | (1, 0) | (1, 1) |\n|----------|:----:|:-----:|:------:|:------:|\n| $f_X(x_1,x_2)$| $\\frac{1}{4}$ | $\\frac{1}{4}$ | $\\frac{1}{4}$ | $\\frac{1}{4}$ |\n\n: Probability Distribution of $X$\n\n| $(y_1,y_2)$|   (0, 0)| (1, 0) | (2, 1) |\n|----------|:----:|:-----:|:------:|:------:|\n| $f_Y(y_1,y_2)$| $\\frac{1}{4}$ | $\\frac{2}{4}$ | $\\frac{1}{4}$ |\n\n: Probability Distribution of $Y$\n\nExmaple: Transformation of Joint Discrete Random Variable (Not One to One)\n:::\n\n### Trnasformation of Continuous Random Variables\n\n::: {#thm-continuous}\n\ncontinuous random variable $X$ 의 probability distribution이 $f_X(x)$ 이고 $X$ 와 $Y$ 사이에는 $Y=u(X)$ 라는 one-to-one relation이 성립될 때 $y=u(x)$ 를 유일한 $x$ 를 $y$ 에 대한 함수인 $x=w(y)$ 로 표현 가능할 때 Y의 확률 분포는 \n$$\nf_Y(y)=f_X(w(y))|J|\n$$ \n이다. ($J=w'(y)$, called 'Jacobian')\n:::\n\n#### Example\n\n* In the case of a One-to-One relation\n\n지수분포(exponential distribution)는 연속 확률 분포 중 하나로, 사건이 서로 독립적일 때, 일정 시간동안 발생하는 사건의 횟수가 푸아송 분포를 따른다면, 다음 사건이 발생할 때까지의 대기 시간을 확률 변수 $X \\in [0, \\infty)$ 로 하는 분포이다. [(Source: Wiki)](https://en.wikipedia.org/wiki/Exponential_distribution).\n\n참고:\n$$\n\\begin{aligned}\n  X&\\sim Exp(\\lambda) \\\\\n  \\text E[X] &= \\frac{1}{\\lambda}\\\\\n  \\text{Var}[X] &= \\frac{1}{\\lambda^2}\\\\\n  f(x;\\lambda)&=\n  \\begin{cases} \n    \\lambda e^{-\\lambda x} & x \\ge 0\\\\\n    0 & x<0\n  \\end{cases}\\\\\n\\end{aligned}\n$$\n$\\lambda>0$ is the parameter of the distribution, called 'rate parameter'.\n\nTransformation of Linear Function. When two random variables $X \\sim \\text{exp}(\\lambda)$ and $Y$ has the relation, $Y=aX+b$ $(a\\ne 0)$. When $f_X(x)=\\lambda e^{-\\lambda x}$, $f_Y(y)$ is\n\n**By Theorem**\n\n$$\n\\begin{aligned}\n  Y&=u(X)=aX+b\\\\\n  y&=u(x)=ax+b\\\\\n  x&=w(y)=\\frac{y-b}{a}\\\\\n  f_Y(y)&=f_X(w(y))|J|=f_X(\\frac{y-b}{a})|J|\\\\\n        &=f_X(\\frac{y-b}{a})|w'(y)|\\\\\n        &=f_X(\\frac{y-b}{a})|\\frac{1}{a}|\\\\\n        &=\\frac{f_X(\\frac{y-b}{a})}{|a|}\\\\\n\\end{aligned}\n$$\n\n**By Definition**\n\n:::: {.columns}\n\n::: {.column width=\"50%\"}\n* $a>0$\n$$\n\\begin{aligned}\n  F_Y(Y)&=P_Y(Y\\le y)\\\\\n        &=P_Y(aX+b\\le y)\\\\\n        &=P_Y(X\\le \\frac{y-b}{a})\\\\\n        &=F_X(\\frac{y-b}{a})\\\\\n  F'_Y(Y)&=\\frac{d}{dy}F_X(\\frac{y-b}{a})\\\\\n         &=f_X(\\frac{y-b}{a})\\frac{1}{a}\\\\\n\\end{aligned}\n$$\n\n:::\n\n::: {.column width=\"50%\"}\n* $a\\le 0$\n$$\n\\begin{aligned}\n  F_Y(Y)&=P_Y(Y\\le y)\\\\\n        &=P_Y(aX+b\\le y)\\\\\n        &=P_Y(X> \\frac{y-b}{a})\\\\\n        &=1-F_X(\\frac{y-b}{a})\\\\\n  F'_Y(Y)&=\\frac{d}{dy}(1-F_X(\\frac{y-b}{a}))\\\\\n         &=-f_X(\\frac{y-b}{a})\\frac{1}{a}\\\\  \n\\end{aligned}\n$$\n:::\n\n$$\n\\therefore f_Y(y)=\\frac{f_X(\\frac{y-b}{a})}{|a|}=\\frac{\\lambda exp(-\\lambda (\\frac{y-b}{a}))}{|a|}\n$$\n\n::::\n\n위의 정리를 유도를 하진 않았지만 증명을 해보면 사실, $|J|$ 는 역함수의 미분의 계수인 것을 할 수 있다. 위의 예시를 **By definition** 으로 푼 것을 보면 $y=u(x)$ 와 $x=w(y)$ 의 관계인 것을 알 수 있고 $|J|$ 에 해당되는 $\\frac{1}{a}$ 는 CDF $F(Y)$ 의 derivative를 구하는 과정에서 발생하는 chain rule에 의해 생긴 것을 알 수 있다. \n\n$$\n\\begin{aligned}\n  y&=u(x)\\\\\n  \\frac{dy}{dx}&=u'(x)\\\\\n  x&=w(y)=u^{-1}(y)\\\\\n  \\frac{dx}{dy}&=w'(y) \\\\\n  w'(y)&=\\frac{dx}{dy}=(\\frac{dy}{dx})^{-1}=\\frac{1}{u'(x)}\n\\end{aligned}\n$$\n\n```{python}\nimport numpy as np\nimport matplotlib.pyplot as plt\n\nx = np.linspace(-10, 20, 1000)\ny = 2*x+1\ny2 = x/2+1\n\nfig, ax = plt.subplots()\n\n\nax.axhline(y=0, color='k')\nax.axvline(x=0, color='k')\nax.grid(True, which='both')\n\nax.plot(x,x,color='black',label=r'$y=x$', linestyle='dashed')\nax.plot(x,2*x-2,color='black',label=r'$x=w(y) \\rightarrow y=2x-2 $')\nax.plot(x,y2,color='red',label=r'$y=u(x)=\\frac{1}{2}x+1$')\nax.set_aspect(1)\nax.set_title(r\"Example of Relation of X and Y, $y=u(x)$ vs $x=w(y)$\")\nax.set_xlabel(\"x-axis\")\nax.set_ylabel(\"y-axis\")\nax.set_xlim(-20, 40)\n\nplt.legend(shadow=True, loc=(-0.5, 1.1), handlelength=1.5, fontsize=8)\nplt.show()\n\n```\n\n\n```{python}\nimport numpy as np\nimport matplotlib.pyplot as plt\n\nx = np.linspace(-10, 20, 1000)\ny = 2*x+1\ny2 = x/2+1\n\nfig, ax = plt.subplots()\n\n\nax.axhline(y=0, color='k')\nax.axvline(x=0, color='k')\nax.grid(True, which='both')\n\nax.plot(x,y,color='black',label=r'$y=2x+1$')\nax.plot(x,y2,color='red',label=r'$y=\\frac{1}{2}x+1$')\nax.set_aspect(1)\nax.set_title(r\"Transformation of Linear Function, $f_Y(y)=\\frac{f_X(\\frac{y-b}{a})}{|a|}$\")\nax.set_xlabel(\"X\")\nax.set_ylabel(\"Y=u(X)\")\nax.set_xlim(-20, 40)\nax.text(10, 0,'|', color='black', horizontalalignment='center', verticalalignment='center')\nax.text(10, -5, r'$\\frac{y-b}{a}$', horizontalalignment='center',color='black')\nax.text(0, 5,'--', color='black', horizontalalignment='center', verticalalignment='center')\nax.text(-9, 5, r'$ax+b$', verticalalignment='center',color='black')\n\nplt.legend(shadow=True, loc=(-0.5, 1.1), handlelength=1.5, fontsize=8)\nplt.show()\n\n```\n\n$P(Y\\le y)=P(X\\le \\frac{y-b}{a})$ 이기 때문에 $X$ 의 특정 구간의 확률과 대응되는 $Y$ 의 구간의 확률이 같다고 했을 때 $Y \\le y$ 의 범위는 $X$ 를 $b$ 만큼 이동한 후 $a$ 배한 $x$ 좌표 이하 구간에 대응 된다 즉, $X\\le \\frac{y-b}{a}$. 이 때, 두 구간에서의 확률 밀도가 같아야 하기 때문에 $f_x(x)$ 가 $f_Y(y)$ 의 $\\frac{1}{a}$ 배 인 것을 알 수 있다.\n\n위의 그림에서 처럼, 두 확률 변수 $X$ 와 $Y$ 의 관계를 $y = 2x+1$ $(a>1)$ 와 $y = \\frac{1}{2}x+1$ $(0 \\le a\\le 1)$ 로 두 가지의 예로 들면, 위의 그래프의 경우, $y = 2x+1$ $(a>1)$ 일 때 $0<X<10$ 는 $1<Y<21$ 의 구간이 2배가 되는 것을 관찰 할 수 있다. 반대로, $y = \\frac{1}{2}x+1$ $(0 \\le a\\le 1)$ 일 때 $0<X<10$ 는 $1<Y<6$ 의 구간이 $\\frac{1}{2}$ 배가 된다. 이 때 각 예시의 경우에 $X$ 와 $Y$ 의 확률 값이 같기 때문에 ($P(Y\\le y)=P(X\\le \\frac{y-1}{2})$ 와 $P(Y\\le y)=P(X\\le \\frac{y-1}{\\frac{1}{2}})$). $f_x(x)$ 가 $f_Y(y)$ 의 각 각 $2$ 배와 $\\frac{1}{2}$ 배 인 것을 추정 할 수 있다.\n\n* In the case of not a One-to-One relation\n\n$Y=X^2$ 일 때,\n\n$$\n\\begin{aligned}\n  F_Y(Y)&=P_Y(Y\\le y)\\\\\n        &=P_Y(X^2\\le y)\\\\\n        &=P_Y(-\\sqrt{y}\\le X \\le \\sqrt y)\\\\\n        &=F_X(\\sqrt{y})-F_X(-\\sqrt{y})\\\\\n  F'_Y(Y)&=\\frac{d}{dy}(F_X(\\sqrt{y})-F_X(-\\sqrt{y}))\\\\\n        &=f_X(\\sqrt{y})\\frac{1}{2\\sqrt{y}}+f_X(-\\sqrt{y})\\frac{1}{2\\sqrt{y}}\\\\\n        &=\\frac{f_X(\\sqrt{y})}{2\\sqrt{y}}+\\frac{f_X(-\\sqrt{y})}{2\\sqrt{y}}\\\\\n\\end{aligned}\n$$\n\n\n```{python}\nimport numpy as np\nimport matplotlib.pyplot as plt\n\nx = np.linspace(-10, 10, 1000)\ny = x*x\n\nfig, ax = plt.subplots()\n\n\nax.axhline(y=0, color='k')\nax.axvline(x=0, color='k')\nax.grid(True, which='both')\n\nax.plot(x,y,color='black',label=r'$y=x^2$')\n#ax.text(3.0,0.5,r'$\\sqrt{y}$')\n#ax.text(-4,0.5,r'$-\\sqrt{y}$')\nax.set_xlim([-10, 10])\nax.set_ylim([0, 10])\n\nax.set_aspect(1)\nax.set_title(r\"Transformation of Random Variables, $y=x^2$\")\nax.set_xlabel(\"x-axis\")\nax.set_ylabel(\"y-axis\")\n\nplt.legend(shadow=True, loc=(-0.2, 1.1), handlelength=1.5, fontsize=8)\nplt.show()\n\n```\n\n$X$ 의 분포를 알고 $X$ 와 $Y$ 의 relation을 알고있을 때 $X$ 의 분포로부터 $Y$ 의 분포를 추정 가능한 것의 이점 중 하나는 $Y$ 의 통계량을 $Y$ 의 분포를 사용하지 않고 계산해낼 수 있다는 점이다.\n\n예를 들어, $X \\sim N(0,1)$ 이고  $Y=u(X)$ 라는 관계를 알고있을 때, $Y$ 의 통계량 $E(Y)$, $Var(Y)$ 를 알고싶다면 굳이 힘들게 $Y$ 의 분포를 계산할 필요가 없다. 이미 $X$ 의 확률 분포 $f_X(x)$ 를 알고있기 때문에 아래와 같이 $Y$ 의 통계량을 계산해낼 수 있다. \n\n$$\n\\begin{aligned}\n  \\text{E}(Y)&=\\int Y f_Y(y) dy\\\\\n            &=\\int u(X) f_X(x) dx\\\\\n  \\text{E}(Y^2)&=\\int Y^2 f_Y(y) dy\\\\\n            &=\\int u(X)^2 f_X(x) dx\\\\\n  \\text{Var}(Y)&=\\text{E}(Y^2)-\\text{E}(Y)^2\\\\\n  &=\\text{E}(g(X)^2)-\\text{E}(g(X))^2\\\\\n\\end{aligned}\n$$\n\n### Trnasformation of Joint Continuous Random Variables\n\n::: {#thm-continuous_joint}\n\nTwo continuous random variable $X_1$ 과 $X_2$ 의 joint probability distribution이 $f(x_1,x_2)$ 이고  $(x_1,x_2)$ 와 $(y_1,y_2)$ 가 one-to-one relation이 성립될 때 $y_1=u_1(x_1,x_2)$ 와 $y_2=u_2(x_1,x_2)$ 를 유일한 $x_1=w_1(y_1,y_2)$ 와 $x_2=w_2(y_1,y_2)$ 의 함수로 표현 가능할 때 $Y_1=u_1(X_1,X_2)$ 와 $Y_2=u_2(X_1,X_2)$ 로 정의되는 새로운 확률변수 $Y_1$ 과 $Y_2$ 의 joint probability distribution는 \n$$\ng(y_1.y_2)=f(w_1(y_1,y_2),w_2(y_1,y_2)) |J|\n$$ \n이다.  \n여기서, \n$$\n\\begin{aligned}\n  |J|=|\n  \\begin{bmatrix}\n  \\frac{\\partial x_1}{\\partial y_1}&\\frac{\\partial x_1}{\\partial y_2}\\\\\n  \\frac{\\partial x_2}{\\partial y_1}&\\frac{\\partial x_2}{\\partial y_2}\\\\\n  \\end{bmatrix}| = | \\begin{bmatrix}\n  \\frac{\\partial w_1(y_1,y_2)}{\\partial y_1}&\\frac{\\partial w_1(y_1,y_2)}{\\partial y_2}\\\\\n  \\frac{\\partial w_2(y_1,y_2)}{\\partial y_1}&\\frac{\\partial w_2(y_1,y_2)}{\\partial y_2}\\\\\n  \\end{bmatrix} |\n\\end{aligned}\n$$\ncalled 'the determinant of jacobian matrix'\n\n:::\n\n#### Example\n\n* 예제\n\n연속확률변수  $X_1$ 과 $X_2$ 는 결합확률분포 \n$$ \nf(x_1,x_2)=\n  \\begin{cases}\n    4x_1x_2, & \\text{if  } 0<x_1<1,& 0< x_2 <1 \\\\ \n    0, & \\text{otherwise}\n  \\end{cases}\n$$ \n일 때, $Y_1=X_1^2$ 과 $Y_2=X_1X_2$ 의 결합확률 분포는\n\n$$\n\\begin{aligned}\ny_1&=u_1(x_1,x_2)= x_1^2\\\\\ny_2&=u_2(x_1,x_2)= x_1x_2\\\\\nx_1&=w_1(y_1,y_2)= \\sqrt{y_1} & (y_1>0)\\\\\nx_2&=w_2(y_1,y_2)= \\frac{y_2}{x_1} = \\frac{y_2}{\\sqrt{y_1}}  & (y_1>0)\\\\\ng(y_1.y_2)&=f(w_1(y_1,y_2),w_2(y_1,y_2))|J|\\\\\ng(y_1.y_2)&=f(w_1(y_1,y_2),w_2(y_1,y_2))|J|\\\\\n          &=4\\sqrt{y_1}\\frac{y_2}{\\sqrt{y_1}}\\frac{1}{2y_1}\\\\\n          &=\\begin{cases}\n          \\frac{2y_2}{y_1} & \\text{if  } y_2^2<y_1<1, \\text{  } 0<y_2<1\\\\\n          0 & \\text{otherwise}\n          \\end{cases}\\\\\n          |J|&=|\n          \\begin{bmatrix}\n          \\frac{\\partial x_1}{\\partial y_1}&\\frac{\\partial x_1}{\\partial y_2}\\\\\n          \\frac{\\partial x_2}{\\partial y_1}&\\frac{\\partial x_2}{\\partial y_2}\\\\\n          \\end{bmatrix}|\\\\\n           &=|\n          \\begin{bmatrix}\n          \\frac{1}{2\\sqrt{y_1}}&0\\\\\n          y_2(-\\frac{1}{2}y_1^{\\frac{-3}{2}})&\\frac{1}{\\sqrt{y_1}}\\\\\n          \\end{bmatrix}|\\\\\n          &=\\frac{1}{2y_1}\n\\end{aligned}\n$$ \n\n이다. \n:::\n\n</div>\n\n\n\n## Blog Guide Map Link\n\n* [Statistics Blog](../guide_map/index.qmd)\n* [Engineering Blog](../../Engineering/guide_map/index.qmd)\n* [Deep Learning Blog](../../DL/guide_map/index.qmd)\n* [Machine Learning Blog](../../ML/guide_map/index.qmd)\n* [Mathematics Blog](../../Mathmatics/guide_map/index.qmd)\n* [Patent Blog](../../Patent/guide_map/index.qmd)\n* [Validation Blog](../../Validation/guide_map/index.qmd)\n\n\n\n","srcMarkdownNoYaml":"\n\n<ul class=\"nav nav-pills\" id=\"language-tab\" role=\"tablist\">\n  <li class=\"nav-item\" role=\"presentation\">\n    <button class=\"nav-link active\" id=\"Korean-tab\" data-bs-toggle=\"tab\" data-bs-target=\"#Korean\" type=\"button\" role=\"tab\" aria-controls=\"Korean\" aria-selected=\"true\">Korean</button>\n  </li>\n  <li class=\"nav-item\" role=\"presentation\">\n    <button class=\"nav-link\" id=\"English-tab\" data-bs-toggle=\"tab\" data-bs-target=\"#English\" type=\"button\" role=\"tab\" aria-controls=\"knitr\" aria-selected=\"false\">English</button>\n  </li>\n\n<div class=\"tab-content\" id=\"language-tabcontent\">\n\n<div class=\"tab-pane fade  show active\" id=\"Korean\" role=\"tabpanel\" aria-labelledby=\"Korean-tab\">\n\n::: {#Korean .tab-pane .fade .show .active role=\"tabpanel\" aria-labelledby=\"Korean-tab\"}\n\n\n\n## Trnasformation of Random Variables\n\n### Introduction\n\n확률 변수 2개 이상에 대한 확률 분포를 joint probability distribution (결합확률분포)라고 하는데 두 확률 변수 $X$ 와 $Y$ 의 관계에 대해서 규명해야 할 때가 있다. 예를 들어, X 와 Y의 높은 상관계수라든지 또는 비선형적인 관계가 관찰될 때 그 관계가 수리적으로 모델링이 가능하고 한 확률 변수의 분포에 대한 정보를 알고있다면 미지의 다른 확률 변수의 분포가 추정가능해진다. 이 때 두 변수에 대한 관계 정도가 높으면 높을수록 추정이 쉬워진다.\n\n이번 블로그에서는 주어진 확률 변수 $X$ 에 대해서 $X$ 의 pmf (probability mass function) 또는 pdf (probability density function) $f_x(x)$ 를 알고있을 때 확률 변수에 $X$ 에 적절한 함수의 변환을 적용해 확률 변수 $Y$ 를 $Y=u(X)$ 라는 관계식이 정의 가능할 때 $Y$ 의 pmf 또는 pdf를 구하는 방법에 집중한다. 후에 MGF (Momment Generating Function) 학습에 응용될 수 있는 개념으로 잘 정리할 필요가 있다. \n\n### Trnasformation of Discrete Random Variables\n\n::: {#thm-discrete}\n\nDiscrete random variable $X$ 의 probability distribution이 $f_X(x)$ 이고  $X$ 와 $Y$ 사이에는 $Y=u(X)$ 라는 one-to-one relation이 성립될 때 $y=u(x)$ 를 유일한 $x$ 를 $y$ 에 대한 함수인 $x=w(y)$ 로 표현 가능하다면 $Y$ 의 probability distribution는 \n$$\nf_Y(y)=f_X(w(y))\n$$ \n이다.  \n\n:::\n\n#### Example\n\n* In the case of a One-to-One relation\n\n동전을 독립적으로 2번 던질 때, 확률 변수 $X$ 가 앞면이 나오는 수라고 정의했을 때, 확률 분포 아래 표 (a)와 같다.  $Y=2X+1$ 라는 관계가 성립할 때 $Y$ 의 분포는 아래 표 (b)와 같다.\n\n::: {#tbl-panel layout-ncol=2}\n\n| $X$      |    0 |     1 |      2 |\n|----------|:----:|:-----:|:------:|\n| $P_X(X=x)$| $\\frac{1}{4}$ | $\\frac{2}{4}$ | $\\frac{1}{4}$ |\n\n: Probability Distribution of $X$ \n\n| $Y=2X+1$ |    1 |     3 |      5 |\n|----------|:----:|:-----:|:------:|\n| $P_Y(Y=y)$| $\\frac{1}{4}$ | $\\frac{2}{4}$ | $\\frac{1}{4}$ |\n\n: Probability Distribution of $Y=2X+1$\n\nExmaple: Transformation of Discrete Random Variable (One to One)\n:::\n\n* In the case of not a One-to-One relation\n\n동전을 독립적으로 2번 던질 때, 확률 변수 $X$ 가 앞면이 나오는 수의 합이라고 정의 했을때, $X$ 의 확률 분포는 아래 표 (a) 와 같다. 이 때 $Y=mod(X,2)$ 라는 관계가 성립할 때 $Y$ 의 분포는 아래 표 (b) 같다.\n\n::: {#tbl-panel layout-ncol=2}\n\n| $X$      |    0 |     1 |      2 |\n|----------|:----:|:-----:|:------:|\n| $P_X(X=x)$| $\\frac{1}{4}$ | $\\frac{2}{4}$ | $\\frac{1}{4}$ |\n\n: Probability Distribution of $X$\n\n| $Y=mod(x,2)$ |    0 |     1 |\n|----------|:----:|:-----:|\n| $P_Y(Y=y)$| $\\frac{2}{4}$ | $\\frac{2}{4}$ |\n\n: Probability Distribution of $Y=mod(x,2)$\n\nExmaple: Transformation of Discrete Random Variable (Not One to One)\n:::\n\n위의 예시와 같이 두 확률 변수가 one to one 관계일 때는 확률분포가 그대로 유지되어서 쉽게 변환된 확률 변수의 분포가 추정가능하지만 one to one 관계가 아닐 경우 확률 분포가 바뀌게 된다.\n\n* another example (In the case of not a One-to-One relation)\n\n기하분포 (Geometric Distribution)란 동일한 베르누이 (Bernoulli) 분포의 시행을 독립적으로 반복할 때 첫 성공까지의 시행 횟수를 확률변수 $X$ 로 하는 분포이다. 즉, $x-1$ 번째까지 베르누이 시행이 실패하고 $x$ 번째 시행에서 성공할 확률 분포를 말한다. \n\nNotation은 $X \\sim Geometric(p)$ 또는 $X \\sim Geo(p)$ 라고 표현하고, $p$ 는 독립 시행에서 성공할 확률이다. (참고: $text{E}(X)=\\frac{1}{p}$, $\\text{Var}(X)=\\frac{1-p}{p^2}$)\n\n$X \\sim Geometric(\\frac{4}{5})$ 일 때 $X$ 의 확률분포 $f(x)=\\frac{4}{5}(\\frac{1}{5})^{(x-1)}$, $x=1,2,3 ...$ 가 기하분포일 때 $Y=X^2$ 의 확률분포는\n\n$$\n\\begin{aligned}\n  y&=u(x)=x^2 \\\\\n  x&=w(y)=\\sqrt{y} \\text{ } (x>0)\\\\\n  f_Y(y)&=f_X(w(y))=f_X(\\sqrt{y})=\\frac{4}{5}(\\frac{1}{5}^{(\\sqrt{y}-1)})\\\\\n  \\therefore f_Y(y)&=\n  \\begin{cases} \n    \\frac{4}{5}(\\frac{1}{5}^{(\\sqrt{y}-1)}) &\\text{if} \\text{  } y =1, 4, 9, ...\\\\\n     0 \\text{  } & \\text{otherwise}\n    \\end{cases}\n\\end{aligned}\n$$\n\n이다.\n\n### Trnasformation of Joint Discrete Random Variables\n\n::: {#thm-discrete_joint}\n\nTwo discrete random variables $X_1$ 과 $X_2$ 의 joint probability distribution이 $f(x_1,x_2)$ 이고  $(x_1,x_2)$ 와 $(y_1,y_2)$ 가 one-to-one relation이 성립되어 $y_1=u_1(x_1,x_2)$ 와 $y_2=u_2(x_1,x_2)$ 를 유일한 $x_1=w_1(y_1,y_2)$ 와 $x_2=w_2(y_1,y_2)$ 의 함수로 표현 가능하다면 새로운 확률변수 $\\mathbf{Y}$, 즉, $Y_1$ 과 $Y_2$ 의 joint probability distribution는 \n$$\nf_Y(y_1,y_2)=f_X(w_1(y_1,y_2),w_2(y_1,y_2))\n$$ \n이다.  \n\n:::\n\n#### Example \n\n* exmaple 1\n\n다항 분포(multinomial distribution)란 2개 이상의 독립적인 확률 변수 $\\mathbf{X}=X_1, X_2, ...$ 들에 대한 확률분포로, 여러 독립 시행에서 각 각의 값이 특정 횟수가 나타날 확률을 정의하고 독립 변수가 2개인 경우 다항 분포의 특별한 case로 이항 분포 (binomial distribution)가 된다. \n\n참고[( Source: wiki)](https://en.wikipedia.org/wiki/Multinomial_distribution) :\n\n$$\n\\begin{aligned}\n  f_(x) & =\\frac{n!}{x_1!x_2!\\dots x_k!}p_1^{x_1}p_2^{x_2}\\dots p_k^{x_k}\\\\\n  \\text{E}(x)&=np_i\\\\\n  \\text{Var}(x)&=np_i(1-p_i)\n\\end{aligned}\n$$\n\n$X_1$ and $X_2$ 가 다음과 같은 multinomial distribution을 따를 때 \n$$\nf(x_1,x_2) = \\binom{2}{x_1,x_2,2-x_1-x_2}\\frac{1}{4}^{x_1}\\frac{1}{3}^{x_2}\\frac{5}{12}^{2-x_1-x_2} x_1=0,1,2, \\space x_2=0,1,2, \\space x_1+x_2\\le 2\n$$\n\n$Y_1=X_1+X_2$ 와 $Y_2=X_1-X_2$ 의 결합 확률 분포는\n\n$$\n\\begin{aligned}\n  y_1&=u_1(x_1,x_2)=x_1+x_2\\\\\n  y_2&=u_2(x_1,x_2)=x_1-x_2\\\\\n  x_1&=w_1(y_1,y_2)=\\frac{y_1+y_2}{2}\\\\\n  x_2&=w_2(y_1,y_2)=\\frac{y_1-y_2}{2}\\\\\n  f_Y(y_1,y_2)&=\\binom{2}{\\frac{y_1+y_2}{2},\\frac{y_1-y_2}{2},2-y_1 }\\frac{1}{4}^{\\frac{y_1+y_2}{2}}\\frac{5}{12}^{2-y_1} y_1=0,1,2, \\space y_2=-2,-1,0,1,2\n\\end{aligned}\n$$\n이다.\n\n* exmaple 2\n\n$X_1$ 과 $X_2$ 의 결합확률분포가 다음과 같을 때 변환된 $Y_1=X_1+X_2$ 와 $Y_2=X_1X_2$ 의 결합확률 분포는?\n\n::: {#tbl-panel layout-ncol=2}\n\n| $(x_1,x_2)$|   (0, 0) |     (0, 1) | (1, 0) | (1, 1) |\n|----------|:----:|:-----:|:------:|:------:|\n| $f_X(x_1,x_2)$| $\\frac{1}{4}$ | $\\frac{1}{4}$ | $\\frac{1}{4}$ | $\\frac{1}{4}$ |\n\n: Probability Distribution of $X$\n\n| $(y_1,y_2)$|   (0, 0)| (1, 0) | (2, 1) |\n|----------|:----:|:-----:|:------:|:------:|\n| $f_Y(y_1,y_2)$| $\\frac{1}{4}$ | $\\frac{2}{4}$ | $\\frac{1}{4}$ |\n\n: Probability Distribution of $Y$\n\nExmaple: Transformation of Joint Discrete Random Variable (Not One to One)\n:::\n\n### Trnasformation of Continuous Random Variables\n\n::: {#thm-continuous}\n\ncontinuous random variable $X$ 의 probability distribution이 $f_X(x)$ 이고 $X$ 와 $Y$ 사이에는 $Y=u(X)$ 라는 one-to-one relation이 성립될 때 $y=u(x)$ 를 유일한 $x$ 를 $y$ 에 대한 함수인 $x=w(y)$ 로 표현 가능할 때 Y의 확률 분포는 \n$$\nf_Y(y)=f_X(w(y))|J|\n$$ \n이다. ($J=w'(y)$, called 'Jacobian')\n:::\n\n#### Example\n\n* In the case of a One-to-One relation\n\n지수분포(exponential distribution)는 연속 확률 분포 중 하나로, 사건이 서로 독립적일 때, 일정 시간동안 발생하는 사건의 횟수가 푸아송 분포를 따른다면, 다음 사건이 발생할 때까지의 대기 시간을 확률 변수 $X \\in [0, \\infty)$ 로 하는 분포이다. [(Source: Wiki)](https://en.wikipedia.org/wiki/Exponential_distribution).\n\n참고:\n$$\n\\begin{aligned}\n  X&\\sim Exp(\\lambda) \\\\\n  \\text E[X] &= \\frac{1}{\\lambda}\\\\\n  \\text{Var}[X] &= \\frac{1}{\\lambda^2}\\\\\n  f(x;\\lambda)&=\n  \\begin{cases} \n    \\lambda e^{-\\lambda x} & x \\ge 0\\\\\n    0 & x<0\n  \\end{cases}\\\\\n\\end{aligned}\n$$\n$\\lambda>0$ is the parameter of the distribution, called 'rate parameter'.\n\nTransformation of Linear Function. When two random variables $X \\sim \\text{exp}(\\lambda)$ and $Y$ has the relation, $Y=aX+b$ $(a\\ne 0)$. When $f_X(x)=\\lambda e^{-\\lambda x}$, $f_Y(y)$ is\n\n**By Theorem**\n\n$$\n\\begin{aligned}\n  Y&=u(X)=aX+b\\\\\n  y&=u(x)=ax+b\\\\\n  x&=w(y)=\\frac{y-b}{a}\\\\\n  f_Y(y)&=f_X(w(y))|J|=f_X(\\frac{y-b}{a})|J|\\\\\n        &=f_X(\\frac{y-b}{a})|w'(y)|\\\\\n        &=f_X(\\frac{y-b}{a})|\\frac{1}{a}|\\\\\n        &=\\frac{f_X(\\frac{y-b}{a})}{|a|}\\\\\n\\end{aligned}\n$$\n\n**By Definition**\n\n:::: {.columns}\n\n::: {.column width=\"50%\"}\n* $a>0$\n$$\n\\begin{aligned}\n  F_Y(Y)&=P_Y(Y\\le y)\\\\\n        &=P_Y(aX+b\\le y)\\\\\n        &=P_Y(X\\le \\frac{y-b}{a})\\\\\n        &=F_X(\\frac{y-b}{a})\\\\\n  F'_Y(Y)&=\\frac{d}{dy}F_X(\\frac{y-b}{a})\\\\\n         &=f_X(\\frac{y-b}{a})\\frac{1}{a}\\\\\n\\end{aligned}\n$$\n\n:::\n\n::: {.column width=\"50%\"}\n* $a\\le 0$\n$$\n\\begin{aligned}\n  F_Y(Y)&=P_Y(Y\\le y)\\\\\n        &=P_Y(aX+b\\le y)\\\\\n        &=P_Y(X> \\frac{y-b}{a})\\\\\n        &=1-F_X(\\frac{y-b}{a})\\\\\n  F'_Y(Y)&=\\frac{d}{dy}(1-F_X(\\frac{y-b}{a}))\\\\\n         &=-f_X(\\frac{y-b}{a})\\frac{1}{a}\\\\  \n\\end{aligned}\n$$\n:::\n\n$$\n\\therefore f_Y(y)=\\frac{f_X(\\frac{y-b}{a})}{|a|}=\\frac{\\lambda exp(-\\lambda (\\frac{y-b}{a}))}{|a|}\n$$\n\n::::\n\n위의 정리를 유도를 하진 않았지만 증명을 해보면 사실, $|J|$ 는 역함수의 미분의 계수인 것을 할 수 있다. 위의 예시를 **By definition** 으로 푼 것을 보면 $y=u(x)$ 와 $x=w(y)$ 의 관계인 것을 알 수 있고 $|J|$ 에 해당되는 $\\frac{1}{a}$ 는 CDF $F(Y)$ 의 derivative를 구하는 과정에서 발생하는 chain rule에 의해 생긴 것을 알 수 있다. \n\n$$\n\\begin{aligned}\n  y&=u(x)\\\\\n  \\frac{dy}{dx}&=u'(x)\\\\\n  x&=w(y)=u^{-1}(y)\\\\\n  \\frac{dx}{dy}&=w'(y) \\\\\n  w'(y)&=\\frac{dx}{dy}=(\\frac{dy}{dx})^{-1}=\\frac{1}{u'(x)}\n\\end{aligned}\n$$\n\n```{python}\nimport numpy as np\nimport matplotlib.pyplot as plt\n\nx = np.linspace(-10, 20, 1000)\ny = 2*x+1\ny2 = x/2+1\n\nfig, ax = plt.subplots()\n\n\nax.axhline(y=0, color='k')\nax.axvline(x=0, color='k')\nax.grid(True, which='both')\n\nax.plot(x,x,color='black',label=r'$y=x$', linestyle='dashed')\nax.plot(x,2*x-2,color='black',label=r'$x=w(y) \\rightarrow y=2x-2 $')\nax.plot(x,y2,color='red',label=r'$y=u(x)=\\frac{1}{2}x+1$')\nax.set_aspect(1)\nax.set_title(r\"Example of Relation of X and Y, $y=u(x)$ vs $x=w(y)$\")\nax.set_xlabel(\"x-axis\")\nax.set_ylabel(\"y-axis\")\nax.set_xlim(-20, 40)\n\nplt.legend(shadow=True, loc=(-0.5, 1.1), handlelength=1.5, fontsize=8)\nplt.show()\n\n```\n\n\n```{python}\nimport numpy as np\nimport matplotlib.pyplot as plt\n\nx = np.linspace(-10, 20, 1000)\ny = 2*x+1\ny2 = x/2+1\n\nfig, ax = plt.subplots()\n\n\nax.axhline(y=0, color='k')\nax.axvline(x=0, color='k')\nax.grid(True, which='both')\n\nax.plot(x,y,color='black',label=r'$y=2x+1$')\nax.plot(x,y2,color='red',label=r'$y=\\frac{1}{2}x+1$')\nax.set_aspect(1)\nax.set_title(r\"Transformation of Linear Function, $f_Y(y)=\\frac{f_X(\\frac{y-b}{a})}{|a|}$\")\nax.set_xlabel(\"X\")\nax.set_ylabel(\"Y=u(X)\")\nax.set_xlim(-20, 40)\nax.text(10, 0,'|', color='black', horizontalalignment='center', verticalalignment='center')\nax.text(10, -5, r'$\\frac{y-b}{a}$', horizontalalignment='center',color='black')\nax.text(0, 5,'--', color='black', horizontalalignment='center', verticalalignment='center')\nax.text(-9, 5, r'$ax+b$', verticalalignment='center',color='black')\n\nplt.legend(shadow=True, loc=(-0.5, 1.1), handlelength=1.5, fontsize=8)\nplt.show()\n\n```\n\n$P(Y\\le y)=P(X\\le \\frac{y-b}{a})$ 이기 때문에 $X$ 의 특정 구간의 확률과 대응되는 $Y$ 의 구간의 확률이 같다고 했을 때 $Y \\le y$ 의 범위는 $X$ 를 $b$ 만큼 이동한 후 $a$ 배한 $x$ 좌표 이하 구간에 대응 된다 즉, $X\\le \\frac{y-b}{a}$. 이 때, 두 구간에서의 확률 밀도가 같아야 하기 때문에 $f_x(x)$ 가 $f_Y(y)$ 의 $\\frac{1}{a}$ 배 인 것을 알 수 있다.\n\n위의 그림에서 처럼, 두 확률 변수 $X$ 와 $Y$ 의 관계를 $y = 2x+1$ $(a>1)$ 와 $y = \\frac{1}{2}x+1$ $(0 \\le a\\le 1)$ 로 두 가지의 예로 들면, 위의 그래프의 경우, $y = 2x+1$ $(a>1)$ 일 때 $0<X<10$ 는 $1<Y<21$ 의 구간이 2배가 되는 것을 관찰 할 수 있다. 반대로, $y = \\frac{1}{2}x+1$ $(0 \\le a\\le 1)$ 일 때 $0<X<10$ 는 $1<Y<6$ 의 구간이 $\\frac{1}{2}$ 배가 된다. 이 때 각 예시의 경우에 $X$ 와 $Y$ 의 확률 값이 같기 때문에 ($P(Y\\le y)=P(X\\le \\frac{y-1}{2})$ 와 $P(Y\\le y)=P(X\\le \\frac{y-1}{\\frac{1}{2}})$). $f_x(x)$ 가 $f_Y(y)$ 의 각 각 $2$ 배와 $\\frac{1}{2}$ 배 인 것을 추정 할 수 있다.\n\n* In the case of not a One-to-One relation\n\n$Y=X^2$ 일 때,\n\n$$\n\\begin{aligned}\n  F_Y(Y)&=P_Y(Y\\le y)\\\\\n        &=P_Y(X^2\\le y)\\\\\n        &=P_Y(-\\sqrt{y}\\le X \\le \\sqrt y)\\\\\n        &=F_X(\\sqrt{y})-F_X(-\\sqrt{y})\\\\\n  F'_Y(Y)&=\\frac{d}{dy}(F_X(\\sqrt{y})-F_X(-\\sqrt{y}))\\\\\n        &=f_X(\\sqrt{y})\\frac{1}{2\\sqrt{y}}+f_X(-\\sqrt{y})\\frac{1}{2\\sqrt{y}}\\\\\n        &=\\frac{f_X(\\sqrt{y})}{2\\sqrt{y}}+\\frac{f_X(-\\sqrt{y})}{2\\sqrt{y}}\\\\\n\\end{aligned}\n$$\n\n\n```{python}\nimport numpy as np\nimport matplotlib.pyplot as plt\n\nx = np.linspace(-10, 10, 1000)\ny = x*x\n\nfig, ax = plt.subplots()\n\n\nax.axhline(y=0, color='k')\nax.axvline(x=0, color='k')\nax.grid(True, which='both')\n\nax.plot(x,y,color='black',label=r'$y=x^2$')\n#ax.text(3.0,0.5,r'$\\sqrt{y}$')\n#ax.text(-4,0.5,r'$-\\sqrt{y}$')\nax.set_xlim([-10, 10])\nax.set_ylim([0, 10])\n\nax.set_aspect(1)\nax.set_title(r\"Transformation of Random Variables, $y=x^2$\")\nax.set_xlabel(\"x-axis\")\nax.set_ylabel(\"y-axis\")\n\nplt.legend(shadow=True, loc=(-0.2, 1.1), handlelength=1.5, fontsize=8)\nplt.show()\n\n```\n\n$X$ 의 분포를 알고 $X$ 와 $Y$ 의 relation을 알고있을 때 $X$ 의 분포로부터 $Y$ 의 분포를 추정 가능한 것의 이점 중 하나는 $Y$ 의 통계량을 $Y$ 의 분포를 사용하지 않고 계산해낼 수 있다는 점이다.\n\n예를 들어, $X \\sim N(0,1)$ 이고  $Y=u(X)$ 라는 관계를 알고있을 때, $Y$ 의 통계량 $E(Y)$, $Var(Y)$ 를 알고싶다면 굳이 힘들게 $Y$ 의 분포를 계산할 필요가 없다. 이미 $X$ 의 확률 분포 $f_X(x)$ 를 알고있기 때문에 아래와 같이 $Y$ 의 통계량을 계산해낼 수 있다. \n\n$$\n\\begin{aligned}\n  \\text{E}(Y)&=\\int Y f_Y(y) dy\\\\\n            &=\\int u(X) f_X(x) dx\\\\\n  \\text{E}(Y^2)&=\\int Y^2 f_Y(y) dy\\\\\n            &=\\int u(X)^2 f_X(x) dx\\\\\n  \\text{Var}(Y)&=\\text{E}(Y^2)-\\text{E}(Y)^2\\\\\n  &=\\text{E}(g(X)^2)-\\text{E}(g(X))^2\\\\\n\\end{aligned}\n$$\n\n### Trnasformation of Joint Continuous Random Variables\n\n::: {#thm-continuous_joint}\n\nTwo continuous random variable $X_1$ 과 $X_2$ 의 joint probability distribution이 $f(x_1,x_2)$ 이고  $(x_1,x_2)$ 와 $(y_1,y_2)$ 가 one-to-one relation이 성립될 때 $y_1=u_1(x_1,x_2)$ 와 $y_2=u_2(x_1,x_2)$ 를 유일한 $x_1=w_1(y_1,y_2)$ 와 $x_2=w_2(y_1,y_2)$ 의 함수로 표현 가능할 때 $Y_1=u_1(X_1,X_2)$ 와 $Y_2=u_2(X_1,X_2)$ 로 정의되는 새로운 확률변수 $Y_1$ 과 $Y_2$ 의 joint probability distribution는 \n$$\ng(y_1.y_2)=f(w_1(y_1,y_2),w_2(y_1,y_2)) |J|\n$$ \n이다.  \n여기서, \n$$\n\\begin{aligned}\n  |J|=|\n  \\begin{bmatrix}\n  \\frac{\\partial x_1}{\\partial y_1}&\\frac{\\partial x_1}{\\partial y_2}\\\\\n  \\frac{\\partial x_2}{\\partial y_1}&\\frac{\\partial x_2}{\\partial y_2}\\\\\n  \\end{bmatrix}| = | \\begin{bmatrix}\n  \\frac{\\partial w_1(y_1,y_2)}{\\partial y_1}&\\frac{\\partial w_1(y_1,y_2)}{\\partial y_2}\\\\\n  \\frac{\\partial w_2(y_1,y_2)}{\\partial y_1}&\\frac{\\partial w_2(y_1,y_2)}{\\partial y_2}\\\\\n  \\end{bmatrix} |\n\\end{aligned}\n$$\ncalled 'the determinant of jacobian matrix'\n\n:::\n\n#### Example\n\n* 예제\n\n연속확률변수  $X_1$ 과 $X_2$ 는 결합확률분포 \n$$ \nf(x_1,x_2)=\n  \\begin{cases}\n    4x_1x_2, & \\text{if  } 0<x_1<1,& 0< x_2 <1 \\\\ \n    0, & \\text{otherwise}\n  \\end{cases}\n$$ \n일 때, $Y_1=X_1^2$ 과 $Y_2=X_1X_2$ 의 결합확률 분포는\n\n$$\n\\begin{aligned}\ny_1&=u_1(x_1,x_2)= x_1^2\\\\\ny_2&=u_2(x_1,x_2)= x_1x_2\\\\\nx_1&=w_1(y_1,y_2)= \\sqrt{y_1} & (y_1>0)\\\\\nx_2&=w_2(y_1,y_2)= \\frac{y_2}{x_1} = \\frac{y_2}{\\sqrt{y_1}}  & (y_1>0)\\\\\ng(y_1.y_2)&=f(w_1(y_1,y_2),w_2(y_1,y_2))|J|\\\\\ng(y_1.y_2)&=f(w_1(y_1,y_2),w_2(y_1,y_2))|J|\\\\\n          &=4\\sqrt{y_1}\\frac{y_2}{\\sqrt{y_1}}\\frac{1}{2y_1}\\\\\n          &=\\begin{cases}\n          \\frac{2y_2}{y_1} & \\text{if  } y_2^2<y_1<1, \\text{  } 0<y_2<1\\\\\n          0 & \\text{otherwise}\n          \\end{cases}\\\\\n          |J|&=|\n          \\begin{bmatrix}\n          \\frac{\\partial x_1}{\\partial y_1}&\\frac{\\partial x_1}{\\partial y_2}\\\\\n          \\frac{\\partial x_2}{\\partial y_1}&\\frac{\\partial x_2}{\\partial y_2}\\\\\n          \\end{bmatrix}|\\\\\n           &=|\n          \\begin{bmatrix}\n          \\frac{1}{2\\sqrt{y_1}}&0\\\\\n          y_2(-\\frac{1}{2}y_1^{\\frac{-3}{2}})&\\frac{1}{\\sqrt{y_1}}\\\\\n          \\end{bmatrix}|\\\\\n          &=\\frac{1}{2y_1}\n\\end{aligned}\n$$ \n\n이다. \n:::\n\n</div>\n\n\n\n## Blog Guide Map Link\n\n* [Statistics Blog](../guide_map/index.qmd)\n* [Engineering Blog](../../Engineering/guide_map/index.qmd)\n* [Deep Learning Blog](../../DL/guide_map/index.qmd)\n* [Machine Learning Blog](../../ML/guide_map/index.qmd)\n* [Mathematics Blog](../../Mathmatics/guide_map/index.qmd)\n* [Patent Blog](../../Patent/guide_map/index.qmd)\n* [Validation Blog](../../Validation/guide_map/index.qmd)\n\n\n\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":false,"cache":true,"freeze":true,"echo":true,"output":true,"warning":false,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":true,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"message":false,"engine":"jupyter"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":true,"code-overflow":"wrap","code-link":false,"code-line-numbers":true,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","highlight-style":"github","css":["../../../../styles.css"],"toc":true,"toc-depth":3,"number-sections":true,"include-in-header":[{"text":"<style>\n.custom-footer { \n  text-align: center; \n  font-size: 0.8em; \n  color: #666; \n  margin-top: 2rem; \n}\n</style>\n"}],"include-after-body":["../../../../js.html","../../signup.html"],"output-file":"2023-02-21_transformation.html"},"language":{"toc-title-document":"목차","toc-title-website":"목차","related-formats-title":"기타 형식","related-notebooks-title":"Notebooks","source-notebooks-prefix":"원천","other-links-title":"기타 링크","code-links-title":"코드 링크","launch-dev-container-title":"Dev 컨테이너 실행","launch-binder-title":"랜치 Binder","article-notebook-label":"기사 노트북","notebook-preview-download":"노트북 다운로드","notebook-preview-download-src":"소스 다운로드","notebook-preview-back":"기사로 돌아가기","manuscript-meca-bundle":"MECA 아카이브","section-title-abstract":"초록","section-title-appendices":"부록","section-title-footnotes":"각주","section-title-references":"참고문헌","section-title-reuse":"라이센스","section-title-copyright":"저작권","section-title-citation":"인용","appendix-attribution-cite-as":"인용방법","appendix-attribution-bibtex":"BibTeX 인용:","title-block-author-single":"저자","title-block-author-plural":"저자","title-block-affiliation-single":"소속","title-block-affiliation-plural":"소속","title-block-published":"공개","title-block-modified":"Modified","title-block-keywords":"키워드","callout-tip-title":"힌트","callout-note-title":"노트","callout-warning-title":"경고","callout-important-title":"중요","callout-caution-title":"주의","code-summary":"코드","code-tools-menu-caption":"코드","code-tools-show-all-code":"전체 코드 표시","code-tools-hide-all-code":"전체 코드 숨기기","code-tools-view-source":"소스 코드 표시","code-tools-source-code":"소스 코드","tools-share":"Share","tools-download":"Download","code-line":"선","code-lines":"윤곽","copy-button-tooltip":"클립보드 복사","copy-button-tooltip-success":"복사완료!","repo-action-links-edit":"편집","repo-action-links-source":"소스코드 보기","repo-action-links-issue":"이슈 보고","back-to-top":"맨 위로","search-no-results-text":"일치 없음","search-matching-documents-text":"일치된 문서","search-copy-link-title":"검색 링크 복사","search-hide-matches-text":"추가 검색 결과 숨기기","search-more-match-text":"추가 검색결과","search-more-matches-text":"추가 검색결과","search-clear-button-title":"제거","search-text-placeholder":"","search-detached-cancel-button-title":"취소","search-submit-button-title":"검색","search-label":"검색","toggle-section":"토글 섹션","toggle-sidebar":"사이드바 전환","toggle-dark-mode":"다크 모드 전환","toggle-reader-mode":"리더 모드 전환","toggle-navigation":"탐색 전환","crossref-fig-title":"그림","crossref-tbl-title":"표","crossref-lst-title":"목록","crossref-thm-title":"정리","crossref-lem-title":"보조정리","crossref-cor-title":"따름정리","crossref-prp-title":"명제","crossref-cnj-title":"추측","crossref-def-title":"정의","crossref-exm-title":"보기","crossref-exr-title":"예제","crossref-ch-prefix":"장","crossref-apx-prefix":"부록","crossref-sec-prefix":"섹션","crossref-eq-prefix":"방정식","crossref-lof-title":"그림 목록","crossref-lot-title":"표 목록","crossref-lol-title":"코드 목록","environment-proof-title":"증명","environment-remark-title":"주석","environment-solution-title":"해답","listing-page-order-by":"정렬","listing-page-order-by-default":"디폴트","listing-page-order-by-date-asc":"날짜(오름차순)","listing-page-order-by-date-desc":"날짜(내림차순)","listing-page-order-by-number-desc":"페이지 번호(내림차순)","listing-page-order-by-number-asc":"페이지 번호(오름차순)","listing-page-field-date":"날짜","listing-page-field-title":"제목","listing-page-field-description":"설명","listing-page-field-author":"저자","listing-page-field-filename":"파일명","listing-page-field-filemodified":"갱신일","listing-page-field-subtitle":"부제목","listing-page-field-readingtime":"읽기 시간","listing-page-field-wordcount":"단어 수","listing-page-field-categories":"분류","listing-page-minutes-compact":"{0} 분","listing-page-category-all":"전체","listing-page-no-matches":"일치 없음","listing-page-words":"{0} 단어"},"metadata":{"lang":"ko","fig-responsive":true,"quarto-version":"1.4.543","theme":{"light":["cosmo","../../../../theme.scss"],"dark":["cosmo","../../../../theme-dark.scss"]},"code-copy":true,"grid":{"sidebar-width":"200px","body-width":"1200px","margin-width":"200px"},"comments":{"giscus":{"repo":"kmink3225/blog","category":"Blog"}},"title-block-banner":"#EDF3F9","title-block-banner-color":"black","toc-location":"right","open-graph":true,"twitter-card":true,"search":true,"date-format":"YYYY년 MM월 DD일","title":"Transformation of Random Variables","subtitle":"Transformation of Functions","description":"","categories":["Statistics"],"author":"Kwangmin Kim","date":"02/21/2023","draft":false,"page-layout":"full"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}