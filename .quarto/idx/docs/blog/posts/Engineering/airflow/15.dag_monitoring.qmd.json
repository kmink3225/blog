{"title":"Template Variabler","markdown":{"yaml":{"title":"Template Variabler","subtitle":"DAG Creation, Bash Operator, Task Performance Subject,","description":"template\n","categories":["Engineering"],"author":"Kwangmin Kim","date":"05/01/2023","format":{"html":{"page-layout":"full","code-fold":true,"toc":true,"number-sections":true}},"comments":{"utterances":{"repo":"./docs/comments"}},"draft":false},"headingText":"Jinja Template","containsRefs":false,"markdown":"\n\n<ul class=\"nav nav-pills\" id=\"language-tab\" role=\"tablist\">\n  <li class=\"nav-item\" role=\"presentation\">\n    <button class=\"nav-link active\" id=\"Korean-tab\" data-bs-toggle=\"tab\" data-bs-target=\"#Korean\" type=\"button\" role=\"tab\" aria-controls=\"Korean\" aria-selected=\"true\">Korean</button>\n  </li>\n  <li class=\"nav-item\" role=\"presentation\">\n    <button class=\"nav-link\" id=\"English-tab\" data-bs-toggle=\"tab\" data-bs-target=\"#English\" type=\"button\" role=\"tab\" aria-controls=\"knitr\" aria-selected=\"false\">English</button>\n  </li>\n\n<div class=\"tab-content\" id=\"language-tabcontent\">\n\n<div class=\"tab-pane fade  show active\" id=\"Korean\" role=\"tabpanel\" aria-labelledby=\"Korean-tab\">\n\n::: {#Korean .tab-pane .fade .show .active role=\"tabpanel\" aria-labelledby=\"Korean-tab\"}\n\n\n* 문서(파일)에서 특정 양식으로 작성된 값을 런타임시 실제 값으로 치환해주는 처리 엔진\n* 템플릿 엔진은 여러 솔루션이 존재하며 그 중 Jinja 템플릿은 파이썬 언어에서 사용하는 엔진\n\n    ```markdown\n    from jinja2 import Template\n\n    template = Template('my name is {{name}}')\n    new_template = template.render('name=hjkim')\n    print(new_template)\n    ```\n\n* Jinja 템플릿, 어디서 쓰이나?\n    - 파이썬 기반 웹 프레임워크인 Flask, Django에서 주로 사용\n    (주로 HTML 템플릿 저장 후 화면에 보여질 때 실제 값으로 변환해서 출력)\n    - SQL작성시에도 활용 가능\n\n## Airflow에서 사용법\n\n* 오퍼레이터 파라미터 입력시 중괄호 {} 2개를 이용하면 Airflow에서 기본적으로 제공하는 변수들을 치환된 값으로 입력할 수 있음. (ex: 수행 날짜, DAG_ID)\n    - https://airflow.apache.org/docs/apache-airflow/stable/templates-ref.html\n* 모든 오퍼레이터, 모든 파라미터에 Template 변수 적용이 가능한가? No!\n* Airflow 문서에서 어떤 파라미터에 Template 변수 적용 가능한지 확인 필요\n    - https://airflow.apache.org/docs/apacheairflow/stable/_api/airflow/operators/index.html\n\n# BashOperator with Template\n\n## BashOperator\n\n* Bash 오퍼레이터는 어떤 파라미터에 Template를 쓸 수 있는가?\n* 파라미터\n    * bash_command (str)\n    * env (dict[str, str] | None)\n    * append_env (bool)\n    * output_encoding (str)\n    * skip_exit_code (int)\n    * cwd (str | None)\n* https://airflow.apache.org/docs/apache-airflow/stable/_api/airflow/operators/bash/index.html\n\n\n```markdown\nbash_t1 = BashOperator(\n    task_id='bash_t1',\n    bash_command='echo \"End date is {{ data_interval_end }}\"'\n)\nbash_t2 = BashOperator(\n    task_id='bash_t2',\n    env={'START_DATE': '{{ data_interval_start | ds}}','END_DATE':'{{ data_interval_end | ds }}'},\n    bash_command='echo \"Start date is $START_DATE \" && ''echo \"End date is $END_DATE\"'\n)\n\n```\n\n# Airflow Date\n\n## 데이터 추출 예시\n\n* Daily ETL 처리를 위한 조회 쿼리(2023/02/25 0시 실행)\n* example: 등록 테이블\n\n|REG_DATE|NAME|ADDRESS|\n|-----|:-:|:-:|\n|2023-02-24 15:34:35|홍길동|Busan|\n|2023-02-24 19:14:42|김태희|Seoul|\n|2023-02-24 23:52:19|조인성|Daejeon|\n\n```markdown\nSELECT NAME, ADDRESS\nFROM TBL_REG\nWHERE REG_DATE BETWEEN TIMESTAMP('2023-02-24 00:00:00')\nAND TIMESTAMP('2023-02-24 23:59:59')\n```\n데이터 관점의 시작일: 2023-02-24\n데이터 관점의 종료일: 2023-02-25\n\n\n## Airflow 날짜 Template 변수\n\n* 예시: 일 배치\n    * ex. 2023-02-24 이전 배치일 (논리적 기준일)\n        * = data_interval_start\n        * = dag_run.logical_date\n        * = ds (yyyy-mm-dd 형식)\n        * = ts (타임스탬프)\n        * = execution_date (과거버전)\n    * ex. 2023-02-25 배치일\n        * = data_interval_end\n        * = \n        * = \n        * = \n        * = next_execution_date (과거버전)\n\n# Python Operator with Template\n\n## Python 오퍼레이터에서 Template 변수 사용\n\n* Python 오퍼레이터는 어떤 파라미터에 Template을 쓸 수 있는가?\n* 파라미터\n    * python_callable\n    * op_kwargs\n    * op_args\n    * templates_dict\n    * templates_exts\n    * show_return_value_in_logs\n* https://airflow.apache.org/docs/apache-airflow/stable/_api/airflow/operators/python/index.html\n\n    ```markdown\n    def python_function1(start_date, end_date, **kwargs):\n        print(start_date)\n        print(end_date)\n\n    python_t1 = PythonOperator(\n        task_id='python_t1',\n        python_callable=python_function,\n        op_kwargs={'start_date':'{{data_interval_start | ds}}', 'end_date':'{{data_interval_end | ds}}'}\n    )\n    ```\n\n* 파이썬 오퍼레이터는 **kwargs에 Template 변수들을 자동으로 제공해주고 있음\n\n    ```markdown\n    @task(task_id='python_t2')\n    def python_function2(**kwargs):\n        print(kwargs)\n        print('ds:' + kwargs['ds'])\n        print('ts:' + str(kwargs['ts']))\n        print('data_interval_start:' + str(kwargs['data_interval_start']))\n        print('data_interval_end:' + str(kwargs['data_interval_end']))\n        print('task_instance': + str(kwargs['ti']))\n    python_function2()\n    ```\n\n# Bash Operator with Macro\n\n## Macro 변수의 이해\n\n* Macro 변수의 필요성\n\n    ```markdown\n    sql = f'''\n    SELECT NAME, ADDRESS\n    FROM TBL_REG\n    WHERE REG_DATE BETWEEN ?? AND ??\n    '''\n    ```\n\n    DAG 스케줄은 매일 말일에 도는 스케줄인데\n    BETWEEN 값을 전월 마지막일부터 어제 날짜까지 주고\n    싶은데 어떻게 하지?\n    예를 들어\n    배치일이 1월 31일이면 12월 31일부터 1월 30일 까지\n    배치일이 2월 28일이면 1월 31일부터 2월 27일까지\n    BETWEEN 이 설정되었으면 좋겠어.\n    DAG 스케줄이 월 단위이니까\n    Template 변수에서 data_interval_start 값은 한달 전 말일\n    이니까 시작일은 해결될 것 같은데 끝 부분은 어떻게 만들지? \n    data_interval_end 에서 하루 뺀 값이 나와야 하는데…\n\n* Template 변수 기반 다양한 날짜 연산이 가능하도록 연산 모듈을 제공하고 있음\n\n    |Variable|Description|\n    |:--:|------|\n    |macros.datetime|The standard lib's datetime.datetime|\n    |macros.timedelta|The standard lib's datetime.timedelta|\n    |macros.dateutil|A reference to the dateutil package|\n    |macros.time|The standard lib's time|\n    |macros.uuid|The standard lib's uuid|\n    |macros.random|The standard lib's random|\n\n    * macros.datetime & macros.dateutil: 날짜 연산에 유용한 파이썬 라이브러리\n* Macro를 잘 쓰려면 파이썬 datetime 및 dateutil 라이브러리에 익숙해져야 함.\n\n## 파이썬 datetime + dateutil 라이브러리 이해\n\n```markdown\nfrom datetime import datetime\nfrom dateutil import relativedelta\n\nnow = datetime(year=2003, month=3, day=30)\nprint('current time:'+str(now))\nprint('-------------month operation-------------')\nprint(now+relativedelta.relativedelta(month=1)) # 1월로 변경\nprint(now.replace(month=1)) # 1월로 변경\nprint(now+relativedelta.relativedelta(months=-1)) # 1개월 빼기\nprint('-------------day operation-------------')\nprint(now+relativedelta.relativedelta(day=1)) #1일로 변경\nprint(now.replace(day=1)) #1일로 변경\nprint(now+relativedelta.relativedelta(days=-1)) #1일 빼기\nprint('-------------multiple operations-------------')\nprint(now+relativedelta.relativedelta(months=-1)+relativedelta.relativedelta(days=-1)) #1개월, 1일 빼기\n```\n\n## Bash 오퍼레이터에서 Macro 변수 활용하기\n\n* 예시1. 매월 말일 수행되는 Dag에서 변수 START_DATE: 전월 말일, 변수 END_DATE: 어제로 env 셋팅하기\n* 예시2. 매월 둘째주 토요일에 수행되는 Dag에서 변수 START_DATE: 2주 전 월요일 변수 END_DATE: 2주 전 토요일로 env 셋팅하기\n* 변수는 YYYY-MM-DD 형식으로 나오도록 할 것\n\n    ```markdown\n    t1 = BashOperator(\n        task_id='t1',\n        env={'START_DATE':''},\n    )\n    ```\n\n이 부분에 template + macro 활용\n\n# Python 오퍼레이터 with macro\n\n* 어떤 파라미터가 Template 변수를 지원할까?\n* 패러미터\n    * python_callable (Callable | None)\n    * op_kwargs\n    * op_args\n    * templates_dict\n    * templates_exts\n    * show_return_value_in_logs\n* https://airflow.apache.org/docs/apacheairflow/stable/_api/airflow/operators/python/index.html#airflow.operators.python.PythonOperator\n\n    ```markdown\n    @task(task_id='task_using_macros',\n        templates_dict={'start_date':'{{ (data_interval_end.in_timezone(\"Asia/Seoul\")\n    + macros.dateutil.relativedelta.relativedelta(months=-1, day=1)) | ds }}',\n    'end_date': '{{\n    (data_interval_end.in_timezone(\"Asia/Seoul\").replace(day=1) +\n    macros.dateutil.relativedelta.relativedelta(days=-1)) | ds }}'\n        }\n    )\n    \n    def get_datetime_macro(**kwargs):\n        templates_dict = kwargs.get('templates_dict') or {}\n        if templates_dict:\n        start_date = templates_dict.get('start_date') or 'start_date없음'\n        end_date = templates_dict.get('end_date') or 'end_date없음'\n        print(start_date)\n        print(end_date)\n    ```\n* 그러나 Python 오퍼레이터에서 굳이 macro를 사용할 필요가 있을까? 날짜 연산을 DAG안에서 직접 할 수 있다면?\n    * macro 사용\n    ```markdown\n    @task(task_id='task_using_macros',\n        templates_dict={'start_date':'{{ (data_interval_end.in_timezone(\"Asia/Seoul\") + macros.dateutil.relativedelta.relativedelta(months=-1,day=1)) | ds }}',\n        'end_date': '{{ (data_interval_end.in_timezone(\"Asia/Seoul\").replace(day=1) +\n        macros.dateutil.relativedelta.relativedelta(days=-1)) | ds }}'\n        }\n    )\n\n    def get_datetime_macro(**kwargs):\n        templates_dict = kwargs.get('templates_dict') or {}\n        if templates_dict:\n            start_date = templates_dict.get('start_date') or 'start_date없음'\n            end_date = templates_dict.get('end_date') or 'end_date없음'\n            print(start_date)\n            print(end_date)\n\n    @task(task_id='task_direct_calc')\n    def get_datetime_calc(**kwargs):\n        from dateutil.relativedelta import relativedelta\n        data_interval_end = kwargs['data_interval_end']\n    ```\n\n    * 직접 연산\n\n    ```markdown\n    prev_month_day_first = data_interval_end.in_timezone('Asia/Seoul') + relativedelta(months=-1, day=1)\n    prev_month_day_last = data_interval_end.in_timezone('Asia/Seoul').replace(day=1) + relativedelta(days=-1)\n    print(prev_month_day_first.strftime('%Y-%m-%d'))\n    print(prev_month_day_last.strftime('%Y-%m-%d'))\n    ```\n:::\n</div>\n\n<div class=\"tab-pane fade\" id=\"English\" role=\"tabpanel\" aria-labelledby=\"English-tab\">\n\n::: {#English .tab-pane .fade role=\"tabpanel\" aria-labelledby=\"English-tab\"}\n\n:::\n\n\n</div>\n\n# Go to Blog Content List\n\n[Blog Content List](../../content_list.qmd)  \n[Engineering Content List](../../Engineering/guide_map/index.qmd)","srcMarkdownNoYaml":"\n\n<ul class=\"nav nav-pills\" id=\"language-tab\" role=\"tablist\">\n  <li class=\"nav-item\" role=\"presentation\">\n    <button class=\"nav-link active\" id=\"Korean-tab\" data-bs-toggle=\"tab\" data-bs-target=\"#Korean\" type=\"button\" role=\"tab\" aria-controls=\"Korean\" aria-selected=\"true\">Korean</button>\n  </li>\n  <li class=\"nav-item\" role=\"presentation\">\n    <button class=\"nav-link\" id=\"English-tab\" data-bs-toggle=\"tab\" data-bs-target=\"#English\" type=\"button\" role=\"tab\" aria-controls=\"knitr\" aria-selected=\"false\">English</button>\n  </li>\n\n<div class=\"tab-content\" id=\"language-tabcontent\">\n\n<div class=\"tab-pane fade  show active\" id=\"Korean\" role=\"tabpanel\" aria-labelledby=\"Korean-tab\">\n\n::: {#Korean .tab-pane .fade .show .active role=\"tabpanel\" aria-labelledby=\"Korean-tab\"}\n\n# Jinja Template\n\n* 문서(파일)에서 특정 양식으로 작성된 값을 런타임시 실제 값으로 치환해주는 처리 엔진\n* 템플릿 엔진은 여러 솔루션이 존재하며 그 중 Jinja 템플릿은 파이썬 언어에서 사용하는 엔진\n\n    ```markdown\n    from jinja2 import Template\n\n    template = Template('my name is {{name}}')\n    new_template = template.render('name=hjkim')\n    print(new_template)\n    ```\n\n* Jinja 템플릿, 어디서 쓰이나?\n    - 파이썬 기반 웹 프레임워크인 Flask, Django에서 주로 사용\n    (주로 HTML 템플릿 저장 후 화면에 보여질 때 실제 값으로 변환해서 출력)\n    - SQL작성시에도 활용 가능\n\n## Airflow에서 사용법\n\n* 오퍼레이터 파라미터 입력시 중괄호 {} 2개를 이용하면 Airflow에서 기본적으로 제공하는 변수들을 치환된 값으로 입력할 수 있음. (ex: 수행 날짜, DAG_ID)\n    - https://airflow.apache.org/docs/apache-airflow/stable/templates-ref.html\n* 모든 오퍼레이터, 모든 파라미터에 Template 변수 적용이 가능한가? No!\n* Airflow 문서에서 어떤 파라미터에 Template 변수 적용 가능한지 확인 필요\n    - https://airflow.apache.org/docs/apacheairflow/stable/_api/airflow/operators/index.html\n\n# BashOperator with Template\n\n## BashOperator\n\n* Bash 오퍼레이터는 어떤 파라미터에 Template를 쓸 수 있는가?\n* 파라미터\n    * bash_command (str)\n    * env (dict[str, str] | None)\n    * append_env (bool)\n    * output_encoding (str)\n    * skip_exit_code (int)\n    * cwd (str | None)\n* https://airflow.apache.org/docs/apache-airflow/stable/_api/airflow/operators/bash/index.html\n\n\n```markdown\nbash_t1 = BashOperator(\n    task_id='bash_t1',\n    bash_command='echo \"End date is {{ data_interval_end }}\"'\n)\nbash_t2 = BashOperator(\n    task_id='bash_t2',\n    env={'START_DATE': '{{ data_interval_start | ds}}','END_DATE':'{{ data_interval_end | ds }}'},\n    bash_command='echo \"Start date is $START_DATE \" && ''echo \"End date is $END_DATE\"'\n)\n\n```\n\n# Airflow Date\n\n## 데이터 추출 예시\n\n* Daily ETL 처리를 위한 조회 쿼리(2023/02/25 0시 실행)\n* example: 등록 테이블\n\n|REG_DATE|NAME|ADDRESS|\n|-----|:-:|:-:|\n|2023-02-24 15:34:35|홍길동|Busan|\n|2023-02-24 19:14:42|김태희|Seoul|\n|2023-02-24 23:52:19|조인성|Daejeon|\n\n```markdown\nSELECT NAME, ADDRESS\nFROM TBL_REG\nWHERE REG_DATE BETWEEN TIMESTAMP('2023-02-24 00:00:00')\nAND TIMESTAMP('2023-02-24 23:59:59')\n```\n데이터 관점의 시작일: 2023-02-24\n데이터 관점의 종료일: 2023-02-25\n\n\n## Airflow 날짜 Template 변수\n\n* 예시: 일 배치\n    * ex. 2023-02-24 이전 배치일 (논리적 기준일)\n        * = data_interval_start\n        * = dag_run.logical_date\n        * = ds (yyyy-mm-dd 형식)\n        * = ts (타임스탬프)\n        * = execution_date (과거버전)\n    * ex. 2023-02-25 배치일\n        * = data_interval_end\n        * = \n        * = \n        * = \n        * = next_execution_date (과거버전)\n\n# Python Operator with Template\n\n## Python 오퍼레이터에서 Template 변수 사용\n\n* Python 오퍼레이터는 어떤 파라미터에 Template을 쓸 수 있는가?\n* 파라미터\n    * python_callable\n    * op_kwargs\n    * op_args\n    * templates_dict\n    * templates_exts\n    * show_return_value_in_logs\n* https://airflow.apache.org/docs/apache-airflow/stable/_api/airflow/operators/python/index.html\n\n    ```markdown\n    def python_function1(start_date, end_date, **kwargs):\n        print(start_date)\n        print(end_date)\n\n    python_t1 = PythonOperator(\n        task_id='python_t1',\n        python_callable=python_function,\n        op_kwargs={'start_date':'{{data_interval_start | ds}}', 'end_date':'{{data_interval_end | ds}}'}\n    )\n    ```\n\n* 파이썬 오퍼레이터는 **kwargs에 Template 변수들을 자동으로 제공해주고 있음\n\n    ```markdown\n    @task(task_id='python_t2')\n    def python_function2(**kwargs):\n        print(kwargs)\n        print('ds:' + kwargs['ds'])\n        print('ts:' + str(kwargs['ts']))\n        print('data_interval_start:' + str(kwargs['data_interval_start']))\n        print('data_interval_end:' + str(kwargs['data_interval_end']))\n        print('task_instance': + str(kwargs['ti']))\n    python_function2()\n    ```\n\n# Bash Operator with Macro\n\n## Macro 변수의 이해\n\n* Macro 변수의 필요성\n\n    ```markdown\n    sql = f'''\n    SELECT NAME, ADDRESS\n    FROM TBL_REG\n    WHERE REG_DATE BETWEEN ?? AND ??\n    '''\n    ```\n\n    DAG 스케줄은 매일 말일에 도는 스케줄인데\n    BETWEEN 값을 전월 마지막일부터 어제 날짜까지 주고\n    싶은데 어떻게 하지?\n    예를 들어\n    배치일이 1월 31일이면 12월 31일부터 1월 30일 까지\n    배치일이 2월 28일이면 1월 31일부터 2월 27일까지\n    BETWEEN 이 설정되었으면 좋겠어.\n    DAG 스케줄이 월 단위이니까\n    Template 변수에서 data_interval_start 값은 한달 전 말일\n    이니까 시작일은 해결될 것 같은데 끝 부분은 어떻게 만들지? \n    data_interval_end 에서 하루 뺀 값이 나와야 하는데…\n\n* Template 변수 기반 다양한 날짜 연산이 가능하도록 연산 모듈을 제공하고 있음\n\n    |Variable|Description|\n    |:--:|------|\n    |macros.datetime|The standard lib's datetime.datetime|\n    |macros.timedelta|The standard lib's datetime.timedelta|\n    |macros.dateutil|A reference to the dateutil package|\n    |macros.time|The standard lib's time|\n    |macros.uuid|The standard lib's uuid|\n    |macros.random|The standard lib's random|\n\n    * macros.datetime & macros.dateutil: 날짜 연산에 유용한 파이썬 라이브러리\n* Macro를 잘 쓰려면 파이썬 datetime 및 dateutil 라이브러리에 익숙해져야 함.\n\n## 파이썬 datetime + dateutil 라이브러리 이해\n\n```markdown\nfrom datetime import datetime\nfrom dateutil import relativedelta\n\nnow = datetime(year=2003, month=3, day=30)\nprint('current time:'+str(now))\nprint('-------------month operation-------------')\nprint(now+relativedelta.relativedelta(month=1)) # 1월로 변경\nprint(now.replace(month=1)) # 1월로 변경\nprint(now+relativedelta.relativedelta(months=-1)) # 1개월 빼기\nprint('-------------day operation-------------')\nprint(now+relativedelta.relativedelta(day=1)) #1일로 변경\nprint(now.replace(day=1)) #1일로 변경\nprint(now+relativedelta.relativedelta(days=-1)) #1일 빼기\nprint('-------------multiple operations-------------')\nprint(now+relativedelta.relativedelta(months=-1)+relativedelta.relativedelta(days=-1)) #1개월, 1일 빼기\n```\n\n## Bash 오퍼레이터에서 Macro 변수 활용하기\n\n* 예시1. 매월 말일 수행되는 Dag에서 변수 START_DATE: 전월 말일, 변수 END_DATE: 어제로 env 셋팅하기\n* 예시2. 매월 둘째주 토요일에 수행되는 Dag에서 변수 START_DATE: 2주 전 월요일 변수 END_DATE: 2주 전 토요일로 env 셋팅하기\n* 변수는 YYYY-MM-DD 형식으로 나오도록 할 것\n\n    ```markdown\n    t1 = BashOperator(\n        task_id='t1',\n        env={'START_DATE':''},\n    )\n    ```\n\n이 부분에 template + macro 활용\n\n# Python 오퍼레이터 with macro\n\n* 어떤 파라미터가 Template 변수를 지원할까?\n* 패러미터\n    * python_callable (Callable | None)\n    * op_kwargs\n    * op_args\n    * templates_dict\n    * templates_exts\n    * show_return_value_in_logs\n* https://airflow.apache.org/docs/apacheairflow/stable/_api/airflow/operators/python/index.html#airflow.operators.python.PythonOperator\n\n    ```markdown\n    @task(task_id='task_using_macros',\n        templates_dict={'start_date':'{{ (data_interval_end.in_timezone(\"Asia/Seoul\")\n    + macros.dateutil.relativedelta.relativedelta(months=-1, day=1)) | ds }}',\n    'end_date': '{{\n    (data_interval_end.in_timezone(\"Asia/Seoul\").replace(day=1) +\n    macros.dateutil.relativedelta.relativedelta(days=-1)) | ds }}'\n        }\n    )\n    \n    def get_datetime_macro(**kwargs):\n        templates_dict = kwargs.get('templates_dict') or {}\n        if templates_dict:\n        start_date = templates_dict.get('start_date') or 'start_date없음'\n        end_date = templates_dict.get('end_date') or 'end_date없음'\n        print(start_date)\n        print(end_date)\n    ```\n* 그러나 Python 오퍼레이터에서 굳이 macro를 사용할 필요가 있을까? 날짜 연산을 DAG안에서 직접 할 수 있다면?\n    * macro 사용\n    ```markdown\n    @task(task_id='task_using_macros',\n        templates_dict={'start_date':'{{ (data_interval_end.in_timezone(\"Asia/Seoul\") + macros.dateutil.relativedelta.relativedelta(months=-1,day=1)) | ds }}',\n        'end_date': '{{ (data_interval_end.in_timezone(\"Asia/Seoul\").replace(day=1) +\n        macros.dateutil.relativedelta.relativedelta(days=-1)) | ds }}'\n        }\n    )\n\n    def get_datetime_macro(**kwargs):\n        templates_dict = kwargs.get('templates_dict') or {}\n        if templates_dict:\n            start_date = templates_dict.get('start_date') or 'start_date없음'\n            end_date = templates_dict.get('end_date') or 'end_date없음'\n            print(start_date)\n            print(end_date)\n\n    @task(task_id='task_direct_calc')\n    def get_datetime_calc(**kwargs):\n        from dateutil.relativedelta import relativedelta\n        data_interval_end = kwargs['data_interval_end']\n    ```\n\n    * 직접 연산\n\n    ```markdown\n    prev_month_day_first = data_interval_end.in_timezone('Asia/Seoul') + relativedelta(months=-1, day=1)\n    prev_month_day_last = data_interval_end.in_timezone('Asia/Seoul').replace(day=1) + relativedelta(days=-1)\n    print(prev_month_day_first.strftime('%Y-%m-%d'))\n    print(prev_month_day_last.strftime('%Y-%m-%d'))\n    ```\n:::\n</div>\n\n<div class=\"tab-pane fade\" id=\"English\" role=\"tabpanel\" aria-labelledby=\"English-tab\">\n\n::: {#English .tab-pane .fade role=\"tabpanel\" aria-labelledby=\"English-tab\"}\n\n:::\n\n\n</div>\n\n# Go to Blog Content List\n\n[Blog Content List](../../content_list.qmd)  \n[Engineering Content List](../../Engineering/guide_map/index.qmd)"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":true,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"markdown"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":true,"code-overflow":"wrap","code-link":false,"code-line-numbers":true,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","highlight-style":"github","css":["../../../../../styles.css"],"toc":true,"toc-depth":3,"number-sections":true,"include-in-header":[{"text":"<style>\n.custom-footer { \n  text-align: center; \n  font-size: 0.8em; \n  color: #666; \n  margin-top: 2rem; \n}\n</style>\n"}],"include-after-body":["../../../../../js.html","../../../signup.html"],"output-file":"15.dag_monitoring.html"},"language":{"toc-title-document":"목차","toc-title-website":"목차","related-formats-title":"기타 형식","related-notebooks-title":"Notebooks","source-notebooks-prefix":"원천","other-links-title":"기타 링크","code-links-title":"코드 링크","launch-dev-container-title":"Dev 컨테이너 실행","launch-binder-title":"랜치 Binder","article-notebook-label":"기사 노트북","notebook-preview-download":"노트북 다운로드","notebook-preview-download-src":"소스 다운로드","notebook-preview-back":"기사로 돌아가기","manuscript-meca-bundle":"MECA 아카이브","section-title-abstract":"초록","section-title-appendices":"부록","section-title-footnotes":"각주","section-title-references":"참고문헌","section-title-reuse":"라이센스","section-title-copyright":"저작권","section-title-citation":"인용","appendix-attribution-cite-as":"인용방법","appendix-attribution-bibtex":"BibTeX 인용:","title-block-author-single":"저자","title-block-author-plural":"저자","title-block-affiliation-single":"소속","title-block-affiliation-plural":"소속","title-block-published":"공개","title-block-modified":"Modified","title-block-keywords":"키워드","callout-tip-title":"힌트","callout-note-title":"노트","callout-warning-title":"경고","callout-important-title":"중요","callout-caution-title":"주의","code-summary":"코드","code-tools-menu-caption":"코드","code-tools-show-all-code":"전체 코드 표시","code-tools-hide-all-code":"전체 코드 숨기기","code-tools-view-source":"소스 코드 표시","code-tools-source-code":"소스 코드","tools-share":"Share","tools-download":"Download","code-line":"선","code-lines":"윤곽","copy-button-tooltip":"클립보드 복사","copy-button-tooltip-success":"복사완료!","repo-action-links-edit":"편집","repo-action-links-source":"소스코드 보기","repo-action-links-issue":"이슈 보고","back-to-top":"맨 위로","search-no-results-text":"일치 없음","search-matching-documents-text":"일치된 문서","search-copy-link-title":"검색 링크 복사","search-hide-matches-text":"추가 검색 결과 숨기기","search-more-match-text":"추가 검색결과","search-more-matches-text":"추가 검색결과","search-clear-button-title":"제거","search-text-placeholder":"","search-detached-cancel-button-title":"취소","search-submit-button-title":"검색","search-label":"검색","toggle-section":"토글 섹션","toggle-sidebar":"사이드바 전환","toggle-dark-mode":"다크 모드 전환","toggle-reader-mode":"리더 모드 전환","toggle-navigation":"탐색 전환","crossref-fig-title":"그림","crossref-tbl-title":"표","crossref-lst-title":"목록","crossref-thm-title":"정리","crossref-lem-title":"보조정리","crossref-cor-title":"따름정리","crossref-prp-title":"명제","crossref-cnj-title":"추측","crossref-def-title":"정의","crossref-exm-title":"보기","crossref-exr-title":"예제","crossref-ch-prefix":"장","crossref-apx-prefix":"부록","crossref-sec-prefix":"섹션","crossref-eq-prefix":"방정식","crossref-lof-title":"그림 목록","crossref-lot-title":"표 목록","crossref-lol-title":"코드 목록","environment-proof-title":"증명","environment-remark-title":"주석","environment-solution-title":"해답","listing-page-order-by":"정렬","listing-page-order-by-default":"디폴트","listing-page-order-by-date-asc":"날짜(오름차순)","listing-page-order-by-date-desc":"날짜(내림차순)","listing-page-order-by-number-desc":"페이지 번호(내림차순)","listing-page-order-by-number-asc":"페이지 번호(오름차순)","listing-page-field-date":"날짜","listing-page-field-title":"제목","listing-page-field-description":"설명","listing-page-field-author":"저자","listing-page-field-filename":"파일명","listing-page-field-filemodified":"갱신일","listing-page-field-subtitle":"부제목","listing-page-field-readingtime":"읽기 시간","listing-page-field-wordcount":"단어 수","listing-page-field-categories":"분류","listing-page-minutes-compact":"{0} 분","listing-page-category-all":"전체","listing-page-no-matches":"일치 없음","listing-page-words":"{0} 단어"},"metadata":{"lang":"ko","fig-responsive":true,"quarto-version":"1.4.543","theme":{"light":["cosmo","../../../../../theme.scss"],"dark":["cosmo","../../../../../theme-dark.scss"]},"code-copy":true,"grid":{"sidebar-width":"200px","body-width":"1200px","margin-width":"200px"},"comments":{"giscus":{"repo":"kmink3225/blog","category":"Blog"},"utterances":{"repo":"./docs/comments"}},"title-block-banner":"#EDF3F9","title-block-banner-color":"black","toc-location":"right","open-graph":true,"twitter-card":true,"search":true,"date-format":"YYYY년 MM월 DD일","title":"Template Variabler","subtitle":"DAG Creation, Bash Operator, Task Performance Subject,","description":"template\n","categories":["Engineering"],"author":"Kwangmin Kim","date":"05/01/2023","draft":false,"page-layout":"full"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}